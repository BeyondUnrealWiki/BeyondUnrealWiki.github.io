<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"  "http://www.w3.org/TR/html4/loose.dtd">

<html>
<head lang="en">
	<title>UnrealWiki: BrushBuilder</title>
	<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
	<link rel="stylesheet" type="text/css" media="screen, print"
		href="shared/stylebase.structural.css">	
	<link rel="stylesheet" type="text/css" media="screen"
		href="shared/template-default.css">
	<link rel="stylesheet" type="text/css" media="screen"
		href="shared/styles.chblue.css">
	<link rel="stylesheet" type="text/css" media="print"
		href="shared/template-default-print.css">
	<!--[if IE 6]>
			<style>
			/* dirty hack for IE6. */
			#quickbar {
				position: absolute;
				}
			</style>
	<![endif]-->
  <link rel="start" href="http://wiki.beyondunreal.com/">
  <link rel="glossary"  href="http://wiki.beyondunreal.com/wiki/Terminology">
  <link rel="help"  href="http://wiki.beyondunreal.com/wiki/Using_The_Wiki">
<script type="text/javascript" src="shared/dhtml.js"></script>
<script type="text/javascript" src="shared/dhtml-menu.js"></script>
<style type="text/css">#dhtml-menu    { background: #eee; padding: 5px 0px; margin-right: -20px; border: 1px solid #888; border-left: 1px solid #ccc; border-top: 1px solid #ccc;  border-right: 1px solid #888; border-bottom: 1px solid #888 }
#dhtml-menu td { color: #000; font-family: Arial,Helvetica,sans-serif; font-size: 9pt; line-height: 13pt; padding: 1px 10px; cursor: default }
#dhtml-menu a  { color: #000; font-family: Arial,Helvetica,sans-serif; font-size: 9pt; line-height: 13pt; text-decoration: none }
#dhtml-menu tt { font-family: monospace; font-size: 9pt }
#dhtml-menu-separator { height: 1px; background: red }
#dhtml-menu-anchor { cursor: default }
</style>
<script type="text/javascript" src="shared/expandable.js"></script>
</head>
<body onLoad="menuInit(); document.cookie='page=BrushBuilder; path=/'" class="default">
<div id="scrolling"><!-- contains all except the fixed sidebar -->
<div id="topbar"  class="bar">
	<div class="righthalf">
		<form class="inline" method="post" action="/wiki" enctype="application/x-www-form-urlencoded"><input type="text" name="search"  size="20" /> <input type="submit" name="search" value="search" /></form>
	</div>
	<div class="lefthalf">
		<script type="text/javascript"><!--
			menuAlignRight = false;
		//--></script>
		<span><script type="text/javascript"><!--
 menuWriteAnchor("Quick Navigation") //--></script></span> | <a href="(start).html">Home Page</a> | <a href="recent-changes.html">Recent Changes</a> | <a href="http://wiki.beyondunreal.com/wiki?action=editprefs">Preferences</a>
	</div>
</div>

<div id="content"><!-- contains the title and article -->
	<h1 class='pagetitle'><a href="http://wiki.beyondunreal.com/wiki?back=BrushBuilder">BrushBuilder</a></h1>
	<div class="wiki"><div class="classpath"><img src="shared//gameicons/icon-ut.png"> <a href="unreal-tournament.html">UT</a> :: <a href="object-ut.html">Object (UT)</a> &gt;&gt; BrushBuilder (Package: Editor)<br></div>
<div class="classpath"><img src="shared//gameicons/icon-ut2003.png"> <a href="unreal-tournament-2003.html">UT2003</a> :: <a href="object.html">Object</a> &gt;&gt; BrushBuilder (Package: Editor)<br></div>
<p>This is the base class for <a href="unrealed-3.html">UnrealEd</a>'s <a href="brushbuilders.html">Brushbuilders</a> (mappers should read that page for information on how to use the tools). The rest of this page is more of interest to coders who want to understand or make new brushbuilders. </p>
<h2><a name="0.1"></a>UnrealEd</h2>
<p>The brushbuilder buttons that appear in UnrealEd's <a href="toolbox.html">toolbox</a> are generated by subclasses of this base class. UnrealEd creates an interface button for all the first non-abstract child classes, ie:</p>
<PRE class="tree">Object
  +- BrushBuilder 
       +- MyChildClass -- is loaded
       |    +- MyGrandchildClass  -- isn't loaded
       +- MyAbstractChildClass -- abstract, not loaded
            +- MyOtherGrandchildClass -- is loaded</PRE><p>Functions are inherited as you'd expect, but properties defined in a parent class won't appear in the parameters. In other words, only properties that would appear under the classname if this were a regular actor appear in the brushbuilder parameters box.</p>
<h2><a name="0.2"></a>Interface</h2>
<p>Each script needs a Build() event; this is called when the user clicks the interface icons or the Build button in the parameters window. The parameters seen here correspond to editable variables declared in the class. </p>
<h2><a name="0.3"></a>Functions </h2>
<p>Several native functions perform the basic building commands. </p>
<p>Rough notes on brush creation: </p>
<p class="indent1">This is pure speculation on my (tarquin's) part. The vertex building commands add points as vectors to a dynamic array. The poly building commands then pick these out to define the polys. The array is then discarded for the resulting brush, as can be seen in a brush itself (<a href="brush-hacking.html">Brush Hacking</a>), each poly has a segregated vertex list. At the construction stage, however, a vertex from the array can be used for several polys.</p>
<p class="indent1">BrginBrush() reinitialises the vertex array. This is kept for each class, not in the RBB, so there's (unfortunately) no cross-talk possible between brushbuilder classes.</p>
<h3><a name="0.3.1"></a>BadParameters </h3>
<pre class="uscript">BadParameters<span class="uscript-operator">(</span> <span class="uscript-keyword">optional</span> <span class="uscript-type">string</span> Message <span class="uscript-operator">)</span></pre><p>This function produces a dialog box in UnrealEd displaying <em class="em1">Message</em> and an OK button. It should be called to alert the user of parameters that are out of range, or incompatible options. To span the messgae over several lines in the dialog box, use a string expression with "$ Chr(13) $". The Epic brushbuilder scripts have a block of input-checking conditions after declaring any local variables in the Build() function.</p>
<pre class="uscript"><span class="uscript-keyword">if</span><span class="uscript-operator">(</span> MyParameter <span class="uscript-operator">&lt;=</span> <span class="uscript-number">0</span> <span class="uscript-operator">)</span>
    <span class="uscript-keyword">return</span> BadParameters<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-keyword">if</span><span class="uscript-operator">(</span> HALisUnhappy <span class="uscript-operator">)</span>
    <span class="uscript-keyword">return</span> BadParameters<span class="uscript-operator">(</span><span class="uscript-string">"I'm sorry, David, I can't let you do that."</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-keyword">if</span><span class="uscript-operator">(</span> Confustication <span class="uscript-operator">&amp;&amp;</span> MyParameter <span class="uscript-operator">&gt;</span> <span class="uscript-number">16</span> <span class="uscript-operator">)</span>
    BadParameters<span class="uscript-operator">(</span><span class="uscript-string">"You are about to make a brush that can't be used as a subtract. Click to proceed."</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span></pre><p>A little innovation of Tarquin's not seen in the native builders is using <code>BadParameters()</code> without <code>return</code> as seen in the third example above, to warn the user of non-fatal problems: when the user clicks OK the builder will proceed. If you intend to release your builder, it's vital that you prevent the user from crashing UEd or creating BSP errors in their levels as a result of bad parameters.</p>
<h3><a name="0.3.2"></a>Setting up</h3>
<pre class="uscript">BeginBrush<span class="uscript-operator">(</span> <span class="uscript-type">bool</span> MergeCoplanars <span class="uscript-operator">,</span> <span class="uscript-type">name</span> Group <span class="uscript-operator">)</span></pre><p>This initialises the <a href="red-builder-brush.html">red builder brush</a>. If not included, the vertices and polys from the last build with this class persist, and the brush will be a horrible mess (even if it doesn't look like a mess, polys will be super-imposed. Try applying a masked texture to see!)</p>
<dl><dt>MergeCoplanars</dt><dd>if set to true, the resulting brush will have coplanar sets of polygons merged. Note that non-adjacent polys will be merged if their textures are oriented in the same direction &ndash; the <a href="extruder-brushbuilder.html">Extruder Brushbuilder</a> does this sometimes. Since texture orientation is determined (I think) by the order in which the vertices are listed in the poly definition function call, some care may be needed.</dd><dt>Group</dt><dd>Sets the group name of the brush. Not sure of its purpose. The build-in brushbuilders allow the user to specify this.  </dd></dl>
<pre class="uscript">EndBrush<span class="uscript-operator">(</span><span class="uscript-operator">)</span></pre><p>This wraps up the brush building process. Used to close the Build function thus: </p>
<pre class="uscript"><span class="uscript-keyword">return</span> EndBrush<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span></pre><h3><a name="0.3.3"></a>Vertex building </h3>
<p>Two functions add vertices to the list, taking the position either from a vector or 3 seperate co-ordinates:</p>
<pre class="uscript"><span class="uscript-type">int</span> Vertexv<span class="uscript-operator">(</span> vector V <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-type">int</span> Vertex3f<span class="uscript-operator">(</span> <span class="uscript-type">float</span> x<span class="uscript-operator">,</span> <span class="uscript-type">float</span> y<span class="uscript-operator">,</span> <span class="uscript-type">float</span> z <span class="uscript-operator">)</span><span class="uscript-operator">;</span></pre><p>They return the index of the vertex just created. </p>
<h3><a name="0.3.4"></a>Vertex inspection </h3>
<pre class="uscript">GetVertexCount<span class="uscript-operator">(</span><span class="uscript-operator">)</span></pre><p>Returns the number of vertices currently in the internal array. Since these start with 0, this number is also the index of the next vertex to be built. This is useful for poly building within a function call, as seen in Epic's CylinderBuilders for example.  </p>
<pre class="uscript">GetVertex<span class="uscript-operator">(</span> <span class="uscript-type">int</span> i <span class="uscript-operator">)</span></pre><p>Returns the position vector of a vertex from the array. Useful for bug-tracking, thus:</p>
<pre class="uscript"><span class="uscript-comment">// show me the location of vertex i:</span>
log<span class="uscript-operator">(</span>i <span class="uscript-operator">$</span> <span class="uscript-string">": "</span> <span class="uscript-operator">$</span> <span class="uscript-operator">(</span>GetVertex<span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> </pre><p>There is also a function GetPolyCount(), which I assume returns the number of polys defined.</p>
<h3><a name="0.3.5"></a>Poly building </h3>
<p>Several functions define polygons. They all take similar parameters. </p>
<pre class="uscript"><span class="uscript-comment">// build a 3-sided polygon:</span>
Poly3i<span class="uscript-operator">(</span> Direction<span class="uscript-operator">,</span> i<span class="uscript-operator">,</span> j<span class="uscript-operator">,</span> k<span class="uscript-operator">,</span> ItemName<span class="uscript-operator">,</span> PolyFlags <span class="uscript-operator">)</span>

<span class="uscript-comment">// build a 4-sided polygon:</span>
Poly4i<span class="uscript-operator">(</span> Direction<span class="uscript-operator">,</span> i<span class="uscript-operator">,</span> j<span class="uscript-operator">,</span> k<span class="uscript-operator">,</span> l<span class="uscript-operator">,</span> ItemName<span class="uscript-operator">,</span> PolyFlags <span class="uscript-operator">)</span>

<span class="uscript-comment">// build a polygon with any number of sides:</span>
PolyBegin<span class="uscript-operator">(</span> Direction<span class="uscript-operator">,</span> ItemName<span class="uscript-operator">,</span> PolyFlags <span class="uscript-operator">)</span>
Polyi<span class="uscript-operator">(</span> i <span class="uscript-operator">)</span>
PolyEnd<span class="uscript-operator">(</span><span class="uscript-operator">)</span></pre><p>Poly3i and Poly4i build polys from 3 and 4 points. PolyBegin, Polyi and PolyEnd work together to build a poly from any number of points. Polyi is often placed inside a for() loop (see <a href="flow-syntax.html">Flow Syntax</a>). Their parameters all work in the same way.</p>
<dl><dt>int Direction</dt><dd>Determines which way the poly faces. This should be +1 or -1, though I suspect any value will work and the sign will determine the result. With Direction=1, the vertices are taken in an anti-clockwise direction when looking at the poly from the exterior. When working out which order to take vertices, remember the <a href="unreal-world.html">Unreal World</a> uses a left-handed co-ordinate system. As a last resort, list them in sequence, try building and if the poly is visible from the wrong side, flip the value of Direction or re-order them.</dd><dt>int i, int j, int k, int l</dt><dd>specifies an item from the vertex array.</dd><dt>optional name ItemName</dt><dd>a name for the poly. Polys are grouped by name as a convenience to the mapper. The name itself doesn't matter. This is used only for the SHIFT+I command (see [Surface Selection]<a href="http://wiki.beyondunreal.com/wiki?action=edit&id=Surface_Selection&referrerid=BrushBuilder">?</a>). This can be set with an expression: see <a href="scripting-custom-brushbuild.html">Scripting Custom Brushbuilders</a>.</dd><dt>optional int PolyFlags</dt><dd>flags for that polygon. Omit this parameter to make regular polys; set to 0x00000108 for a two-sided sheet. See <a href="polyflags.html">PolyFlags</a> for the full list.</dd></dl>
<h2><a name="0.4"></a>Properties </h2>
<p>Two properties are unused by the script but are read by UnrealEd to create the interface. Set them in <a href="default-properties.html">default properties</a>.</p>
<dl><dt>BitmapFilename</dt><dd>the bitmap file to display on the button. This must be stored in {<a href="base-directory.html">Base Directory</a>}/System/editorres. The value required is the name of the file without the .BMP extension.</dd><dt>ToolTip</dt><dd>The hint text that appears when the user hovers the mouse pointer on the button.</dd></dl>
<h2><a name="0.5"></a>Known Subclasses </h2>
<p>Built-in:</p>
<ul><li><a href="conebuilder.html">ConeBuilder</a></li>
<li><a href="cubebuilder.html">CubeBuilder</a></li>
<li><a href="curvedstairbuilder.html">CurvedStairBuilder</a></li>
<li><a href="cylinderbuilder.html">CylinderBuilder</a></li>
<li><a href="linearstairbuilder.html">LinearStairBuilder</a></li>
<li><a href="sheetbuilder.html">SheetBuilder</a></li>
<li><a href="spiralstairbuilder.html">SpiralStairBuilder</a></li>
<li><a href="terrainbuilder.html">TerrainBuilder</a></li>
<li><a href="tetrahedronbuilder.html">TetrahedronBuilder</a></li>
<li><a href="volumetricbuilder.html">VolumetricBuilder</a></li>
</ul>
<p>Custom:</p>
<ul><li><a href="tarquinbuilderbase.html">TarquinBuilderBase</a> (not yet released)</li>
<li>TarquinCylinderBuilder<a href="http://wiki.beyondunreal.com/wiki?action=edit&id=TarquinCylinderBuilder&referrerid=BrushBuilder">?</a></li>
<li><a href="tarquinspiralstairbuilder.html">TarquinSpiralStairBuilder</a></li>
<li>TarquinPanoramaBuilder<a href="http://wiki.beyondunreal.com/wiki?action=edit&id=TarquinPanoramaBuilder&referrerid=BrushBuilder">?</a></li>
<li><a href="tarquintorusbuilder.html">TarquinTorusBuilder</a></li>
</ul>
<h2><a name="0.6"></a>Related Topics </h2>
<ul><li><a href="brushbuilders.html">Brushbuilders</a>: reference page for the built-in brushbuilders</li>
<li><a href="red-builder-brush.html">Red builder brush</a></li>
<li><a href="scripting-custom-brushbuild.html">Scripting Custom Brushbuilders</a> explains how to create your own scripts</li>
</ul>
<h2><a name="0.7"></a>Custom Brushbuilders </h2>
<p>These add extra buttons to the interface.</p>
<ul><li><a href="http://www.planetunreal.com/tarquin/">[Tarquin's UT]</a>, home of his custom brush builders.<ul><li><a href="tarquin-brushbuilders.html">Tarquin Brushbuilders</a></li>
<li><a href="extruder-brushbuilder.html">Extruder Brushbuilder</a></li>
</ul>
</li>
<li><a href="zxanphorian-brushbuilders.html">Zxanphorian Brushbuilders</a></li>
<li><a href="http://www.unrealediting.de/files/index.php3?view=buttons">[Framebuilder]</a>, by JohnMcL.</li>
<li><a href="http://members.home.com/darendash/">[Unreal Realm Of Concepts]</a>, home of the Platonic Solids builder. </li>
</ul>
<hr class="thin"><p><a href="category-class-ut.html">Category Class (UT)</a><br><a href="category-class-ut2003.html">Category Class (UT2003)</a></p>
<script type="text/javascript"><!--
 menuItemAdd("UnrealEd", "#0.1");
menuItemAdd("Interface", "#0.2");
menuItemAdd("Functions ", "#0.3");
menuItemAdd("<tt>&nbsp;&nbsp;</tt>BadParameters ", "#0.3.1");
menuItemAdd("<tt>&nbsp;&nbsp;</tt>Setting up", "#0.3.2");
menuItemAdd("<tt>&nbsp;&nbsp;</tt>Vertex building ", "#0.3.3");
menuItemAdd("<tt>&nbsp;&nbsp;</tt>Vertex inspection ", "#0.3.4");
menuItemAdd("<tt>&nbsp;&nbsp;</tt>Poly building ", "#0.3.5");
menuItemAdd("Properties ", "#0.4");
menuItemAdd("Known Subclasses ", "#0.5");
menuItemAdd("Related Topics ", "#0.6");
menuItemAdd("Custom Brushbuilders ", "#0.7");
 menuWrite() //--></script></div>
</div>

<div id="footer" class="bar">
	<p><form method="post" action="http://wiki.beyondunreal.com/wiki" enctype="application/x-www-form-urlencoded">
<a href="(start).html">Home Page</a> | <a href="recent-changes.html">Recent Changes</a> | <a href="http://wiki.beyondunreal.com/wiki?action=editprefs">Preferences</a><br>
<a href="http://wiki.beyondunreal.com/wiki?action=edit&id=BrushBuilder">Edit text of this page</a> | <a href="http://wiki.beyondunreal.com/wiki?action=history&id=BrushBuilder">View other revisions</a><br>Last edited September 1, 2005 11:14 <a href="http://wiki.beyondunreal.com/wiki?action=browse&diff=1&id=BrushBuilder">(diff)</a><br>Search: <input type="text" name="search"  size="20" /><input type="hidden" name="dosearch" value="1"  /><br><br><small><a href="http://wiki.beyondunreal.com/wiki/BrushBuilder">Original page</a> &#150; copy created Sat, Jun 23, 2007</small><div></div>
</form>
	</p>
	<p>Gah - a solution with more questions. (EntropicLqd)
</p>
</div>
</div><!-- close of "scrolling" div -->

<div id="quickbar">
	<div id="logo"><a href="http://wiki.beyondunreal.com/"><img src="shared/wikilogo.jpg" width="143" height="100" border="0"></a>
		</div>
	<div class="qbsitename">
		<p>The Unreal Engine Documentation Site</p>
	</div>
	<div class="qbsection">
<p><a href="metatopics.html">Wiki Community</a></p>
<p><a href="category-category.html">Topic Categories</a></p>
<p><a href="/cgi-bin/imageupload.cgi/wiki-ext/imageupload.htt" target="_blank ">Image Uploads</a></p>
<p><a href="http://wiki.beyondunreal.com/wiki?action=random">Random Page</a></p>
<p><a href="recent-changes.html">Recent Changes</a></p>
<p><a href="offline-wiki.html">Offline Wiki</a></p>
</div><div class="qbsection">
<p><a href="unreal-engine.html">Unreal Engine</a></p>
<p><a href="console-commands.html">Console Commands</a></p>
<p><a href="terminology.html">Terminology</a></p>
<p><a href="category-faq.html">FAQs</a></p>
<p><a href="help-desk.html">Help Desk</a></p>
</div><div class="qbsection">
<p><a href="topics-on-mapping.html">Mapping Topics</a></p>
<p><a href="mapping-lessons.html">Mapping Lessons</a></p>
<p><a href="unrealed-3.html">UnrealEd Interface</a></p>
</div><div class="qbsection">
<p><a href="unrealscript.html">UnrealScript Topics</a></p>
<p><a href="unrealscript-lessons.html">UnrealScript Lessons</a></p>
<p><a href="making-mods.html">Making Mods</a></p>
<p><a href="class-tree.html">Class Tree</a></p>
</div><div class="qbsection">
<p><a href="topics-on-modeling.html">Modeling Topics</a></p>
</div><div class="qbsection">
<p><a href="chongqing-page.html">Chongqing Page</a></p>
<p><a href="log-in.html">Log In</a></p></div>
</div>

</body></html>
