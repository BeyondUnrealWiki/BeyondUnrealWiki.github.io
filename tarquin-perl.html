<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"  "http://www.w3.org/TR/html4/loose.dtd">

<html>
<head lang="en">
	<title>UnrealWiki: Tarquin/Perl</title>
	<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
	<link rel="stylesheet" type="text/css" media="screen, print"
		href="shared/stylebase.structural.css">	
	<link rel="stylesheet" type="text/css" media="screen"
		href="shared/template-default.css">
	<link rel="stylesheet" type="text/css" media="screen"
		href="shared/styles.chblue.css">
	<link rel="stylesheet" type="text/css" media="print"
		href="shared/template-default-print.css">
	<!--[if IE 6]>
			<style>
			/* dirty hack for IE6. */
			#quickbar {
				position: absolute;
				}
			</style>
	<![endif]-->
  <link rel="start" href="http://wiki.beyondunreal.com/">
  <link rel="glossary"  href="http://wiki.beyondunreal.com/wiki/Terminology">
  <link rel="help"  href="http://wiki.beyondunreal.com/wiki/Using_The_Wiki">
<script type="text/javascript" src="shared/dhtml.js"></script>
<script type="text/javascript" src="shared/dhtml-menu.js"></script>
<style type="text/css">#dhtml-menu    { background: #eee; padding: 5px 0px; margin-right: -20px; border: 1px solid #888; border-left: 1px solid #ccc; border-top: 1px solid #ccc;  border-right: 1px solid #888; border-bottom: 1px solid #888 }
#dhtml-menu td { color: #000; font-family: Arial,Helvetica,sans-serif; font-size: 9pt; line-height: 13pt; padding: 1px 10px; cursor: default }
#dhtml-menu a  { color: #000; font-family: Arial,Helvetica,sans-serif; font-size: 9pt; line-height: 13pt; text-decoration: none }
#dhtml-menu tt { font-family: monospace; font-size: 9pt }
#dhtml-menu-separator { height: 1px; background: red }
#dhtml-menu-anchor { cursor: default }
</style>
<script type="text/javascript" src="shared/expandable.js"></script>
</head>
<body onLoad="menuInit(); document.cookie='page=Tarquin/Perl; path=/'" class="default">
<div id="scrolling"><!-- contains all except the fixed sidebar -->
<div id="topbar"  class="bar">
	<div class="righthalf">
		<form class="inline" method="post" action="/wiki" enctype="application/x-www-form-urlencoded"><input type="text" name="search"  size="20" /> <input type="submit" name="search" value="search" /></form>
	</div>
	<div class="lefthalf">
		<script type="text/javascript"><!--
			menuAlignRight = false;
		//--></script>
		<span><script type="text/javascript"><!--
 menuWriteAnchor("Quick Navigation") //--></script></span> | <a href="(start).html">Home Page</a> | <a href="recent-changes.html">Recent Changes</a> | <a href="http://wiki.beyondunreal.com/wiki?action=editprefs">Preferences</a>
	</div>
</div>

<div id="content"><!-- contains the title and article -->
	<h1 class='pagetitle'><a href="tarquin.html">Tarquin</a>/<a href="http://wiki.beyondunreal.com/wiki?back=Tarquin/Perl">Perl</a></h1>
	<div class="wiki"><p>Tarquin's Little Corner of Perl</p>
<p>(a pun on Wisdom of Perl ... has that been done before? probably. anyway, I can hardly class this as "wisdom"!)</p>
<p>Insane ramblings on perl...</p>
<h2><a name="0.1"></a>scripts</h2>
<p>These both use Mych's Wookee playground, but with different 'brains' &ndash; much simpler brains.</p>
<ul><li><a href="http://wiki.beyondunreal.com/cgi-bin/class.cgi">http://wiki.beyondunreal.com/cgi-bin/class.cgi</a></li>
<li><a href="http://wiki.beyondunreal.com/cgi-bin/reverser.cgi">http://wiki.beyondunreal.com/cgi-bin/reverser.cgi</a></li>
</ul>
<p>I wonder ... has anyone made a script like the playground, with two input fields:</p>
<ul><li>text to process</li>
<li>perl script to exectute on the text</li>
</ul>
<p><em class="em2">Mychaeel:</em> I suppose anything has been done already.  Are you asking because you'd like to create such a script yourself?</p>
<p><em class="em2">Tarquin:</em> I made the reverser script for wikipedia; and the core is so simple  (4 lines but it could be just one), that I thought it would be neat if one script could take different instructions. Not sure how to do it, the dark arts of reading url parameters are a bit beyond me. BTW, why is the main portion of your playground script within an "eval"?</p>
<p><em class="em2">Mychaeel:</em> To catch errors (which would otherwise end the script and make the server output "Internal Server Error" because no headers have been printed yet).</p>
<h3><a name="0.1.1"></a>references</h3>
<p>The use of [, { and ( for arrays and hashes confuses me, but I think I've cracked it. The basic token is (. Perl knows whether this is to be an array or a hash from the variable name &amp; the nature of the list:</p>
<p class="indent1">@anArray = ( 3, 4, 5 );</p>
<p class="indent1">%aHash = ( 'Waterloo' =&gt; 'Abba' , 'Diva' =&gt; 'Dana International' );</p>
<p>and so forth. I think a lot of confusion sprang up when I was creating an array of hashes (or was it a hash or arrays), and I read perlreftut with an insufficient concentration of mood-enhacing chemicals in my system.</p>
<p>This came to light when I set off today to understand what &rarr; means. It's converted into a nice little arrow on this wiki, but in its promordial state, -&gt; it's altogether different. Look at it. It's like goo oozing through a ceiling grate in cheap sci-fi. It's like chicken with teeth. Those two little characters together are not of this world; something about the shape they form together projects the idea that it is not of this world. Someone once took a hyphen, ordinary, and a right-angle-bracket aka a greater than symbol, also fairly rudimentary and put them together (incidentally, I've encountered people who can't remember which of &lt; and &gt; means greater and lesser, and resort to complex mnemonics (more on those later). What's there to miss? Big side, big number. Pointy small side, small number) &ndash; two innocuous symbols, yet adjacency breeds unfamiliarity. It's certainly gestalt. Or emergent. Or something.</p>
<p>So... if $myRef holds a reference, {$myRef} can be made to stand for the array, in @{$myRef}, so ${$myRef}[1] is an element like $myArray[1] is, and the evil arrow comes in as a shorthand to write $myRef&rarr;[1]. Hooray. One step closer to understanding Wookee...</p>
<p><em class="em2">Mychaeel:</em>  Good luck on your pursuit of the Evil Arrow.  <img alt=":-)" src="emoticons/smile.gif" align="middle">  I actually find the <code>$myRef-&gt;[1]</code> syntax much neater looking than the <code>${$myRef}[1]</code> one, that's why I'm using it wherever possible; and it's mandatory for calling object or class methods as in <code>$myObject-&gt;blah()</code>, so accessing myObject's properties as <code>$myObject-&gt;{foo}</code> makes for a nice analogy between the two.</p>
<p><em class="em2">Tarquin:</em>  It is nicer, but like nice things in maths, I find I need to understand the complicated thing before I can really grasp the shorthand.</p>
<p><em class="em2">Dma:</em>  You mean this stuff doesn't just intuitively make sense to you? <img alt=":-)" src="emoticons/smile.gif" align="middle"></p>
<p><em class="em2">Tarquin:</em> I'm currently feeling extremely smug for having done:</p>
<pre class="uscript">  <span class="uscript-keyword">foreach</span> <span class="uscript-operator">(</span> \<span class="uscript-operator">@</span>classPublicVars <span class="uscript-operator">,</span> \<span class="uscript-operator">@</span>classPrivateVars <span class="uscript-operator">)</span> <span class="uscript-operator">{</span>
    <span class="uscript-operator">@</span><span class="uscript-operator">$</span>_ <span class="uscript-operator">=</span> sort <span class="uscript-operator">{</span>uc<span class="uscript-operator">(</span><span class="uscript-operator">$</span>a<span class="uscript-operator">)</span> cmp uc<span class="uscript-operator">(</span><span class="uscript-operator">$</span>b<span class="uscript-operator">)</span><span class="uscript-operator">}</span> <span class="uscript-operator">@</span><span class="uscript-operator">$</span>_ <span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span></pre><p>Sure, I could have done the same thing with two consecutive sort functions, once on each array &ndash; but see under "laziness"</p>
<h3><a name="0.1.2"></a>objects</h3>
<p>If I understand correctly, objects in Perl work exactly liek the hash references above, with $myObject&rarr;property analogous to myUnrealObject.property. </p>
<p>So an object just works like a souped-up reference things. </p>
<p class="indent1"><em class="em2">Mychaeel:</em>  That's a pretty to-the-point description of what Perl objects are.  In fact, the manual describes them as "references that know to which package they belong."  Perl just memorizes a package name along with a regular reference (via the use of the <code>bless</code> command, given the reference and the package name) and uses that package name to call methods.</p>
<p>I'm reading perltoot. It seems that the object stuff has to be within a package that's called up by a procedural main perl file.</p>
<p class="indent1"><em class="em2">Mychaeel:</em>  The "package" part is right, I don't understand the "procedural main Perl file" part though.</p>
<p class="indent1"><em class="em2">Tarquin:</em>  it's not like UnrealScript which has no single "way in", or Java where the root class (I think) has a main() method. There's a layer of Perl above the classes which created the objects and does stuff &ndash; a bit like Unreal has the native code that creates objects and makes them do stuff.</p>
<p class="indent1"><em class="em2">Mychaeel:</em>  ...or like C++ which has a main() procedure either.  In theory this main program could just create an "application" object and call a "main" method of it, if you wish to stay as object-oriented as possible.  (Delphi does that, basically.)</p>
<p class="indent1"><em class="em2">Birelli:</em> I'm pretty sure in Java it's actually called init() (at least in applets), but that really doesn't matter so I'll be quiet now <img alt=";-)" src="emoticons/wink.gif" align="middle"></p>
<p><em class="em2">Olorin:</em> I'll pitch in: I think perl implicitly uses a routine called 'MAIN' if you don't have one. I think it's good practice to explicitly have a MAIN label to indicate where your execution begins, so my Perl scripts start with:</p>
<pre class="uscript">#<span class="uscript-operator">!</span> usr<span class="uscript-operator">/</span>bin<span class="uscript-operator">/</span>perl

MAIN:
  #stuff
  exit<span class="uscript-operator">(</span><span class="uscript-number">0</span><span class="uscript-operator">)</span>
#other routines</pre><p>From which you can see I grew up on C/C++.</p>
<h3><a name="0.1.3"></a>wookee</h3>
<p>moving on to working out what wookee does...</p>
<p>the modified sub WikiToHTML does this:</p>
<ol><li>create a new BlockWiki object</li>
<li>feed it the html from @_ </li>
<li>let BlockWiki cascade everything from there</li>
</ol>
<p>Questions:</p>
<p><em class="em2">Tarquin:</em> is it necessary to create a new object? why not just use 'static' things in the class?</p>
<p><em class="em2">Mychaeel:</em>  If you look into that class you'll find that it indeed has to save a lot of state information &ndash; for instance, the variable that accumulates the formatted output.  Hence, we need an object.  (Of course that information could also be stored in "static" (package- or class-level) variables, but that'd somewhat defeat the purpose of OOP and would make the code non-reentrant, and you couldn't nest <code>&lt;wiki&gt;</code> blocks in <code>&lt;wiki&gt;</code> blocks.)</p>
<p><em class="em2">Tarquin:</em>  Thank you <img alt=":)" src="emoticons/smile.gif" align="middle"> I think I get it. So it's not necessary from a syntax point of view, it's just <em class="em1">useful</em> to do it that way. For my page idea I might as well use static, since I don't need multiple instances of the page object... hmm. Not sure how I'll handle redirects, maybe that could fit in like that. more pondering required.</p>
<p><em class="em2">Mychaeel:</em>  From an OOP point of view, it'd be advisable to use static properties and methods only if you need them and stick to instance properties and methods otherwise.</p>
<h3><a name="0.1.4"></a>shift</h3>
<p><em class="em2">Tarquin:</em> "shift" called with no argument means the first element from the @_ array, and pops it off too so the next use of shift gets the next one &ndash; I think. It's syntax like that that mkes Perl scary. It takes an initial Klein-bottle flip of the brain to understand, but once you know it it's extremely simple to use. It's like maths. <img alt=":)" src="emoticons/smile.gif" align="middle"></p>
<p><em class="em2">Mychaeel:</em>  Hehe.  <img alt=":-D" src="emoticons/biggrin.gif" align="middle">  How true, how true.</p>
<blockquote><p>The array @_ is a local array, but its elements are aliases for the actual scalar parameters. </p>
</blockquote><p>That means ALL perl subroutine parameters are "out" parameters in Uscript jargon!</p>
<p><em class="em2">Mychaeel:</em>  If you use them like that, yes.  (Usually you copy the @_ elements to local variables.)  But be careful:  If you try to assign to a @_ element that represents a constant expression, you'll get a fatal error.  The much better way of dealing with "out" parameters is passing references.</p>
<p><em class="em2">Tarquin:</em>  Do some people consider perl to have too many built-in functions? I think it's great &ndash; once you get the hang of enough of them to do something.</p>
<p>Something like <code>join("&lt;br&gt;", @MyArray );</code> in another language might go like...</p>
<pre class="uscript"><span class="uscript-keyword">for</span><span class="uscript-operator">(</span> i<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">,</span> i<span class="uscript-operator">&lt;</span> <span class="uscript-operator">.</span><span class="uscript-operator">.</span><span class="uscript-operator">.</span>
<span class="uscript-comment">// urg whats the syntax for counting an arrays elements</span>
<span class="uscript-comment">// urg used , instead of ; again</span>
<span class="uscript-comment">// urg is it "i&lt;Elements", "i&lt;=Elements" or "i&lt;Elements-1"? </span>
<span class="uscript-comment">// (Why is there a zero? Life would be so much easier without it)</span>
MyArray<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span> <span class="uscript-operator">=</span>
<span class="uscript-comment">// damn. I need something to output to. </span>
<span class="uscript-comment">// go back up and create a local variable</span>
<span class="uscript-comment">// decide to put this all in a seperate function</span>
<span class="uscript-comment">// spend 5 minutes moving code around</span>
<span class="uscript-comment">// make up a new variable name for the local version of the array</span>
MyString <span class="uscript-operator">=</span> <span class="uscript-string">"&lt;br&gt;"</span><span class="uscript-operator">$</span> MyArray<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span> <span class="uscript-operator">;</span>
<span class="uscript-comment">// hm. would it be handy if my function took an arbitrary joining string?</span></pre><p>...and so on.</p>
<p><em class="em2">Mychaeel:</em>  Perl certainly isn't a "minimal" language like C where the language base consists of only a small handfull of statements and everything else is added through libraries.  Some people might consider Perl "ugly" from a language design point of view because of that, but Perl never claimed to be a "beautiful" language, just a useful and efficient one.  (C++ at least provides syntax constructs to make library functionality <em class="em1">look</em> as if it was built in.)</p>
<p>For that matter, PHP is worse than Perl:  Virtually every functionality extension has to be provided as native code and preferably be compiled directly into the PHP executable.  Perl is powerful enough to allow for such extensions to be provided as Perl modules themselves.  Only very few Perl modules require support through native code, and usually you can clearly see the reason why.</p>
<h3><a name="0.1.5"></a>Linguistics</h3>
<p>something I'll write about later...</p>
<p>I had an idea about all the shortcuts in perl like "shift" with no argument implies shift @_. Analogous to things like "shouldn't" in English.</p>
<h3><a name="0.1.6"></a>General comments</h3>
<p><em class="em2">Mychaeel:</em>  tarquin, if you're looking for a book about Perl, get <a href="http://www.amazon.com/exec/obidos/ASIN/0596000278/qid=1023909155/sr=8-1/ref=sr_8_1/104-6149721-8404759">[Programming Perl]</a> (co-authored by Larry Wall, Perl's creator), usually only referred to as "the Camel Book" (for obvious reasons).  It's actually a pretty entertaining read.  <img alt=":)" src="emoticons/smile.gif" align="middle"></p>
<h3><a name="0.1.7"></a>Links</h3>
<p><em class="em2">Dma:</em>  <a href="http://www.bbspot.com/News/2001/03/perl_test.html">http://www.bbspot.com/News/2001/03/perl_test.html</a> &lt;== <img alt=":-D" src="emoticons/biggrin.gif" align="middle"></p>
<p><em class="em2">Tarquin:</em> <a href="http://www.perl.com/pub/a/1998/08/show/onion.html">http://www.perl.com/pub/a/1998/08/show/onion.html</a></p>
<p><em class="em2">Mychaeel:</em>  A <em class="em1">very</em> good read... thanks for the pointer.  "The fact is, your brains are built to do Perl programming." &ndash; The only thing that has always bothered me in Perl is that <code>if</code> and all sorts of loops (<code>for</code>, <code>while</code> and so on) <em class="em1">require</em> a block in braces. It has me wondering whether that's a problem related to parsing the otherwise pretty form-free Perl source, or whether Perl's creators just had a fit of wanting to inflict something they consider "good programming style" on lowly Perl programmers...</p>
<p class="indent1"><em class="em2">T1:</em> If doesn't require a block in braces. you can do <code>dosomething() if(condition)</code></p>
<p class="indent1"><em class="em2">Mychaeel:</em> Yes, I know.  <img alt=":-)" src="emoticons/smile.gif" align="middle">  What I meant is the <code>if (cond) { block }</code> form, which you'll have to use if you need an <code>else</code> or <code>elsif</code>.</p>
<p><em class="em2">Mychaeel:</em>  Hehe:  "We can debug relationships, but it's always good policy to consider the people themselves to be features. People get annoyed when you try to debug them."  How true, how true...</p>
<p><em class="em2">Tarquin:</em>  For Mych: <a href="http://c2.com/cgi/wiki?ThereIsNothingPerlCannotDo">http://c2.com/cgi/wiki?ThereIsNothingPerlCannotDo</a> <img alt=";)" src="emoticons/wink.gif" align="middle"> There's plenty of perl stuff on PPR, including the idea of using ||= as an assignment operator for OO (and here I say OO.. <img alt="O_o" src="emoticons/ohoh.gif" align="middle">!). I wonder if there's a Perl-specific Wiki. </p>
<p><em class="em2">Mychaeel:</em>  I agree with that Wiki page.  <img alt=":-D" src="emoticons/biggrin.gif" align="middle">  There's a link to an article on <a href="http://www.perl.com/pub/a/language/misc/fmproto.html">[Why Perl prototypes are bad]</a> which I definitely <em class="em1">disagree</em> with though.  The "inherent bugs" the author talks about aren't in fact any &ndash; it's just that Perl prototypes and C prototypes aren't the same, and aren't supposed to be.  (Like that a prototype becomes effective only <em class="em1">after</em> it has been parsed.)  Quite simply, Perl isn't a language for the easily confused.</p>
<p><em class="em2">Tarquin:</em>  Hmm... that wiki on perl we found the other day is offline <img alt=":(" src="emoticons/sad.gif" align="middle"> I was looking forward to rambling there, too.</p>
<h2><a name="0.2"></a>Problems with Magic content </h2>
<p>I have, basically, this:</p>
<pre class="uscript">package Parent <span class="uscript-operator">{</span>

  sub ListParameters <span class="uscript-operator">{</span>
    my <span class="uscript-operator">$</span><span class="uscript-keyword">class</span> <span class="uscript-operator">=</span> shift<span class="uscript-operator">;</span>
    my <span class="uscript-operator">@</span>parameters <span class="uscript-operator">=</span> <span class="uscript-operator">$</span><span class="uscript-keyword">class</span><span class="uscript-operator">-</span><span class="uscript-operator">&gt;</span>CommandParameters<span class="uscript-operator">;</span>
    <span class="uscript-operator">$</span>text <span class="uscript-operator">.</span><span class="uscript-operator">=</span> join <span class="uscript-name">''</span><span class="uscript-operator">,</span> map <span class="uscript-operator">{</span> <span class="uscript-string">"&lt;LI&gt;$_&lt;/LI&gt;"</span> <span class="uscript-operator">}</span> <span class="uscript-operator">@</span>parameters <span class="uscript-operator">;</span>
<span class="uscript-operator">}</span>

# called from UseModWiki
  sub MakeSection <span class="uscript-operator">{</span>
    my <span class="uscript-operator">$</span><span class="uscript-keyword">class</span>       <span class="uscript-operator">=</span> shift<span class="uscript-operator">;</span>
    my <span class="uscript-operator">$</span>page        <span class="uscript-operator">=</span> shift<span class="uscript-operator">;</span> # the page being browsed
    my <span class="uscript-operator">$</span>magicmodule <span class="uscript-operator">=</span> shift<span class="uscript-operator">;</span> # the requested magicmodule   
    my <span class="uscript-operator">%</span>params <span class="uscript-operator">=</span> map <span class="uscript-operator">{</span> s<span class="uscript-operator">/</span><span class="uscript-operator">^</span><span class="uscript-string">"|"</span><span class="uscript-operator">$</span><span class="uscript-comment">//g; $_ } (shift =~ m[(\w+)\s*=\s*("[^"]*"?|\S+)]g); #"</span>
    <span class="uscript-operator">$</span>params<span class="uscript-operator">{</span><span class="uscript-name">'thispage'</span><span class="uscript-operator">}</span> <span class="uscript-operator">=</span> <span class="uscript-operator">$</span>page<span class="uscript-operator">;</span> # add the page to the parameters hash
    <span class="uscript-operator">$</span>text <span class="uscript-operator">.</span><span class="uscript-operator">=</span> qq<span class="uscript-operator">[</span><span class="uscript-operator">&lt;</span>div <span class="uscript-keyword">class</span><span class="uscript-operator">=</span><span class="uscript-string">"magic"</span> id<span class="uscript-operator">=</span><span class="uscript-string">"$magicmodule"</span><span class="uscript-operator">&gt;</span>\n<span class="uscript-operator">]</span><span class="uscript-operator">;</span>
    <span class="uscript-keyword">if</span><span class="uscript-operator">(</span> grep <span class="uscript-operator">/</span><span class="uscript-operator">^</span>\Q<span class="uscript-operator">$</span>magicmodule\E<span class="uscript-operator">$</span><span class="uscript-operator">/</span> <span class="uscript-operator">,</span> <span class="uscript-operator">@</span>registered <span class="uscript-operator">)</span><span class="uscript-operator">{</span>
      # <span class="uscript-keyword">if</span> one of our packages matches the <span class="uscript-type">name</span> of the wiki page<span class="uscript-operator">,</span> run the script
      <span class="uscript-operator">$</span>text <span class="uscript-operator">.</span><span class="uscript-operator">=</span> <span class="uscript-operator">$</span>magicmodule<span class="uscript-operator">-</span><span class="uscript-operator">&gt;</span>GenerateContent<span class="uscript-operator">(</span><span class="uscript-operator">%</span>params<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
      <span class="uscript-operator">$</span>text <span class="uscript-operator">.</span><span class="uscript-operator">=</span> <span class="uscript-operator">$</span>magicmodule<span class="uscript-operator">-</span><span class="uscript-operator">&gt;</span>ListParameters<span class="uscript-operator">;</span>
    <span class="uscript-keyword">return</span> <span class="uscript-operator">$</span>text<span class="uscript-operator">;</span>
  <span class="uscript-operator">}</span>


<span class="uscript-operator">}</span>


package CommandClass <span class="uscript-operator">{</span>
  <span class="uscript-operator">@</span>ISA <span class="uscript-operator">=</span> qw<span class="uscript-operator">(</span>Parent<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
  sub CommandParameters <span class="uscript-operator">{</span> <span class="uscript-operator">}</span>
<span class="uscript-operator">}</span></pre><p>If CommandParameters contains something, eg </p>
<pre class="paraverbatim">  sub CommandParameters { 'foo', 'bar' }</pre><p>then I get it out as a list. If it contains NOTHING, the array @parameters gets the value of $class in it. Now I understand that  CommandParameters is called with $class as the first element of its @_. But why is it spitting it back out, and how do I stop it?</p>
<p>...</p>
<p>I've switched to using </p>
<pre class="paraverbatim">  sub CommandParameters { undef }</pre><p>but I still can't work out how to test that the @parameters array is empty.</p>
<p>ALWAYS FALSE:</p>
<pre class="paraverbatim">    return "" if scalar @parameters == 0;
    return "" if @parameters == ()</pre><p>ALWAYS TRUE</p>
<pre class="paraverbatim">    return "" if $parameters == 0;
    return "" unless defined @parameters; # I've put "undef" into an array ... what does that do to it?</pre><p><em class="em2">Mychaeel:</em> Well... an array with "undef" in it has at least a single (undefined) element.  An empty array is "()".  And:  An empty function always returns the value of its "@_" &ndash; you have to do <em class="em1">something</em> in that function to set a different return value.  Also, "$parameters" and "@parameters" are two different and completely unrelated variables.</p>
<p><em class="em2">Tarquin:</em> For some reason I had it in my head that $array returns the number of elements. :con: So how do I check @array eq (undef) ? That gives a "Use of uninitialized value in string eq at emptyarray.pl line 31." Though I could just keep the function empty and test for a return equal to ( $class ). </p>
<p><em class="em2">Mychaeel:</em> The much neater way would be simply having the function return an empty array:</p>
<pre class="paraverbatim">  sub CommandParameters { () }</pre><p>That could be the default implementation in the common base class, so that only subclasses which do have parameters need to overwrite that function.</p>
<p><em class="em2">Tarquin:</em> Done. Thanks. <img alt=":)" src="emoticons/smile.gif" align="middle"> I've just used "scalar @parameters == 0" as I can't work out how to check it's equal to ().</p>
<p><em class="em2">Mychaeel:</em> Since "==" expects scalar operands, the "scalar" operator is redundant; otherwise yes, that'd be the way to check whether an array is empty.</p>
<pre class="paraverbatim">  if (@parameters == 0) { ... }</pre><p><em class="em2">Tarquin:</em> Stylistic question. Would the following be considered <em class="em1">really bad</em>, because a sub is calling a child implementation of itself?</p>
<pre class="uscript"><span class="uscript-operator">{</span>
  package WantedPages<span class="uscript-operator">;</span>
  <span class="uscript-operator">@</span>ISA <span class="uscript-operator">=</span> qw<span class="uscript-operator">(</span>MagicContentMaker<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
  # <span class="uscript-operator">.</span><span class="uscript-operator">.</span><span class="uscript-operator">.</span>snip<span class="uscript-operator">.</span><span class="uscript-operator">.</span><span class="uscript-operator">.</span>

  sub GenerateContent <span class="uscript-operator">{</span>
    my <span class="uscript-operator">(</span> <span class="uscript-operator">$</span><span class="uscript-keyword">class</span><span class="uscript-operator">,</span> <span class="uscript-operator">%</span>params <span class="uscript-operator">)</span> <span class="uscript-operator">=</span> <span class="uscript-operator">@</span>_<span class="uscript-operator">;</span>
    my <span class="uscript-operator">(</span><span class="uscript-operator">$</span>text<span class="uscript-operator">,</span> <span class="uscript-operator">@</span>links<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    #my <span class="uscript-operator">$</span>testoutput<span class="uscript-operator">;</span>
    
    <span class="uscript-keyword">if</span><span class="uscript-operator">(</span> <span class="uscript-operator">$</span>params<span class="uscript-operator">{</span>sort<span class="uscript-operator">}</span> <span class="uscript-operator">=</span> <span class="uscript-name">'alpha'</span> <span class="uscript-operator">)</span> <span class="uscript-operator">{</span>
      <span class="uscript-keyword">return</span> WantedPagesAlpha<span class="uscript-operator">-</span><span class="uscript-operator">&gt;</span>GenerateContent
    <span class="uscript-operator">}</span>
    <span class="uscript-keyword">else</span> <span class="uscript-operator">{</span>
      <span class="uscript-keyword">return</span> WantedPagesRequests<span class="uscript-operator">-</span><span class="uscript-operator">&gt;</span>GenerateContent<span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>
<span class="uscript-operator">}</span>

<span class="uscript-operator">{</span>
  package WantedPagesAlpha<span class="uscript-operator">;</span>
  <span class="uscript-operator">@</span>ISA <span class="uscript-operator">=</span> qw<span class="uscript-operator">(</span>WantedPages<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
  # <span class="uscript-operator">.</span><span class="uscript-operator">.</span><span class="uscript-operator">.</span>etc
<span class="uscript-operator">}</span></pre><p><em class="em2">Mychaeel:</em> Well... I'd consider it bad OOP, and it also only works because GenerateContent is technically a static method for class WantedPages whereas it is a normal (non-static) method in its superclass &ndash; which in turn is bad OOP too and wouldn't work with any programming language except Perl which doesn't have an all-too-strict syntactical notion of OOP in the first place.</p>
<p>So I'd say it is ugly on several levels; but why make "sort=..." a parameter anyway?  It'd be very neat and OOP-nice to create an (abstract) class WantedPages where WantedPagesAlpha and WantedPagesRequests are subclasses of which can be used as such in the #MAGIC header directly.</p>
<p><em class="em2">Tarquin:</em> It seemed to me easier for the end-user to think of WantedPages as a single command with different options. But it's a lot easier to code your way. I was trying to understand how to travel <em class="em1">down</em> a class tree based on options for the Lunatic UseMoo project. BTW, have you thought of making a perl wrapper like <a href="umake.html">UMake</a>? Just something that registers to open perl filetypes, displays output and provides a "run last script again" button. </p>
<p><em class="em2">Mychaeel:</em> No, I never considered doing that.  Setting up the file types is a one-time configuration task, and my editor allows setting up a custom menu command to run the script I'm editing without any helper tools.</p>
<p>Actually, with something like UnrealScript's "states" you could create your "runtime subclass selection" quite neatly.  States are more or less a type of subclassing that's "orthogonal" to the normal subclassing.  Unlike normal subclasses however it is possible to switch an object's state at runtime, so you could in theory have a single WantedPages class that has two states, "SortAlpha" and "SortRequests", each of which provides its own implementation of the GenerateContent method.  However, because states can be switched at runtime, it is impossible to have different <em class="em1">data</em> in different states &ndash; and that's also why you cannot simply switch classes at runtime for a given object because there you <em class="em1">can</em> have different data in different objects.  (Typecasting objects &ndash; as opposed to object <em class="em1">references</em> &ndash; therefore is a non-trivial task that usually involves the creation of an all-new object of the target type in the process.)</p>
<p><em class="em2">Tarquin:</em> Which text editor do you use?</p>
<p><em class="em2">Mychaeel:</em> Still <span class="interwiki"><a href="http://forums.beyondunreal.com/showthread.php?postid=*#post*1436905">this one</a></span>.  It may not be as feature-complete as other text editor that are around, but what's more important to me is that it's entirely feature-complete in respect to the features I <em class="em1">want</em>.  <img alt=":-)" src="emoticons/smile.gif" align="middle"> &ndash; Oh, and I have replaced that very old "umake" version by <a href="umake.html">UMake</a> meanwhile.</p>
<h2><a name="0.3"></a>Feb 2004</h2>
<p>I think I FINALLY really get references! I wrote this last night to check:</p>
<pre>
#!/usr/bin/perl
%myHash = (
  foo =&gt; 'bar',
  biz =&gt; 'bax',
  );
sub takeHash {
  my $hashRef = shift;
  foreach (keys %$hashRef) {
    print $hashRef-&gt;{$_}, ', ';
  }
}
takeHash(\%myHash);
</pre><p>I am having to make design decisions in UseMOO. The key problem is that I am breaking OO principles in bad ways. The basic idea behind MOO is that we have a class tree like this:</p>
<ul><li>Page<ul><li>PrefsPage</li>
<li>AdminPage</li>
<li>WikiPage<ul><li>RecentChanges</li>
<li>EditPage</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>... and so on. Each object adds new functionality. To make this actually work, the script needs to start by choosing which class to create an instance of, and then run that instance's browsePage() method. The problem is how to choose the class in the first place. I've borrowed Mychaeel's registration system, and using this, the new() function is able to travel <em class="em1">down</em> the class tree, checking which conditions the browser parameters satisfy. So:</p>
<ul><li>register() needs to call its immediate parent, but the parent itself needs to call <em class="em1">its</em> parent!</li>
<li>new() needs to call implementations of itself in subclasses, which is BAD.</li>
</ul>
<p>For register, I think the least yucky solution is this:</p>
<pre>
  sub WikiPage::register {
    my $class = shift;  $class = (ref $class or $class);
    
    # WikiPage can't call this, it must call something further up
    if ($class eq 'WikiPage') {
      $class-&gt;SUPER::register;
      return;
    }
    
    push @registered, $class
      if $class-&gt;isa(Page)
      and not grep /^\Q$class\E$/, @registered;
    }
</pre><p>and for new(), to avoid the danger of recursive calling, have new(), newPageChild(), newWikiPageChild() etc.</p>
<h2><a name="0.4"></a>Feb 2004 part 2</h2>
<p>I think I have a tweak to the above that makes it slightly more palatable.</p>
<p>Give each class a sub called "this" that returns the class name. (AFAIK there's no way to magically do this in perl.) To use the example from the perlboot manpage:</p>
<pre>
{ 
  package Animal;
  
  sub this { 'Animal' }
  
  sub speak {
    my $class = shift; $class = (ref $class or $class);
    print "a $class goes ", $class-&gt;sound, "!\n";
    if ( $class-&gt;this ne this ) {
      print "we're not where we were";
    }
    return;
  }
}
</pre><p>Now if we call Horse&rarr;speak (or some other subclass), the speak sub know it's running in a superclass. This approach would eliminate the use of the class name in my register sub above, which makes it look a bit cleaner.</p>
<h2><a name="0.5"></a>Feb 2004 part 3</h2>
<p>I think I finally understand what Mych means when he says that trying something and finding out it doesn't work days later can be a good thing.</p>
<p>I've had to change the way Moo creates instances, because the first way isn't flexible enough. The new method is a little unorthodox, but having seen for myself the drawbacks of the original method, I'm more convinced the new method is right.</p>
<p>What I'm now doing is this:</p>
<pre>
 my $instance = {}
 Page-&gt;constructor( $instance, @variables );
</pre><p>in effect, constructor() is really a blesser.</p>
<hr class="thin"><p><a href="category-rant.html">Category Rant</a></p>
<script type="text/javascript"><!--
 menuItemAdd("scripts", "#0.1");
menuItemAdd("<tt>&nbsp;&nbsp;</tt>references", "#0.1.1");
menuItemAdd("<tt>&nbsp;&nbsp;</tt>objects", "#0.1.2");
menuItemAdd("<tt>&nbsp;&nbsp;</tt>wookee", "#0.1.3");
menuItemAdd("<tt>&nbsp;&nbsp;</tt>shift", "#0.1.4");
menuItemAdd("<tt>&nbsp;&nbsp;</tt>Linguistics", "#0.1.5");
menuItemAdd("<tt>&nbsp;&nbsp;</tt>General comments", "#0.1.6");
menuItemAdd("<tt>&nbsp;&nbsp;</tt>Links", "#0.1.7");
menuItemAdd("Problems with Magic content ", "#0.2");
menuItemAdd("Feb 2004", "#0.3");
menuItemAdd("Feb 2004 part 2", "#0.4");
menuItemAdd("Feb 2004 part 3", "#0.5");
 menuWrite() //--></script></div>
</div>

<div id="footer" class="bar">
	<p><form method="post" action="http://wiki.beyondunreal.com/wiki" enctype="application/x-www-form-urlencoded">
<a href="(start).html">Home Page</a> | <a href="tarquin.html">Tarquin</a> | <a href="recent-changes.html">Recent Changes</a> | <a href="http://wiki.beyondunreal.com/wiki?action=editprefs">Preferences</a><br>
<a href="http://wiki.beyondunreal.com/wiki?action=edit&id=Tarquin/Perl">Edit text of this page</a> | <a href="http://wiki.beyondunreal.com/wiki?action=history&id=Tarquin/Perl">View other revisions</a><br>Last edited April 6, 2006 18:12 <a href="http://wiki.beyondunreal.com/wiki?action=browse&diff=1&id=Tarquin/Perl">(diff)</a><br>Search: <input type="text" name="search"  size="20" /><input type="hidden" name="dosearch" value="1"  /><br><br><small><a href="http://wiki.beyondunreal.com/wiki/Tarquin/Perl">Original page</a> &#150; copy created Sat, Jun 23, 2007</small><div></div>
</form>
	</p>
	<p>My program doesn't have bugs. It just develops random features.
</p>
</div>
</div><!-- close of "scrolling" div -->

<div id="quickbar">
	<div id="logo"><a href="http://wiki.beyondunreal.com/"><img src="shared/wikilogo.jpg" width="143" height="100" border="0"></a>
		</div>
	<div class="qbsitename">
		<p>The Unreal Engine Documentation Site</p>
	</div>
	<div class="qbsection">
<p><a href="metatopics.html">Wiki Community</a></p>
<p><a href="category-category.html">Topic Categories</a></p>
<p><a href="/cgi-bin/imageupload.cgi/wiki-ext/imageupload.htt" target="_blank ">Image Uploads</a></p>
<p><a href="http://wiki.beyondunreal.com/wiki?action=random">Random Page</a></p>
<p><a href="recent-changes.html">Recent Changes</a></p>
<p><a href="offline-wiki.html">Offline Wiki</a></p>
</div><div class="qbsection">
<p><a href="unreal-engine.html">Unreal Engine</a></p>
<p><a href="console-commands.html">Console Commands</a></p>
<p><a href="terminology.html">Terminology</a></p>
<p><a href="category-faq.html">FAQs</a></p>
<p><a href="help-desk.html">Help Desk</a></p>
</div><div class="qbsection">
<p><a href="topics-on-mapping.html">Mapping Topics</a></p>
<p><a href="mapping-lessons.html">Mapping Lessons</a></p>
<p><a href="unrealed-3.html">UnrealEd Interface</a></p>
</div><div class="qbsection">
<p><a href="unrealscript.html">UnrealScript Topics</a></p>
<p><a href="unrealscript-lessons.html">UnrealScript Lessons</a></p>
<p><a href="making-mods.html">Making Mods</a></p>
<p><a href="class-tree.html">Class Tree</a></p>
</div><div class="qbsection">
<p><a href="topics-on-modeling.html">Modeling Topics</a></p>
</div><div class="qbsection">
<p><a href="chongqing-page.html">Chongqing Page</a></p>
<p><a href="log-in.html">Log In</a></p></div>
</div>

</body></html>
