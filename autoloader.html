<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"  "http://www.w3.org/TR/html4/loose.dtd">

<html>
<head lang="en">
	<title>UnrealWiki: AutoLoader</title>
	<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
	<link rel="stylesheet" type="text/css" media="screen, print"
		href="shared/stylebase.structural.css">	
	<link rel="stylesheet" type="text/css" media="screen"
		href="shared/template-default.css">
	<link rel="stylesheet" type="text/css" media="screen"
		href="shared/styles.chblue.css">
	<link rel="stylesheet" type="text/css" media="print"
		href="shared/template-default-print.css">
	<!--[if IE 6]>
			<style>
			/* dirty hack for IE6. */
			#quickbar {
				position: absolute;
				}
			</style>
	<![endif]-->
  <link rel="start" href="http://wiki.beyondunreal.com/">
  <link rel="glossary"  href="http://wiki.beyondunreal.com/wiki/Terminology">
  <link rel="help"  href="http://wiki.beyondunreal.com/wiki/Using_The_Wiki">
<script type="text/javascript" src="shared/dhtml.js"></script>
<script type="text/javascript" src="shared/dhtml-menu.js"></script>
<style type="text/css">#dhtml-menu    { background: #eee; padding: 5px 0px; margin-right: -20px; border: 1px solid #888; border-left: 1px solid #ccc; border-top: 1px solid #ccc;  border-right: 1px solid #888; border-bottom: 1px solid #888 }
#dhtml-menu td { color: #000; font-family: Arial,Helvetica,sans-serif; font-size: 9pt; line-height: 13pt; padding: 1px 10px; cursor: default }
#dhtml-menu a  { color: #000; font-family: Arial,Helvetica,sans-serif; font-size: 9pt; line-height: 13pt; text-decoration: none }
#dhtml-menu tt { font-family: monospace; font-size: 9pt }
#dhtml-menu-separator { height: 1px; background: red }
#dhtml-menu-anchor { cursor: default }
</style>
<script type="text/javascript" src="shared/expandable.js"></script>
</head>
<body onLoad="menuInit(); document.cookie='page=AutoLoader; path=/'" class="default">
<div id="scrolling"><!-- contains all except the fixed sidebar -->
<div id="topbar"  class="bar">
	<div class="righthalf">
		<form class="inline" method="post" action="/wiki" enctype="application/x-www-form-urlencoded"><input type="text" name="search"  size="20" /> <input type="submit" name="search" value="search" /></form>
	</div>
	<div class="lefthalf">
		<script type="text/javascript"><!--
			menuAlignRight = false;
		//--></script>
		<span><script type="text/javascript"><!--
 menuWriteAnchor("Quick Navigation") //--></script></span> | <a href="(start).html">Home Page</a> | <a href="recent-changes.html">Recent Changes</a> | <a href="http://wiki.beyondunreal.com/wiki?action=editprefs">Preferences</a>
	</div>
</div>

<div id="content"><!-- contains the title and article -->
	<h1 class='pagetitle'><a href="http://wiki.beyondunreal.com/wiki?back=AutoLoader">AutoLoader</a></h1>
	<div class="wiki"><div class="classpath"><img src="shared//gameicons/icon-ut2003.png"> <a href="unreal-tournament-2003.html">UT2003</a> :: <a href="actor.html">Actor</a> &gt;&gt; <a href="info.html">Info</a> &gt;&gt; AutoLoader (Package: ConfigManager)<br></div>
<p>Here's an <a href="autoloader-example.html">/example</a> on how to use this class</p>
<pre class="uscript"><span class="uscript-line">00001</span>  <span class="uscript-comment">//-----------------------------------------------------------</span>
<span class="uscript-line">00002</span>  <span class="uscript-comment">//  ConfigManager.AutoLoader</span>
<span class="uscript-line">00003</span>  <span class="uscript-comment">//</span>
<span class="uscript-line">00004</span>  <span class="uscript-comment">//  This class has two functions:</span>
<span class="uscript-line">00005</span>  <span class="uscript-comment">//  1. Perform all required ini changes needed for your mod.  Will also UNDO</span>
<span class="uscript-line">00006</span>  <span class="uscript-comment">//     any changes made to the ini if your mod is deactivated.</span>
<span class="uscript-line">00007</span>  <span class="uscript-comment">//     Additional benefit of auto-installation of your mutator on a dedicated</span>
<span class="uscript-line">00008</span>  <span class="uscript-comment">//     server (to enable set bEnableMyLoader=True in defaultproperties)</span>
<span class="uscript-line">00009</span>  <span class="uscript-comment">//</span>
<span class="uscript-line">00010</span>  <span class="uscript-comment">//  2.  Pass FillPlayInfo() calls to mutators which are not part of the game's</span>
<span class="uscript-line">00011</span>  <span class="uscript-comment">//      mutator list (such as mutators which only require ServerActors= lines in ini)</span>
<span class="uscript-line">00012</span>  <span class="uscript-comment">//</span>
<span class="uscript-line">00013</span>  <span class="uscript-comment">//-----------------------------------------------------------</span>
<span class="uscript-line">00014</span>  <span class="uscript-keyword">class</span> AutoLoader <span class="uscript-keyword">extends</span> Info
<span class="uscript-line">00015</span>      <span class="uscript-keyword">abstract</span><span class="uscript-operator">;</span>
<span class="uscript-line">00016</span>  
<span class="uscript-line">00017</span>  <span class="uscript-comment">// Quick note about debugging - By setting DEBUG=True in defaultproperties of your</span>
<span class="uscript-line">00018</span>  <span class="uscript-comment">// AutoLoader subclass when compiling, you can receive large amounts of debug data.</span>
<span class="uscript-line">00019</span>  <span class="uscript-comment">// However, you will quickly encounter the 1024 byte limit if you use ucc.exe to</span>
<span class="uscript-line">00020</span>  <span class="uscript-comment">// start the testing server.  By starting a server using the "ut2003 -server" command,</span>
<span class="uscript-line">00021</span>  <span class="uscript-comment">// you will bypass this limit, since ut2003.exe does not have these limitations.</span>
<span class="uscript-line">00022</span>  
<span class="uscript-line">00023</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">const</span> <span class="uscript-type">bool</span> DEBUG<span class="uscript-operator">;</span>
<span class="uscript-line">00024</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">const</span> <span class="uscript-type">bool</span> DEBUGPROPS<span class="uscript-operator">;</span>
<span class="uscript-line">00025</span>  
<span class="uscript-line">00026</span>  <span class="uscript-keyword">var</span> ConfigMaster                Manager<span class="uscript-operator">;</span>            <span class="uscript-comment">// Pointer to ConfigMaster mutator</span>
<span class="uscript-line">00027</span>  <span class="uscript-keyword">var</span> <span class="uscript-type">string</span>                      InteractionClass<span class="uscript-operator">;</span>   <span class="uscript-comment">// Not yet implemented</span>
<span class="uscript-line">00028</span>  
<span class="uscript-line">00029</span>  <span class="uscript-comment">//=======================================</span>
<span class="uscript-line">00030</span>  <span class="uscript-comment">//  Loading ServerActors</span>
<span class="uscript-line">00031</span>  <span class="uscript-comment">//=======================================</span>
<span class="uscript-line">00032</span>  <span class="uscript-comment">// Pointer to GameEngine</span>
<span class="uscript-line">00033</span>  <span class="uscript-keyword">var</span> GameEngine                  GE<span class="uscript-operator">;</span>
<span class="uscript-line">00034</span>  
<span class="uscript-line">00035</span>  <span class="uscript-comment">// This loader includes a server-side only mutator or server actor</span>
<span class="uscript-line">00036</span>  <span class="uscript-comment">// that will not be part of the mutator chain (will receive FillPlayInfo() calls)</span>
<span class="uscript-line">00037</span>  <span class="uscript-keyword">var</span><span class="uscript-operator">(</span><span class="uscript-operator">)</span> <span class="uscript-type">bool</span>                      bIncludeServerActor<span class="uscript-operator">;</span>
<span class="uscript-line">00038</span>  
<span class="uscript-line">00039</span>  <span class="uscript-comment">// Classname of the ServerActor this loader loads</span>
<span class="uscript-line">00040</span>  <span class="uscript-comment">//  Same value as what would otherwise be your mod's</span>
<span class="uscript-line">00041</span>  <span class="uscript-comment">//  ServerActors= line in the .ini file.</span>
<span class="uscript-line">00042</span>  <span class="uscript-keyword">var</span><span class="uscript-operator">(</span><span class="uscript-operator">)</span> <span class="uscript-type">string</span> ActorClass<span class="uscript-operator">;</span>
<span class="uscript-line">00043</span>  
<span class="uscript-line">00044</span>  <span class="uscript-comment">// Friendly Name of the Server Actor class</span>
<span class="uscript-line">00045</span>  <span class="uscript-comment">//  Used by webadmin/adminmenu as the name of the server actor</span>
<span class="uscript-line">00046</span>  <span class="uscript-keyword">var</span><span class="uscript-operator">(</span><span class="uscript-operator">)</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>          FriendlyName<span class="uscript-operator">;</span>
<span class="uscript-line">00047</span>  <span class="uscript-keyword">var</span><span class="uscript-operator">(</span><span class="uscript-operator">)</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>          ActorDescription<span class="uscript-operator">;</span>
<span class="uscript-line">00048</span>  
<span class="uscript-line">00049</span>  <span class="uscript-comment">// Lock this loader to a certain version (or higher) of your mod</span>
<span class="uscript-line">00050</span>  <span class="uscript-keyword">var</span><span class="uscript-operator">(</span><span class="uscript-operator">)</span> <span class="uscript-type">string</span>            RequiredVersion<span class="uscript-operator">;</span>    <span class="uscript-comment">// Required version of actor</span>
<span class="uscript-line">00051</span>  <span class="uscript-keyword">var</span><span class="uscript-operator">(</span><span class="uscript-operator">)</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>  VersionWarning<span class="uscript-operator">;</span>     <span class="uscript-comment">// Message to write to server log if version not enough</span>
<span class="uscript-line">00052</span>  <span class="uscript-keyword">var</span><span class="uscript-operator">(</span><span class="uscript-operator">)</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>  DownloadMsg<span class="uscript-operator">;</span>        <span class="uscript-comment">// Message to write to log</span>
<span class="uscript-line">00053</span>  
<span class="uscript-line">00054</span>  <span class="uscript-comment">//=======================================</span>
<span class="uscript-line">00055</span>  <span class="uscript-comment">//  Automatic configuration changes</span>
<span class="uscript-line">00056</span>  <span class="uscript-comment">//=======================================</span>
<span class="uscript-line">00057</span>  <span class="uscript-comment">// A single ini change</span>
<span class="uscript-line">00058</span>  <span class="uscript-keyword">struct</span> IniEntry
<span class="uscript-line">00059</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">00060</span>      <span class="uscript-keyword">var</span><span class="uscript-operator">(</span><span class="uscript-operator">)</span> <span class="uscript-type">string</span> ClassFrom<span class="uscript-operator">;</span> <span class="uscript-comment">// Class which contains the setting we want to change</span>
<span class="uscript-line">00061</span>      <span class="uscript-keyword">var</span><span class="uscript-operator">(</span><span class="uscript-operator">)</span> <span class="uscript-type">string</span> PropName<span class="uscript-operator">;</span>  <span class="uscript-comment">// Name of the variable we're trying to change</span>
<span class="uscript-line">00062</span>      <span class="uscript-keyword">var</span><span class="uscript-operator">(</span><span class="uscript-operator">)</span> <span class="uscript-type">string</span> PropValue<span class="uscript-operator">;</span> <span class="uscript-comment">// Value to apply</span>
<span class="uscript-line">00063</span>  <span class="uscript-operator">}</span><span class="uscript-operator">;</span>
<span class="uscript-line">00064</span>  
<span class="uscript-line">00065</span>  <span class="uscript-comment">// Array of ini settings required by this mod</span>
<span class="uscript-line">00066</span>  <span class="uscript-keyword">var</span><span class="uscript-operator">(</span><span class="uscript-operator">)</span>   <span class="uscript-keyword">array</span><span class="uscript-operator">&lt;</span>IniEntry<span class="uscript-operator">&gt;</span>                 RequiredIniEntries<span class="uscript-operator">;</span>
<span class="uscript-line">00067</span>  <span class="uscript-keyword">var</span>     <span class="uscript-keyword">array</span><span class="uscript-operator">&lt;</span>Property<span class="uscript-operator">&gt;</span>                 Properties<span class="uscript-operator">;</span>
<span class="uscript-line">00068</span>  
<span class="uscript-line">00069</span>  
<span class="uscript-line">00070</span>  <span class="uscript-comment">//###################################################################</span>
<span class="uscript-line">00071</span>  <span class="uscript-comment">//###################################################################</span>
<span class="uscript-line">00072</span>  <span class="uscript-comment">//</span>
<span class="uscript-line">00073</span>  <span class="uscript-comment">//  Public methods - should be subclassed to customize loader's response</span>
<span class="uscript-line">00074</span>  
<span class="uscript-line">00075</span>  <span class="uscript-comment">// if return true, loader class will be spawned</span>
<span class="uscript-line">00076</span>  <span class="uscript-keyword">static</span> <span class="uscript-keyword">function</span> <span class="uscript-type">bool</span> IsActive<span class="uscript-operator">(</span><span class="uscript-operator">)</span>
<span class="uscript-line">00077</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">00078</span>      <span class="uscript-keyword">return</span> <span class="uscript-keyword">false</span><span class="uscript-operator">;</span>
<span class="uscript-line">00079</span>  <span class="uscript-operator">}</span>
<span class="uscript-line">00080</span>  
<span class="uscript-line">00081</span>  <span class="uscript-comment">// should be subclassed - set loader to active/will be included next match</span>
<span class="uscript-line">00082</span>  <span class="uscript-keyword">static</span> <span class="uscript-keyword">function</span> <span class="uscript-type">bool</span> EnableLoader<span class="uscript-operator">(</span><span class="uscript-keyword">optional</span> <span class="uscript-type">string</span> SpecialActor<span class="uscript-operator">)</span>
<span class="uscript-line">00083</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">00084</span>      <span class="uscript-keyword">return</span> <span class="uscript-keyword">false</span><span class="uscript-operator">;</span>
<span class="uscript-line">00085</span>  <span class="uscript-operator">}</span>
<span class="uscript-line">00086</span>  
<span class="uscript-line">00087</span>  <span class="uscript-comment">// should be subclassed</span>
<span class="uscript-line">00088</span>  <span class="uscript-keyword">static</span> <span class="uscript-keyword">function</span> <span class="uscript-type">bool</span> DisableLoader<span class="uscript-operator">(</span><span class="uscript-keyword">optional</span> <span class="uscript-type">string</span> SpecialActor<span class="uscript-operator">)</span>
<span class="uscript-line">00089</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">00090</span>      <span class="uscript-keyword">return</span> <span class="uscript-keyword">true</span><span class="uscript-operator">;</span>
<span class="uscript-line">00091</span>  <span class="uscript-operator">}</span>
<span class="uscript-line">00092</span>  
<span class="uscript-line">00093</span>  <span class="uscript-comment">// called on all loader classes - used to activate loader based on active mutators</span>
<span class="uscript-line">00094</span>  <span class="uscript-keyword">static</span> <span class="uscript-keyword">function</span> <span class="uscript-type">bool</span> CheckCurrentMutators<span class="uscript-operator">(</span><span class="uscript-type">string</span> URL<span class="uscript-operator">)</span>
<span class="uscript-line">00095</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">00096</span>      <span class="uscript-keyword">return</span> <span class="uscript-keyword">false</span><span class="uscript-operator">;</span>
<span class="uscript-line">00097</span>  <span class="uscript-operator">}</span>
<span class="uscript-line">00098</span>  
<span class="uscript-line">00099</span>  <span class="uscript-comment">// called on all loader classes which have bIncludeServerActor=True - used to activate loader based on manual ServerActor entry</span>
<span class="uscript-line">00100</span>  <span class="uscript-keyword">static</span> <span class="uscript-keyword">function</span> <span class="uscript-type">bool</span> CheckStrayActors<span class="uscript-operator">(</span><span class="uscript-type">string</span> ServerActors<span class="uscript-operator">)</span>
<span class="uscript-line">00101</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">00102</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">int</span> i<span class="uscript-operator">;</span>
<span class="uscript-line">00103</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">bool</span> bAddMe<span class="uscript-operator">;</span>
<span class="uscript-line">00104</span>  
<span class="uscript-line">00105</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-keyword">default</span><span class="uscript-operator">.</span>bIncludeServerActor<span class="uscript-operator">)</span>
<span class="uscript-line">00106</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>InStr<span class="uscript-operator">(</span>ServerActors<span class="uscript-operator">,</span><span class="uscript-keyword">default</span><span class="uscript-operator">.</span>ActorClass<span class="uscript-operator">)</span> <span class="uscript-operator">!=</span> <span class="uscript-operator">-</span><span class="uscript-number">1</span><span class="uscript-operator">)</span>
<span class="uscript-line">00107</span>              bAddMe <span class="uscript-operator">=</span> EnableLoader<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00108</span>  
<span class="uscript-line">00109</span>      <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i <span class="uscript-operator">=</span> <span class="uscript-number">0</span><span class="uscript-operator">;</span> i <span class="uscript-operator">&lt;</span> <span class="uscript-keyword">default</span><span class="uscript-operator">.</span>RequiredIniEntries<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">;</span> i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">00110</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">!</span>bAddMe <span class="uscript-operator">&amp;&amp;</span> <span class="uscript-keyword">default</span><span class="uscript-operator">.</span>RequiredIniEntries<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>ClassFrom <span class="uscript-operator">~=</span> <span class="uscript-string">"Engine.GameEngine"</span> <span class="uscript-operator">&amp;&amp;</span> <span class="uscript-keyword">default</span><span class="uscript-operator">.</span>RequiredIniEntries<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>PropName <span class="uscript-operator">~=</span> <span class="uscript-string">"ServerActors"</span><span class="uscript-operator">)</span>
<span class="uscript-line">00111</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>InStr<span class="uscript-operator">(</span>ServerActors<span class="uscript-operator">,</span><span class="uscript-keyword">default</span><span class="uscript-operator">.</span>RequiredIniEntries<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>PropValue<span class="uscript-operator">)</span> <span class="uscript-operator">!=</span> <span class="uscript-operator">-</span><span class="uscript-number">1</span><span class="uscript-operator">)</span>
<span class="uscript-line">00112</span>                  bAddMe <span class="uscript-operator">=</span> EnableLoader<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00113</span>  
<span class="uscript-line">00114</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-keyword">default</span><span class="uscript-operator">.</span>DEBUG<span class="uscript-operator">)</span>
<span class="uscript-line">00115</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">00116</span>          log<span class="uscript-operator">(</span><span class="uscript-keyword">default</span><span class="uscript-operator">.</span><span class="uscript-keyword">Class</span><span class="uscript-operator">@</span><span class="uscript-string">"Received string value:"</span><span class="uscript-operator">$</span>ServerActors<span class="uscript-operator">,</span><span class="uscript-name">'CheckStrayActors'</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00117</span>          log<span class="uscript-operator">(</span><span class="uscript-keyword">default</span><span class="uscript-operator">.</span><span class="uscript-keyword">Class</span><span class="uscript-operator">@</span><span class="uscript-string">"Returning"</span><span class="uscript-operator">@</span>bAddMe<span class="uscript-operator">,</span><span class="uscript-name">'CheckStrayActors'</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00118</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">00119</span>      <span class="uscript-keyword">return</span> bAddMe<span class="uscript-operator">;</span>
<span class="uscript-line">00120</span>  <span class="uscript-operator">}</span>
<span class="uscript-line">00121</span>  
<span class="uscript-line">00122</span>  <span class="uscript-comment">// Only managed actors can be added to Ladder profiles</span>
<span class="uscript-line">00123</span>  <span class="uscript-comment">// Normally, only the ActorClass of your loader (if bIncludeServerActor=True) would be need to be managed</span>
<span class="uscript-line">00124</span>  <span class="uscript-keyword">static</span> <span class="uscript-keyword">function</span> <span class="uscript-keyword">array</span><span class="uscript-operator">&lt;</span><span class="uscript-type">string</span><span class="uscript-operator">&gt;</span> GetManagedActors<span class="uscript-operator">(</span><span class="uscript-operator">)</span>
<span class="uscript-line">00125</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">00126</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">int</span> i<span class="uscript-operator">;</span>
<span class="uscript-line">00127</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">string</span> A<span class="uscript-operator">,</span> B<span class="uscript-operator">,</span> C<span class="uscript-operator">;</span>
<span class="uscript-line">00128</span>      <span class="uscript-keyword">local</span> <span class="uscript-keyword">array</span><span class="uscript-operator">&lt;</span><span class="uscript-type">string</span><span class="uscript-operator">&gt;</span> ABC<span class="uscript-operator">;</span>
<span class="uscript-line">00129</span>  
<span class="uscript-line">00130</span>      i <span class="uscript-operator">=</span> <span class="uscript-operator">-</span><span class="uscript-number">1</span><span class="uscript-operator">;</span>
<span class="uscript-line">00131</span>      <span class="uscript-keyword">while</span> <span class="uscript-operator">(</span><span class="uscript-keyword">static</span><span class="uscript-operator">.</span>AddManagedActor<span class="uscript-operator">(</span>i<span class="uscript-operator">++</span><span class="uscript-operator">,</span>A<span class="uscript-operator">,</span>B<span class="uscript-operator">,</span>C<span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">00132</span>          ABC<span class="uscript-operator">[</span>ABC<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">]</span> <span class="uscript-operator">=</span> A<span class="uscript-operator">$</span><span class="uscript-string">","</span><span class="uscript-operator">$</span>B<span class="uscript-operator">$</span><span class="uscript-string">","</span><span class="uscript-operator">$</span>C<span class="uscript-operator">;</span>
<span class="uscript-line">00133</span>  
<span class="uscript-line">00134</span>      <span class="uscript-keyword">return</span> ABC<span class="uscript-operator">;</span>
<span class="uscript-line">00135</span>  <span class="uscript-operator">}</span>
<span class="uscript-line">00136</span>  
<span class="uscript-line">00137</span>  <span class="uscript-comment">// Managed actors will be passed FillPlayInfo() calls</span>
<span class="uscript-line">00138</span>  <span class="uscript-keyword">static</span> <span class="uscript-keyword">function</span> <span class="uscript-type">bool</span> AddManagedActor<span class="uscript-operator">(</span><span class="uscript-type">int</span> Idx<span class="uscript-operator">,</span> <span class="uscript-keyword">out</span> <span class="uscript-type">string</span> ActorClassName<span class="uscript-operator">,</span> <span class="uscript-keyword">out</span> <span class="uscript-type">string</span> ActorName<span class="uscript-operator">,</span> <span class="uscript-keyword">out</span> <span class="uscript-type">string</span> ActorDesc<span class="uscript-operator">)</span>
<span class="uscript-line">00139</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">00140</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>Idx <span class="uscript-operator">==</span> <span class="uscript-operator">-</span><span class="uscript-number">1</span> <span class="uscript-operator">&amp;&amp;</span> <span class="uscript-keyword">default</span><span class="uscript-operator">.</span>bIncludeServerActor<span class="uscript-operator">)</span>
<span class="uscript-line">00141</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">00142</span>          ActorClassName <span class="uscript-operator">=</span> <span class="uscript-keyword">default</span><span class="uscript-operator">.</span>ActorClass<span class="uscript-operator">;</span>
<span class="uscript-line">00143</span>          ActorName <span class="uscript-operator">=</span> <span class="uscript-keyword">default</span><span class="uscript-operator">.</span>FriendlyName<span class="uscript-operator">;</span>
<span class="uscript-line">00144</span>          ActorDesc <span class="uscript-operator">=</span> <span class="uscript-keyword">default</span><span class="uscript-operator">.</span>ActorDescription<span class="uscript-operator">;</span>
<span class="uscript-line">00145</span>          <span class="uscript-keyword">return</span> <span class="uscript-keyword">true</span><span class="uscript-operator">;</span>
<span class="uscript-line">00146</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">00147</span>  
<span class="uscript-line">00148</span>      <span class="uscript-keyword">return</span> <span class="uscript-keyword">false</span><span class="uscript-operator">;</span>
<span class="uscript-line">00149</span>  <span class="uscript-operator">}</span>
<span class="uscript-line">00150</span>  
<span class="uscript-line">00151</span>  <span class="uscript-comment">// Optional hook for version filtering</span>
<span class="uscript-line">00152</span>  <span class="uscript-keyword">static</span> <span class="uscript-keyword">function</span> <span class="uscript-type">bool</span> MatchesVersion<span class="uscript-operator">(</span><span class="uscript-type">float</span> ActorVersion<span class="uscript-operator">,</span> <span class="uscript-keyword">optional</span> <span class="uscript-type">bool</span> bExact<span class="uscript-operator">,</span> <span class="uscript-keyword">optional</span> <span class="uscript-type">string</span> NewURL<span class="uscript-operator">)</span>
<span class="uscript-line">00153</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">00154</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">float</span> CurrentVersion<span class="uscript-operator">;</span>
<span class="uscript-line">00155</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">string</span> LogText<span class="uscript-operator">;</span>
<span class="uscript-line">00156</span>  
<span class="uscript-line">00157</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-keyword">default</span><span class="uscript-operator">.</span>RequiredVersion <span class="uscript-operator">==</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">00158</span>          <span class="uscript-keyword">return</span> <span class="uscript-keyword">true</span><span class="uscript-operator">;</span>
<span class="uscript-line">00159</span>  
<span class="uscript-line">00160</span>      CurrentVersion <span class="uscript-operator">=</span> <span class="uscript-type">float</span><span class="uscript-operator">(</span><span class="uscript-keyword">default</span><span class="uscript-operator">.</span>RequiredVersion<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00161</span>  
<span class="uscript-line">00162</span>      <span class="uscript-comment">// Return false if loader version is higher than actor version</span>
<span class="uscript-line">00163</span>      <span class="uscript-comment">// Return false if loader version is lower than actor version and bExact=True</span>
<span class="uscript-line">00164</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">(</span>ActorVersion <span class="uscript-operator">&lt;</span> CurrentVersion<span class="uscript-operator">)</span> <span class="uscript-operator">||</span> <span class="uscript-operator">(</span>ActorVersion <span class="uscript-operator">&gt;</span> CurrentVersion <span class="uscript-operator">&amp;&amp;</span> bExact<span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">00165</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">00166</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-keyword">default</span><span class="uscript-operator">.</span>VersionWarning <span class="uscript-operator">!=</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">00167</span>          <span class="uscript-operator">{</span>
<span class="uscript-line">00168</span>              LogText <span class="uscript-operator">=</span> <span class="uscript-keyword">static</span><span class="uscript-operator">.</span>ReplaceTag<span class="uscript-operator">(</span><span class="uscript-keyword">default</span><span class="uscript-operator">.</span>VersionWarning<span class="uscript-operator">,</span><span class="uscript-string">"%CurVer%"</span><span class="uscript-operator">,</span>CurrentVersion<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00169</span>              LogText <span class="uscript-operator">=</span> <span class="uscript-keyword">static</span><span class="uscript-operator">.</span>ReplaceTag<span class="uscript-operator">(</span>LogText<span class="uscript-operator">,</span><span class="uscript-string">"%ReqVer%"</span><span class="uscript-operator">,</span>ActorVersion<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00170</span>              log<span class="uscript-operator">(</span>LogText<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00171</span>          <span class="uscript-operator">}</span>
<span class="uscript-line">00172</span>  
<span class="uscript-line">00173</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>NewURL <span class="uscript-operator">!=</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">00174</span>              log<span class="uscript-operator">(</span><span class="uscript-keyword">static</span><span class="uscript-operator">.</span>ReplaceTag<span class="uscript-operator">(</span><span class="uscript-keyword">default</span><span class="uscript-operator">.</span>DownloadMsg<span class="uscript-operator">,</span><span class="uscript-string">"%URL%"</span><span class="uscript-operator">,</span>NewURL<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00175</span>  
<span class="uscript-line">00176</span>          <span class="uscript-keyword">return</span> <span class="uscript-keyword">false</span><span class="uscript-operator">;</span>
<span class="uscript-line">00177</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">00178</span>  
<span class="uscript-line">00179</span>      <span class="uscript-keyword">return</span> <span class="uscript-keyword">true</span><span class="uscript-operator">;</span>
<span class="uscript-line">00180</span>  <span class="uscript-operator">}</span>
<span class="uscript-line">00181</span>  
<span class="uscript-line">00182</span>  <span class="uscript-comment">// To prevent your loader from causing a server crash, add your checks here</span>
<span class="uscript-line">00183</span>  <span class="uscript-comment">// return false to prevent your loader from being loaded</span>
<span class="uscript-line">00184</span>  
<span class="uscript-line">00185</span>  <span class="uscript-comment">// You only need to override this function if bIncludeServerActor=False in your loader,</span>
<span class="uscript-line">00186</span>  <span class="uscript-comment">// or if you have RequiredIniChanges that reference additional custom packages</span>
<span class="uscript-line">00187</span>  <span class="uscript-keyword">static</span> <span class="uscript-keyword">function</span> <span class="uscript-type">bool</span> ValidateLoader<span class="uscript-operator">(</span><span class="uscript-operator">)</span>
<span class="uscript-line">00188</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">00189</span>      <span class="uscript-keyword">local</span> <span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>Info<span class="uscript-operator">&gt;</span>   MyActor<span class="uscript-operator">;</span>
<span class="uscript-line">00190</span>  
<span class="uscript-line">00191</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-keyword">default</span><span class="uscript-operator">.</span>bIncludeServerActor <span class="uscript-operator">&amp;&amp;</span> <span class="uscript-keyword">default</span><span class="uscript-operator">.</span>ActorClass <span class="uscript-operator">!=</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">00192</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">00193</span>          <span class="uscript-comment">// Specify True for 3rd param in DynamicLoadObject to prevent log spam if MyActor isn't on server</span>
<span class="uscript-line">00194</span>          MyActor <span class="uscript-operator">=</span> <span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>Info<span class="uscript-operator">&gt;</span><span class="uscript-operator">(</span>DynamicLoadObject<span class="uscript-operator">(</span><span class="uscript-keyword">default</span><span class="uscript-operator">.</span>ActorClass<span class="uscript-operator">,</span><span class="uscript-keyword">class</span><span class="uscript-name">'Class'</span><span class="uscript-operator">,</span><span class="uscript-keyword">True</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00195</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>MyActor <span class="uscript-operator">==</span> <span class="uscript-keyword">None</span><span class="uscript-operator">)</span>
<span class="uscript-line">00196</span>              <span class="uscript-keyword">return</span> <span class="uscript-keyword">false</span><span class="uscript-operator">;</span>
<span class="uscript-line">00197</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">00198</span>  
<span class="uscript-line">00199</span>      <span class="uscript-keyword">return</span> <span class="uscript-keyword">true</span><span class="uscript-operator">;</span>
<span class="uscript-line">00200</span>  <span class="uscript-operator">}</span>
<span class="uscript-line">00201</span>  
<span class="uscript-line">00202</span>  <span class="uscript-comment">// Hook for loader to cancel external removal request, or effect any specialized ini changes to make before removal</span>
<span class="uscript-line">00203</span>  <span class="uscript-keyword">function</span> <span class="uscript-type">bool</span> AcceptRemoval<span class="uscript-operator">(</span><span class="uscript-keyword">optional</span> <span class="uscript-keyword">array</span><span class="uscript-operator">&lt;</span>Property<span class="uscript-operator">&gt;</span> Props<span class="uscript-operator">)</span>
<span class="uscript-line">00204</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">00205</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>Props<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span> <span class="uscript-operator">&gt;</span> <span class="uscript-number">0</span><span class="uscript-operator">)</span>
<span class="uscript-line">00206</span>          Properties <span class="uscript-operator">=</span> Props<span class="uscript-operator">;</span>
<span class="uscript-line">00207</span>  
<span class="uscript-line">00208</span>      RemoveMe<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00209</span>      <span class="uscript-keyword">return</span> <span class="uscript-keyword">true</span><span class="uscript-operator">;</span>
<span class="uscript-line">00210</span>  <span class="uscript-operator">}</span>
<span class="uscript-line">00211</span>  
<span class="uscript-line">00212</span>  <span class="uscript-comment">// should be subclassed</span>
<span class="uscript-line">00213</span>  <span class="uscript-comment">// always use "return !bEnableMyLoader;"</span>
<span class="uscript-line">00214</span>  <span class="uscript-comment">// see LadderLoader.LadderLoader or TeamBalanceLoader.BalanceLoader for examples</span>
<span class="uscript-line">00215</span>  <span class="uscript-keyword">function</span> <span class="uscript-type">bool</span> WantsToBeDisabled<span class="uscript-operator">(</span><span class="uscript-operator">)</span>
<span class="uscript-line">00216</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">00217</span>      <span class="uscript-keyword">return</span> <span class="uscript-keyword">false</span><span class="uscript-operator">;</span>
<span class="uscript-line">00218</span>  <span class="uscript-operator">}</span>
<span class="uscript-line">00219</span>  
<span class="uscript-line">00220</span>  <span class="uscript-comment">// called for each RequiredIniEntry</span>
<span class="uscript-line">00221</span>  <span class="uscript-comment">// return true to apply the RequiredIniEntry.PropValue</span>
<span class="uscript-line">00222</span>  <span class="uscript-keyword">function</span> <span class="uscript-type">bool</span> ObjectNeedsUpdate<span class="uscript-operator">(</span>Object O<span class="uscript-operator">,</span> <span class="uscript-type">string</span> PropName<span class="uscript-operator">,</span> <span class="uscript-type">string</span> PropValue<span class="uscript-operator">)</span>
<span class="uscript-line">00223</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">00224</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">string</span> Temp<span class="uscript-operator">;</span>
<span class="uscript-line">00225</span>  
<span class="uscript-line">00226</span>      Temp <span class="uscript-operator">=</span> O<span class="uscript-operator">.</span>GetPropertyText<span class="uscript-operator">(</span>PropName<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00227</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span> InStr<span class="uscript-operator">(</span>Caps<span class="uscript-operator">(</span>Temp<span class="uscript-operator">)</span><span class="uscript-operator">,</span>Caps<span class="uscript-operator">(</span>PropValue<span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">&lt;</span> <span class="uscript-number">0</span> <span class="uscript-operator">)</span>
<span class="uscript-line">00228</span>          <span class="uscript-keyword">return</span> <span class="uscript-keyword">true</span><span class="uscript-operator">;</span>
<span class="uscript-line">00229</span>  
<span class="uscript-line">00230</span>      <span class="uscript-keyword">return</span> <span class="uscript-keyword">false</span><span class="uscript-operator">;</span>
<span class="uscript-line">00231</span>  <span class="uscript-operator">}</span>
<span class="uscript-line">00232</span>  
<span class="uscript-line">00233</span>  <span class="uscript-comment">// notification of pending update - return false to skip update for loader</span>
<span class="uscript-line">00234</span>  <span class="uscript-keyword">function</span> <span class="uscript-type">bool</span> ApplyUpdate<span class="uscript-operator">(</span><span class="uscript-operator">)</span>
<span class="uscript-line">00235</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">00236</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>DEBUG<span class="uscript-operator">)</span> log<span class="uscript-operator">(</span><span class="uscript-keyword">class</span><span class="uscript-operator">@</span><span class="uscript-string">"Returning"</span><span class="uscript-operator">@</span>IsActive<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">,</span><span class="uscript-name">'ApplyUpdate'</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00237</span>      <span class="uscript-keyword">return</span> IsActive<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00238</span>  <span class="uscript-operator">}</span>
<span class="uscript-line">00239</span>  
<span class="uscript-line">00240</span>  <span class="uscript-comment">// return -1 if want to simply add entry</span>
<span class="uscript-line">00241</span>  <span class="uscript-comment">// return index of array entry if want to overwrite</span>
<span class="uscript-line">00242</span>  <span class="uscript-keyword">function</span> <span class="uscript-type">int</span> CheckArrayEntry<span class="uscript-operator">(</span><span class="uscript-type">string</span> PropName<span class="uscript-operator">,</span> <span class="uscript-keyword">array</span><span class="uscript-operator">&lt;</span><span class="uscript-type">string</span><span class="uscript-operator">&gt;</span> PropArray<span class="uscript-operator">)</span>
<span class="uscript-line">00243</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">00244</span>      <span class="uscript-keyword">return</span> <span class="uscript-operator">-</span><span class="uscript-number">1</span><span class="uscript-operator">;</span>
<span class="uscript-line">00245</span>  <span class="uscript-operator">}</span>
<span class="uscript-line">00246</span>  
<span class="uscript-line">00247</span>  <span class="uscript-comment">// To maintain consistency, always add to "Server Actors" page</span>
<span class="uscript-line">00248</span>  <span class="uscript-comment">// static function FillPlayInfo(PlayInfo PI)</span>
<span class="uscript-line">00249</span>  <span class="uscript-comment">// {</span>
<span class="uscript-line">00250</span>  <span class="uscript-comment">//      Super.FillPlayInfo(PI);</span>
<span class="uscript-line">00251</span>  <span class="uscript-comment">//      PI.AddSetting("ServerActors",....</span>
<span class="uscript-line">00252</span>  <span class="uscript-comment">// }</span>
<span class="uscript-line">00253</span>  <span class="uscript-comment">//</span>
<span class="uscript-line">00254</span>  <span class="uscript-comment">//###################################################################</span>
<span class="uscript-line">00255</span>  <span class="uscript-comment">//###################################################################</span>
<span class="uscript-line">00256</span>  <span class="uscript-comment">//</span>
<span class="uscript-line">00257</span>  <span class="uscript-comment">//  Public Final Methods</span>
<span class="uscript-line">00258</span>  <span class="uscript-comment">//  These are used to operate the internal mechanisms of the auto loader system.</span>
<span class="uscript-line">00259</span>  <span class="uscript-comment">//</span>
<span class="uscript-line">00260</span>  <span class="uscript-comment">//</span>
<span class="uscript-line">00261</span>  
<span class="uscript-line">00262</span>  <span class="uscript-comment">// Called by ConfigMaster when Level.ServerTravel is called</span>
<span class="uscript-line">00263</span>  
<span class="uscript-line">00264</span>  <span class="uscript-comment">// Removes loader if WantsToBeDisabled() returns True</span>
<span class="uscript-line">00265</span>  <span class="uscript-comment">// Applies value for RequiredIniProperties if ObjectNeedsUpdate returns true</span>
<span class="uscript-line">00266</span>  <span class="uscript-keyword">final</span> <span class="uscript-keyword">function</span> UpdateConfiguration<span class="uscript-operator">(</span><span class="uscript-keyword">array</span><span class="uscript-operator">&lt;</span>Property<span class="uscript-operator">&gt;</span> Props<span class="uscript-operator">)</span>
<span class="uscript-line">00267</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">00268</span>      <span class="uscript-keyword">local</span> Object            O<span class="uscript-operator">;</span>
<span class="uscript-line">00269</span>      <span class="uscript-keyword">local</span> Property          P<span class="uscript-operator">;</span>
<span class="uscript-line">00270</span>  
<span class="uscript-line">00271</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">string</span>            N<span class="uscript-operator">,</span>V<span class="uscript-operator">;</span>
<span class="uscript-line">00272</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">int</span>               i<span class="uscript-operator">,</span> j<span class="uscript-operator">;</span>
<span class="uscript-line">00273</span>  
<span class="uscript-line">00274</span>      <span class="uscript-keyword">local</span> <span class="uscript-keyword">array</span><span class="uscript-operator">&lt;</span><span class="uscript-type">string</span><span class="uscript-operator">&gt;</span>     Arr<span class="uscript-operator">;</span>
<span class="uscript-line">00275</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">string</span>            ArrS<span class="uscript-operator">;</span>
<span class="uscript-line">00276</span>  
<span class="uscript-line">00277</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>DEBUG<span class="uscript-operator">)</span>
<span class="uscript-line">00278</span>          log<span class="uscript-operator">(</span><span class="uscript-string">"Update configuration in"</span><span class="uscript-operator">@</span><span class="uscript-keyword">class</span><span class="uscript-operator">,</span><span class="uscript-name">'UpdateConfiguration'</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00279</span>  
<span class="uscript-line">00280</span>      ResetConfig<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00281</span>      Properties <span class="uscript-operator">=</span> Props<span class="uscript-operator">;</span>
<span class="uscript-line">00282</span>  
<span class="uscript-line">00283</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>WantsToBeDisabled<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">00284</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">00285</span>          RemoveMe<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00286</span>          <span class="uscript-keyword">return</span><span class="uscript-operator">;</span>
<span class="uscript-line">00287</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">00288</span>  
<span class="uscript-line">00289</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>bIncludeServerActor <span class="uscript-operator">&amp;&amp;</span> ActorClass <span class="uscript-operator">!=</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">00290</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">00291</span>          O <span class="uscript-operator">=</span> GetObjectOfClass<span class="uscript-operator">(</span><span class="uscript-keyword">class</span><span class="uscript-name">'Engine.GameEngine'</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00292</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>O <span class="uscript-operator">!=</span> <span class="uscript-keyword">None</span><span class="uscript-operator">)</span>
<span class="uscript-line">00293</span>          <span class="uscript-operator">{</span>
<span class="uscript-line">00294</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>ObjectNeedsUpdate<span class="uscript-operator">(</span>O<span class="uscript-operator">,</span> <span class="uscript-string">"ServerActors"</span><span class="uscript-operator">,</span> ActorClass<span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">00295</span>              <span class="uscript-operator">{</span>
<span class="uscript-line">00296</span>                  ArrS <span class="uscript-operator">=</span> O<span class="uscript-operator">.</span>GetPropertyText<span class="uscript-operator">(</span><span class="uscript-string">"ServerActors"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00297</span>                  <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>ArrS <span class="uscript-operator">!=</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">00298</span>                      Arr <span class="uscript-operator">=</span> GenerateArray<span class="uscript-operator">(</span>ArrS<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00299</span>  
<span class="uscript-line">00300</span>                  j <span class="uscript-operator">=</span> <span class="uscript-operator">-</span><span class="uscript-number">1</span><span class="uscript-operator">;</span>
<span class="uscript-line">00301</span>                  <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>Arr<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span> <span class="uscript-operator">&gt;</span> <span class="uscript-number">0</span><span class="uscript-operator">)</span>
<span class="uscript-line">00302</span>                      j <span class="uscript-operator">=</span> CheckArrayEntry<span class="uscript-operator">(</span><span class="uscript-string">"ServerActors"</span><span class="uscript-operator">,</span> Arr<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00303</span>  
<span class="uscript-line">00304</span>                  <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>j <span class="uscript-operator">&lt;</span> <span class="uscript-number">0</span><span class="uscript-operator">)</span>
<span class="uscript-line">00305</span>                      O<span class="uscript-operator">.</span>SetPropertyText<span class="uscript-operator">(</span><span class="uscript-string">"ServerActors"</span><span class="uscript-operator">,</span>AddDynArrayMember<span class="uscript-operator">(</span>O<span class="uscript-operator">,</span><span class="uscript-string">"ServerActors"</span><span class="uscript-operator">,</span>ActorClass<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00306</span>  
<span class="uscript-line">00307</span>                  <span class="uscript-keyword">else</span> O<span class="uscript-operator">.</span>SetPropertyText<span class="uscript-operator">(</span><span class="uscript-string">"ServerActors"</span><span class="uscript-operator">,</span>InsertArrayMember<span class="uscript-operator">(</span>O<span class="uscript-operator">,</span> <span class="uscript-string">"ServerActors"</span><span class="uscript-operator">,</span> ActorClass<span class="uscript-operator">,</span> j<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00308</span>                  O<span class="uscript-operator">.</span>SaveConfig<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00309</span>              <span class="uscript-operator">}</span>
<span class="uscript-line">00310</span>          <span class="uscript-operator">}</span>
<span class="uscript-line">00311</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">00312</span>  
<span class="uscript-line">00313</span>      <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i <span class="uscript-operator">=</span> <span class="uscript-number">0</span><span class="uscript-operator">;</span>i<span class="uscript-operator">&lt;</span>RequiredIniEntries<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">;</span>i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">00314</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">00315</span>          O <span class="uscript-operator">=</span> GetObjectForEntry<span class="uscript-operator">(</span>RequiredIniEntries<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00316</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>O <span class="uscript-operator">==</span> <span class="uscript-keyword">None</span><span class="uscript-operator">)</span> <span class="uscript-keyword">continue</span><span class="uscript-operator">;</span>
<span class="uscript-line">00317</span>  
<span class="uscript-line">00318</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">!</span>ObjectNeedsUpdate<span class="uscript-operator">(</span>O<span class="uscript-operator">,</span> RequiredIniEntries<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>PropName<span class="uscript-operator">,</span> RequiredIniEntries<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>PropValue<span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-keyword">continue</span><span class="uscript-operator">;</span>
<span class="uscript-line">00319</span>  
<span class="uscript-line">00320</span>          N <span class="uscript-operator">=</span> RequiredIniEntries<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>PropName<span class="uscript-operator">;</span>
<span class="uscript-line">00321</span>          V <span class="uscript-operator">=</span> RequiredIniEntries<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>PropValue<span class="uscript-operator">;</span>
<span class="uscript-line">00322</span>          P <span class="uscript-operator">=</span> GetProperty<span class="uscript-operator">(</span>O<span class="uscript-operator">,</span> N<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00323</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>DEBUG<span class="uscript-operator">)</span>
<span class="uscript-line">00324</span>              log<span class="uscript-operator">(</span><span class="uscript-keyword">class</span><span class="uscript-operator">@</span><span class="uscript-string">"got property"</span><span class="uscript-operator">@</span>p<span class="uscript-operator">,</span><span class="uscript-name">'UpdateConfiguration'</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00325</span>  
<span class="uscript-line">00326</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>P <span class="uscript-operator">==</span> <span class="uscript-keyword">None</span><span class="uscript-operator">)</span> <span class="uscript-keyword">continue</span><span class="uscript-operator">;</span>
<span class="uscript-line">00327</span>  
<span class="uscript-line">00328</span>          j <span class="uscript-operator">=</span> <span class="uscript-operator">-</span><span class="uscript-number">1</span><span class="uscript-operator">;</span>
<span class="uscript-line">00329</span>  
<span class="uscript-line">00330</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>PropIsArray<span class="uscript-operator">(</span>P<span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">00331</span>          <span class="uscript-operator">{</span>
<span class="uscript-line">00332</span>              ArrS <span class="uscript-operator">=</span> O<span class="uscript-operator">.</span>GetPropertyText<span class="uscript-operator">(</span>N<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00333</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>ArrS <span class="uscript-operator">!=</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">00334</span>                  Arr <span class="uscript-operator">=</span> GenerateArray<span class="uscript-operator">(</span>ArrS<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00335</span>  
<span class="uscript-line">00336</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>Arr<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span> <span class="uscript-operator">&gt;</span> <span class="uscript-number">0</span><span class="uscript-operator">)</span>
<span class="uscript-line">00337</span>                  j <span class="uscript-operator">=</span> CheckArrayEntry<span class="uscript-operator">(</span>N<span class="uscript-operator">,</span> Arr<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00338</span>  
<span class="uscript-line">00339</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>j <span class="uscript-operator">&lt;</span> <span class="uscript-number">0</span><span class="uscript-operator">)</span>
<span class="uscript-line">00340</span>                  O<span class="uscript-operator">.</span>SetPropertyText<span class="uscript-operator">(</span>N<span class="uscript-operator">,</span>AddDynArrayMember<span class="uscript-operator">(</span>O<span class="uscript-operator">,</span>N<span class="uscript-operator">,</span>V<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00341</span>  
<span class="uscript-line">00342</span>              <span class="uscript-keyword">else</span> O<span class="uscript-operator">.</span>SetPropertyText<span class="uscript-operator">(</span>N<span class="uscript-operator">,</span>InsertArrayMember<span class="uscript-operator">(</span>O<span class="uscript-operator">,</span> N<span class="uscript-operator">,</span> V<span class="uscript-operator">,</span> j<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00343</span>          <span class="uscript-operator">}</span>
<span class="uscript-line">00344</span>  
<span class="uscript-line">00345</span>          <span class="uscript-keyword">else</span>
<span class="uscript-line">00346</span>          <span class="uscript-operator">{</span>
<span class="uscript-line">00347</span>              StoreDefaultValue<span class="uscript-operator">(</span>O<span class="uscript-operator">,</span> N<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00348</span>              O<span class="uscript-operator">.</span>SetPropertyText<span class="uscript-operator">(</span>N<span class="uscript-operator">,</span>V<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00349</span>          <span class="uscript-operator">}</span>
<span class="uscript-line">00350</span>  
<span class="uscript-line">00351</span>          O<span class="uscript-operator">.</span>SaveConfig<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00352</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">00353</span>  <span class="uscript-operator">}</span>
<span class="uscript-line">00354</span>  
<span class="uscript-line">00355</span>  <span class="uscript-comment">// Regarding OriginalValues</span>
<span class="uscript-line">00356</span>  <span class="uscript-keyword">final</span> <span class="uscript-keyword">function</span> StoreDefaultValue<span class="uscript-operator">(</span>Object O<span class="uscript-operator">,</span> <span class="uscript-type">string</span> PropName<span class="uscript-operator">)</span>
<span class="uscript-line">00357</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">00358</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">int</span> i<span class="uscript-operator">,</span> idx<span class="uscript-operator">;</span>
<span class="uscript-line">00359</span>      <span class="uscript-keyword">local</span> IniEntry NewDefault<span class="uscript-operator">;</span>
<span class="uscript-line">00360</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">string</span> CurrentValue<span class="uscript-operator">,</span> Quote<span class="uscript-operator">;</span>
<span class="uscript-line">00361</span>      <span class="uscript-keyword">local</span> <span class="uscript-keyword">array</span><span class="uscript-operator">&lt;</span><span class="uscript-type">string</span><span class="uscript-operator">&gt;</span> Ar<span class="uscript-operator">;</span>
<span class="uscript-line">00362</span>  
<span class="uscript-line">00363</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>DEBUG<span class="uscript-operator">)</span>
<span class="uscript-line">00364</span>          log<span class="uscript-operator">(</span><span class="uscript-keyword">class</span><span class="uscript-operator">@</span><span class="uscript-string">"storing default"</span><span class="uscript-operator">@</span>o<span class="uscript-operator">@</span>propname<span class="uscript-operator">,</span><span class="uscript-name">'StoreDefaultValue'</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00365</span>  
<span class="uscript-line">00366</span>      <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i <span class="uscript-operator">=</span> <span class="uscript-number">0</span><span class="uscript-operator">;</span> i <span class="uscript-operator">&lt;</span> ConfigMaster<span class="uscript-operator">(</span>Owner<span class="uscript-operator">)</span><span class="uscript-operator">.</span>OriginalValues<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">;</span> i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">00367</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>ConfigMaster<span class="uscript-operator">(</span>Owner<span class="uscript-operator">)</span><span class="uscript-operator">.</span>OriginalValues<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>ClassFrom <span class="uscript-operator">==</span> <span class="uscript-type">string</span><span class="uscript-operator">(</span>O<span class="uscript-operator">.</span><span class="uscript-keyword">Class</span><span class="uscript-operator">)</span> <span class="uscript-operator">&amp;&amp;</span> ConfigMaster<span class="uscript-operator">(</span>Owner<span class="uscript-operator">)</span><span class="uscript-operator">.</span>OriginalValues<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>PropName <span class="uscript-operator">==</span> PropName<span class="uscript-operator">)</span>
<span class="uscript-line">00368</span>              <span class="uscript-keyword">return</span><span class="uscript-operator">;</span>
<span class="uscript-line">00369</span>  
<span class="uscript-line">00370</span>      NewDefault<span class="uscript-operator">.</span>ClassFrom <span class="uscript-operator">=</span> <span class="uscript-type">string</span><span class="uscript-operator">(</span>O<span class="uscript-operator">.</span><span class="uscript-keyword">Class</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00371</span>      <span class="uscript-comment">// Check if this property name is a single array member</span>
<span class="uscript-line">00372</span>      i <span class="uscript-operator">=</span> <span class="uscript-operator">-</span><span class="uscript-number">1</span><span class="uscript-operator">;</span> idx <span class="uscript-operator">=</span> <span class="uscript-operator">-</span><span class="uscript-number">1</span><span class="uscript-operator">;</span>
<span class="uscript-line">00373</span>      i <span class="uscript-operator">=</span> InStr<span class="uscript-operator">(</span>PropName<span class="uscript-operator">,</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00374</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>i <span class="uscript-operator">!=</span> <span class="uscript-operator">-</span><span class="uscript-number">1</span><span class="uscript-operator">)</span>
<span class="uscript-line">00375</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">00376</span>          idx <span class="uscript-operator">=</span> <span class="uscript-type">int</span><span class="uscript-operator">(</span>Left<span class="uscript-operator">(</span>PropName<span class="uscript-operator">,</span> i<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00377</span>          PropName <span class="uscript-operator">=</span> Mid<span class="uscript-operator">(</span>PropName<span class="uscript-operator">,</span> i <span class="uscript-operator">+</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00378</span>          CurrentValue <span class="uscript-operator">=</span> O<span class="uscript-operator">.</span>GetPropertyText<span class="uscript-operator">(</span>PropName<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00379</span>          Ar <span class="uscript-operator">=</span> GenerateArray<span class="uscript-operator">(</span>CurrentValue<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00380</span>          CurrentValue <span class="uscript-operator">=</span> Ar<span class="uscript-operator">[</span>idx<span class="uscript-operator">]</span><span class="uscript-operator">;</span>
<span class="uscript-line">00381</span>  
<span class="uscript-line">00382</span>          <span class="uscript-comment">// Remove literal string wrapper</span>
<span class="uscript-line">00383</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>Left<span class="uscript-operator">(</span>CurrentValue<span class="uscript-operator">,</span><span class="uscript-number">1</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"\""</span><span class="uscript-operator">)</span>
<span class="uscript-line">00384</span>          <span class="uscript-operator">{</span>
<span class="uscript-line">00385</span>              CurrentValue <span class="uscript-operator">=</span> Mid<span class="uscript-operator">(</span>CurrentValue<span class="uscript-operator">,</span><span class="uscript-number">1</span><span class="uscript-operator">,</span>Len<span class="uscript-operator">(</span>CurrentValue<span class="uscript-operator">)</span> <span class="uscript-operator">-</span> <span class="uscript-number">2</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00386</span>              Quote <span class="uscript-operator">=</span> <span class="uscript-string">""</span><span class="uscript-operator">;</span>
<span class="uscript-line">00387</span>          <span class="uscript-operator">}</span>
<span class="uscript-line">00388</span>          CurrentValue <span class="uscript-operator">=</span> idx <span class="uscript-operator">$</span> <span class="uscript-string">""</span> <span class="uscript-operator">$</span> CurrentValue <span class="uscript-operator">$</span> Quote<span class="uscript-operator">;</span>
<span class="uscript-line">00389</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">00390</span>  
<span class="uscript-line">00391</span>      <span class="uscript-keyword">else</span> CurrentValue <span class="uscript-operator">=</span> O<span class="uscript-operator">.</span>GetPropertyText<span class="uscript-operator">(</span>PropName<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00392</span>  
<span class="uscript-line">00393</span>      NewDefault<span class="uscript-operator">.</span>PropName <span class="uscript-operator">=</span> PropName<span class="uscript-operator">;</span>
<span class="uscript-line">00394</span>      NewDefault<span class="uscript-operator">.</span>PropValue <span class="uscript-operator">=</span> CurrentValue<span class="uscript-operator">;</span>
<span class="uscript-line">00395</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>DEBUG<span class="uscript-operator">)</span>
<span class="uscript-line">00396</span>          log<span class="uscript-operator">(</span><span class="uscript-keyword">class</span><span class="uscript-operator">@</span><span class="uscript-string">"old value:"</span><span class="uscript-operator">@</span>NewDefault<span class="uscript-operator">.</span>PropValue<span class="uscript-operator">,</span><span class="uscript-name">'StoreDefaultValue'</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00397</span>  
<span class="uscript-line">00398</span>      ConfigMaster<span class="uscript-operator">(</span>Owner<span class="uscript-operator">)</span><span class="uscript-operator">.</span>OriginalValues<span class="uscript-operator">[</span>ConfigMaster<span class="uscript-operator">(</span>Owner<span class="uscript-operator">)</span><span class="uscript-operator">.</span>OriginalValues<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">]</span> <span class="uscript-operator">=</span> NewDefault<span class="uscript-operator">;</span>
<span class="uscript-line">00399</span>      ConfigMaster<span class="uscript-operator">(</span>Owner<span class="uscript-operator">)</span><span class="uscript-operator">.</span>SaveConfig<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00400</span>  <span class="uscript-operator">}</span>
<span class="uscript-line">00401</span>  
<span class="uscript-line">00402</span>  <span class="uscript-keyword">final</span> <span class="uscript-keyword">function</span> <span class="uscript-type">bool</span> RestoreOriginalValue<span class="uscript-operator">(</span>Object O<span class="uscript-operator">,</span> <span class="uscript-type">string</span> PropName<span class="uscript-operator">)</span>
<span class="uscript-line">00403</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">00404</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">int</span> i<span class="uscript-operator">,</span> j<span class="uscript-operator">,</span> idx<span class="uscript-operator">;</span>
<span class="uscript-line">00405</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">string</span> CurrentValue<span class="uscript-operator">,</span> StoredValue<span class="uscript-operator">;</span>
<span class="uscript-line">00406</span>      <span class="uscript-keyword">local</span> <span class="uscript-keyword">array</span><span class="uscript-operator">&lt;</span><span class="uscript-type">string</span><span class="uscript-operator">&gt;</span> Ar<span class="uscript-operator">;</span>
<span class="uscript-line">00407</span>  
<span class="uscript-line">00408</span>      <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i <span class="uscript-operator">=</span> <span class="uscript-number">0</span><span class="uscript-operator">;</span> i <span class="uscript-operator">&lt;</span> ConfigMaster<span class="uscript-operator">(</span>Owner<span class="uscript-operator">)</span><span class="uscript-operator">.</span>OriginalValues<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">;</span> i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">00409</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">00410</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>ConfigMaster<span class="uscript-operator">(</span>Owner<span class="uscript-operator">)</span><span class="uscript-operator">.</span>OriginalValues<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>ClassFrom <span class="uscript-operator">~=</span> <span class="uscript-type">string</span><span class="uscript-operator">(</span>O<span class="uscript-operator">.</span><span class="uscript-keyword">Class</span><span class="uscript-operator">)</span> <span class="uscript-operator">&amp;&amp;</span> ConfigMaster<span class="uscript-operator">(</span>Owner<span class="uscript-operator">)</span><span class="uscript-operator">.</span>OriginalValues<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>PropName <span class="uscript-operator">~=</span> PropName<span class="uscript-operator">)</span>
<span class="uscript-line">00411</span>          <span class="uscript-operator">{</span>
<span class="uscript-line">00412</span>              StoredValue <span class="uscript-operator">=</span> ConfigMaster<span class="uscript-operator">(</span>Owner<span class="uscript-operator">)</span><span class="uscript-operator">.</span>OriginalValues<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>PropValue<span class="uscript-operator">;</span>
<span class="uscript-line">00413</span>              <span class="uscript-comment">// First check if this was a single array member</span>
<span class="uscript-line">00414</span>              j <span class="uscript-operator">=</span> InStr<span class="uscript-operator">(</span>StoredValue<span class="uscript-operator">,</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00415</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>j <span class="uscript-operator">!=</span> <span class="uscript-operator">-</span><span class="uscript-number">1</span><span class="uscript-operator">)</span>
<span class="uscript-line">00416</span>              <span class="uscript-operator">{</span>
<span class="uscript-line">00417</span>                  idx <span class="uscript-operator">=</span> <span class="uscript-type">int</span><span class="uscript-operator">(</span>Left<span class="uscript-operator">(</span>StoredValue<span class="uscript-operator">,</span> j<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00418</span>                  StoredValue <span class="uscript-operator">=</span> Mid<span class="uscript-operator">(</span>StoredValue<span class="uscript-operator">,</span> j <span class="uscript-operator">+</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00419</span>                  <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>Right<span class="uscript-operator">(</span>StoredValue<span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">00420</span>                  <span class="uscript-operator">{</span>
<span class="uscript-line">00421</span>                      StoredValue <span class="uscript-operator">=</span> Left<span class="uscript-operator">(</span>StoredValue<span class="uscript-operator">,</span> Len<span class="uscript-operator">(</span>StoredValue<span class="uscript-operator">)</span> <span class="uscript-operator">-</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00422</span>                      StoredValue <span class="uscript-operator">=</span> <span class="uscript-string">"\""</span> <span class="uscript-operator">$</span> StoredValue <span class="uscript-operator">$</span> <span class="uscript-string">"\""</span><span class="uscript-operator">;</span>
<span class="uscript-line">00423</span>                  <span class="uscript-operator">}</span>
<span class="uscript-line">00424</span>                  CurrentValue <span class="uscript-operator">=</span> O<span class="uscript-operator">.</span>GetPropertyText<span class="uscript-operator">(</span>PropName<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00425</span>                  Ar <span class="uscript-operator">=</span> GenerateArray<span class="uscript-operator">(</span>CurrentValue<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00426</span>                  Ar<span class="uscript-operator">[</span>idx<span class="uscript-operator">]</span> <span class="uscript-operator">=</span> StoredValue<span class="uscript-operator">;</span>
<span class="uscript-line">00427</span>                  StoredValue <span class="uscript-operator">=</span> <span class="uscript-string">"("</span> <span class="uscript-operator">$</span> Join<span class="uscript-operator">(</span>Ar<span class="uscript-operator">,</span><span class="uscript-string">","</span><span class="uscript-operator">,</span><span class="uscript-keyword">True</span><span class="uscript-operator">)</span> <span class="uscript-operator">$</span><span class="uscript-string">")"</span><span class="uscript-operator">;</span>
<span class="uscript-line">00428</span>              <span class="uscript-operator">}</span>
<span class="uscript-line">00429</span>  
<span class="uscript-line">00430</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>DEBUG<span class="uscript-operator">)</span>
<span class="uscript-line">00431</span>                  log<span class="uscript-operator">(</span><span class="uscript-keyword">class</span><span class="uscript-operator">@</span><span class="uscript-string">"Assigning"</span><span class="uscript-operator">@</span>StoredValue<span class="uscript-operator">@</span><span class="uscript-string">"to property"</span><span class="uscript-operator">@</span><span class="uscript-type">string</span><span class="uscript-operator">(</span>O<span class="uscript-operator">.</span><span class="uscript-keyword">Class</span><span class="uscript-operator">)</span><span class="uscript-operator">$</span><span class="uscript-string">"."</span><span class="uscript-operator">$</span>PropName<span class="uscript-operator">,</span><span class="uscript-name">'RestoreOriginalValue'</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00432</span>              O<span class="uscript-operator">.</span>SetPropertyText<span class="uscript-operator">(</span>PropName<span class="uscript-operator">,</span> StoredValue<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00433</span>              O<span class="uscript-operator">.</span>SaveConfig<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00434</span>              <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>
<span class="uscript-line">00435</span>          <span class="uscript-operator">}</span>
<span class="uscript-line">00436</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">00437</span>  
<span class="uscript-line">00438</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>i <span class="uscript-operator">&lt;</span> ConfigMaster<span class="uscript-operator">(</span>Owner<span class="uscript-operator">)</span><span class="uscript-operator">.</span>OriginalValues<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">)</span>
<span class="uscript-line">00439</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">00440</span>          ConfigMaster<span class="uscript-operator">(</span>Owner<span class="uscript-operator">)</span><span class="uscript-operator">.</span>OriginalValues<span class="uscript-operator">.</span><span class="uscript-keyword">Remove</span><span class="uscript-operator">(</span>i<span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00441</span>          ConfigMaster<span class="uscript-operator">(</span>Owner<span class="uscript-operator">)</span><span class="uscript-operator">.</span>SaveConfig<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00442</span>          <span class="uscript-keyword">return</span> <span class="uscript-keyword">true</span><span class="uscript-operator">;</span>
<span class="uscript-line">00443</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">00444</span>  
<span class="uscript-line">00445</span>      <span class="uscript-keyword">return</span> <span class="uscript-keyword">false</span><span class="uscript-operator">;</span>
<span class="uscript-line">00446</span>  <span class="uscript-operator">}</span>
<span class="uscript-line">00447</span>  
<span class="uscript-line">00448</span>  <span class="uscript-comment">//###################################################################</span>
<span class="uscript-line">00449</span>  <span class="uscript-comment">//###################################################################</span>
<span class="uscript-line">00450</span>  <span class="uscript-comment">//</span>
<span class="uscript-line">00451</span>  <span class="uscript-comment">//  Internal Methods</span>
<span class="uscript-line">00452</span>  <span class="uscript-comment">//  These are used to control the internal operation of the loader itself.</span>
<span class="uscript-line">00453</span>  <span class="uscript-comment">//  These methods may only be called by other methods within the loader.</span>
<span class="uscript-line">00454</span>  <span class="uscript-comment">//</span>
<span class="uscript-line">00455</span>  
<span class="uscript-line">00456</span>  <span class="uscript-keyword">protected</span> <span class="uscript-keyword">final</span> <span class="uscript-keyword">function</span> RemoveMe<span class="uscript-operator">(</span><span class="uscript-operator">)</span>
<span class="uscript-line">00457</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">00458</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">int</span> i<span class="uscript-operator">;</span>
<span class="uscript-line">00459</span>      <span class="uscript-keyword">local</span> Object O<span class="uscript-operator">;</span>
<span class="uscript-line">00460</span>      <span class="uscript-keyword">local</span> Property P<span class="uscript-operator">;</span>
<span class="uscript-line">00461</span>  
<span class="uscript-line">00462</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>DEBUG<span class="uscript-operator">)</span>
<span class="uscript-line">00463</span>          log<span class="uscript-operator">(</span><span class="uscript-keyword">class</span><span class="uscript-operator">@</span><span class="uscript-string">"being removed."</span><span class="uscript-operator">,</span><span class="uscript-name">'RemoveMe'</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00464</span>  
<span class="uscript-line">00465</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>bIncludeServerActor <span class="uscript-operator">&amp;&amp;</span> ActorClass <span class="uscript-operator">!=</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">00466</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">00467</span>          O <span class="uscript-operator">=</span> GetObjectOfClass<span class="uscript-operator">(</span><span class="uscript-keyword">class</span><span class="uscript-name">'Engine.GameEngine'</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00468</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>O <span class="uscript-operator">!=</span> <span class="uscript-keyword">None</span><span class="uscript-operator">)</span>
<span class="uscript-line">00469</span>              RemoveArrayEntry<span class="uscript-operator">(</span>O<span class="uscript-operator">,</span> <span class="uscript-string">"ServerActors"</span><span class="uscript-operator">,</span> ActorClass<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00470</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">00471</span>  
<span class="uscript-line">00472</span>      <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i <span class="uscript-operator">=</span> <span class="uscript-number">0</span><span class="uscript-operator">;</span> i <span class="uscript-operator">&lt;</span> RequiredIniEntries<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">;</span> i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">00473</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">00474</span>          O <span class="uscript-operator">=</span> GetObjectForEntry<span class="uscript-operator">(</span>RequiredIniEntries<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00475</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>O <span class="uscript-operator">==</span> <span class="uscript-keyword">None</span><span class="uscript-operator">)</span> <span class="uscript-keyword">continue</span><span class="uscript-operator">;</span>
<span class="uscript-line">00476</span>  
<span class="uscript-line">00477</span>          P <span class="uscript-operator">=</span> GetProperty<span class="uscript-operator">(</span>O<span class="uscript-operator">,</span>RequiredIniEntries<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>PropName<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00478</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>P <span class="uscript-operator">!=</span> <span class="uscript-keyword">None</span> <span class="uscript-operator">&amp;&amp;</span> PropIsArray<span class="uscript-operator">(</span>P<span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">00479</span>              RemoveArrayEntry<span class="uscript-operator">(</span>O<span class="uscript-operator">,</span>RequiredIniEntries<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>PropName<span class="uscript-operator">,</span>RequiredIniEntries<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>PropValue<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00480</span>  
<span class="uscript-line">00481</span>          <span class="uscript-keyword">else</span> RestoreOriginalValue<span class="uscript-operator">(</span>O<span class="uscript-operator">,</span> RequiredIniEntries<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>PropName<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00482</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">00483</span>  
<span class="uscript-line">00484</span>      DisableLoader<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00485</span>  <span class="uscript-operator">}</span>
<span class="uscript-line">00486</span>  
<span class="uscript-line">00487</span>  <span class="uscript-keyword">protected</span> <span class="uscript-keyword">final</span> <span class="uscript-keyword">function</span> <span class="uscript-type">string</span> InsertArrayMember<span class="uscript-operator">(</span>Object Obj<span class="uscript-operator">,</span> <span class="uscript-type">string</span> PropName<span class="uscript-operator">,</span> <span class="uscript-type">string</span> NewValue<span class="uscript-operator">,</span> <span class="uscript-type">int</span> Pos<span class="uscript-operator">)</span>
<span class="uscript-line">00488</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">00489</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">string</span> CurValue<span class="uscript-operator">,</span> Quote<span class="uscript-operator">,</span> Tmp<span class="uscript-operator">;</span>
<span class="uscript-line">00490</span>      <span class="uscript-keyword">local</span> <span class="uscript-keyword">array</span><span class="uscript-operator">&lt;</span><span class="uscript-type">string</span><span class="uscript-operator">&gt;</span> Members<span class="uscript-operator">;</span>
<span class="uscript-line">00491</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">bool</span> bStatic<span class="uscript-operator">;</span>
<span class="uscript-line">00492</span>  
<span class="uscript-line">00493</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>Obj <span class="uscript-operator">==</span> <span class="uscript-keyword">None</span><span class="uscript-operator">)</span>
<span class="uscript-line">00494</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">00495</span>          Warn<span class="uscript-operator">(</span><span class="uscript-string">"Object is None"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00496</span>          <span class="uscript-keyword">return</span> <span class="uscript-string">""</span><span class="uscript-operator">;</span>
<span class="uscript-line">00497</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">00498</span>  
<span class="uscript-line">00499</span>      CurValue <span class="uscript-operator">=</span> Obj<span class="uscript-operator">.</span>GetPropertyText<span class="uscript-operator">(</span>PropName<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00500</span>      Members <span class="uscript-operator">=</span> GenerateArray<span class="uscript-operator">(</span>CurValue<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00501</span>  
<span class="uscript-line">00502</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>DEBUG<span class="uscript-operator">)</span>
<span class="uscript-line">00503</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">00504</span>          log<span class="uscript-operator">(</span><span class="uscript-keyword">class</span><span class="uscript-operator">$</span><span class="uscript-string">":Inserting new member at position"</span><span class="uscript-operator">@</span>Pos<span class="uscript-operator">@</span><span class="uscript-string">"to"</span><span class="uscript-operator">@</span>Obj<span class="uscript-operator">$</span><span class="uscript-string">"."</span><span class="uscript-operator">$</span>PropName<span class="uscript-operator">$</span><span class="uscript-string">":"</span><span class="uscript-operator">@</span>NewValue<span class="uscript-operator">,</span><span class="uscript-name">'InsertArrayMember'</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00505</span>          log<span class="uscript-operator">(</span><span class="uscript-keyword">class</span><span class="uscript-operator">$</span><span class="uscript-string">":Current Value:"</span><span class="uscript-operator">$</span>CurValue<span class="uscript-operator">,</span><span class="uscript-name">'InsertArrayMember'</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00506</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">00507</span>  
<span class="uscript-line">00508</span>  <span class="uscript-comment">// Check for literal string</span>
<span class="uscript-line">00509</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>InStr<span class="uscript-operator">(</span>Caps<span class="uscript-operator">(</span>CurValue<span class="uscript-operator">)</span><span class="uscript-operator">,</span> Caps<span class="uscript-operator">(</span>NewValue<span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">&lt;</span> <span class="uscript-number">0</span> <span class="uscript-operator">&amp;&amp;</span> Members<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span> <span class="uscript-operator">&gt;</span> <span class="uscript-number">0</span><span class="uscript-operator">)</span>
<span class="uscript-line">00510</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">00511</span>          bStatic <span class="uscript-operator">=</span> Left<span class="uscript-operator">(</span>Members<span class="uscript-operator">[</span>pos<span class="uscript-operator">]</span><span class="uscript-operator">,</span> Len<span class="uscript-operator">(</span>PropName<span class="uscript-operator">)</span> <span class="uscript-operator">+</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span> <span class="uscript-operator">~=</span> <span class="uscript-operator">(</span>PropName <span class="uscript-operator">$</span> <span class="uscript-string">"["</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00512</span>          Tmp <span class="uscript-operator">=</span> StringIf<span class="uscript-operator">(</span>bStatic<span class="uscript-operator">,</span> Mid<span class="uscript-operator">(</span>Members<span class="uscript-operator">[</span>pos<span class="uscript-operator">]</span><span class="uscript-operator">,</span>InStr<span class="uscript-operator">(</span>Members<span class="uscript-operator">[</span>pos<span class="uscript-operator">]</span><span class="uscript-operator">,</span><span class="uscript-string">"="</span><span class="uscript-operator">)</span> <span class="uscript-operator">+</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span><span class="uscript-operator">,</span> Members<span class="uscript-operator">[</span><span class="uscript-number">0</span><span class="uscript-operator">]</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00513</span>          Quote <span class="uscript-operator">=</span> StringIf<span class="uscript-operator">(</span>Left<span class="uscript-operator">(</span>Tmp<span class="uscript-operator">,</span><span class="uscript-number">1</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"\""</span> <span class="uscript-operator">&amp;&amp;</span> Left<span class="uscript-operator">(</span>NewValue<span class="uscript-operator">,</span><span class="uscript-number">1</span><span class="uscript-operator">)</span> <span class="uscript-operator">!=</span> <span class="uscript-string">"\""</span><span class="uscript-operator">,</span><span class="uscript-string">"\""</span><span class="uscript-operator">,</span><span class="uscript-string">""</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00514</span>  
<span class="uscript-line">00515</span>          NewValue <span class="uscript-operator">=</span> StringIf<span class="uscript-operator">(</span>bStatic<span class="uscript-operator">,</span> PropName <span class="uscript-operator">$</span> <span class="uscript-string">"="</span> <span class="uscript-operator">$</span> Quote <span class="uscript-operator">$</span> NewValue <span class="uscript-operator">$</span> Quote<span class="uscript-operator">,</span> Quote <span class="uscript-operator">$</span> NewValue <span class="uscript-operator">$</span> Quote<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00516</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>DEBUG<span class="uscript-operator">)</span>
<span class="uscript-line">00517</span>              log<span class="uscript-operator">(</span>InStr<span class="uscript-operator">(</span>Caps<span class="uscript-operator">(</span>CurValue<span class="uscript-operator">)</span><span class="uscript-operator">,</span>Caps<span class="uscript-operator">(</span>NewValue<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">@</span>InStr<span class="uscript-operator">(</span>Caps<span class="uscript-operator">(</span>CurValue<span class="uscript-operator">)</span><span class="uscript-operator">,</span>Caps<span class="uscript-operator">(</span>NewValue<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">&lt;</span><span class="uscript-number">0</span><span class="uscript-operator">@</span>Caps<span class="uscript-operator">(</span>CurValue<span class="uscript-operator">)</span><span class="uscript-operator">@</span><span class="uscript-string">"||"</span><span class="uscript-operator">@</span>Caps<span class="uscript-operator">(</span>NewValue<span class="uscript-operator">)</span><span class="uscript-operator">,</span><span class="uscript-name">'AddDynArrayMember'</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00518</span>  
<span class="uscript-line">00519</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>NewValue <span class="uscript-operator">!=</span> <span class="uscript-string">""</span> <span class="uscript-operator">&amp;&amp;</span> Pos <span class="uscript-operator">&gt;</span> <span class="uscript-operator">-</span><span class="uscript-number">1</span><span class="uscript-operator">)</span>
<span class="uscript-line">00520</span>          <span class="uscript-operator">{</span>
<span class="uscript-line">00521</span>              StoreDefaultValue<span class="uscript-operator">(</span>Obj<span class="uscript-operator">,</span> Pos<span class="uscript-operator">$</span><span class="uscript-string">""</span><span class="uscript-operator">$</span>PropName<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00522</span>              Members<span class="uscript-operator">[</span>Pos<span class="uscript-operator">]</span> <span class="uscript-operator">=</span> NewValue<span class="uscript-operator">;</span>
<span class="uscript-line">00523</span>          <span class="uscript-operator">}</span>
<span class="uscript-line">00524</span>  
<span class="uscript-line">00525</span>          CurValue <span class="uscript-operator">=</span> <span class="uscript-string">"("</span> <span class="uscript-operator">$</span> Join<span class="uscript-operator">(</span>Members<span class="uscript-operator">,</span><span class="uscript-string">","</span><span class="uscript-operator">,</span><span class="uscript-keyword">True</span><span class="uscript-operator">)</span> <span class="uscript-operator">$</span> <span class="uscript-string">")"</span><span class="uscript-operator">;</span>
<span class="uscript-line">00526</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">00527</span>  
<span class="uscript-line">00528</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>DEBUG<span class="uscript-operator">)</span>
<span class="uscript-line">00529</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">00530</span>          log<span class="uscript-operator">(</span><span class="uscript-keyword">class</span><span class="uscript-operator">@</span><span class="uscript-string">"Returning:"</span><span class="uscript-operator">$</span>CurValue<span class="uscript-operator">,</span><span class="uscript-name">'InsertArrayMember'</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00531</span>          log<span class="uscript-operator">(</span><span class="uscript-keyword">class</span><span class="uscript-operator">@</span><span class="uscript-string">""</span><span class="uscript-operator">,</span><span class="uscript-name">'InsertArrayMember'</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00532</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">00533</span>  
<span class="uscript-line">00534</span>      <span class="uscript-keyword">return</span> CurValue<span class="uscript-operator">;</span>
<span class="uscript-line">00535</span>  <span class="uscript-operator">}</span>
<span class="uscript-line">00536</span>  
<span class="uscript-line">00537</span>  <span class="uscript-comment">// Currently, UT2003 does not support setting static arrays through the use of SetPropertyText</span>
<span class="uscript-line">00538</span>  <span class="uscript-keyword">protected</span> <span class="uscript-keyword">final</span> <span class="uscript-keyword">function</span> <span class="uscript-type">string</span> AddStaticArrayMember<span class="uscript-operator">(</span>Object Obj<span class="uscript-operator">,</span> <span class="uscript-type">string</span> PropName<span class="uscript-operator">,</span> <span class="uscript-type">string</span> NewValue<span class="uscript-operator">)</span>
<span class="uscript-line">00539</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">00540</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">int</span> i<span class="uscript-operator">;</span>
<span class="uscript-line">00541</span>      <span class="uscript-keyword">local</span> <span class="uscript-keyword">array</span><span class="uscript-operator">&lt;</span><span class="uscript-type">string</span><span class="uscript-operator">&gt;</span> Members<span class="uscript-operator">;</span>
<span class="uscript-line">00542</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">string</span> Quote<span class="uscript-operator">,</span> TempValue<span class="uscript-operator">,</span> CurValue<span class="uscript-operator">;</span>
<span class="uscript-line">00543</span>  
<span class="uscript-line">00544</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>Obj <span class="uscript-operator">==</span> <span class="uscript-keyword">None</span><span class="uscript-operator">)</span>
<span class="uscript-line">00545</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">00546</span>          Warn<span class="uscript-operator">(</span><span class="uscript-string">"Object was None for property"</span><span class="uscript-operator">@</span>PropName<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00547</span>          <span class="uscript-keyword">return</span> <span class="uscript-string">""</span><span class="uscript-operator">;</span>
<span class="uscript-line">00548</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">00549</span>  
<span class="uscript-line">00550</span>      CurValue <span class="uscript-operator">=</span> Obj<span class="uscript-operator">.</span>GetPropertyText<span class="uscript-operator">(</span>PropName<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00551</span>      Members <span class="uscript-operator">=</span> GenerateArray<span class="uscript-operator">(</span>CurValue<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00552</span>  
<span class="uscript-line">00553</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>InStr<span class="uscript-operator">(</span>Caps<span class="uscript-operator">(</span>CurValue<span class="uscript-operator">)</span><span class="uscript-operator">,</span> Caps<span class="uscript-operator">(</span>NewValue<span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">&lt;</span> <span class="uscript-number">0</span><span class="uscript-operator">)</span>
<span class="uscript-line">00554</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">00555</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>Members<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span> <span class="uscript-operator">&gt;</span> <span class="uscript-number">0</span><span class="uscript-operator">)</span>
<span class="uscript-line">00556</span>          <span class="uscript-operator">{</span>
<span class="uscript-line">00557</span>              TempValue <span class="uscript-operator">=</span> Mid<span class="uscript-operator">(</span>Members<span class="uscript-operator">[</span><span class="uscript-number">0</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span>InStr<span class="uscript-operator">(</span>Members<span class="uscript-operator">[</span><span class="uscript-number">0</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span><span class="uscript-string">"="</span><span class="uscript-operator">)</span><span class="uscript-operator">+</span><span class="uscript-number">1</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00558</span>  
<span class="uscript-line">00559</span>              <span class="uscript-comment">// Check for literal string</span>
<span class="uscript-line">00560</span>              Quote <span class="uscript-operator">=</span> StringIf<span class="uscript-operator">(</span>Left<span class="uscript-operator">(</span>TempValue<span class="uscript-operator">,</span><span class="uscript-number">1</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"\""</span> <span class="uscript-operator">&amp;&amp;</span> Left<span class="uscript-operator">(</span>NewValue<span class="uscript-operator">,</span><span class="uscript-number">1</span><span class="uscript-operator">)</span> <span class="uscript-operator">!=</span> <span class="uscript-string">"\""</span><span class="uscript-operator">,</span> <span class="uscript-string">"\""</span><span class="uscript-operator">,</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00561</span>              <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i <span class="uscript-operator">=</span> <span class="uscript-number">0</span><span class="uscript-operator">;</span> i <span class="uscript-operator">&lt;</span> Members<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">;</span> i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">00562</span>              <span class="uscript-operator">{</span>
<span class="uscript-line">00563</span>                  <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>Members<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span> <span class="uscript-operator">==</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">00564</span>                  <span class="uscript-operator">{</span>
<span class="uscript-line">00565</span>                      Members<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span> <span class="uscript-operator">=</span> PropName <span class="uscript-operator">$</span> <span class="uscript-string">"["</span> <span class="uscript-operator">$</span> i <span class="uscript-operator">$</span> <span class="uscript-string">"]="</span> <span class="uscript-operator">$</span> Quote <span class="uscript-operator">$</span> NewValue <span class="uscript-operator">$</span> Quote<span class="uscript-operator">;</span>
<span class="uscript-line">00566</span>                      <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>
<span class="uscript-line">00567</span>                  <span class="uscript-operator">}</span>
<span class="uscript-line">00568</span>              <span class="uscript-operator">}</span>
<span class="uscript-line">00569</span>              CurValue <span class="uscript-operator">=</span> <span class="uscript-string">"("</span> <span class="uscript-operator">$</span> Join<span class="uscript-operator">(</span>Members<span class="uscript-operator">,</span><span class="uscript-string">","</span><span class="uscript-operator">)</span> <span class="uscript-operator">$</span><span class="uscript-string">")"</span><span class="uscript-operator">;</span>
<span class="uscript-line">00570</span>          <span class="uscript-operator">}</span>
<span class="uscript-line">00571</span>  
<span class="uscript-line">00572</span>          <span class="uscript-keyword">else</span> CurValue <span class="uscript-operator">=</span> <span class="uscript-string">"("</span> <span class="uscript-operator">$</span> PropName <span class="uscript-operator">$</span> <span class="uscript-string">"[0]="</span> <span class="uscript-operator">$</span> NewValue <span class="uscript-operator">$</span> <span class="uscript-string">")"</span><span class="uscript-operator">;</span>
<span class="uscript-line">00573</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">00574</span>  
<span class="uscript-line">00575</span>      <span class="uscript-keyword">return</span> CurValue<span class="uscript-operator">;</span>
<span class="uscript-line">00576</span>  <span class="uscript-operator">}</span>
<span class="uscript-line">00577</span>  
<span class="uscript-line">00578</span>  <span class="uscript-keyword">protected</span> <span class="uscript-keyword">final</span> <span class="uscript-keyword">function</span> <span class="uscript-type">string</span> AddDynArrayMember<span class="uscript-operator">(</span>Object Obj<span class="uscript-operator">,</span> <span class="uscript-type">string</span> PropName<span class="uscript-operator">,</span> <span class="uscript-type">string</span> NewValue<span class="uscript-operator">)</span>
<span class="uscript-line">00579</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">00580</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">string</span> CurValue<span class="uscript-operator">,</span> Quote<span class="uscript-operator">;</span>
<span class="uscript-line">00581</span>      <span class="uscript-keyword">local</span> <span class="uscript-keyword">array</span><span class="uscript-operator">&lt;</span><span class="uscript-type">string</span><span class="uscript-operator">&gt;</span> Members<span class="uscript-operator">;</span>
<span class="uscript-line">00582</span>  
<span class="uscript-line">00583</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>Obj <span class="uscript-operator">==</span> <span class="uscript-keyword">None</span><span class="uscript-operator">)</span>
<span class="uscript-line">00584</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">00585</span>          Warn<span class="uscript-operator">(</span><span class="uscript-string">"Object is None"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00586</span>          <span class="uscript-keyword">return</span> <span class="uscript-string">""</span><span class="uscript-operator">;</span>
<span class="uscript-line">00587</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">00588</span>  
<span class="uscript-line">00589</span>      CurValue <span class="uscript-operator">=</span> Obj<span class="uscript-operator">.</span>GetPropertyText<span class="uscript-operator">(</span>PropName<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00590</span>      Members <span class="uscript-operator">=</span> GenerateArray<span class="uscript-operator">(</span>CurValue<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00591</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>DEBUG<span class="uscript-operator">)</span>
<span class="uscript-line">00592</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">00593</span>          log<span class="uscript-operator">(</span><span class="uscript-keyword">class</span><span class="uscript-operator">$</span><span class="uscript-string">":Adding new member to"</span><span class="uscript-operator">@</span>Obj<span class="uscript-operator">$</span><span class="uscript-string">"."</span><span class="uscript-operator">$</span>PropName<span class="uscript-operator">$</span><span class="uscript-string">":"</span><span class="uscript-operator">@</span>NewValue<span class="uscript-operator">,</span><span class="uscript-name">'AddDynArrayMember'</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00594</span>          log<span class="uscript-operator">(</span><span class="uscript-keyword">class</span><span class="uscript-operator">$</span><span class="uscript-string">":Current Value:"</span><span class="uscript-operator">$</span>CurValue<span class="uscript-operator">,</span><span class="uscript-name">'AddDynArrayMember'</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00595</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">00596</span>  
<span class="uscript-line">00597</span>  <span class="uscript-comment">// Check for literal string</span>
<span class="uscript-line">00598</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>InStr<span class="uscript-operator">(</span>Caps<span class="uscript-operator">(</span>CurValue<span class="uscript-operator">)</span><span class="uscript-operator">,</span> Caps<span class="uscript-operator">(</span>NewValue<span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">&lt;</span> <span class="uscript-number">0</span><span class="uscript-operator">)</span>
<span class="uscript-line">00599</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">00600</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>Members<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span> <span class="uscript-operator">&gt;</span> <span class="uscript-number">0</span><span class="uscript-operator">)</span>
<span class="uscript-line">00601</span>          <span class="uscript-operator">{</span>
<span class="uscript-line">00602</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>DEBUG<span class="uscript-operator">)</span>
<span class="uscript-line">00603</span>                  log<span class="uscript-operator">(</span>InStr<span class="uscript-operator">(</span>Caps<span class="uscript-operator">(</span>CurValue<span class="uscript-operator">)</span><span class="uscript-operator">,</span>Caps<span class="uscript-operator">(</span>NewValue<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">@</span>InStr<span class="uscript-operator">(</span>Caps<span class="uscript-operator">(</span>CurValue<span class="uscript-operator">)</span><span class="uscript-operator">,</span>Caps<span class="uscript-operator">(</span>NewValue<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">&lt;</span><span class="uscript-number">0</span><span class="uscript-operator">@</span>Caps<span class="uscript-operator">(</span>CurValue<span class="uscript-operator">)</span><span class="uscript-operator">@</span><span class="uscript-string">"||"</span><span class="uscript-operator">@</span>Caps<span class="uscript-operator">(</span>NewValue<span class="uscript-operator">)</span><span class="uscript-operator">,</span><span class="uscript-name">'AddDynArrayMember'</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00604</span>  
<span class="uscript-line">00605</span>              Quote <span class="uscript-operator">=</span> StringIf<span class="uscript-operator">(</span>Left<span class="uscript-operator">(</span>Members<span class="uscript-operator">[</span><span class="uscript-number">0</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span><span class="uscript-number">1</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"\""</span> <span class="uscript-operator">&amp;&amp;</span> Left<span class="uscript-operator">(</span>NewValue<span class="uscript-operator">,</span><span class="uscript-number">1</span><span class="uscript-operator">)</span> <span class="uscript-operator">!=</span> <span class="uscript-string">"\""</span><span class="uscript-operator">,</span> <span class="uscript-string">"\""</span><span class="uscript-operator">,</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00606</span>              Members<span class="uscript-operator">[</span>Members<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">]</span> <span class="uscript-operator">=</span> Quote <span class="uscript-operator">$</span> NewValue <span class="uscript-operator">$</span> Quote<span class="uscript-operator">;</span>
<span class="uscript-line">00607</span>              CurValue <span class="uscript-operator">=</span> <span class="uscript-string">"("</span> <span class="uscript-operator">$</span> Join<span class="uscript-operator">(</span>Members<span class="uscript-operator">,</span><span class="uscript-string">","</span><span class="uscript-operator">,</span><span class="uscript-keyword">True</span><span class="uscript-operator">)</span> <span class="uscript-operator">$</span> <span class="uscript-string">")"</span><span class="uscript-operator">;</span>
<span class="uscript-line">00608</span>          <span class="uscript-operator">}</span>
<span class="uscript-line">00609</span>          <span class="uscript-keyword">else</span> CurValue <span class="uscript-operator">=</span> <span class="uscript-string">"("</span> <span class="uscript-operator">$</span> NewValue <span class="uscript-operator">$</span> <span class="uscript-string">")"</span><span class="uscript-operator">;</span>
<span class="uscript-line">00610</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">00611</span>  
<span class="uscript-line">00612</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>DEBUG<span class="uscript-operator">)</span>
<span class="uscript-line">00613</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">00614</span>          log<span class="uscript-operator">(</span><span class="uscript-keyword">class</span><span class="uscript-operator">@</span><span class="uscript-string">"Returning:"</span><span class="uscript-operator">$</span>CurValue<span class="uscript-operator">,</span><span class="uscript-name">'AddDynArrayMember'</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00615</span>          log<span class="uscript-operator">(</span><span class="uscript-keyword">class</span><span class="uscript-operator">@</span><span class="uscript-string">""</span><span class="uscript-operator">,</span><span class="uscript-name">'AddDynArrayMember'</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00616</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">00617</span>  
<span class="uscript-line">00618</span>      <span class="uscript-keyword">return</span> CurValue<span class="uscript-operator">;</span>
<span class="uscript-line">00619</span>  <span class="uscript-operator">}</span>
<span class="uscript-line">00620</span>  
<span class="uscript-line">00621</span>  <span class="uscript-comment">// UT2003 currently does not support setting the value of static arrays</span>
<span class="uscript-line">00622</span>  <span class="uscript-keyword">protected</span> <span class="uscript-keyword">final</span> <span class="uscript-keyword">function</span> RemoveArrayEntry<span class="uscript-operator">(</span>Object O<span class="uscript-operator">,</span> <span class="uscript-type">string</span> PropName<span class="uscript-operator">,</span> <span class="uscript-type">string</span> PropValue<span class="uscript-operator">)</span>
<span class="uscript-line">00623</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">00624</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">int</span> i<span class="uscript-operator">,</span> j<span class="uscript-operator">;</span>
<span class="uscript-line">00625</span>      <span class="uscript-keyword">local</span> <span class="uscript-keyword">array</span><span class="uscript-operator">&lt;</span><span class="uscript-type">string</span><span class="uscript-operator">&gt;</span> Members<span class="uscript-operator">;</span>
<span class="uscript-line">00626</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">string</span> ArrayString<span class="uscript-operator">,</span> Quote<span class="uscript-operator">,</span> Tmp<span class="uscript-operator">;</span>
<span class="uscript-line">00627</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">bool</span> bStatic<span class="uscript-operator">;</span>
<span class="uscript-line">00628</span>  
<span class="uscript-line">00629</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>O <span class="uscript-operator">==</span> <span class="uscript-keyword">None</span><span class="uscript-operator">)</span>
<span class="uscript-line">00630</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">00631</span>          Warn<span class="uscript-operator">(</span><span class="uscript-string">"Object was none for property"</span><span class="uscript-operator">@</span>PropName<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00632</span>          <span class="uscript-keyword">return</span><span class="uscript-operator">;</span>
<span class="uscript-line">00633</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">00634</span>  
<span class="uscript-line">00635</span>      ArrayString <span class="uscript-operator">=</span> O<span class="uscript-operator">.</span>GetPropertyText<span class="uscript-operator">(</span>PropName<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00636</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>ArrayString <span class="uscript-operator">==</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">00637</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">00638</span>          Warn<span class="uscript-operator">(</span><span class="uscript-string">"Property was not found:"</span><span class="uscript-operator">@</span>PropName<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00639</span>          <span class="uscript-keyword">return</span><span class="uscript-operator">;</span>
<span class="uscript-line">00640</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">00641</span>  
<span class="uscript-line">00642</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>DEBUG<span class="uscript-operator">)</span>
<span class="uscript-line">00643</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">00644</span>          log<span class="uscript-operator">(</span><span class="uscript-keyword">class</span><span class="uscript-operator">$</span><span class="uscript-string">": Removing array member"</span><span class="uscript-operator">@</span><span class="uscript-type">string</span><span class="uscript-operator">(</span>O<span class="uscript-operator">.</span><span class="uscript-keyword">Class</span><span class="uscript-operator">)</span><span class="uscript-operator">$</span><span class="uscript-string">"."</span><span class="uscript-operator">$</span>PropName<span class="uscript-operator">$</span><span class="uscript-string">":"</span><span class="uscript-operator">$</span>ArrayString<span class="uscript-operator">,</span><span class="uscript-name">'RemoveArrayEntry'</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00645</span>          log<span class="uscript-operator">(</span><span class="uscript-keyword">class</span><span class="uscript-operator">$</span><span class="uscript-string">": Member to be removed:"</span><span class="uscript-operator">$</span>PropValue<span class="uscript-operator">,</span><span class="uscript-name">'RemoveArrayEntry'</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00646</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">00647</span>  
<span class="uscript-line">00648</span>      Members <span class="uscript-operator">=</span> GenerateArray<span class="uscript-operator">(</span>ArrayString<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00649</span>      bStatic <span class="uscript-operator">=</span> Left<span class="uscript-operator">(</span>Members<span class="uscript-operator">[</span><span class="uscript-number">0</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span> Len<span class="uscript-operator">(</span>PropName<span class="uscript-operator">)</span> <span class="uscript-operator">+</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span> <span class="uscript-operator">~=</span> <span class="uscript-operator">(</span>PropName <span class="uscript-operator">$</span> <span class="uscript-string">"["</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00650</span>      Tmp <span class="uscript-operator">=</span> StringIf<span class="uscript-operator">(</span>bStatic<span class="uscript-operator">,</span> Mid<span class="uscript-operator">(</span>Members<span class="uscript-operator">[</span><span class="uscript-number">0</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span>InStr<span class="uscript-operator">(</span>Members<span class="uscript-operator">[</span><span class="uscript-number">0</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span><span class="uscript-string">"="</span><span class="uscript-operator">)</span> <span class="uscript-operator">+</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span><span class="uscript-operator">,</span> Members<span class="uscript-operator">[</span><span class="uscript-number">0</span><span class="uscript-operator">]</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00651</span>      Quote <span class="uscript-operator">=</span> StringIf<span class="uscript-operator">(</span>Left<span class="uscript-operator">(</span>Tmp<span class="uscript-operator">,</span><span class="uscript-number">1</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"\""</span> <span class="uscript-operator">&amp;&amp;</span> Left<span class="uscript-operator">(</span>PropValue<span class="uscript-operator">,</span><span class="uscript-number">1</span><span class="uscript-operator">)</span> <span class="uscript-operator">!=</span> <span class="uscript-string">"\""</span><span class="uscript-operator">,</span><span class="uscript-string">"\""</span><span class="uscript-operator">,</span><span class="uscript-string">""</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00652</span>  
<span class="uscript-line">00653</span>      PropValue <span class="uscript-operator">=</span> StringIf<span class="uscript-operator">(</span>bStatic<span class="uscript-operator">,</span> PropName <span class="uscript-operator">$</span> <span class="uscript-string">"="</span> <span class="uscript-operator">$</span> Quote <span class="uscript-operator">$</span> PropValue <span class="uscript-operator">$</span> Quote<span class="uscript-operator">,</span> Quote <span class="uscript-operator">$</span> PropValue <span class="uscript-operator">$</span> Quote<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00654</span>      <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i <span class="uscript-operator">=</span> <span class="uscript-number">0</span><span class="uscript-operator">;</span> i <span class="uscript-operator">&lt;</span> Members<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">;</span> i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">00655</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">00656</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>DEBUG<span class="uscript-operator">)</span>
<span class="uscript-line">00657</span>              log<span class="uscript-operator">(</span><span class="uscript-keyword">class</span><span class="uscript-operator">@</span><span class="uscript-string">"Comparing"</span><span class="uscript-operator">@</span>i<span class="uscript-operator">@</span>PropValue<span class="uscript-operator">@</span><span class="uscript-string">"to"</span><span class="uscript-operator">@</span>Members<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">,</span><span class="uscript-name">'RemoveArrayEntry'</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00658</span>  
<span class="uscript-line">00659</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>Members<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span> <span class="uscript-operator">~=</span> PropValue<span class="uscript-operator">)</span>
<span class="uscript-line">00660</span>              <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>
<span class="uscript-line">00661</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">00662</span>  
<span class="uscript-line">00663</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>i <span class="uscript-operator">&lt;</span> Members<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">)</span>
<span class="uscript-line">00664</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">00665</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>DEBUG<span class="uscript-operator">)</span> log<span class="uscript-operator">(</span><span class="uscript-keyword">class</span><span class="uscript-operator">@</span><span class="uscript-string">"Removing array member"</span><span class="uscript-operator">@</span>i<span class="uscript-operator">$</span><span class="uscript-string">":"</span><span class="uscript-operator">$</span>Members<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">,</span><span class="uscript-name">'RemoveArrayEntry'</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00666</span>  
<span class="uscript-line">00667</span>          <span class="uscript-comment">// Check if we should restore a previous value</span>
<span class="uscript-line">00668</span>          <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>j <span class="uscript-operator">=</span> <span class="uscript-number">0</span><span class="uscript-operator">;</span> j <span class="uscript-operator">&lt;</span> ConfigMaster<span class="uscript-operator">(</span>Owner<span class="uscript-operator">)</span><span class="uscript-operator">.</span>OriginalValues<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">;</span> j<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">00669</span>          <span class="uscript-operator">{</span>
<span class="uscript-line">00670</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>DEBUG<span class="uscript-operator">)</span>
<span class="uscript-line">00671</span>              <span class="uscript-operator">{</span>
<span class="uscript-line">00672</span>                  log<span class="uscript-operator">(</span><span class="uscript-keyword">class</span><span class="uscript-operator">@</span><span class="uscript-string">"Checking Backup Value"</span><span class="uscript-operator">@</span>j<span class="uscript-operator">@</span><span class="uscript-string">"class:"</span><span class="uscript-operator">$</span>ConfigMaster<span class="uscript-operator">(</span>Owner<span class="uscript-operator">)</span><span class="uscript-operator">.</span>OriginalValues<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>ClassFrom<span class="uscript-operator">@</span><span class="uscript-string">"against"</span><span class="uscript-operator">@</span><span class="uscript-type">string</span><span class="uscript-operator">(</span>O<span class="uscript-operator">.</span><span class="uscript-keyword">Class</span><span class="uscript-operator">)</span><span class="uscript-operator">,</span><span class="uscript-name">'RemoveArrayEntry'</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00673</span>                  log<span class="uscript-operator">(</span><span class="uscript-keyword">class</span><span class="uscript-operator">@</span><span class="uscript-string">"Checking Backup Value"</span><span class="uscript-operator">@</span>j<span class="uscript-operator">@</span><span class="uscript-string">"Property:"</span><span class="uscript-operator">$</span>ConfigMaster<span class="uscript-operator">(</span>Owner<span class="uscript-operator">)</span><span class="uscript-operator">.</span>OriginalValues<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>PropName<span class="uscript-operator">@</span><span class="uscript-string">"against"</span><span class="uscript-operator">@</span>PropName<span class="uscript-operator">,</span><span class="uscript-name">'RemoveArrayEntry'</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00674</span>              <span class="uscript-operator">}</span>
<span class="uscript-line">00675</span>  
<span class="uscript-line">00676</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>ConfigMaster<span class="uscript-operator">(</span>Owner<span class="uscript-operator">)</span><span class="uscript-operator">.</span>OriginalValues<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>ClassFrom <span class="uscript-operator">~=</span> <span class="uscript-type">string</span><span class="uscript-operator">(</span>O<span class="uscript-operator">.</span><span class="uscript-keyword">Class</span><span class="uscript-operator">)</span> <span class="uscript-operator">&amp;&amp;</span>
<span class="uscript-line">00677</span>                  ConfigMaster<span class="uscript-operator">(</span>Owner<span class="uscript-operator">)</span><span class="uscript-operator">.</span>OriginalValues<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>PropName <span class="uscript-operator">~=</span> PropName <span class="uscript-operator">)</span>
<span class="uscript-line">00678</span>              <span class="uscript-operator">{</span>
<span class="uscript-line">00679</span>                  RestoreOriginalValue<span class="uscript-operator">(</span>O<span class="uscript-operator">,</span> PropName<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00680</span>                  <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>
<span class="uscript-line">00681</span>              <span class="uscript-operator">}</span>
<span class="uscript-line">00682</span>          <span class="uscript-operator">}</span>
<span class="uscript-line">00683</span>  
<span class="uscript-line">00684</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>j <span class="uscript-operator">&lt;</span> ConfigMaster<span class="uscript-operator">(</span>Owner<span class="uscript-operator">)</span><span class="uscript-operator">.</span>OriginalValues<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">)</span>
<span class="uscript-line">00685</span>              <span class="uscript-keyword">return</span><span class="uscript-operator">;</span>
<span class="uscript-line">00686</span>  
<span class="uscript-line">00687</span>          Members<span class="uscript-operator">.</span><span class="uscript-keyword">Remove</span><span class="uscript-operator">(</span>i<span class="uscript-operator">,</span><span class="uscript-number">1</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00688</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">00689</span>  
<span class="uscript-line">00690</span>      <span class="uscript-keyword">else</span> <span class="uscript-keyword">return</span><span class="uscript-operator">;</span>
<span class="uscript-line">00691</span>  
<span class="uscript-line">00692</span>      PropValue <span class="uscript-operator">=</span> <span class="uscript-string">"("</span> <span class="uscript-operator">$</span> Join<span class="uscript-operator">(</span>Members<span class="uscript-operator">,</span><span class="uscript-string">","</span><span class="uscript-operator">)</span> <span class="uscript-operator">$</span> <span class="uscript-string">")"</span><span class="uscript-operator">;</span>
<span class="uscript-line">00693</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>DEBUG<span class="uscript-operator">)</span>
<span class="uscript-line">00694</span>          log<span class="uscript-operator">(</span><span class="uscript-keyword">class</span><span class="uscript-operator">@</span><span class="uscript-string">"Assigning"</span><span class="uscript-operator">@</span>PropValue<span class="uscript-operator">@</span><span class="uscript-string">"to property"</span><span class="uscript-operator">@</span><span class="uscript-type">string</span><span class="uscript-operator">(</span>O<span class="uscript-operator">.</span><span class="uscript-keyword">Class</span><span class="uscript-operator">)</span><span class="uscript-operator">$</span><span class="uscript-string">"."</span><span class="uscript-operator">$</span>PropName<span class="uscript-operator">,</span><span class="uscript-name">'RemoveArrayEntry'</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00695</span>      O<span class="uscript-operator">.</span>SetPropertyText<span class="uscript-operator">(</span>PropName<span class="uscript-operator">,</span>PropValue<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00696</span>      O<span class="uscript-operator">.</span>SaveConfig<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00697</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>DEBUG<span class="uscript-operator">)</span>
<span class="uscript-line">00698</span>          log<span class="uscript-operator">(</span><span class="uscript-keyword">class</span><span class="uscript-operator">@</span><span class="uscript-string">"Returning"</span><span class="uscript-operator">@</span>O<span class="uscript-operator">.</span>GetPropertyText<span class="uscript-operator">(</span>PropName<span class="uscript-operator">)</span><span class="uscript-operator">,</span><span class="uscript-name">'RemoveArrayEntry'</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00699</span>  <span class="uscript-operator">}</span>
<span class="uscript-line">00700</span>  
<span class="uscript-line">00701</span>  <span class="uscript-comment">// Just a function to handle safe object creation</span>
<span class="uscript-line">00702</span>  <span class="uscript-keyword">protected</span> <span class="uscript-keyword">final</span> <span class="uscript-keyword">function</span> Object GetObjectForEntry<span class="uscript-operator">(</span>IniEntry ThisEntry<span class="uscript-operator">)</span>
<span class="uscript-line">00703</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">00704</span>      <span class="uscript-keyword">local</span> Object O<span class="uscript-operator">;</span>
<span class="uscript-line">00705</span>      <span class="uscript-keyword">local</span> <span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>Object<span class="uscript-operator">&gt;</span> OClass<span class="uscript-operator">;</span>
<span class="uscript-line">00706</span>  
<span class="uscript-line">00707</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>DEBUG<span class="uscript-operator">)</span>
<span class="uscript-line">00708</span>          log<span class="uscript-operator">(</span><span class="uscript-keyword">class</span><span class="uscript-operator">@</span><span class="uscript-string">"Getting"</span><span class="uscript-operator">@</span>ThisEntry<span class="uscript-operator">.</span>ClassFrom<span class="uscript-operator">@</span>ThisEntry<span class="uscript-operator">.</span>PropName<span class="uscript-operator">@</span>ThisEntry<span class="uscript-operator">.</span>PropValue<span class="uscript-operator">,</span><span class="uscript-name">'GetObjectForEntry'</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00709</span>  
<span class="uscript-line">00710</span>      OClass <span class="uscript-operator">=</span> <span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>Object<span class="uscript-operator">&gt;</span><span class="uscript-operator">(</span>DynamicLoadObject<span class="uscript-operator">(</span>ThisEntry<span class="uscript-operator">.</span>ClassFrom<span class="uscript-operator">,</span><span class="uscript-keyword">class</span><span class="uscript-name">'Class'</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00711</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>OClass <span class="uscript-operator">==</span> <span class="uscript-keyword">None</span><span class="uscript-operator">)</span>
<span class="uscript-line">00712</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">00713</span>          Warn<span class="uscript-operator">(</span><span class="uscript-string">"Could not load class"</span><span class="uscript-operator">@</span>ThisEntry<span class="uscript-operator">.</span>ClassFrom<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00714</span>          <span class="uscript-keyword">return</span> <span class="uscript-keyword">None</span><span class="uscript-operator">;</span>
<span class="uscript-line">00715</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">00716</span>  
<span class="uscript-line">00717</span>      O <span class="uscript-operator">=</span> GetObjectOfClass<span class="uscript-operator">(</span>OClass<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00718</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>O <span class="uscript-operator">==</span> <span class="uscript-keyword">None</span><span class="uscript-operator">)</span>
<span class="uscript-line">00719</span>          Warn<span class="uscript-operator">(</span><span class="uscript-string">"Unable to access object for class"</span><span class="uscript-operator">@</span>OClass<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00720</span>  
<span class="uscript-line">00721</span>      <span class="uscript-keyword">return</span> O<span class="uscript-operator">;</span>
<span class="uscript-line">00722</span>  <span class="uscript-operator">}</span>
<span class="uscript-line">00723</span>  
<span class="uscript-line">00724</span>  <span class="uscript-keyword">protected</span> <span class="uscript-keyword">final</span> <span class="uscript-keyword">function</span> Object GetObjectOfClass<span class="uscript-operator">(</span><span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>Object<span class="uscript-operator">&gt;</span> ObjClass<span class="uscript-operator">)</span>
<span class="uscript-line">00725</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">00726</span>      <span class="uscript-keyword">local</span> Object Obj<span class="uscript-operator">;</span>
<span class="uscript-line">00727</span>      <span class="uscript-keyword">local</span> Actor A<span class="uscript-operator">;</span>
<span class="uscript-line">00728</span>  
<span class="uscript-line">00729</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>DEBUG<span class="uscript-operator">)</span>
<span class="uscript-line">00730</span>          log<span class="uscript-operator">(</span><span class="uscript-keyword">class</span><span class="uscript-operator">@</span><span class="uscript-string">"Finding"</span><span class="uscript-operator">@</span>ObjClass<span class="uscript-operator">,</span><span class="uscript-name">'GetObjectOfClass'</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00731</span>  
<span class="uscript-line">00732</span>      <span class="uscript-comment">// Check for GameEngine</span>
<span class="uscript-line">00733</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>ObjClass <span class="uscript-operator">==</span> <span class="uscript-keyword">class</span><span class="uscript-name">'GameEngine'</span><span class="uscript-operator">)</span>
<span class="uscript-line">00734</span>          <span class="uscript-keyword">return</span> GE<span class="uscript-operator">;</span>
<span class="uscript-line">00735</span>  
<span class="uscript-line">00736</span>      <span class="uscript-comment">// First try the easy way</span>
<span class="uscript-line">00737</span>      <span class="uscript-keyword">foreach</span> AllObjects<span class="uscript-operator">(</span>ObjClass<span class="uscript-operator">,</span>Obj<span class="uscript-operator">)</span>
<span class="uscript-line">00738</span>          <span class="uscript-keyword">return</span> Obj<span class="uscript-operator">;</span>
<span class="uscript-line">00739</span>  
<span class="uscript-line">00740</span>      <span class="uscript-comment">// Object may not be loaded right now, so attempt to load it</span>
<span class="uscript-line">00741</span>      <span class="uscript-comment">// If actor, spawn it</span>
<span class="uscript-line">00742</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>ClassIsChildOf<span class="uscript-operator">(</span>ObjClass<span class="uscript-operator">,</span><span class="uscript-keyword">class</span><span class="uscript-name">'Actor'</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">00743</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">00744</span>          A <span class="uscript-operator">=</span> Spawn<span class="uscript-operator">(</span><span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>Actor<span class="uscript-operator">&gt;</span><span class="uscript-operator">(</span>ObjClass<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00745</span>          A<span class="uscript-operator">.</span>GoToState<span class="uscript-operator">(</span><span class="uscript-name">''</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00746</span>          <span class="uscript-keyword">return</span> A<span class="uscript-operator">;</span>
<span class="uscript-line">00747</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">00748</span>  
<span class="uscript-line">00749</span>      <span class="uscript-comment">// if object, new it</span>
<span class="uscript-line">00750</span>      Obj <span class="uscript-operator">=</span> <span class="uscript-keyword">new</span><span class="uscript-operator">(</span><span class="uscript-keyword">None</span><span class="uscript-operator">)</span> ObjClass<span class="uscript-operator">;</span>
<span class="uscript-line">00751</span>  
<span class="uscript-line">00752</span>      <span class="uscript-comment">// might be property</span>
<span class="uscript-line">00753</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>Obj <span class="uscript-operator">==</span> <span class="uscript-keyword">None</span><span class="uscript-operator">)</span>
<span class="uscript-line">00754</span>          Obj <span class="uscript-operator">=</span> <span class="uscript-keyword">new</span><span class="uscript-operator">(</span><span class="uscript-keyword">Class</span><span class="uscript-operator">)</span> ObjClass<span class="uscript-operator">;</span>
<span class="uscript-line">00755</span>  
<span class="uscript-line">00756</span>      <span class="uscript-comment">// Don't know if this will even work ?</span>
<span class="uscript-line">00757</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>Obj <span class="uscript-operator">==</span> <span class="uscript-keyword">None</span><span class="uscript-operator">)</span>
<span class="uscript-line">00758</span>          Obj <span class="uscript-operator">=</span> <span class="uscript-keyword">New</span><span class="uscript-operator">(</span>ObjClass<span class="uscript-operator">.</span><span class="uscript-keyword">default</span><span class="uscript-operator">.</span>Outer<span class="uscript-operator">)</span> ObjClass<span class="uscript-operator">;</span>
<span class="uscript-line">00759</span>  
<span class="uscript-line">00760</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>DEBUG<span class="uscript-operator">)</span>
<span class="uscript-line">00761</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">00762</span>          log<span class="uscript-operator">(</span><span class="uscript-keyword">class</span><span class="uscript-operator">@</span><span class="uscript-string">"Could not create new object"</span><span class="uscript-operator">@</span>ObjClass<span class="uscript-operator">,</span><span class="uscript-name">'GetObjectOfClass'</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00763</span>          log<span class="uscript-operator">(</span><span class="uscript-keyword">class</span><span class="uscript-operator">@</span>ObjClass<span class="uscript-operator">@</span><span class="uscript-string">"outer is"</span><span class="uscript-operator">@</span>ObjClass<span class="uscript-operator">.</span><span class="uscript-keyword">default</span><span class="uscript-operator">.</span>Outer<span class="uscript-operator">,</span><span class="uscript-name">'GetObjectOfClass'</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00764</span>          log<span class="uscript-operator">(</span><span class="uscript-keyword">class</span><span class="uscript-operator">@</span><span class="uscript-string">""</span><span class="uscript-operator">,</span><span class="uscript-name">'GetObjectOfClass'</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00765</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">00766</span>  
<span class="uscript-line">00767</span>      <span class="uscript-keyword">return</span> Obj<span class="uscript-operator">;</span>
<span class="uscript-line">00768</span>  <span class="uscript-operator">}</span>
<span class="uscript-line">00769</span>  
<span class="uscript-line">00770</span>  <span class="uscript-keyword">protected</span> <span class="uscript-keyword">final</span> <span class="uscript-keyword">function</span> Property GetProperty<span class="uscript-operator">(</span>Object O<span class="uscript-operator">,</span> <span class="uscript-type">string</span> PropName<span class="uscript-operator">)</span>
<span class="uscript-line">00771</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">00772</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">int</span> i<span class="uscript-operator">;</span>
<span class="uscript-line">00773</span>      <span class="uscript-keyword">local</span> <span class="uscript-keyword">Class</span> ClassOuter<span class="uscript-operator">;</span>
<span class="uscript-line">00774</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">bool</span> classexact<span class="uscript-operator">,</span> classchild<span class="uscript-operator">,</span> propn<span class="uscript-operator">,</span> seenclass<span class="uscript-operator">;</span>
<span class="uscript-line">00775</span>  
<span class="uscript-line">00776</span>      <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>i<span class="uscript-operator">&lt;</span>Properties<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">;</span>i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">00777</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">00778</span>          seenclass <span class="uscript-operator">=</span> <span class="uscript-keyword">Class</span><span class="uscript-operator">(</span>Properties<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>Outer<span class="uscript-operator">)</span> <span class="uscript-operator">==</span> ClassOuter<span class="uscript-operator">;</span>
<span class="uscript-line">00779</span>  
<span class="uscript-line">00780</span>          ClassOuter <span class="uscript-operator">=</span> <span class="uscript-keyword">Class</span><span class="uscript-operator">(</span>Properties<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>Outer<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00781</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>DEBUGPROPS<span class="uscript-operator">)</span>
<span class="uscript-line">00782</span>          <span class="uscript-operator">{</span>
<span class="uscript-line">00783</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>ClassOuter <span class="uscript-operator">==</span> <span class="uscript-keyword">None</span><span class="uscript-operator">)</span>
<span class="uscript-line">00784</span>              <span class="uscript-operator">{</span>
<span class="uscript-line">00785</span>                  log<span class="uscript-operator">(</span><span class="uscript-keyword">class</span><span class="uscript-operator">@</span><span class="uscript-string">"Property Outer is not a class!"</span><span class="uscript-operator">,</span><span class="uscript-name">'GetProperty'</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00786</span>                  <span class="uscript-keyword">continue</span><span class="uscript-operator">;</span>
<span class="uscript-line">00787</span>              <span class="uscript-operator">}</span>
<span class="uscript-line">00788</span>  
<span class="uscript-line">00789</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">!</span>seenclass<span class="uscript-operator">)</span>
<span class="uscript-line">00790</span>              <span class="uscript-operator">{</span>
<span class="uscript-line">00791</span>                  log<span class="uscript-operator">(</span><span class="uscript-keyword">class</span><span class="uscript-operator">@</span><span class="uscript-string">"Compare Obj Class"</span><span class="uscript-operator">@</span>O<span class="uscript-operator">.</span><span class="uscript-keyword">Class</span><span class="uscript-operator">@</span><span class="uscript-string">"to"</span><span class="uscript-operator">@</span>Properties<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>Outer<span class="uscript-operator">,</span><span class="uscript-name">'GetProperty'</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00792</span>                  <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>O<span class="uscript-operator">.</span><span class="uscript-keyword">Class</span><span class="uscript-operator">==</span>Properties<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>Outer<span class="uscript-operator">)</span>
<span class="uscript-line">00793</span>                      classexact <span class="uscript-operator">=</span> <span class="uscript-keyword">true</span><span class="uscript-operator">;</span>
<span class="uscript-line">00794</span>              <span class="uscript-operator">}</span>
<span class="uscript-line">00795</span>  
<span class="uscript-line">00796</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">!</span>classchild <span class="uscript-operator">&amp;&amp;</span> ClassIsChildOf<span class="uscript-operator">(</span>O<span class="uscript-operator">.</span><span class="uscript-keyword">Class</span><span class="uscript-operator">,</span>ClassOuter<span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">00797</span>              <span class="uscript-operator">{</span>
<span class="uscript-line">00798</span>                  log<span class="uscript-operator">(</span><span class="uscript-keyword">class</span><span class="uscript-operator">@</span><span class="uscript-string">"Obj class"</span><span class="uscript-operator">@</span>O<span class="uscript-operator">.</span><span class="uscript-keyword">Class</span><span class="uscript-operator">@</span><span class="uscript-string">"is child of"</span><span class="uscript-operator">@</span>ClassOuter<span class="uscript-operator">,</span><span class="uscript-name">'GetProperty'</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00799</span>                  classchild <span class="uscript-operator">=</span> <span class="uscript-keyword">true</span><span class="uscript-operator">;</span>
<span class="uscript-line">00800</span>              <span class="uscript-operator">}</span>
<span class="uscript-line">00801</span>  
<span class="uscript-line">00802</span>              <span class="uscript-keyword">else</span> <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">!</span>classchild <span class="uscript-operator">&amp;&amp;</span> ClassIsChildOf<span class="uscript-operator">(</span>ClassOuter<span class="uscript-operator">,</span>O<span class="uscript-operator">.</span><span class="uscript-keyword">Class</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">00803</span>              <span class="uscript-operator">{</span>
<span class="uscript-line">00804</span>                  log<span class="uscript-operator">(</span><span class="uscript-keyword">class</span><span class="uscript-operator">@</span><span class="uscript-string">"Obj class"</span><span class="uscript-operator">@</span>O<span class="uscript-operator">.</span><span class="uscript-keyword">Class</span><span class="uscript-operator">@</span><span class="uscript-string">"is parent of"</span><span class="uscript-operator">@</span>ClassOuter<span class="uscript-operator">,</span><span class="uscript-name">'GetProperty'</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00805</span>                  classchild <span class="uscript-operator">=</span> <span class="uscript-keyword">true</span><span class="uscript-operator">;</span>
<span class="uscript-line">00806</span>              <span class="uscript-operator">}</span>
<span class="uscript-line">00807</span>  
<span class="uscript-line">00808</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">!</span>propn <span class="uscript-operator">&amp;&amp;</span> classexact<span class="uscript-operator">)</span>
<span class="uscript-line">00809</span>              <span class="uscript-operator">{</span>
<span class="uscript-line">00810</span>                  log<span class="uscript-operator">(</span><span class="uscript-keyword">class</span><span class="uscript-operator">@</span><span class="uscript-string">"Compare Name"</span><span class="uscript-operator">@</span>PropName<span class="uscript-operator">@</span><span class="uscript-string">"to"</span><span class="uscript-operator">@</span>Properties<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span><span class="uscript-type">Name</span><span class="uscript-operator">,</span><span class="uscript-name">'GetProperty'</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00811</span>                  <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>PropName <span class="uscript-operator">==</span> <span class="uscript-type">string</span><span class="uscript-operator">(</span>Properties<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span><span class="uscript-type">Name</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">00812</span>                      propn <span class="uscript-operator">=</span> <span class="uscript-keyword">true</span><span class="uscript-operator">;</span>
<span class="uscript-line">00813</span>              <span class="uscript-operator">}</span>
<span class="uscript-line">00814</span>          <span class="uscript-operator">}</span>
<span class="uscript-line">00815</span>  
<span class="uscript-line">00816</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">(</span>ClassIsChildOf<span class="uscript-operator">(</span>O<span class="uscript-operator">.</span><span class="uscript-keyword">Class</span><span class="uscript-operator">,</span>ClassOuter<span class="uscript-operator">)</span><span class="uscript-operator">||</span>O<span class="uscript-operator">.</span><span class="uscript-keyword">Class</span> <span class="uscript-operator">==</span> Properties<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>Outer<span class="uscript-operator">||</span>ClassIsChildOf<span class="uscript-operator">(</span>ClassOuter<span class="uscript-operator">,</span>O<span class="uscript-operator">.</span><span class="uscript-keyword">Class</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">&amp;&amp;</span> <span class="uscript-type">string</span><span class="uscript-operator">(</span>Properties<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span><span class="uscript-type">Name</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> PropName<span class="uscript-operator">)</span>
<span class="uscript-line">00817</span>          <span class="uscript-operator">{</span>
<span class="uscript-line">00818</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>DEBUG<span class="uscript-operator">)</span>
<span class="uscript-line">00819</span>              <span class="uscript-operator">{</span>
<span class="uscript-line">00820</span>                  log<span class="uscript-operator">(</span><span class="uscript-keyword">class</span><span class="uscript-operator">@</span><span class="uscript-string">"Returning Property"</span><span class="uscript-operator">@</span>Properties<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">,</span><span class="uscript-name">'GetProperty'</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00821</span>                  log<span class="uscript-operator">(</span><span class="uscript-keyword">class</span><span class="uscript-operator">@</span><span class="uscript-string">""</span><span class="uscript-operator">,</span><span class="uscript-name">'GetProperty'</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00822</span>              <span class="uscript-operator">}</span>
<span class="uscript-line">00823</span>  
<span class="uscript-line">00824</span>              <span class="uscript-keyword">return</span> Properties<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">;</span>
<span class="uscript-line">00825</span>          <span class="uscript-operator">}</span>
<span class="uscript-line">00826</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">00827</span>  
<span class="uscript-line">00828</span>      <span class="uscript-keyword">return</span> <span class="uscript-keyword">None</span><span class="uscript-operator">;</span>
<span class="uscript-line">00829</span>  <span class="uscript-operator">}</span>
<span class="uscript-line">00830</span>  
<span class="uscript-line">00831</span>  <span class="uscript-keyword">protected</span> <span class="uscript-keyword">final</span> <span class="uscript-keyword">function</span> <span class="uscript-type">bool</span> PropIsArray<span class="uscript-operator">(</span>Property P<span class="uscript-operator">)</span>
<span class="uscript-line">00832</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">00833</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>DEBUG<span class="uscript-operator">)</span>
<span class="uscript-line">00834</span>          log<span class="uscript-operator">(</span><span class="uscript-keyword">class</span><span class="uscript-operator">@</span><span class="uscript-string">"Checking Property"</span><span class="uscript-operator">@</span>P<span class="uscript-operator">.</span>Outer<span class="uscript-operator">$</span><span class="uscript-string">"."</span><span class="uscript-operator">$</span>P<span class="uscript-operator">.</span><span class="uscript-type">Name</span><span class="uscript-operator">$</span><span class="uscript-string">":"</span><span class="uscript-operator">@</span>P<span class="uscript-operator">.</span><span class="uscript-keyword">Class</span><span class="uscript-operator">,</span><span class="uscript-name">'PropIsArray'</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00835</span>      <span class="uscript-keyword">return</span> P<span class="uscript-operator">.</span><span class="uscript-keyword">Class</span> <span class="uscript-operator">==</span> <span class="uscript-keyword">class</span><span class="uscript-name">'ArrayProperty'</span><span class="uscript-operator">;</span>
<span class="uscript-line">00836</span>  <span class="uscript-operator">}</span>
<span class="uscript-line">00837</span>  
<span class="uscript-line">00838</span>  <span class="uscript-keyword">protected</span> <span class="uscript-keyword">static</span> <span class="uscript-keyword">final</span> <span class="uscript-keyword">function</span> <span class="uscript-keyword">array</span><span class="uscript-operator">&lt;</span><span class="uscript-type">string</span><span class="uscript-operator">&gt;</span> GenerateArray<span class="uscript-operator">(</span><span class="uscript-type">string</span> ArrayString<span class="uscript-operator">)</span>
<span class="uscript-line">00839</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">00840</span>      <span class="uscript-keyword">local</span> <span class="uscript-keyword">array</span><span class="uscript-operator">&lt;</span><span class="uscript-type">string</span><span class="uscript-operator">&gt;</span> Members<span class="uscript-operator">;</span>
<span class="uscript-line">00841</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">int</span> i<span class="uscript-operator">;</span>
<span class="uscript-line">00842</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">string</span> S<span class="uscript-operator">;</span>
<span class="uscript-line">00843</span>  
<span class="uscript-line">00844</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>ArrayString <span class="uscript-operator">!=</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">00845</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">00846</span>          <span class="uscript-comment">// Remove the array wrapper ( )</span>
<span class="uscript-line">00847</span>          ArrayString <span class="uscript-operator">=</span> Mid<span class="uscript-operator">(</span>ArrayString<span class="uscript-operator">,</span><span class="uscript-number">1</span><span class="uscript-operator">,</span>Len<span class="uscript-operator">(</span>ArrayString<span class="uscript-operator">)</span><span class="uscript-operator">-</span><span class="uscript-number">2</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00848</span>  
<span class="uscript-line">00849</span>          <span class="uscript-comment">// If string contains internal containers, then have to split differently</span>
<span class="uscript-line">00850</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>Left<span class="uscript-operator">(</span>ArrayString<span class="uscript-operator">,</span><span class="uscript-number">1</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"("</span><span class="uscript-operator">)</span>
<span class="uscript-line">00851</span>          <span class="uscript-operator">{</span>
<span class="uscript-line">00852</span>              <span class="uscript-keyword">do</span> <span class="uscript-operator">{</span>
<span class="uscript-line">00853</span>                  <span class="uscript-keyword">do</span> <span class="uscript-operator">{</span>
<span class="uscript-line">00854</span>                      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>Left<span class="uscript-operator">(</span>ArrayString<span class="uscript-operator">,</span><span class="uscript-number">1</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">")"</span><span class="uscript-operator">)</span>
<span class="uscript-line">00855</span>                          i<span class="uscript-operator">--</span><span class="uscript-operator">;</span>
<span class="uscript-line">00856</span>                      <span class="uscript-keyword">else</span> <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>Left<span class="uscript-operator">(</span>ArrayString<span class="uscript-operator">,</span><span class="uscript-number">1</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"("</span><span class="uscript-operator">)</span>
<span class="uscript-line">00857</span>                          i<span class="uscript-operator">++</span><span class="uscript-operator">;</span>
<span class="uscript-line">00858</span>                      Eat<span class="uscript-operator">(</span>S<span class="uscript-operator">,</span> ArrayString<span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00859</span>                  <span class="uscript-operator">}</span> <span class="uscript-keyword">until</span> <span class="uscript-operator">(</span>i <span class="uscript-operator">==</span> <span class="uscript-number">0</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00860</span>  
<span class="uscript-line">00861</span>                  Members<span class="uscript-operator">[</span>Members<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">]</span> <span class="uscript-operator">=</span> S<span class="uscript-operator">;</span>
<span class="uscript-line">00862</span>                  S <span class="uscript-operator">=</span> <span class="uscript-string">""</span><span class="uscript-operator">;</span>
<span class="uscript-line">00863</span>                  <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>ArrayString <span class="uscript-operator">!=</span> <span class="uscript-string">""</span> <span class="uscript-operator">&amp;&amp;</span> Left<span class="uscript-operator">(</span>ArrayString<span class="uscript-operator">,</span><span class="uscript-number">1</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">","</span><span class="uscript-operator">)</span>
<span class="uscript-line">00864</span>                      ArrayString <span class="uscript-operator">=</span> Mid<span class="uscript-operator">(</span>ArrayString<span class="uscript-operator">,</span><span class="uscript-number">1</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00865</span>              <span class="uscript-operator">}</span> <span class="uscript-keyword">until</span> <span class="uscript-operator">(</span>ArrayString <span class="uscript-operator">==</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00866</span>          <span class="uscript-operator">}</span>
<span class="uscript-line">00867</span>  
<span class="uscript-line">00868</span>          <span class="uscript-keyword">else</span> Split2<span class="uscript-operator">(</span>ArrayString<span class="uscript-operator">,</span><span class="uscript-string">","</span><span class="uscript-operator">,</span>Members<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00869</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">00870</span>  
<span class="uscript-line">00871</span>      <span class="uscript-keyword">return</span> Members<span class="uscript-operator">;</span>
<span class="uscript-line">00872</span>  <span class="uscript-operator">}</span>
<span class="uscript-line">00873</span>  
<span class="uscript-line">00874</span>  <span class="uscript-keyword">protected</span> <span class="uscript-keyword">static</span> <span class="uscript-keyword">final</span> <span class="uscript-keyword">function</span> <span class="uscript-type">bool</span> NotInPlayInfo<span class="uscript-operator">(</span>PlayInfo PI<span class="uscript-operator">,</span> <span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>Info<span class="uscript-operator">&gt;</span> NewInfo<span class="uscript-operator">)</span>
<span class="uscript-line">00875</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">00876</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">int</span> i<span class="uscript-operator">;</span>
<span class="uscript-line">00877</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>PI <span class="uscript-operator">==</span> <span class="uscript-keyword">None</span><span class="uscript-operator">)</span>
<span class="uscript-line">00878</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">00879</span>          Warn<span class="uscript-operator">(</span><span class="uscript-string">"Invalid PlayInfo Object!"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00880</span>          <span class="uscript-keyword">return</span> <span class="uscript-keyword">false</span><span class="uscript-operator">;</span>
<span class="uscript-line">00881</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">00882</span>  
<span class="uscript-line">00883</span>      <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>i<span class="uscript-operator">&lt;</span>PI<span class="uscript-operator">.</span>InfoClasses<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">;</span>i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">00884</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">00885</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>PI<span class="uscript-operator">.</span>InfoClasses<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span> <span class="uscript-operator">==</span> NewInfo<span class="uscript-operator">)</span>
<span class="uscript-line">00886</span>              <span class="uscript-keyword">return</span> <span class="uscript-keyword">false</span><span class="uscript-operator">;</span>
<span class="uscript-line">00887</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">00888</span>  
<span class="uscript-line">00889</span>      <span class="uscript-keyword">return</span> <span class="uscript-keyword">true</span><span class="uscript-operator">;</span>
<span class="uscript-line">00890</span>  <span class="uscript-operator">}</span>
<span class="uscript-line">00891</span>  
<span class="uscript-line">00892</span>  
<span class="uscript-line">00893</span>  <span class="uscript-comment">//###################################################################</span>
<span class="uscript-line">00894</span>  <span class="uscript-comment">//###################################################################</span>
<span class="uscript-line">00895</span>  <span class="uscript-comment">//</span>
<span class="uscript-line">00896</span>  <span class="uscript-comment">//  Utility Methods</span>
<span class="uscript-line">00897</span>  <span class="uscript-comment">//  These are used perform various tedious operations.</span>
<span class="uscript-line">00898</span>  <span class="uscript-comment">//</span>
<span class="uscript-line">00899</span>  <span class="uscript-comment">// Moves Num elements from Source to Dest</span>
<span class="uscript-line">00900</span>  <span class="uscript-keyword">static</span> <span class="uscript-keyword">final</span> <span class="uscript-keyword">function</span> Eat<span class="uscript-operator">(</span><span class="uscript-keyword">out</span> <span class="uscript-type">string</span> Dest<span class="uscript-operator">,</span> <span class="uscript-keyword">out</span> <span class="uscript-type">string</span> Source<span class="uscript-operator">,</span> <span class="uscript-type">int</span> Num<span class="uscript-operator">)</span>
<span class="uscript-line">00901</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">00902</span>      Dest <span class="uscript-operator">=</span> Dest <span class="uscript-operator">$</span> Left<span class="uscript-operator">(</span>Source<span class="uscript-operator">,</span> Num<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00903</span>      Source <span class="uscript-operator">=</span> Mid<span class="uscript-operator">(</span>Source<span class="uscript-operator">,</span> Num<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00904</span>  <span class="uscript-operator">}</span>
<span class="uscript-line">00905</span>  
<span class="uscript-line">00906</span>  <span class="uscript-keyword">static</span> <span class="uscript-keyword">final</span> <span class="uscript-keyword">function</span> <span class="uscript-type">string</span> StringIf<span class="uscript-operator">(</span><span class="uscript-type">bool</span> Condition<span class="uscript-operator">,</span> <span class="uscript-type">string</span> IfTrue<span class="uscript-operator">,</span> <span class="uscript-type">string</span> IfFalse<span class="uscript-operator">)</span>
<span class="uscript-line">00907</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">00908</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>Condition<span class="uscript-operator">)</span> <span class="uscript-keyword">return</span> IfTrue<span class="uscript-operator">;</span>
<span class="uscript-line">00909</span>      <span class="uscript-keyword">return</span> IfFalse<span class="uscript-operator">;</span>
<span class="uscript-line">00910</span>  <span class="uscript-operator">}</span>
<span class="uscript-line">00911</span>  
<span class="uscript-line">00912</span>  <span class="uscript-comment">// Based on AccessControlIni &amp; Object.ReplaceText()</span>
<span class="uscript-line">00913</span>  <span class="uscript-keyword">static</span> <span class="uscript-keyword">final</span> <span class="uscript-keyword">function</span> <span class="uscript-type">string</span> ReplaceTag<span class="uscript-operator">(</span><span class="uscript-type">string</span> from<span class="uscript-operator">,</span> <span class="uscript-type">string</span> tag<span class="uscript-operator">,</span> <span class="uscript-keyword">coerce</span> <span class="uscript-type">string</span> with<span class="uscript-operator">)</span>
<span class="uscript-line">00914</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">00915</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">int</span> i<span class="uscript-operator">;</span>
<span class="uscript-line">00916</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">string</span> t<span class="uscript-operator">;</span>
<span class="uscript-line">00917</span>  
<span class="uscript-line">00918</span>      <span class="uscript-comment">// InStr() is case-sensitive</span>
<span class="uscript-line">00919</span>      i <span class="uscript-operator">=</span> InStr<span class="uscript-operator">(</span>Caps<span class="uscript-operator">(</span>from<span class="uscript-operator">)</span><span class="uscript-operator">,</span> Caps<span class="uscript-operator">(</span>tag<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00920</span>      <span class="uscript-keyword">while</span> <span class="uscript-operator">(</span>i <span class="uscript-operator">!=</span> <span class="uscript-operator">-</span><span class="uscript-number">1</span><span class="uscript-operator">)</span>
<span class="uscript-line">00921</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">00922</span>          t <span class="uscript-operator">=</span> t <span class="uscript-operator">$</span> Left<span class="uscript-operator">(</span>from<span class="uscript-operator">,</span>i<span class="uscript-operator">)</span> <span class="uscript-operator">$</span> with<span class="uscript-operator">;</span>
<span class="uscript-line">00923</span>          from <span class="uscript-operator">=</span> mid<span class="uscript-operator">(</span>from<span class="uscript-operator">,</span>i<span class="uscript-operator">+</span>len<span class="uscript-operator">(</span>tag<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00924</span>          i <span class="uscript-operator">=</span> InStr<span class="uscript-operator">(</span>Caps<span class="uscript-operator">(</span>from<span class="uscript-operator">)</span><span class="uscript-operator">,</span> Caps<span class="uscript-operator">(</span>tag<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00925</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">00926</span>  
<span class="uscript-line">00927</span>      t <span class="uscript-operator">=</span> t <span class="uscript-operator">$</span> from<span class="uscript-operator">;</span>
<span class="uscript-line">00928</span>      <span class="uscript-keyword">return</span> t<span class="uscript-operator">;</span>
<span class="uscript-line">00929</span>  <span class="uscript-operator">}</span>
<span class="uscript-line">00930</span>  
<span class="uscript-line">00931</span>  <span class="uscript-comment">// Following functions from wUtils103 by El_Muerte[TDS]</span>
<span class="uscript-line">00932</span>  <span class="uscript-comment">// Included by permission (copied to avoid package dependancy)</span>
<span class="uscript-line">00933</span>  
<span class="uscript-line">00934</span>  <span class="uscript-comment">// Shifts an element off a string</span>
<span class="uscript-line">00935</span>  <span class="uscript-comment">// example (delim = ' '): 'this is a string' -&gt; 'is a string'</span>
<span class="uscript-line">00936</span>  <span class="uscript-comment">// if quotechar = " : '"this is" a string' -&gt; 'a string'</span>
<span class="uscript-line">00937</span>  <span class="uscript-keyword">static</span> <span class="uscript-keyword">final</span> <span class="uscript-keyword">function</span> <span class="uscript-type">string</span> StrShift<span class="uscript-operator">(</span><span class="uscript-keyword">out</span> <span class="uscript-type">string</span> line<span class="uscript-operator">,</span> <span class="uscript-type">string</span> delim<span class="uscript-operator">,</span> <span class="uscript-keyword">optional</span> <span class="uscript-type">string</span> quotechar<span class="uscript-operator">)</span>
<span class="uscript-line">00938</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">00939</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">int</span> delimpos<span class="uscript-operator">,</span> quotepos<span class="uscript-operator">;</span>
<span class="uscript-line">00940</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">string</span> result<span class="uscript-operator">;</span>
<span class="uscript-line">00941</span>  
<span class="uscript-line">00942</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span> quotechar <span class="uscript-operator">!=</span> <span class="uscript-string">""</span> <span class="uscript-operator">&amp;&amp;</span> Left<span class="uscript-operator">(</span>line<span class="uscript-operator">,</span> Len<span class="uscript-operator">(</span>quotechar<span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> quotechar <span class="uscript-operator">)</span> <span class="uscript-operator">{</span>
<span class="uscript-line">00943</span>          <span class="uscript-keyword">do</span> <span class="uscript-operator">{</span>
<span class="uscript-line">00944</span>              quotepos <span class="uscript-operator">=</span> InstrFrom<span class="uscript-operator">(</span>line<span class="uscript-operator">,</span> quotechar<span class="uscript-operator">,</span> quotepos <span class="uscript-operator">+</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00945</span>          <span class="uscript-operator">}</span> <span class="uscript-keyword">until</span> <span class="uscript-operator">(</span>quotepos <span class="uscript-operator">==</span> <span class="uscript-operator">-</span><span class="uscript-number">1</span> <span class="uscript-operator">||</span> quotepos <span class="uscript-operator">+</span> Len<span class="uscript-operator">(</span>quotechar<span class="uscript-operator">)</span> <span class="uscript-operator">==</span> Len<span class="uscript-operator">(</span>line<span class="uscript-operator">)</span>
<span class="uscript-line">00946</span>                  <span class="uscript-operator">||</span> Mid<span class="uscript-operator">(</span>line<span class="uscript-operator">,</span> quotepos <span class="uscript-operator">+</span> len<span class="uscript-operator">(</span>quotechar<span class="uscript-operator">)</span><span class="uscript-operator">,</span> len<span class="uscript-operator">(</span>delim<span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> delim<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00947</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">00948</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span> quotepos <span class="uscript-operator">!=</span> <span class="uscript-operator">-</span><span class="uscript-number">1</span> <span class="uscript-operator">)</span> <span class="uscript-operator">{</span>
<span class="uscript-line">00949</span>          delimpos <span class="uscript-operator">=</span> InstrFrom<span class="uscript-operator">(</span>line<span class="uscript-operator">,</span> delim<span class="uscript-operator">,</span> quotepos<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00950</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">00951</span>      <span class="uscript-keyword">else</span> <span class="uscript-operator">{</span>
<span class="uscript-line">00952</span>          delimpos <span class="uscript-operator">=</span> Instr<span class="uscript-operator">(</span>line<span class="uscript-operator">,</span> delim<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00953</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">00954</span>  
<span class="uscript-line">00955</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>delimpos <span class="uscript-operator">==</span> <span class="uscript-operator">-</span><span class="uscript-number">1</span><span class="uscript-operator">)</span>
<span class="uscript-line">00956</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">00957</span>          result <span class="uscript-operator">=</span> line<span class="uscript-operator">;</span>
<span class="uscript-line">00958</span>          line <span class="uscript-operator">=</span> <span class="uscript-string">""</span><span class="uscript-operator">;</span>
<span class="uscript-line">00959</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">00960</span>      <span class="uscript-keyword">else</span> <span class="uscript-operator">{</span>
<span class="uscript-line">00961</span>          result <span class="uscript-operator">=</span> Left<span class="uscript-operator">(</span>line<span class="uscript-operator">,</span>delimpos<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00962</span>          line <span class="uscript-operator">=</span> Mid<span class="uscript-operator">(</span>line<span class="uscript-operator">,</span>delimpos<span class="uscript-operator">+</span>len<span class="uscript-operator">(</span>delim<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00963</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">00964</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span> quotechar <span class="uscript-operator">!=</span> <span class="uscript-string">""</span> <span class="uscript-operator">&amp;&amp;</span> Left<span class="uscript-operator">(</span>result<span class="uscript-operator">,</span> Len<span class="uscript-operator">(</span>quotechar<span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> quotechar <span class="uscript-operator">)</span> <span class="uscript-operator">{</span>
<span class="uscript-line">00965</span>        result <span class="uscript-operator">=</span> Mid<span class="uscript-operator">(</span>result<span class="uscript-operator">,</span> Len<span class="uscript-operator">(</span>quotechar<span class="uscript-operator">)</span><span class="uscript-operator">,</span> Len<span class="uscript-operator">(</span>result<span class="uscript-operator">)</span><span class="uscript-operator">-</span><span class="uscript-operator">(</span>Len<span class="uscript-operator">(</span>quotechar<span class="uscript-operator">)</span><span class="uscript-operator">*</span><span class="uscript-number">2</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00966</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">00967</span>      <span class="uscript-keyword">return</span> result<span class="uscript-operator">;</span>
<span class="uscript-line">00968</span>  <span class="uscript-operator">}</span>
<span class="uscript-line">00969</span>  
<span class="uscript-line">00970</span>  <span class="uscript-comment">// Join the elements of a string array to an array</span>
<span class="uscript-line">00971</span>  <span class="uscript-keyword">static</span> <span class="uscript-keyword">final</span> <span class="uscript-keyword">function</span> <span class="uscript-type">string</span> Join<span class="uscript-operator">(</span><span class="uscript-keyword">array</span><span class="uscript-operator">&lt;</span> <span class="uscript-type">string</span> <span class="uscript-operator">&gt;</span> ar<span class="uscript-operator">,</span> <span class="uscript-keyword">optional</span> <span class="uscript-type">string</span> delim<span class="uscript-operator">,</span> <span class="uscript-keyword">optional</span> <span class="uscript-type">bool</span> bIgnoreEmpty<span class="uscript-operator">)</span>
<span class="uscript-line">00972</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">00973</span>    <span class="uscript-keyword">local</span> <span class="uscript-type">string</span> result<span class="uscript-operator">;</span>
<span class="uscript-line">00974</span>    <span class="uscript-keyword">local</span> <span class="uscript-type">int</span> i<span class="uscript-operator">;</span>
<span class="uscript-line">00975</span>    <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i <span class="uscript-operator">=</span> <span class="uscript-number">0</span><span class="uscript-operator">;</span> i <span class="uscript-operator">&lt;</span> ar<span class="uscript-operator">.</span><span class="uscript-keyword">length</span><span class="uscript-operator">;</span> i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">00976</span>    <span class="uscript-operator">{</span>
<span class="uscript-line">00977</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>bIgnoreEmpty <span class="uscript-operator">&amp;&amp;</span> ar<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span> <span class="uscript-operator">==</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span> <span class="uscript-keyword">continue</span><span class="uscript-operator">;</span>
<span class="uscript-line">00978</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>result <span class="uscript-operator">!=</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span> result <span class="uscript-operator">=</span> result<span class="uscript-operator">$</span>delim<span class="uscript-operator">;</span>
<span class="uscript-line">00979</span>      result <span class="uscript-operator">=</span> result<span class="uscript-operator">$</span>ar<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">;</span>
<span class="uscript-line">00980</span>    <span class="uscript-operator">}</span>
<span class="uscript-line">00981</span>  
<span class="uscript-line">00982</span>    <span class="uscript-keyword">return</span> result<span class="uscript-operator">;</span>
<span class="uscript-line">00983</span>  <span class="uscript-operator">}</span>
<span class="uscript-line">00984</span>  
<span class="uscript-line">00985</span>  <span class="uscript-comment">// Fixed split method</span>
<span class="uscript-line">00986</span>  <span class="uscript-comment">// no problems when it starts with a delim</span>
<span class="uscript-line">00987</span>  <span class="uscript-comment">// no problems with ending spaces</span>
<span class="uscript-line">00988</span>  <span class="uscript-comment">// delim can be a string</span>
<span class="uscript-line">00989</span>  <span class="uscript-keyword">static</span> <span class="uscript-keyword">final</span> <span class="uscript-keyword">function</span> <span class="uscript-type">int</span> Split2<span class="uscript-operator">(</span><span class="uscript-keyword">coerce</span> <span class="uscript-type">string</span> src<span class="uscript-operator">,</span> <span class="uscript-type">string</span> delim<span class="uscript-operator">,</span> <span class="uscript-keyword">out</span> <span class="uscript-keyword">array</span><span class="uscript-operator">&lt;</span><span class="uscript-type">string</span><span class="uscript-operator">&gt;</span> parts<span class="uscript-operator">,</span> <span class="uscript-keyword">optional</span> <span class="uscript-type">bool</span> ignoreEmpty<span class="uscript-operator">,</span> <span class="uscript-keyword">optional</span> <span class="uscript-type">string</span> quotechar<span class="uscript-operator">)</span>
<span class="uscript-line">00990</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">00991</span>    <span class="uscript-keyword">local</span> <span class="uscript-type">string</span> temp<span class="uscript-operator">;</span>
<span class="uscript-line">00992</span>    Parts<span class="uscript-operator">.</span><span class="uscript-keyword">Remove</span><span class="uscript-operator">(</span><span class="uscript-number">0</span><span class="uscript-operator">,</span> Parts<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00993</span>    <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>delim <span class="uscript-operator">==</span> <span class="uscript-string">""</span> <span class="uscript-operator">||</span> Src <span class="uscript-operator">==</span> <span class="uscript-string">""</span> <span class="uscript-operator">)</span> <span class="uscript-keyword">return</span> <span class="uscript-number">0</span><span class="uscript-operator">;</span>
<span class="uscript-line">00994</span>    <span class="uscript-keyword">while</span> <span class="uscript-operator">(</span>src <span class="uscript-operator">!=</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">00995</span>    <span class="uscript-operator">{</span>
<span class="uscript-line">00996</span>      temp <span class="uscript-operator">=</span> StrShift<span class="uscript-operator">(</span>src<span class="uscript-operator">,</span> delim<span class="uscript-operator">,</span> quotechar<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00997</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>temp <span class="uscript-operator">==</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">00998</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">00999</span>        <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">!</span>ignoreEmpty<span class="uscript-operator">)</span>
<span class="uscript-line">01000</span>        <span class="uscript-operator">{</span>
<span class="uscript-line">01001</span>          parts<span class="uscript-operator">.</span><span class="uscript-keyword">length</span> <span class="uscript-operator">=</span> parts<span class="uscript-operator">.</span><span class="uscript-keyword">length</span><span class="uscript-number">+1</span><span class="uscript-operator">;</span>
<span class="uscript-line">01002</span>          parts<span class="uscript-operator">[</span>parts<span class="uscript-operator">.</span><span class="uscript-keyword">length</span><span class="uscript-number">-1</span><span class="uscript-operator">]</span> <span class="uscript-operator">=</span> temp<span class="uscript-operator">;</span>
<span class="uscript-line">01003</span>        <span class="uscript-operator">}</span>
<span class="uscript-line">01004</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">01005</span>      <span class="uscript-keyword">else</span> <span class="uscript-operator">{</span>
<span class="uscript-line">01006</span>        parts<span class="uscript-operator">.</span><span class="uscript-keyword">length</span> <span class="uscript-operator">=</span> parts<span class="uscript-operator">.</span><span class="uscript-keyword">length</span><span class="uscript-number">+1</span><span class="uscript-operator">;</span>
<span class="uscript-line">01007</span>        parts<span class="uscript-operator">[</span>parts<span class="uscript-operator">.</span><span class="uscript-keyword">length</span><span class="uscript-number">-1</span><span class="uscript-operator">]</span> <span class="uscript-operator">=</span> temp<span class="uscript-operator">;</span>
<span class="uscript-line">01008</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">01009</span>    <span class="uscript-operator">}</span>
<span class="uscript-line">01010</span>    <span class="uscript-keyword">return</span> parts<span class="uscript-operator">.</span><span class="uscript-keyword">length</span><span class="uscript-operator">;</span>
<span class="uscript-line">01011</span>  <span class="uscript-operator">}</span>
<span class="uscript-line">01012</span>  
<span class="uscript-line">01013</span>  <span class="uscript-comment">// InStr starting from an offset</span>
<span class="uscript-line">01014</span>  <span class="uscript-keyword">static</span> <span class="uscript-keyword">final</span> <span class="uscript-keyword">function</span> <span class="uscript-type">int</span> InStrFrom<span class="uscript-operator">(</span><span class="uscript-keyword">coerce</span> <span class="uscript-type">string</span> StrText<span class="uscript-operator">,</span> <span class="uscript-keyword">coerce</span> <span class="uscript-type">string</span> StrPart<span class="uscript-operator">,</span> <span class="uscript-keyword">optional</span> <span class="uscript-type">int</span> OffsetStart<span class="uscript-operator">)</span>
<span class="uscript-line">01015</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">01016</span>    <span class="uscript-keyword">local</span> <span class="uscript-type">int</span> OffsetPart<span class="uscript-operator">;</span>
<span class="uscript-line">01017</span>  
<span class="uscript-line">01018</span>    OffsetPart <span class="uscript-operator">=</span> InStr<span class="uscript-operator">(</span>Mid<span class="uscript-operator">(</span>StrText<span class="uscript-operator">,</span> OffsetStart<span class="uscript-operator">)</span><span class="uscript-operator">,</span> StrPart<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01019</span>    <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>OffsetPart <span class="uscript-operator">&gt;=</span> <span class="uscript-number">0</span><span class="uscript-operator">)</span>
<span class="uscript-line">01020</span>      OffsetPart <span class="uscript-operator">+=</span> OffsetStart<span class="uscript-operator">;</span>
<span class="uscript-line">01021</span>    <span class="uscript-keyword">return</span> OffsetPart<span class="uscript-operator">;</span>
<span class="uscript-line">01022</span>  <span class="uscript-operator">}</span></pre><hr class="thin"><p><em class="em2">Wormbo:</em> Hmm, a little documentation instead of the source code wouldn't hurt. E.g. how can you use this to enable/disable a server actor?</p>
<p><em class="em2">El Muerte TDS:</em> like this: <a href="http://el-muerte.student.utwente.nl/cgi-bin/cvsweb/UT2003/ChatFilterLoader/Classes/ChatFilterLoader.uc?rev=1.7&content-type=text/x-cvsweb-markup">[ChatFilter AutoLoader]</a>, maybe write a [/example] based on it... first lunch</p>
<hr class="thin"><p><a href="category-custom-class.html">Category Custom Class</a></p>
</div>
</div>

<div id="footer" class="bar">
	<p><form method="post" action="http://wiki.beyondunreal.com/wiki" enctype="application/x-www-form-urlencoded">
<a href="(start).html">Home Page</a> | <a href="recent-changes.html">Recent Changes</a> | <a href="http://wiki.beyondunreal.com/wiki?action=editprefs">Preferences</a><br>
<a href="http://wiki.beyondunreal.com/wiki?action=edit&id=AutoLoader">Edit text of this page</a> | <a href="http://wiki.beyondunreal.com/wiki?action=history&id=AutoLoader">View other revisions</a><br>Last edited December 27, 2005 10:31 <a href="http://wiki.beyondunreal.com/wiki?action=browse&diff=1&id=AutoLoader">(diff)</a><br>Search: <input type="text" name="search"  size="20" /><input type="hidden" name="dosearch" value="1"  /><br><br><small><a href="http://wiki.beyondunreal.com/wiki/AutoLoader">Original page</a> &#150; copy created Sat, Jun 23, 2007</small><div></div>
</form>
	</p>
	<p>My program doesn't have bugs. It just develops random features.
</p>
</div>
</div><!-- close of "scrolling" div -->

<div id="quickbar">
	<div id="logo"><a href="http://wiki.beyondunreal.com/"><img src="shared/wikilogo.jpg" width="143" height="100" border="0"></a>
		</div>
	<div class="qbsitename">
		<p>The Unreal Engine Documentation Site</p>
	</div>
	<div class="qbsection">
<p><a href="metatopics.html">Wiki Community</a></p>
<p><a href="category-category.html">Topic Categories</a></p>
<p><a href="/cgi-bin/imageupload.cgi/wiki-ext/imageupload.htt" target="_blank ">Image Uploads</a></p>
<p><a href="http://wiki.beyondunreal.com/wiki?action=random">Random Page</a></p>
<p><a href="recent-changes.html">Recent Changes</a></p>
<p><a href="offline-wiki.html">Offline Wiki</a></p>
</div><div class="qbsection">
<p><a href="unreal-engine.html">Unreal Engine</a></p>
<p><a href="console-commands.html">Console Commands</a></p>
<p><a href="terminology.html">Terminology</a></p>
<p><a href="category-faq.html">FAQs</a></p>
<p><a href="help-desk.html">Help Desk</a></p>
</div><div class="qbsection">
<p><a href="topics-on-mapping.html">Mapping Topics</a></p>
<p><a href="mapping-lessons.html">Mapping Lessons</a></p>
<p><a href="unrealed-3.html">UnrealEd Interface</a></p>
</div><div class="qbsection">
<p><a href="unrealscript.html">UnrealScript Topics</a></p>
<p><a href="unrealscript-lessons.html">UnrealScript Lessons</a></p>
<p><a href="making-mods.html">Making Mods</a></p>
<p><a href="class-tree.html">Class Tree</a></p>
</div><div class="qbsection">
<p><a href="topics-on-modeling.html">Modeling Topics</a></p>
</div><div class="qbsection">
<p><a href="chongqing-page.html">Chongqing Page</a></p>
<p><a href="log-in.html">Log In</a></p></div>
</div>

</body></html>
