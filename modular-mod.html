<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"  "http://www.w3.org/TR/html4/loose.dtd">

<html>
<head lang="en">
	<title>UnrealWiki: Modular Mod</title>
	<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
	<link rel="stylesheet" type="text/css" media="screen, print"
		href="shared/stylebase.structural.css">	
	<link rel="stylesheet" type="text/css" media="screen"
		href="shared/template-default.css">
	<link rel="stylesheet" type="text/css" media="screen"
		href="shared/styles.chblue.css">
	<link rel="stylesheet" type="text/css" media="print"
		href="shared/template-default-print.css">
	<!--[if IE 6]>
			<style>
			/* dirty hack for IE6. */
			#quickbar {
				position: absolute;
				}
			</style>
	<![endif]-->
  <link rel="start" href="http://wiki.beyondunreal.com/">
  <link rel="glossary"  href="http://wiki.beyondunreal.com/wiki/Terminology">
  <link rel="help"  href="http://wiki.beyondunreal.com/wiki/Using_The_Wiki">
<script type="text/javascript" src="shared/dhtml.js"></script>
<script type="text/javascript" src="shared/dhtml-menu.js"></script>
<style type="text/css">#dhtml-menu    { background: #eee; padding: 5px 0px; margin-right: -20px; border: 1px solid #888; border-left: 1px solid #ccc; border-top: 1px solid #ccc;  border-right: 1px solid #888; border-bottom: 1px solid #888 }
#dhtml-menu td { color: #000; font-family: Arial,Helvetica,sans-serif; font-size: 9pt; line-height: 13pt; padding: 1px 10px; cursor: default }
#dhtml-menu a  { color: #000; font-family: Arial,Helvetica,sans-serif; font-size: 9pt; line-height: 13pt; text-decoration: none }
#dhtml-menu tt { font-family: monospace; font-size: 9pt }
#dhtml-menu-separator { height: 1px; background: red }
#dhtml-menu-anchor { cursor: default }
</style>
<script type="text/javascript" src="shared/expandable.js"></script>
</head>
<body onLoad="menuInit(); document.cookie='page=Modular_Mod; path=/'" class="default">
<div id="scrolling"><!-- contains all except the fixed sidebar -->
<div id="topbar"  class="bar">
	<div class="righthalf">
		<form class="inline" method="post" action="/wiki" enctype="application/x-www-form-urlencoded"><input type="text" name="search"  size="20" /> <input type="submit" name="search" value="search" /></form>
	</div>
	<div class="lefthalf">
		<script type="text/javascript"><!--
			menuAlignRight = false;
		//--></script>
		<span><script type="text/javascript"><!--
 menuWriteAnchor("Quick Navigation") //--></script></span> | <a href="(start).html">Home Page</a> | <a href="recent-changes.html">Recent Changes</a> | <a href="http://wiki.beyondunreal.com/wiki?action=editprefs">Preferences</a>
	</div>
</div>

<div id="content"><!-- contains the title and article -->
	<h1 class='pagetitle'><a href="http://wiki.beyondunreal.com/wiki?back=Modular Mod">Modular Mod</a></h1>
	<div class="wiki"><h2><a name="0.1"></a>Modularity</h2>
<p>The Unreal engine has been built modular, so you can extend the game with your own creations. This is a great feature and ofcourse used a lot.</p>
<p>So why don't you make your mod modular, besides giving other people the power to extend your mod without needing to recompile it completely, it will also be quite handy to categorise some functionality within your mod.</p>
<p>Not every mod can be made modular, you have to find out yourself if your mod lends itself to contain modules. Somethings that often can be build modular:</p>
<ul><li>command handling</li>
<li>power-ups/bonusses</li>
<li>....</li>
</ul>
<p>An example of a modular system in UT2003 is the new WebAdmin (module system is broken in 2136 and earlier tho). It will allow you to add extra pages to the system.</p>
<h2><a name="0.2"></a>Main class</h2>
<p>In the main class you have to load and call the modules.</p>
<pre class="uscript"><span class="uscript-keyword">class</span> MyModMod <span class="uscript-keyword">extends</span> Info <span class="uscript-keyword">config</span><span class="uscript-operator">;</span>

<span class="uscript-keyword">var</span> <span class="uscript-keyword">globalconfig</span> <span class="uscript-keyword">array</span><span class="uscript-operator">&lt;</span><span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>MyModule<span class="uscript-operator">&gt;&gt;</span> MyModuleClasses<span class="uscript-operator">;</span>
<span class="uscript-keyword">var</span> <span class="uscript-keyword">array</span><span class="uscript-operator">&lt;</span>MyModule<span class="uscript-operator">&gt;</span> MyModules<span class="uscript-operator">;</span>

<span class="uscript-keyword">function</span> LoadModules<span class="uscript-operator">(</span><span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
  <span class="uscript-keyword">local</span> <span class="uscript-type">int</span> i<span class="uscript-operator">,</span> j<span class="uscript-operator">,</span> cnt<span class="uscript-operator">;</span>
  <span class="uscript-keyword">local</span> MyModule MMI<span class="uscript-operator">;</span>
  <span class="uscript-keyword">local</span> <span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>MyModule<span class="uscript-operator">&gt;</span> MMC<span class="uscript-operator">;</span>

  cnt <span class="uscript-operator">=</span> <span class="uscript-number">0</span><span class="uscript-operator">;</span>
  <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span> i <span class="uscript-operator">&lt;</span> MyModuleClasses<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">;</span> i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
  <span class="uscript-operator">{</span>
    MMC <span class="uscript-operator">=</span> MyModuleClasses<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">;</span>
    <span class="uscript-comment">// Skip invalid classes;</span>
    <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>MMC <span class="uscript-operator">!=</span> <span class="uscript-keyword">None</span><span class="uscript-operator">)</span>
    <span class="uscript-operator">{</span>
      <span class="uscript-comment">// Make sure we dont have duplicate instance of the same class</span>
      <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>j<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>j<span class="uscript-operator">&lt;</span>TelnetHelpers<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">;</span> j<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
      <span class="uscript-operator">{</span>
        <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>MyModules<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span><span class="uscript-keyword">Class</span> <span class="uscript-operator">==</span> MMC<span class="uscript-operator">)</span>
        <span class="uscript-operator">{</span>
          MMC <span class="uscript-operator">=</span> <span class="uscript-keyword">None</span><span class="uscript-operator">;</span>
          <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>
        <span class="uscript-operator">}</span>
      <span class="uscript-operator">}</span>
      
      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>MMC <span class="uscript-operator">!=</span> <span class="uscript-keyword">None</span><span class="uscript-operator">)</span>
      <span class="uscript-operator">{</span>
        MMI <span class="uscript-operator">=</span> <span class="uscript-keyword">new</span> MMC<span class="uscript-operator">;</span>
        <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>MMI <span class="uscript-operator">!=</span> <span class="uscript-keyword">None</span><span class="uscript-operator">)</span>
        <span class="uscript-operator">{</span>
          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>MMI<span class="uscript-operator">.</span>Init<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
          <span class="uscript-operator">{</span>
            MyModules<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span> <span class="uscript-operator">=</span> MyModules<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-number">+1</span><span class="uscript-operator">;</span>
            MyModules<span class="uscript-operator">[</span>MyModules<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span> <span class="uscript-operator">-</span> <span class="uscript-number">1</span><span class="uscript-operator">]</span> <span class="uscript-operator">=</span> MMI<span class="uscript-operator">;</span>
          <span class="uscript-operator">}</span>
          <span class="uscript-keyword">else</span>
          <span class="uscript-operator">{</span>
            Log<span class="uscript-operator">(</span><span class="uscript-string">"MyModule:"</span><span class="uscript-operator">@</span>MMC<span class="uscript-operator">@</span><span class="uscript-string">"could not be initialized"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
          <span class="uscript-operator">}</span>
        <span class="uscript-operator">}</span>
      <span class="uscript-operator">}</span>
    <span class="uscript-operator">}</span>
  <span class="uscript-operator">}</span>
<span class="uscript-operator">}</span></pre><p><em class="em2">MythOpus:</em> In the code above, I think there is a slight typo and I'm not sure how to fix it.  I'm not sure how to fix it...  anyways the typo is 'TelnetHelper' where you check for the duplicates.</p>
<p>As you can see above we have defined two variables, one of them is configurable: MyModuleClasses. In the config file we will define the Sub Classes of MyModule that we want to load:</p>
<pre class="uscript"><span class="uscript-operator">[</span>MyPackage<span class="uscript-operator">.</span>MyModMod<span class="uscript-operator">]</span>
MyModuleClasses<span class="uscript-operator">=</span><span class="uscript-keyword">class</span><span class="uscript-name">'MyFirstModule'</span>
MyModuleClasses<span class="uscript-operator">=</span><span class="uscript-keyword">class</span><span class="uscript-name">'MySecondModule'</span>
MyModuleClasses<span class="uscript-operator">=</span><span class="uscript-keyword">class</span><span class="uscript-name">'MyExtras.AnotherModule'</span>
etc<span class="uscript-operator">.</span><span class="uscript-operator">.</span><span class="uscript-operator">.</span></pre><p>The method LoadModules() will load all module classes defined in the variable MyModuleClasses and place the instance handle in the var MyModules (this is what we use in the rest of the system). For every instance of MyModule it will class a method called Init() to allow the module to do some initialization. You should call the method LoadModules when your Mod starts.</p>
<p>Now we have loaded all modules we should call them when it's needed, for example:</p>
<pre class="uscript"><span class="uscript-keyword">function</span> SomethingHappend<span class="uscript-operator">(</span>Controller C<span class="uscript-operator">,</span> <span class="uscript-type">string</span> description<span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
  <span class="uscript-keyword">local</span> <span class="uscript-type">int</span> i<span class="uscript-operator">;</span>
  <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i <span class="uscript-operator">=</span> <span class="uscript-number">0</span><span class="uscript-operator">;</span>  i <span class="uscript-operator">&lt;</span> MyModules<span class="uscript-operator">.</span><span class="uscript-keyword">length</span><span class="uscript-operator">;</span> i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
  <span class="uscript-operator">{</span> 
    <span class="uscript-comment">// break loop when handled</span>
    <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>MyModules<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>DoSomething<span class="uscript-operator">(</span>C<span class="uscript-operator">,</span> description<span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>
  <span class="uscript-operator">}</span>
  <span class="uscript-comment">// do some more</span>
<span class="uscript-operator">}</span></pre><p>When this function is called it will loop through the MyModules list and call the method DoSomething on every MyModule until it returns true. Breaking the loop when a MyModule has handled the method is something you usualy want to do. In some cases you want every module to perform some actions, like saving stuff. But most of the time you want to ask a module if it wants to do something with the currect aparameters or not.</p>
<p>Now that this is defined you need to program the Base Class of the Module.</p>
<h2><a name="0.3"></a>Base Module Class</h2>
<pre class="uscript"><span class="uscript-keyword">class</span> MyModule <span class="uscript-keyword">extends</span> Object <span class="uscript-keyword">within</span> MyModMod<span class="uscript-operator">;</span>

<span class="uscript-keyword">function</span> <span class="uscript-type">bool</span> Init<span class="uscript-operator">(</span><span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
  <span class="uscript-keyword">return</span> <span class="uscript-keyword">true</span><span class="uscript-operator">;</span>
<span class="uscript-operator">}</span>

<span class="uscript-keyword">function</span> <span class="uscript-type">bool</span> DoSomething<span class="uscript-operator">(</span>Controller C<span class="uscript-operator">,</span> <span class="uscript-type">string</span> description<span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
  <span class="uscript-keyword">return</span> <span class="uscript-keyword">false</span><span class="uscript-operator">;</span>
<span class="uscript-operator">}</span>

<span class="uscript-keyword">function</span> <span class="uscript-type">bool</span> DoSomethingElse<span class="uscript-operator">(</span>Controller C1<span class="uscript-operator">,</span> Controller C2<span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
  <span class="uscript-keyword">return</span> <span class="uscript-keyword">false</span><span class="uscript-operator">;</span>
<span class="uscript-operator">}</span>

<span class="uscript-keyword">function</span> SaveStatus<span class="uscript-operator">(</span><span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
<span class="uscript-operator">}</span></pre><p>The base class defines all methods that can be called on the module. The base class should not contain a lot of code, only code that is realy common to all modules.</p>
<p>Also on methods that return a bool to define if they handled it should return false by default. Init should return true by default.</p>
<p>The base class is defined to execute within the context of MyModMod, thus it should extend Object since it's already a sub class of whatever MyModMod is a subclass off.</p>
<h3><a name="0.3.1"></a>A module</h3>
<p>Now that we have defined a base class we can create the modules.</p>
<pre class="uscript"><span class="uscript-keyword">class</span> MyFirstModule <span class="uscript-keyword">extends</span> MyModule<span class="uscript-operator">;</span>

<span class="uscript-keyword">function</span> <span class="uscript-type">bool</span> Init<span class="uscript-operator">(</span><span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
  log<span class="uscript-operator">(</span><span class="uscript-string">"MyFirstModule loaded succesfully"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
  <span class="uscript-keyword">return</span> <span class="uscript-keyword">true</span><span class="uscript-operator">;</span>
<span class="uscript-operator">}</span>

<span class="uscript-keyword">function</span> <span class="uscript-type">bool</span> DoSomething<span class="uscript-operator">(</span>Controller C<span class="uscript-operator">,</span> <span class="uscript-type">string</span> description<span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
  <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>description <span class="uscript-operator">!=</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span>
  <span class="uscript-operator">{</span>
    Log<span class="uscript-operator">(</span><span class="uscript-string">"Dosomething called with an non empty description"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    <span class="uscript-keyword">return</span> <span class="uscript-keyword">true</span><span class="uscript-operator">;</span>
  <span class="uscript-operator">}</span>
  <span class="uscript-keyword">return</span> <span class="uscript-keyword">false</span><span class="uscript-operator">;</span>
<span class="uscript-operator">}</span></pre><p>MyFirstModule implements the methods Init and DoSomething, the other methods are left to it's default. In Init we just say that we have loaded. </p>
<p>In DoSomething we add a log line when the description is not empty, and return true. Because we return true we will prevent other Modules to be called. If description is not empty we will return false and give other modules a chance.</p>
<h2><a name="0.4"></a>Releasing a SDK</h2>
<p>When you release your mod it's very wise to provide documentation on how the modules work and how somebody can extend them. Provide the source of the base class(es) with this documentation, document every function declared.</p>
<p><em class="em2">Solid Snake:</em> This is what Chaos Engine is doing.</p>
<h2><a name="0.5"></a>Related Topics</h2>
<ul><li><a href="making-mods.html">Making Mods</a></li>
</ul>
<script type="text/javascript"><!--
 menuItemAdd("Modularity", "#0.1");
menuItemAdd("Main class", "#0.2");
menuItemAdd("Base Module Class", "#0.3");
menuItemAdd("<tt>&nbsp;&nbsp;</tt>A module", "#0.3.1");
menuItemAdd("Releasing a SDK", "#0.4");
menuItemAdd("Related Topics", "#0.5");
 menuWrite() //--></script></div>
</div>

<div id="footer" class="bar">
	<p><form method="post" action="http://wiki.beyondunreal.com/wiki" enctype="application/x-www-form-urlencoded">
<a href="(start).html">Home Page</a> | <a href="recent-changes.html">Recent Changes</a> | <a href="http://wiki.beyondunreal.com/wiki?action=editprefs">Preferences</a><br>
<a href="http://wiki.beyondunreal.com/wiki?action=edit&id=Modular_Mod">Edit text of this page</a> | <a href="http://wiki.beyondunreal.com/wiki?action=history&id=Modular_Mod">View other revisions</a><br>Last edited December 2, 2005 21:37 <a href="http://wiki.beyondunreal.com/wiki?action=browse&diff=1&id=Modular_Mod">(diff)</a><br>Search: <input type="text" name="search"  size="20" /><input type="hidden" name="dosearch" value="1"  /><br><br><small><a href="http://wiki.beyondunreal.com/wiki/Modular_Mod">Original page</a> &#150; copy created Sat, Jun 23, 2007</small><div></div>
</form>
	</p>
	<p>Worst-case scenario: the UEd Goblin wipes the map and burns down your house.
</p>
</div>
</div><!-- close of "scrolling" div -->

<div id="quickbar">
	<div id="logo"><a href="http://wiki.beyondunreal.com/"><img src="shared/wikilogo.jpg" width="143" height="100" border="0"></a>
		</div>
	<div class="qbsitename">
		<p>The Unreal Engine Documentation Site</p>
	</div>
	<div class="qbsection">
<p><a href="metatopics.html">Wiki Community</a></p>
<p><a href="category-category.html">Topic Categories</a></p>
<p><a href="/cgi-bin/imageupload.cgi/wiki-ext/imageupload.htt" target="_blank ">Image Uploads</a></p>
<p><a href="http://wiki.beyondunreal.com/wiki?action=random">Random Page</a></p>
<p><a href="recent-changes.html">Recent Changes</a></p>
<p><a href="offline-wiki.html">Offline Wiki</a></p>
</div><div class="qbsection">
<p><a href="unreal-engine.html">Unreal Engine</a></p>
<p><a href="console-commands.html">Console Commands</a></p>
<p><a href="terminology.html">Terminology</a></p>
<p><a href="category-faq.html">FAQs</a></p>
<p><a href="help-desk.html">Help Desk</a></p>
</div><div class="qbsection">
<p><a href="topics-on-mapping.html">Mapping Topics</a></p>
<p><a href="mapping-lessons.html">Mapping Lessons</a></p>
<p><a href="unrealed-3.html">UnrealEd Interface</a></p>
</div><div class="qbsection">
<p><a href="unrealscript.html">UnrealScript Topics</a></p>
<p><a href="unrealscript-lessons.html">UnrealScript Lessons</a></p>
<p><a href="making-mods.html">Making Mods</a></p>
<p><a href="class-tree.html">Class Tree</a></p>
</div><div class="qbsection">
<p><a href="topics-on-modeling.html">Modeling Topics</a></p>
</div><div class="qbsection">
<p><a href="chongqing-page.html">Chongqing Page</a></p>
<p><a href="log-in.html">Log In</a></p></div>
</div>

</body></html>
