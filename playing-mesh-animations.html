<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"  "http://www.w3.org/TR/html4/loose.dtd">

<html>
<head lang="en">
	<title>UnrealWiki: Playing Mesh Animations</title>
	<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
	<link rel="stylesheet" type="text/css" media="screen, print"
		href="shared/stylebase.structural.css">	
	<link rel="stylesheet" type="text/css" media="screen"
		href="shared/template-default.css">
	<link rel="stylesheet" type="text/css" media="screen"
		href="shared/styles.chblue.css">
	<link rel="stylesheet" type="text/css" media="print"
		href="shared/template-default-print.css">
	<!--[if IE 6]>
			<style>
			/* dirty hack for IE6. */
			#quickbar {
				position: absolute;
				}
			</style>
	<![endif]-->
  <link rel="start" href="http://wiki.beyondunreal.com/">
  <link rel="glossary"  href="http://wiki.beyondunreal.com/wiki/Terminology">
  <link rel="help"  href="http://wiki.beyondunreal.com/wiki/Using_The_Wiki">
<script type="text/javascript" src="shared/dhtml.js"></script>
<script type="text/javascript" src="shared/dhtml-menu.js"></script>
<style type="text/css">#dhtml-menu    { background: #eee; padding: 5px 0px; margin-right: -20px; border: 1px solid #888; border-left: 1px solid #ccc; border-top: 1px solid #ccc;  border-right: 1px solid #888; border-bottom: 1px solid #888 }
#dhtml-menu td { color: #000; font-family: Arial,Helvetica,sans-serif; font-size: 9pt; line-height: 13pt; padding: 1px 10px; cursor: default }
#dhtml-menu a  { color: #000; font-family: Arial,Helvetica,sans-serif; font-size: 9pt; line-height: 13pt; text-decoration: none }
#dhtml-menu tt { font-family: monospace; font-size: 9pt }
#dhtml-menu-separator { height: 1px; background: red }
#dhtml-menu-anchor { cursor: default }
</style>
<script type="text/javascript" src="shared/expandable.js"></script>
</head>
<body onLoad="menuInit(); document.cookie='page=Playing_Mesh_Animations; path=/'" class="default">
<div id="scrolling"><!-- contains all except the fixed sidebar -->
<div id="topbar"  class="bar">
	<div class="righthalf">
		<form class="inline" method="post" action="/wiki" enctype="application/x-www-form-urlencoded"><input type="text" name="search"  size="20" /> <input type="submit" name="search" value="search" /></form>
	</div>
	<div class="lefthalf">
		<script type="text/javascript"><!--
			menuAlignRight = false;
		//--></script>
		<span><script type="text/javascript"><!--
 menuWriteAnchor("Quick Navigation") //--></script></span> | <a href="(start).html">Home Page</a> | <a href="recent-changes.html">Recent Changes</a> | <a href="http://wiki.beyondunreal.com/wiki?action=editprefs">Preferences</a>
	</div>
</div>

<div id="content"><!-- contains the title and article -->
	<h1 class='pagetitle'><a href="http://wiki.beyondunreal.com/wiki?back=Playing Mesh Animations">Playing Mesh Animations</a></h1>
	<div class="wiki"><p><em class="em1">I tried for nearly a month to figure out how to do this and finally came to the conclusion that there is no one tutorial out there that tells you how to get an Animated Static Mesh into the Unreal game. All of the information was scattered in bits and pieces here and there. I decided that instead of squirreling the information away and becoming highly in demand in the field of Unreal gaming development, like a sucker, I would just give it away on the Wiki, so other young punks can take advantage of all my heartache and hard work.</em></p>
<p><em class="em2">Musicalglass</em>: The final tutorial you see here has been modified several times over. I came here with a roughly working solution based on what info I could find, and a lot of questions. Thanks largely to the contributions of Foxpaw and Chip, it has been synthesized into a new solution than the traditional method of extending a decoration or mover class, etc.  thereby eliminating declaring a lot of unnecessary variables with each new actor.</p>
<p><em class="em2">Solid Snake</em>: Well, your kind of missing the point of static meshes if your trying to animate them as such. The keyword is static. They don't change. Once you start animating things your changing the mesh as such...</p>
<hr class="thick"><p>This tutorial deals specifically with getting an Animated SkeletalMesh to actually play in the game Unreal. I will also show you how to attach a trigger, and use a few different trigger conditions.</p>
<p>As of this writing, in the current Editor (UT2003) it is impossible to get an animation into and have it play in the game. That is, not without getting your feet wet with Unreal Script.</p>
<h2><a name="0.1"></a>Prerequisites</h2>
<p>First we will assume a few things:</p>
<ol><li>You know what the <a href="animation-browser.html">Animation Browser</a> is, you've seen animations play in the window and can't figure out how to actually get one into your Map </li>
<li>You've already worked with regular <a href="static-mesh.html">Static Mesh</a>es and know how to apply Textures and get those into your Map OK </li>
<li>You are familiar with a 3D application or are trying to learn how to use <a href="maya.html">Maya</a> PLE and have your own animation you would like to get into the game. </li>
</ol>
<p>We will not assume that you know how to extend Actor Classes or run a compiler from a command prompt or know much of anything about programming for that matter.</p>
<h2><a name="0.2"></a>Compatible Applications</h2>
<p>Currently the only application which can export mesh animations compatible with Unreal is Milkshape, a little $25 3D application. Milkshape is also useful if you want to export any of the existing models that come with Unreal and convert to another format. Of note, it is also compatible with gMax files, the free version of 3DSMax.</p>
<p>If you're using Max or Maya, you'll need the ActorX plugin.</p>
<p>Users of Lightwave etc. would have to be able to export their models to one of the above formats.</p>
<p><em class="em2">Can I do it for free?</em>: You may have noticed that Maya PLE comes on the discs with Unreal. If you're familiar with Photoshop LE, etc. you're probably thinking that this is some kind of stripped down light version of Maya. Actually it is the complete version of Maya in all repects identical to the full version costing thousands of dollars, except for a few minor things:</p>
<ol><li>You don't get a couple of extra features, such as hair and cloth simulation.</li>
<li>Everything you try to output will have a very visible watermark over it, as well as everything you see in the viewports, preventing you from being able to take a screenshot of your work.</li>
</ol>
<p>However, everything you export to the game Unreal using the preloaded ActorX plugin will be perfectly usable. If you're considering a career in 3D, whether it be for games or movies or whatever, the industry will just as soon consider hiring someone with work which has a watermark all over it, if it's good modeling or animation.</p>
<h2><a name="0.3"></a>The Unreal World of Scripting</h2>
<p>OK, ready to get your feet wet with some hardcore coding?</p>
<p>Actually, we're going to let the folks at Epic provide most of our code for us, we just want to tack on a little extra. Traditionally, this has been acomplished by embedding links to all the model data using one of the extensions of the Actor class, such as a Decoration or Mover class. When I looked at the scripts for these methods it seemed that each class had a ton of extra varables associated with it which had nothing to do with the simple task of getting an animation to play. It occurred to me that a new extention to the Actor class specifically for various animation purposes would be useful. I suggested it on this Wiki and, with the help of Foxpaw and Chip have developed just that: an AnimatedActor class.</p>
<p>So we're going to make a very simple script and then compile it.</p>
<p>There are two methods to compile a script; </p>
<ol><li>the fairly simple method of compiling from the Unreal Editor</li>
<li>the slightly more technical method of compiling using ucc make from the DOS command prompt.</li>
</ol>
<p>Unfortunately since we are declaring some new variables, we must use the second method first. However, in order to avoid having to recompile each time from the command prompt, in keeping with the spirit of Object Oriented Programming we will compile a script which does one thing: display a simple placebo static mesh animation, this will act as a placeholder which you can swap for any animation you want later. Once we have the simple dummy script, we can further extend that into new variations like TriggerAnimatedActor. These simple extensions can be quickly compiled from the Editor.</p>
<h2><a name="0.4"></a>Animated Actor Script</h2>
<p>First, copy the following script, open up Notepad or your favorite <a href="text-editor.html">text editor</a> and paste:</p>
<pre class="uscript"><span class="uscript-keyword">class</span> AnimatedActor <span class="uscript-keyword">extends</span> Actor
    <span class="uscript-keyword">placeable</span><span class="uscript-operator">;</span>

<span class="uscript-comment">// You can manually add a trigger state here for one time use or </span>
<span class="uscript-comment">//  extend this class with a library of various AnimatedActor triggers </span>

<span class="uscript-keyword">var</span><span class="uscript-operator">(</span>InitialAnimation<span class="uscript-operator">)</span> <span class="uscript-type">name</span> AnimName<span class="uscript-operator">;</span> 
<span class="uscript-keyword">var</span><span class="uscript-operator">(</span>InitialAnimation<span class="uscript-operator">)</span> <span class="uscript-type">float</span> AnimRate<span class="uscript-operator">;</span> 
<span class="uscript-keyword">var</span> <span class="uscript-type">bool</span> TogglePlay<span class="uscript-operator">;</span>

 <span class="uscript-keyword">defaultproperties</span> 
 <span class="uscript-operator">{</span>
     bStatic<span class="uscript-operator">=</span><span class="uscript-keyword">False</span> 
     bNoDelete<span class="uscript-operator">=</span><span class="uscript-keyword">True</span> 
     bStasis<span class="uscript-operator">=</span><span class="uscript-keyword">False</span> 

     DrawType<span class="uscript-operator">=</span>DT_Mesh 
     Mesh<span class="uscript-operator">=</span>SkeletalMesh<span class="uscript-name">'myRotatingCube.myCubeMesh'</span> 

     AnimName<span class="uscript-operator">=</span><span class="uscript-name">'AnimSeq'</span> 
     AnimRate<span class="uscript-operator">=</span><span class="uscript-number">1</span> 
     TogglePlay<span class="uscript-operator">=</span><span class="uscript-keyword">True</span> 
 <span class="uscript-operator">}</span></pre><p>You will save the file as a text file, only instead of the .txt extension, change it to .uc</p>
<p>Do Save As, find your UT2003 folder on your hard drive and create a new folder in there called AnimatedActor. Inside that create 3 more  folders called Classes, Models and Textures. Save as AnimatedActor.uc in YourHardDrive:/UT2003/AnimatedActor/Classes. </p>
<p>We're just about ready to compile, but first we need to create the Animation Package and replace the PackageName.SkeletalMeshName. I could have just as easily typed that in there for you, but I wanted you to see the relationship to the Animation Browser.</p>
<h2><a name="0.5"></a>Exporting with ActorX </h2>
<p>To begin with for the purpose of this tutorial, we will start with a very simple exported animation. This will be your dummy animation for the purpose of compiling a placeable mesh into your script. Make a quick 256 X 256 Texture in Photoshop or your favorite graphics app, something quick like a gradient or something, don't get all artsy on me, and save it as a .tga file in YourHardDrive:/UT2003/AnimatedActor/Textures. In your 3D application, first make a simple polygon cube, triangulate and texture your model and add a single bone skeleton. Set a keyframe on frame 0, go to frame 4, rotate it 360 degrees and set a keyframe. and you are ready for export. (Remember if your model consists of parts they must first be grouped, N/A here)</p>
<p>Assuming you are using Max or Maya:</p>
<p>In the 3D application's command line, type:</p>
<pre class="paraverbatim"> axmain</pre><p>This brings up the ActorX window and you can export your model as myCubeMesh.PSK in YourHardDrive:/UT2003/AnimatedActor/Models. To export your animation, we'll set the File Name ( myCubeAnim ) the sequence name ( AnimSeq ) and the range ( 1-4 ) Note, we didn't include frame zero, as it is identical to frame 4. This is how to make a perfect looping animation. Click the Digest Animation button, open the animation manager, transfer it from the Animations to the Output Package folder and Save as myCubeAnim.PSA.</p>
<h2><a name="0.6"></a>Assemble in the Animation Manager</h2>
<p>Now we will combine all the elements of our animation. Import your texture into the Texture Browser and save your texture package. Switch over to the Animation Browser and do File &rarr; Mesh Import. Open your myCubeMesh.PSK model. </p>
<p>Let's call our Animation package RotatingCube. In the Mesh Properties down the right side, expand Skin &rarr; Material and click on (0) Some buttons appear. Click the Use button. If you don't see the Use button you may need to resize the window and everything in the Mesh tab will disappear. To get it back click on one of the other tabs and back again. </p>
<p>Now do File &rarr; Animation Import and get your .PSA file into the same package. </p>
<p>Do Edit &rarr; Link Up Animation and Mesh. Now if you expand Animation in the Mesh properties you should see the name of your animation. </p>
<p>If it says None, you can make it pop in by going to File &rarr; Mesh import a second time, select the name of your file and click Cancel. </p>
<p>Now that you have your texture and animation info associated with your Mesh you can save the animation package in Unreal's default Animation folder. Note in the Animation Browser window just above your model you can see the name of your package and mesh. It should read: RotatingCube.myCubeMesh. Now that we have a working animation and package name, we can use that as a temporary placeholder in our first script. So open up the script you created earlier, replace the PackageName and SkeletalMeshName with your own and save and you're ready to compile.</p>
<h2><a name="0.7"></a>Compile Your Script </h2>
<p>OK, so far we've only spent something like an hour doing a simple thing like getting an animation into our map (or maybe weeks if it took you a while to locate this tutorial). Whatever! We're almost there. Our script is all ready to place in the game. We just need to compile it so Unreal can read it. Sounds intimidating if you're not a programmer but it's actually quite simple.</p>
<p>First we need to tell the compiler what to compile, so with your text editor, Open UT2003/System/UT2003.ini. Scroll down to about line 350 or so and you see a list of package names to be compiled like this:</p>
<p>EditPackages=Vehicles</p>
<p>Underneath the last one in the list add a new line and insert your own edit package command to the list:</p>
<p>EditPackages=Vehicles</p>
<p>EditPackages=AnimatedActor</p>
<p>Now save the file and go to your command prompt: On Windows, I believe you'll find that in your Start menu under Programs &rarr; Accessories.</p>
<p>( I forget cause I moved mine long ago to the Start menu itself ) </p>
<p>In the command prompt enter:</p>
<p>cd ut2003\system (Note: backslash not forward slash)</p>
<p>You should be taken to the Unreal system directory. Enter:</p>
<p>ucc make</p>
<p>Unreal should compile your script if all went well. If not you'll see an error in the command prompt window. If you do get an error and have to do something over, you may have to edit and save the UT2003.ini file again before compiling.</p>
<h2><a name="0.8"></a>Placing your AnimatedActor</h2>
<p>Open the Actor Class Browser: In the Actor Classes window do File &rarr; Open Package. You should find your newly compiled AnimatedActor.u Open it and expand the Actor hierarchy. You should now see your new AnimatedActor class in the list. Select it. Now you could right click in your map and select AnimatedActor and you should now be able to place your default cube into your map. Now that you have your AnimatedActor with a valid default Animation Package, you can open it up and swap out a different Animation Package by first placing it in the scene, then double click on it to open the AnimatedActor Properties, expand Display and update the SkeletalMesh.</p>
<p>For extensibility, the AnimatedActor itself does not play the animation. In order to add more options to what you can do with the basic Actor you can now add extensions to the extension.</p>
<h2><a name="0.9"></a>Subclassing from Unreal Editor - Looping Animation Script</h2>
<p>Copy the following script:</p>
<pre class="uscript"><span class="uscript-keyword">class</span> LoopMovie <span class="uscript-keyword">extends</span> AnimatedActor
    <span class="uscript-keyword">placeable</span><span class="uscript-operator">;</span>

<span class="uscript-comment">// ========================================</span>
<span class="uscript-comment">// This bit makes the Animation play automatically at startup</span>
<span class="uscript-comment">// ========================================</span>
 <span class="uscript-keyword">simulated</span> <span class="uscript-keyword">function</span> PostBeginPlay<span class="uscript-operator">(</span><span class="uscript-operator">)</span> 

 <span class="uscript-operator">{</span> 
     LoopAnim<span class="uscript-operator">(</span> AnimName<span class="uscript-operator">,</span> AnimRate <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
     <span class="uscript-keyword">Super</span><span class="uscript-operator">.</span>PostBeginPlay<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
 <span class="uscript-operator">}</span>
<span class="uscript-comment">// ======================================== </span></pre><p>In the Actor Class Browser, right click on your AnimatedActor class and select New. Set the package to myLevel and the name to LoopMovie. Select the entire script and paste the new one. In the Script Editor window Do Tools &rarr; Compile Changed.</p>
<p>That's it! Much simpler that the previous compiling method. You should now be able to add your newly compiled script to any map. When you start a new level it will not appear by default in the Actor Class browser. Simply import LoopMovie.u and it will automatically load the parent AnimatedActor class as well. Expand that, and you can have a whole list of subclasses.</p>
<p>Now, <a href="create-a-room.html">create a room</a> or open a map. Select LoopMovie from the Actor window and right click place in your scene. Your newly created default Skeletal Mesh Animation should pop into the scene. Double click on it to open it's properties. You will see in the LoopMovie Properties we have added a new category to Actor called InitialAnimation. </p>
<p>Expand InitialAnimation and verify that the sequence name matches that of your animation (AnimSeq). </p>
<p>You should now be able to play your map and see your movie play automatically. A pretty rapidly spinning cube. Go back to the editor and change the animation rate to a low number like 0.15. You should now have a much slower animation. Note how unreal interpolates the tweening instead of seeing a choppy 4 frame animation. </p>
<p>Here's a few more subclasses of AnimatedActor you can add to your arsenal;</p>
<h3><a name="0.9.1"></a>Adding a Trigger </h3>
<pre class="uscript"><span class="uscript-keyword">class</span> TriggerMovieOn <span class="uscript-keyword">extends</span> AnimatedActor
    <span class="uscript-keyword">placeable</span><span class="uscript-operator">;</span>

<span class="uscript-comment">// ========================================</span>
<span class="uscript-comment">// Trigger Animation On - Starts in the off state, then triggers on one time</span>
<span class="uscript-comment">// To make it on then off, swap the lines that say LoopAnim &amp; StopAnimating</span>
<span class="uscript-comment">// ========================================</span>
<span class="uscript-keyword">simulated</span> <span class="uscript-keyword">function</span> PostBeginPlay<span class="uscript-operator">(</span><span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
StopAnimating<span class="uscript-operator">(</span>  <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
     <span class="uscript-keyword">Super</span><span class="uscript-operator">.</span>PostBeginPlay<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-operator">}</span>

<span class="uscript-keyword">function</span> Trigger<span class="uscript-operator">(</span> actor Other<span class="uscript-operator">,</span> pawn EventInstigator <span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
     LoopAnim<span class="uscript-operator">(</span> AnimName<span class="uscript-operator">,</span> AnimRate <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-operator">}</span>
<span class="uscript-comment">// ======================================== </span></pre><p>In the Actor Class Browser, expand Trigger and select Trigger and add it to your scene. Open the Trigger properties and set the Event tag to TagName and the Tag to None. Open your animated mesh's properties and set the Tag to None and the Event to TagName.</p>
<h3><a name="0.9.2"></a>Trigger On &amp; Off &amp; On...</h3>
<p>Here's a few more variations for trigger behaviour;</p>
<pre class="uscript"><span class="uscript-keyword">class</span> OnOffMovie <span class="uscript-keyword">extends</span> AnimatedActor
    <span class="uscript-keyword">placeable</span><span class="uscript-operator">;</span>

<span class="uscript-comment">// ========================================</span>
<span class="uscript-comment">// Trigger Animation On &amp; Off &amp; On, etc....</span>
<span class="uscript-comment">// ========================================</span>
<span class="uscript-comment">// this section deativates the animation until triggered</span>
<span class="uscript-comment">// can be turned on &amp; off &amp; on, etc.</span>
<span class="uscript-comment">// once triggered off, it will stop immediately</span>
<span class="uscript-comment">// to make it start with the movie on, change TogglePlay=true to false in the default properties</span>

<span class="uscript-keyword">function</span> Trigger<span class="uscript-operator">(</span> actor Other<span class="uscript-operator">,</span> pawn EventInstigator <span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
<span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>TogglePlay<span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
     LoopAnim<span class="uscript-operator">(</span> AnimName<span class="uscript-operator">,</span> AnimRate <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
     TogglePlay<span class="uscript-operator">=</span><span class="uscript-keyword">False</span><span class="uscript-operator">;</span>
<span class="uscript-operator">}</span>
<span class="uscript-keyword">else</span>
<span class="uscript-operator">{</span>
     StopAnimating<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
     TogglePlay<span class="uscript-operator">=</span><span class="uscript-keyword">True</span><span class="uscript-operator">;</span>
<span class="uscript-operator">}</span>
<span class="uscript-operator">}</span>
<span class="uscript-comment">// ========================================</span></pre><h3><a name="0.9.3"></a>Finish Playing First</h3>
<pre class="uscript"><span class="uscript-keyword">class</span> PlayAllMovie <span class="uscript-keyword">extends</span> AnimatedActor
    <span class="uscript-keyword">placeable</span><span class="uscript-operator">;</span>
<span class="uscript-comment">// ========================================</span>
<span class="uscript-comment">// Trigger Animation on &amp; off - finish playing first</span>
<span class="uscript-comment">// ========================================</span>
<span class="uscript-comment">// this section deativates the animation until triggered</span>
<span class="uscript-comment">// can be turned on &amp; off &amp; on, etc.</span>
<span class="uscript-comment">// once triggered off, it will complete the animation before stopping</span>
<span class="uscript-comment">// to make it start with the movie on, change TogglePlay=true to false in the default properties</span>

<span class="uscript-keyword">function</span> Trigger<span class="uscript-operator">(</span> actor Other<span class="uscript-operator">,</span> pawn EventInstigator <span class="uscript-operator">)</span>

<span class="uscript-operator">{</span> 
     <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>TogglePlay<span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
     LoopAnim<span class="uscript-operator">(</span> AnimName<span class="uscript-operator">,</span> AnimRate <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
     TogglePlay<span class="uscript-operator">=</span><span class="uscript-keyword">False</span><span class="uscript-operator">;</span>
<span class="uscript-operator">}</span>
<span class="uscript-keyword">else</span>
<span class="uscript-operator">{</span> 
     AnimStopLooping<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> 
     TogglePlay<span class="uscript-operator">=</span><span class="uscript-keyword">True</span><span class="uscript-operator">;</span> 
<span class="uscript-operator">}</span> 
<span class="uscript-operator">}</span>
<span class="uscript-comment">// ========================================</span></pre><p>Here's a small expansion on the idea, using Touch() to progressively speed up the animation:</p>
<pre class="uscript"><span class="uscript-comment">//=============================================================================</span>
<span class="uscript-comment">// Accelerate Animation</span>
<span class="uscript-comment">//=============================================================================</span>
<span class="uscript-keyword">class</span> AccelAnim <span class="uscript-keyword">extends</span> AnimatedActor
    <span class="uscript-keyword">placeable</span><span class="uscript-operator">;</span>

<span class="uscript-keyword">event</span> Touch<span class="uscript-operator">(</span> Actor Other <span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
     AnimRate <span class="uscript-operator">+=</span> <span class="uscript-number">0.1</span><span class="uscript-operator">;</span>
     LoopAnim<span class="uscript-operator">(</span> AnimName<span class="uscript-operator">,</span> AnimRate <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-operator">}</span></pre><p>this is very bare-bones but illustrates how the anim rate can be changed by an event.</p>
<p>Under Development - 12/01/03 ~~~ This is a work in progress. If any of you hardcore coders can come up with any more trigger variations or effects, that would be really cool.</p>
<p>Please feel free to contact me at <a href="mailto:musicalglass@hotmail.com">musicalglass@hotmail.com</a> if you find any errors, or if you think there's not enough info in spots or too much which is already covered thoroughly elsewhere on the WIKI or even if you're the one person out there who actually found this info useful. </p>
<h2><a name="0.10"></a>Related Topics</h2>
<ul><li><a href="animation.html">Animation</a></li>
<li><a href="mesh.html">Mesh</a></li>
</ul>
<h2><a name="0.11"></a>Discussion</h2>
<h3><a name="0.11.1"></a>Under Development</h3>
<p>I wanted to make a carousel animation which you can turn on and off with a trigger. Once triggered, it will slowly accelerate to a given speed, loop for a bit, then deccelerate. But if triggered a second time, it will go directly to deccelerate mode. Foxpaw has been helping with the development.</p>
<p>Here is the current script:</p>
<pre class="uscript"><span class="uscript-keyword">class</span> EaseInOut <span class="uscript-keyword">extends</span> Actor <span class="uscript-keyword">placeable</span><span class="uscript-operator">;</span>

<span class="uscript-keyword">var</span><span class="uscript-operator">(</span>EaseInOut<span class="uscript-operator">)</span> <span class="uscript-type">name</span> AnimName<span class="uscript-operator">;</span>
<span class="uscript-keyword">var</span> <span class="uscript-type">float</span> AnimRate<span class="uscript-operator">;</span>

<span class="uscript-keyword">var</span><span class="uscript-operator">(</span>EaseInOut<span class="uscript-operator">)</span> <span class="uscript-type">float</span> MaxAnimRate<span class="uscript-operator">;</span>
<span class="uscript-keyword">var</span><span class="uscript-operator">(</span>EaseInOut<span class="uscript-operator">)</span> <span class="uscript-type">float</span> AccelerateRate<span class="uscript-operator">;</span>
<span class="uscript-keyword">var</span><span class="uscript-operator">(</span>EaseInOut<span class="uscript-operator">)</span> <span class="uscript-type">float</span> DecelerateRate<span class="uscript-operator">;</span>

<span class="uscript-keyword">auto</span> <span class="uscript-keyword">state</span> Off
<span class="uscript-operator">{</span>
  <span class="uscript-keyword">simulated</span> <span class="uscript-keyword">function</span> Tick<span class="uscript-operator">(</span> <span class="uscript-type">float</span> Delta <span class="uscript-operator">)</span>
  <span class="uscript-operator">{</span>
     AnimRate <span class="uscript-operator">=</span> FMax<span class="uscript-operator">(</span>  AnimRate <span class="uscript-operator">-</span> <span class="uscript-operator">(</span>Delta <span class="uscript-operator">*</span> DecelerateRate<span class="uscript-operator">)</span><span class="uscript-operator">,</span> <span class="uscript-number">0</span> <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
     LoopAnim<span class="uscript-operator">(</span> AnimName<span class="uscript-operator">,</span> AnimRate <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
     <span class="uscript-keyword">Global</span><span class="uscript-operator">.</span>Tick<span class="uscript-operator">(</span> Delta <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
     <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span> AnimRate <span class="uscript-operator">&gt;</span> <span class="uscript-number">0</span> <span class="uscript-operator">)</span>
       Level<span class="uscript-operator">.</span>Game<span class="uscript-operator">.</span>Broadcast<span class="uscript-operator">(</span> <span class="uscript-keyword">None</span><span class="uscript-operator">,</span> <span class="uscript-string">"I'm off and my animrate is "</span><span class="uscript-operator">$</span>AnimRate<span class="uscript-operator">,</span> <span class="uscript-name">'Say'</span> <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
  <span class="uscript-operator">}</span>

<span class="uscript-keyword">simulated</span> <span class="uscript-keyword">function</span> Trigger<span class="uscript-operator">(</span> actor Other<span class="uscript-operator">,</span> pawn EventInstigator <span class="uscript-operator">)</span>

  <span class="uscript-operator">{</span>
     Level<span class="uscript-operator">.</span>Game<span class="uscript-operator">.</span>Broadcast<span class="uscript-operator">(</span> <span class="uscript-keyword">None</span><span class="uscript-operator">,</span> <span class="uscript-string">"I got triggered!"</span><span class="uscript-operator">,</span> <span class="uscript-name">'Say'</span> <span class="uscript-operator">)</span><span class="uscript-operator">;</span>

      GotoState<span class="uscript-operator">(</span> <span class="uscript-name">'On'</span> <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
  <span class="uscript-operator">}</span>
<span class="uscript-operator">}</span>

<span class="uscript-keyword">state</span> On
<span class="uscript-operator">{</span>
  <span class="uscript-keyword">simulated</span> <span class="uscript-keyword">function</span> Tick<span class="uscript-operator">(</span> <span class="uscript-type">float</span> Delta <span class="uscript-operator">)</span>
  <span class="uscript-operator">{</span>
     AnimRate <span class="uscript-operator">=</span> FMax<span class="uscript-operator">(</span> AnimRate <span class="uscript-operator">+</span> <span class="uscript-operator">(</span>Delta <span class="uscript-operator">*</span> AccelerateRate<span class="uscript-operator">)</span><span class="uscript-operator">,</span> MaxAnimRate <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
     <span class="uscript-keyword">Global</span><span class="uscript-operator">.</span>Tick<span class="uscript-operator">(</span> Delta <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
     LoopAnim<span class="uscript-operator">(</span> AnimName<span class="uscript-operator">,</span> AnimRate <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
     Level<span class="uscript-operator">.</span>Game<span class="uscript-operator">.</span>Broadcast<span class="uscript-operator">(</span> <span class="uscript-keyword">None</span><span class="uscript-operator">,</span> <span class="uscript-string">"I'm on and my animrate is "</span><span class="uscript-operator">$</span>AnimRate<span class="uscript-operator">,</span> <span class="uscript-name">'Say'</span> <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
  <span class="uscript-operator">}</span>

  Begin:
    Sleep<span class="uscript-operator">(</span><span class="uscript-number">5</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    GotoState<span class="uscript-operator">(</span> <span class="uscript-name">'Off'</span> <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-operator">}</span>

<span class="uscript-keyword">defaultproperties</span>
<span class="uscript-operator">{</span>
     bStatic<span class="uscript-operator">=</span><span class="uscript-keyword">False</span> 
     bNoDelete<span class="uscript-operator">=</span><span class="uscript-keyword">True</span> 
     bStasis<span class="uscript-operator">=</span><span class="uscript-keyword">False</span>

     DrawType<span class="uscript-operator">=</span>DT_Mesh
     Mesh<span class="uscript-operator">=</span>SkeletalMesh<span class="uscript-name">'PackageName.SkeletalMeshName'</span> 

     AnimName<span class="uscript-operator">=</span><span class="uscript-name">'AnimSeq'</span>
     AnimRate<span class="uscript-operator">=</span><span class="uscript-number">0</span>

     AccelerateRate<span class="uscript-operator">=</span><span class="uscript-number">0.5</span>
     DecelerateRate<span class="uscript-operator">=</span><span class="uscript-number">0.5</span>
     MaxAnimRate<span class="uscript-operator">=</span><span class="uscript-number">1</span>
<span class="uscript-operator">}</span></pre><p><em class="em2">Musicalglass</em>: I changed MaxRotationRate to MaxAnimRate to get the script to compile. I noticed I was getting multiple trigger commands so I added a delay in the Trigger properties, which I have found useful for on / off scripts like this. I was getting "I got triggered" to the screen OK but no "I'm on..." so I removed  if ( Other != None &amp;&amp; Other.IsA( 'xPawn' ) ) reasoning that it must have been a part of another script you copied from as there are no xPawns involved here, and it worked perfectly. However, it may zero out on any frame. Once it has come to a complete stop, it snaps to frame 0 to prepare for the next Play command. It would be neccesary to make it so either it will always end on frame 4, or when triggered again will resume playing from the current frame. Also I wanted to add, If Triggered a second time Go To Deccelerate. If I want it to play music while turning that will probably have to go into the script as well.</p>
<p>You were saying that using translation and rotation on a mesh was not a good idea because of the way the video card handles it. Since Movers use this method, would you say then that all movers are problematic and that the best way is always to use bones and animate in an external 3D app? Then using a mesh and scripting to do different effects with PHYS_Rotate etc. would not be a good idea for a scripting tutorial as I would be using a method which is not practical for everyday use, correct?</p>
<p>Also, do you know if there's a way to attach additional objects to the bone of my skeletal mesh, so I can hang additional animated and non anim meshes to my carousel?</p>
<p>I can't seem to get the Touch function to work. I can't find very many examples around. The Hello World tutorial shows you how to write to a log. It should work OK with a Actor class right? It has a default collision radius and everything.</p>
<pre class="uscript"><span class="uscript-keyword">class</span> TouchMovieOn <span class="uscript-keyword">extends</span> AnimatedActor
    <span class="uscript-keyword">placeable</span><span class="uscript-operator">;</span>

<span class="uscript-keyword">function</span> PostBeginPlay<span class="uscript-operator">(</span><span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
StopAnimating<span class="uscript-operator">(</span> <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-keyword">Super</span><span class="uscript-operator">.</span>PostBeginPlay<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-operator">}</span>

<span class="uscript-keyword">function</span> Touch<span class="uscript-operator">(</span> actor Other<span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
     LoopAnim<span class="uscript-operator">(</span> AnimName<span class="uscript-operator">,</span> AnimRate <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-operator">}</span></pre><p>I also tried doing my own simple Hello world using the Message broadcast method desribed by Foxpaw for debugging:</p>
<pre class="uscript"><span class="uscript-keyword">class</span> HelloWorld <span class="uscript-keyword">extends</span> Actor
    <span class="uscript-keyword">placeable</span><span class="uscript-operator">;</span>
<span class="uscript-keyword">function</span> Touch<span class="uscript-operator">(</span> actor Other <span class="uscript-operator">)</span>

  <span class="uscript-operator">{</span>
     Level<span class="uscript-operator">.</span>Game<span class="uscript-operator">.</span>Broadcast<span class="uscript-operator">(</span> <span class="uscript-keyword">None</span><span class="uscript-operator">,</span> <span class="uscript-string">"I've been touched!"</span><span class="uscript-operator">,</span> <span class="uscript-name">'Say'</span> <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
  <span class="uscript-operator">}</span></pre><p>Am I missing something? Does Broadcast only work in conjuction with another action?</p>
<p>Also I was a bit confused about saving your script in myLevel. So that means that the file is saved with the map. So then each time somebody wants to create a new map with the same class they would reimport it into myLevel again or copy it out of the existing map?</p>
<p><em class="em2">Foxpaw:</em> That should work, maybe the actor isn't getting the Touch() call. A fairly easy way to check if it is broadcasting right would be to stick something in PostBeginPlay() or maybe Tick - functions that are pretty much guaranteed to get called. ANd yes, the myLevel package works as you've described it.</p>
<p><em class="em2">Musicalglass:</em> I was thinking about this problem with the carousel snapping to frame 1 on start. It would seem that what I need is a Pause and Resume feature.  As there isn't one supplied I was thinking a possible way to create one would be instead of turning LoopAnim on and off you would freeze and unfreeze the frame rate and LoopAnim would always be true. So you would what, make it so once the frame rate reached zero it would go to sleep mode so it wouldn't eat up ticks, right? Would that work?</p>
<p><em class="em2">Foxpaw:</em> If you are animating the carousel via LoopAnim, I think that should work. However, I wouldn't worry about it getting Ticks, because you can't really prevent it, (It still gets Ticked even while in a latent function like sleep) and also it doesn't really do any harm. If the tick function isn't doing anything, the overhead from the Tick call is very minimal.</p>
<p><em class="em2">Clintonman:</em> I removed the 'Say' argument and the broadcast worked for me.  With 'Say' it only showed in the console.</p>
<pre class="paraverbatim">   Level.Game.Broadcast( None, "I've been touched!");   </pre><hr class="thin"><p><a href="category-tutorial.html">Category Tutorial</a></p>
<p><a href="category-mapping.html">Category Mapping</a></p>
<script type="text/javascript"><!--
 menuItemAdd("Prerequisites", "#0.1");
menuItemAdd("Compatible Applications", "#0.2");
menuItemAdd("The Unreal World of Scripting", "#0.3");
menuItemAdd("Animated Actor Script", "#0.4");
menuItemAdd("Exporting with ActorX ", "#0.5");
menuItemAdd("Assemble in the Animation Manager", "#0.6");
menuItemAdd("Compile Your Script ", "#0.7");
menuItemAdd("Placing your AnimatedActor", "#0.8");
menuItemAdd("Subclassing from Unreal Editor - Looping Animation Script", "#0.9");
menuItemAdd("<tt>&nbsp;&nbsp;</tt>Adding a Trigger ", "#0.9.1");
menuItemAdd("<tt>&nbsp;&nbsp;</tt>Trigger On &amp; Off &amp; On...", "#0.9.2");
menuItemAdd("<tt>&nbsp;&nbsp;</tt>Finish Playing First", "#0.9.3");
menuItemAdd("Related Topics", "#0.10");
menuItemAdd("Discussion", "#0.11");
menuItemAdd("<tt>&nbsp;&nbsp;</tt>Under Development", "#0.11.1");
 menuWrite() //--></script></div>
</div>

<div id="footer" class="bar">
	<p><form method="post" action="http://wiki.beyondunreal.com/wiki" enctype="application/x-www-form-urlencoded">
<a href="(start).html">Home Page</a> | <a href="recent-changes.html">Recent Changes</a> | <a href="http://wiki.beyondunreal.com/wiki?action=editprefs">Preferences</a><br>
<a href="http://wiki.beyondunreal.com/wiki?action=edit&id=Playing_Mesh_Animations">Edit text of this page</a> | <a href="http://wiki.beyondunreal.com/wiki?action=history&id=Playing_Mesh_Animations">View other revisions</a><br>Last edited April 7, 2006 3:34 <a href="http://wiki.beyondunreal.com/wiki?action=browse&diff=1&id=Playing_Mesh_Animations">(diff)</a><br>Search: <input type="text" name="search"  size="20" /><input type="hidden" name="dosearch" value="1"  /><br><br><small><a href="http://wiki.beyondunreal.com/wiki/Playing_Mesh_Animations">Original page</a> &#150; copy created Sat, Jun 23, 2007</small><div></div>
</form>
	</p>
	<p>Mostly Harmless
</p>
</div>
</div><!-- close of "scrolling" div -->

<div id="quickbar">
	<div id="logo"><a href="http://wiki.beyondunreal.com/"><img src="shared/wikilogo.jpg" width="143" height="100" border="0"></a>
		</div>
	<div class="qbsitename">
		<p>The Unreal Engine Documentation Site</p>
	</div>
	<div class="qbsection">
<p><a href="metatopics.html">Wiki Community</a></p>
<p><a href="category-category.html">Topic Categories</a></p>
<p><a href="/cgi-bin/imageupload.cgi/wiki-ext/imageupload.htt" target="_blank ">Image Uploads</a></p>
<p><a href="http://wiki.beyondunreal.com/wiki?action=random">Random Page</a></p>
<p><a href="recent-changes.html">Recent Changes</a></p>
<p><a href="offline-wiki.html">Offline Wiki</a></p>
</div><div class="qbsection">
<p><a href="unreal-engine.html">Unreal Engine</a></p>
<p><a href="console-commands.html">Console Commands</a></p>
<p><a href="terminology.html">Terminology</a></p>
<p><a href="category-faq.html">FAQs</a></p>
<p><a href="help-desk.html">Help Desk</a></p>
</div><div class="qbsection">
<p><a href="topics-on-mapping.html">Mapping Topics</a></p>
<p><a href="mapping-lessons.html">Mapping Lessons</a></p>
<p><a href="unrealed-3.html">UnrealEd Interface</a></p>
</div><div class="qbsection">
<p><a href="unrealscript.html">UnrealScript Topics</a></p>
<p><a href="unrealscript-lessons.html">UnrealScript Lessons</a></p>
<p><a href="making-mods.html">Making Mods</a></p>
<p><a href="class-tree.html">Class Tree</a></p>
</div><div class="qbsection">
<p><a href="topics-on-modeling.html">Modeling Topics</a></p>
</div><div class="qbsection">
<p><a href="chongqing-page.html">Chongqing Page</a></p>
<p><a href="log-in.html">Log In</a></p></div>
</div>

</body></html>
