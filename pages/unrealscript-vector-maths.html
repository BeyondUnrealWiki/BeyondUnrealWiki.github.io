<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"  "http://www.w3.org/TR/html4/loose.dtd">

<html>
<head lang="en">
	<title>UnrealWiki: UnrealScript Vector Maths</title>
	<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
	<link rel="stylesheet" type="text/css" media="screen, print"
		href="shared/stylebase.structural.css">	
	<link rel="stylesheet" type="text/css" media="screen"
		href="shared/template-default.css">
	<link rel="stylesheet" type="text/css" media="screen"
		href="shared/styles.chblue.css">
	<link rel="stylesheet" type="text/css" media="print"
		href="shared/template-default-print.css">
	<!--[if IE 6]>
			<style>
			/* dirty hack for IE6. */
			#quickbar {
				position: absolute;
				}
			</style>
	<![endif]-->
  <link rel="start" href="http://wiki.beyondunreal.com/">
  <link rel="glossary"  href="http://wiki.beyondunreal.com/wiki/Terminology">
  <link rel="help"  href="http://wiki.beyondunreal.com/wiki/Using_The_Wiki">
<script type="text/javascript" src="shared/dhtml.js"></script>
<script type="text/javascript" src="shared/dhtml-menu.js"></script>
<style type="text/css">#dhtml-menu    { background: #eee; padding: 5px 0px; margin-right: -20px; border: 1px solid #888; border-left: 1px solid #ccc; border-top: 1px solid #ccc;  border-right: 1px solid #888; border-bottom: 1px solid #888 }
#dhtml-menu td { color: #000; font-family: Arial,Helvetica,sans-serif; font-size: 9pt; line-height: 13pt; padding: 1px 10px; cursor: default }
#dhtml-menu a  { color: #000; font-family: Arial,Helvetica,sans-serif; font-size: 9pt; line-height: 13pt; text-decoration: none }
#dhtml-menu tt { font-family: monospace; font-size: 9pt }
#dhtml-menu-separator { height: 1px; background: red }
#dhtml-menu-anchor { cursor: default }
</style>
<script type="text/javascript" src="shared/expandable.js"></script>
</head>
<body onLoad="menuInit(); document.cookie='page=UnrealScript_Vector_Maths; path=/'" class="default">
<div id="scrolling"><!-- contains all except the fixed sidebar -->
<div id="topbar"  class="bar">
	<div class="righthalf">
		<form class="inline" method="post" action="/wiki" enctype="application/x-www-form-urlencoded"><input type="text" name="search"  size="20" /> <input type="submit" name="search" value="search" /></form>
	</div>
	<div class="lefthalf">
		<script type="text/javascript"><!--
			menuAlignRight = false;
		//--></script>
		<span><script type="text/javascript"><!--
 menuWriteAnchor("Quick Navigation") //--></script></span> | <a href="../index.html">Home Page</a> | <a href="recent-changes.html">Recent Changes</a>
	</div>
</div>

<div id="content"><!-- contains the title and article -->
	<h1 class='pagetitle'><a href="http://wiki.beyondunreal.com/wiki?back=UnrealScript Vector Maths">UnrealScript Vector Maths</a></h1>
	<div class="wiki"><p>This is a page of "how to I do foo" sort of things, for values of "foo" involving points, <a href="vector.html">vector</a>s, <a href="rotator.html">rotator</a>s, <a href="quaternion.html">quaternion</a>s, etc. Add question, post pseudocode / <a href="unrealscript.html">UnrealScript</a> code.</p>
<p>And as we sometimes say... "it's not rocket science!". Except in this case, it is <img alt=";)" src="emoticons/wink.gif" align="middle">.</p>
<p>In the following:</p>
<ul><li><em class="em2">A</em> and <em class="em2">B</em> are points in space. These could be Actors.</li>
<li><em class="em2">a</em> and <em class="em2">b</em> are vectors for the positions of these points respectively (e.g. <code>A.Location</code>) </li>
</ul>
<h2><a name="0.1"></a>Some basic work with locations</h2>
<p>In these diagrams, vectors that represent:</p>
<ul><li>positions are shown in blue</li>
<li>orientations are shown in green</li>
</ul>
<p>The vector you're after is usually in black.</p>
<h3><a name="0.1.1"></a>A vector that points from <em class="em2">A</em> to <em class="em2">B</em></h3>
<pre class="uscript">vector <span class="uscript-operator">=</span> b <span class="uscript-operator">-</span> a<span class="uscript-operator">;</span></pre><div class="floatimages"><table border=0 cellspacing=0 cellpadding=0 align=center width=1><tr valign=top><td class="floatimages-block"><div><img alt="[vectors-AtoB]" src="images/vectors-atob.png"></div>
</td>
</tr>
</table>
</div>
<p>The simple way to visualize this is to imagine you want to travel from point A to point B, using the vectors you already have. You travel along a backwards, so -a and then along b. This gives -a + b, which is equal to b - a.</p>
<h3><a name="0.1.2"></a>A unit vector pointing from <em class="em2">A</em> to <em class="em2">B</em></h3>
<p>Take the expression from above and normalize it:</p>
<pre class="uscript">vector <span class="uscript-operator">=</span> Normal<span class="uscript-operator">(</span>b <span class="uscript-operator">-</span> a<span class="uscript-operator">)</span><span class="uscript-operator">;</span></pre><h3><a name="0.1.3"></a>The distance between <em class="em2">A</em> and <em class="em2">B</em></h3>
<p>Simply find the length of the vector:</p>
<pre class="uscript">distance <span class="uscript-operator">=</span> VSize<span class="uscript-operator">(</span>a <span class="uscript-operator">-</span> b<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
distance <span class="uscript-operator">=</span> VSize<span class="uscript-operator">(</span>b <span class="uscript-operator">-</span> a<span class="uscript-operator">)</span><span class="uscript-operator">;</span></pre><p>The order doesn't matter here, since the length of a vector is always positive.</p>
<p><em class="em2">Devi:</em></p>
<p>Note that the VSize function is relatively slow since it involves a square root (it uses pythagoras theorem: L^2 = X^2 + Y^2 + Z^2). If you just want to compare the distance between two points to another length (i.e. you want to say "Is the distance between A and B less than 100 units?") then you can speed up the operation by using VSizeSq, which returns the squared length of a vector (it does the same as VSize but leaves out the final square root operation) and by squaring the distance you're comparing to as well. So "Is the length less than 100?" becomes "Is the squared length less than 100 squared?" for example:</p>
<pre class="uscript"><span class="uscript-keyword">function</span> DistanceLessThanOneHundred<span class="uscript-operator">(</span>vector a<span class="uscript-operator">,</span> vector b<span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
   <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>VSizeSq<span class="uscript-operator">(</span>a<span class="uscript-operator">-</span>b<span class="uscript-operator">)</span> <span class="uscript-operator">&lt;</span> <span class="uscript-number">10000</span><span class="uscript-operator">)</span>
   <span class="uscript-operator">{</span>
      <span class="uscript-keyword">return</span> <span class="uscript-keyword">true</span><span class="uscript-operator">;</span>
   <span class="uscript-operator">}</span>
   <span class="uscript-keyword">else</span>
   <span class="uscript-operator">{</span>
      <span class="uscript-keyword">return</span> <span class="uscript-keyword">false</span><span class="uscript-operator">;</span>
   <span class="uscript-operator">}</span>
<span class="uscript-operator">}</span></pre><p>or even </p>
<pre class="uscript"><span class="uscript-keyword">function</span> <span class="uscript-type">bool</span> IsDistanceLessThan<span class="uscript-operator">(</span>vector a<span class="uscript-operator">,</span> vector b<span class="uscript-operator">,</span> <span class="uscript-type">float</span> distance<span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
   <span class="uscript-keyword">return</span> <span class="uscript-operator">(</span>VSizeSq<span class="uscript-operator">(</span>a<span class="uscript-operator">-</span>b<span class="uscript-operator">)</span> <span class="uscript-operator">&lt;</span> distance<span class="uscript-operator">*</span><span class="uscript-operator">*</span><span class="uscript-number">2</span> <span class="uscript-operator">)</span>
<span class="uscript-operator">}</span></pre><p><em class="em2">Wormbo:</em> This just calls for a little optimization warning. Your "VSizeSq" function does not exist in UT2004 and would have to be written in UnrealScript, like this:</p>
<pre class="uscript"><span class="uscript-keyword">static</span> <span class="uscript-keyword">final</span> <span class="uscript-keyword">function</span> <span class="uscript-type">float</span> VSizeSq<span class="uscript-operator">(</span>vector A<span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
  <span class="uscript-keyword">return</span> Square<span class="uscript-operator">(</span>A<span class="uscript-operator">.</span>X<span class="uscript-operator">)</span> <span class="uscript-operator">+</span> Square<span class="uscript-operator">(</span>A<span class="uscript-operator">.</span>Y<span class="uscript-operator">)</span> <span class="uscript-operator">+</span> Square<span class="uscript-operator">(</span>A<span class="uscript-operator">.</span>Z<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-operator">}</span></pre><p>The problem with this is: it's an UnrealScript function. That means, it's already slower than the corresponding native implementation. When using this function, there's one UnrealScript function call (the function itself) as well as 5 native function calls (three times the Square function and twice the operator +). I dare to say that this eats up the benefits of not performing the square root operation on the result.</p>
<p><em class="em2">Devi:</em> I'm working with the Unreal 2.X engine, maybe VSizeSq only exists in that version, apologies for any confusion...</p>
<p>Anyhows, if you want to make your own version of VSizeSQ then the fastest way to do it in UScript is to do the following:</p>
<pre class="uscript"><span class="uscript-keyword">function</span> <span class="uscript-type">float</span> VSizeSq<span class="uscript-operator">(</span>Vector a<span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
  <span class="uscript-keyword">return</span> a <span class="uscript-operator">dot</span> a<span class="uscript-operator">;</span>
<span class="uscript-operator">}</span></pre><p>Which is only one native operator call, hurrah <img alt=":D" src="emoticons/biggrin.gif" align="middle"> As you say with functions being slow to call, you may want to just directly insert "myVector dot myVector" into your code rather than putting it into a seperate function...</p>
<p>(Wormbo, hope you don't mind but I corrected your code sample and comments so that your version of VSizeSq worked with only one vector as it should, rather than working with two)</p>
<p><em class="em2">Wormbo:</em> Oh right, thanks. <img alt=":)" src="emoticons/smile.gif" align="middle"> BTW: I've just tested the execution speed of <tt>x dot x</tt> versus <tt>VSize(x)</tt>:</p>
<pre class="uscript"><span class="uscript-keyword">function</span> <span class="uscript-type">int</span> Main<span class="uscript-operator">(</span><span class="uscript-type">string</span> Args<span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
  <span class="uscript-keyword">local</span> vector v<span class="uscript-operator">;</span>
  <span class="uscript-keyword">local</span> <span class="uscript-type">float</span> f<span class="uscript-operator">;</span>
  <span class="uscript-keyword">local</span> <span class="uscript-type">int</span> i<span class="uscript-operator">,</span> j<span class="uscript-operator">;</span>
  
  <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>j <span class="uscript-operator">=</span> <span class="uscript-number">0</span><span class="uscript-operator">;</span> j <span class="uscript-operator">&lt;</span> <span class="uscript-number">3</span><span class="uscript-operator">;</span> j<span class="uscript-operator">++</span><span class="uscript-operator">)</span> <span class="uscript-operator">{</span>
    log<span class="uscript-operator">(</span><span class="uscript-string">"Test "</span> <span class="uscript-operator">$</span> j<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    i <span class="uscript-operator">=</span> <span class="uscript-type">int</span><span class="uscript-operator">(</span>Args<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    StopWatch<span class="uscript-operator">(</span><span class="uscript-keyword">false</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    <span class="uscript-keyword">while</span> <span class="uscript-operator">(</span>i<span class="uscript-operator">--</span> <span class="uscript-operator">&gt;</span> <span class="uscript-number">0</span><span class="uscript-operator">)</span> <span class="uscript-operator">{</span>
      v <span class="uscript-operator">=</span> <span class="uscript-number">1000</span> <span class="uscript-operator">*</span> VRand<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
      f <span class="uscript-operator">=</span> VSize<span class="uscript-operator">(</span>v<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>
    StopWatch<span class="uscript-operator">(</span><span class="uscript-keyword">true</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    
    i <span class="uscript-operator">=</span> <span class="uscript-type">int</span><span class="uscript-operator">(</span>Args<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    StopWatch<span class="uscript-operator">(</span><span class="uscript-keyword">false</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    <span class="uscript-keyword">while</span> <span class="uscript-operator">(</span>i<span class="uscript-operator">--</span> <span class="uscript-operator">&gt;</span> <span class="uscript-number">0</span><span class="uscript-operator">)</span> <span class="uscript-operator">{</span>
      v <span class="uscript-operator">=</span> <span class="uscript-number">1000</span> <span class="uscript-operator">*</span> VRand<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
      f <span class="uscript-operator">=</span> v <span class="uscript-operator">Dot</span> v<span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>
    StopWatch<span class="uscript-operator">(</span><span class="uscript-keyword">true</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
  <span class="uscript-operator">}</span>
  <span class="uscript-keyword">return</span> <span class="uscript-number">0</span><span class="uscript-operator">;</span>
<span class="uscript-operator">}</span></pre><p>Output:</p>
<table class="paratable-border" border=0 cellspacing=0 cellpadding=0><tr valign=top><td><pre>
D:\UT2004\System&gt;ucc test.test 100000
Executing Class test.TestCommandlet
Test 0
Time=55.081175 ms
Time=61.303065 ms
Test 1
Time=54.837094 ms
Time=60.095937 ms
Test 2
Time=54.314674 ms
Time=60.696120 ms

D:\UT2004\System&gt;ucc test.test 10000
Executing Class test.TestCommandlet
Test 0
Time=5.410266 ms
Time=5.997695 ms
Test 1
Time=5.466540 ms
Time=7.278457 ms
Test 2
Time=5.332435 ms
Time=6.241699 ms

D:\UT2004\System&gt;ucc test.test 1000
Executing Class test.TestCommandlet
Test 0
Time=0.573987 ms
Time=0.569542 ms
Test 1
Time=0.529024 ms
Time=0.590087 ms
Test 2
Time=0.557979 ms
Time=0.596532 ms

D:\UT2004\System&gt;ucc test.test 100
Executing Class test.TestCommandlet
Test 0
Time=0.068894 ms
Time=0.062653 ms
Test 1
Time=0.051611 ms
Time=0.060420 ms
Test 2
Time=0.053945 ms
Time=0.061406 ms

D:\UT2004\System&gt;ucc test.test 10
Executing Class test.TestCommandlet
Test 0
Time=0.020546 ms
Time=0.006913 ms
Test 1
Time=0.014280 ms
Time=0.006459 ms
Test 2
Time=0.005833 ms
Time=0.005924 ms

D:\UT2004\System&gt;ucc test.test 1
Executing Class test.TestCommandlet
Test 0
Time=0.015603 ms
Time=0.001598 ms
Test 1
Time=0.001807 ms
Time=0.001216 ms
Test 2
Time=0.001130 ms
Time=0.001585 ms

D:\UT2004\System&gt;
</pre></td>
</tr>
</table>
<p>Interestingly, loop execution seems to become faster after the first iteration.</p>
<p><em class="em2">Devi:</em> lol, my old boss would be proud of you, he always said you should *always* do timings on things if you're having arguments about optimisations <img alt=":)" src="emoticons/smile.gif" align="middle"> </p>
<p>Anyhows, I've only been using UScript for a week or so (I'm a C++ programmer by training) and I can give no explanation at all for the results you get from that test. The fact that when you did the operation once you found that VSize was about 10 times slower than Dot is what I would have expected, but the fact that the more you do it, the faster VSize gets compared to Dot (even overtaking it in speed) implies something very odd must be happening under the hood of the UC virtual machine...</p>
<p><em class="em2">Switch:</em> The fastest square dist method I found was bit slower than VSize. BTW, some category for pages on profiling would be welcome, putting this in comments adds a lot of noise to the document.</p>
<pre class="uscript"><span class="uscript-keyword">function</span> Profile<span class="uscript-operator">(</span><span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
    <span class="uscript-keyword">local</span> <span class="uscript-type">int</span> a<span class="uscript-operator">,</span>b<span class="uscript-operator">;</span>
    <span class="uscript-keyword">local</span> vector va<span class="uscript-operator">,</span>vb<span class="uscript-operator">;</span>
    
    va <span class="uscript-operator">=</span> <span class="uscript-keyword">vect</span><span class="uscript-operator">(</span><span class="uscript-number">1234.5678</span><span class="uscript-operator">,</span><span class="uscript-operator">-</span><span class="uscript-number">9012.3456</span><span class="uscript-operator">,</span><span class="uscript-number">7890.1234</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> 
    vb <span class="uscript-operator">=</span> <span class="uscript-keyword">vect</span><span class="uscript-operator">(</span><span class="uscript-operator">-</span><span class="uscript-number">5678.9012</span><span class="uscript-operator">,</span><span class="uscript-number">3456.7890</span><span class="uscript-operator">,</span><span class="uscript-operator">-</span><span class="uscript-number">1234.5678</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    
    <span class="uscript-keyword">for</span><span class="uscript-operator">(</span>a<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span> a<span class="uscript-operator">&lt;</span><span class="uscript-number">20</span><span class="uscript-operator">;</span> <span class="uscript-operator">++</span>a<span class="uscript-operator">)</span> <span class="uscript-operator">{</span> stopwatch<span class="uscript-operator">(</span><span class="uscript-keyword">false</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
        <span class="uscript-comment">//for(b=0; b&lt;10000; ++b) {          </span>
        <span class="uscript-comment">//if( ((va-vb)dot(va-vb)) &lt; 1000000 ){}</span>
        <span class="uscript-comment">//if( VSize(va-vb) &lt; 1000 ){}           </span>
        <span class="uscript-comment">//}                                     </span>
    stopwatch<span class="uscript-operator">(</span><span class="uscript-keyword">true</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-operator">}</span>  
<span class="uscript-operator">}</span></pre><pre>
Build: 3355 commandlet
Commandline: start /REALTIME /B ucc sandbox.sandbox

LOOP 20x1, ((va-vb)dot(va-vb)) &lt; 1000000
Time=0.008693 ms
Time=0.001483 ms
Time=0.001213 ms ...

LOOP 20x1, VSize(va-vb) &lt; 1000
Time=0.008144 ms
Time=0.001159 ms
Time=0.001023 ms ...

LOOP 20x10000, ((va-vb)dot(va-vb)) &lt; 1000000
Time=7.056599 ms
Time=6.996057 ms
Time=6.992126 ms ...

LOOP 20x10000, VSize(va-vb) &lt; 1000
Time=4.834834 ms
Time=4.831398 ms
Time=4.831604 ms ...
</pre><p><em class="em2">Foxpaw:</em> Loops get faster with a greater number of iterations because of CPU caching and an increased probability of TLB hits. For this reason I always "precache" things when I profile them, IE running the test twice and keeping the second result. (Unless I need "real world numbers" and it's time consuming enough to be measured on a single iteration.) Ideally you could test with a clean cache every time, but manually flushing the cache and TLB can't really be done from within an operating system such as Windows or Linux, (let alone from within UScript) so I run my tests fully cached.</p>
<h2><a name="0.2"></a>Orientations</h2>
<h3><a name="0.2.1"></a>A unit vector pointing in the direction a player is looking: </h3>
<pre class="uscript">vector <span class="uscript-operator">=</span> vector<span class="uscript-operator">(</span>myPlayerController<span class="uscript-operator">.</span>GetViewRotation<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span></pre><h3><a name="0.2.2"></a>Rotate Actor <em class="em2">A</em> to face point <em class="em2">B</em></h3>
<pre class="uscript">a <span class="uscript-operator">=</span> A<span class="uscript-operator">.</span>location<span class="uscript-operator">;</span>
b <span class="uscript-operator">=</span> B<span class="uscript-operator">.</span>location
A<span class="uscript-operator">.</span>SetRotation<span class="uscript-operator">(</span>rotator<span class="uscript-operator">(</span>b <span class="uscript-operator">-</span> a<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span></pre><div class="floatimages"><table border=0 cellspacing=0 cellpadding=0 align=center width=1><tr valign=top><td class="floatimages-block"><div><img alt="[vectors-AorienttoB]" src="images/vectors-aorienttob.png"></div>
</td>
</tr>
</table>
</div>
<hr class="thin"><p>Things from below here need clarifying....</p>
<h3><a name="0.2.3"></a>...find where <em class="em2">B</em> is in relation to <em class="em2">A</em>?: </h3>
<pre class="uscript">actor A<span class="uscript-operator">,</span> B<span class="uscript-operator">;</span>
vector aFacing<span class="uscript-operator">,</span>aToB<span class="uscript-operator">;</span>

<span class="uscript-comment">// What direction is A facing in?</span>
aFacing<span class="uscript-operator">=</span>Normal<span class="uscript-operator">(</span>Vector<span class="uscript-operator">(</span>A<span class="uscript-operator">.</span>Rotation<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-comment">// Get the vector from A to B</span>
aToB<span class="uscript-operator">=</span>B<span class="uscript-operator">.</span>Location<span class="uscript-operator">-</span>A<span class="uscript-operator">.</span>Location<span class="uscript-operator">;</span>

orientation <span class="uscript-operator">=</span> aFacing <span class="uscript-operator">dot</span> aToB<span class="uscript-operator">;</span>
  <span class="uscript-comment">// &gt; 0.0  B is in front of A</span>
  <span class="uscript-comment">// = 0.0  B is exactly to the right/left of A </span>
  <span class="uscript-comment">// &lt; 0.0  B is behind A</span></pre><p>The code above functions using the mathematic law that states that if you dot product a normalised vector (which I'll call N) with another vector (which I'll V), the result will be the length of V along direction N. We work out a normal vector that points in the same direction as A is facing, then for V we calculate the vector that leads from A to B. Now, if the result is positive then we know that V must be travelling at least a little in the same direction as N (therefore B is in front of A). If the result is 0 then V isn't travelling along N at all (i.e. it must be at right angles to it). Finally if the result is negative then we know that V must be travelling at least a little in the opposite direction of N (meaning B is behind A).</p>
<h3><a name="0.2.4"></a>...find where Actor A is in relation to Pawn B, taking into account B's ViewRotation? <em class="em1">(make sure Pawn B has a Controller)</em>: </h3>
<pre class="uscript">orientation <span class="uscript-operator">=</span> vector<span class="uscript-operator">(</span>B<span class="uscript-operator">.</span>Controller<span class="uscript-operator">.</span>GetViewRotation<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">dot</span> Normal<span class="uscript-operator">(</span>A<span class="uscript-operator">.</span>Location <span class="uscript-operator">-</span> B<span class="uscript-operator">.</span>Location<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
  <span class="uscript-comment">// &gt; 0.0  A points forwards in relation to B (up to 90° apart)</span>
  <span class="uscript-comment">// = 0.0  A is perpendicular to B (exactly 90° between A and B)</span>
  <span class="uscript-comment">// &lt; 0.0  A points backwards in relation to B (more than 90° apart)</span></pre><p><em class="em2">Question:</em> How do I know if its to the Left or Right?</p>
<p><em class="em2">Devi:</em> This code works exactly the same way as the code in the previous section. Now, if you think about it, the question: Is it to the left or right? Can be solved in the same way as the question: Is it in front of me or behind me? You just need to use a vector that points left/right instead of one that points forwards:</p>
<pre class="uscript"><span class="uscript-keyword">local</span> vector lateral<span class="uscript-operator">;</span>

<span class="uscript-comment">// Get facing vector</span>
lateral<span class="uscript-operator">=</span>vector<span class="uscript-operator">(</span>B<span class="uscript-operator">.</span>Controller<span class="uscript-operator">.</span>GetViewRotation<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-comment">// Rotate 90 degrees in XZ, I'm going to assume (probably wrongly) that this lateral vector will point to the left of the facing, but it COULD be facing to the right</span>
<span class="uscript-comment">// in which case the answers below are the wrong way round...</span>
lateral<span class="uscript-operator">=</span>lateral <span class="uscript-operator">cross</span> <span class="uscript-keyword">vect</span><span class="uscript-operator">(</span><span class="uscript-number">0</span><span class="uscript-operator">,</span><span class="uscript-number">0</span><span class="uscript-operator">,</span><span class="uscript-number">1</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>

orientation <span class="uscript-operator">=</span> lateral <span class="uscript-operator">dot</span> Normal<span class="uscript-operator">(</span>A<span class="uscript-operator">.</span>Location <span class="uscript-operator">-</span> B<span class="uscript-operator">.</span>Location<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
  <span class="uscript-comment">// &gt; 0.0  A sits to the left of B</span>
  <span class="uscript-comment">// = 0.0  A is in front of/behind B (exactly 90° between A and B)</span>
  <span class="uscript-comment">// &lt; 0.0  A sits to the right of B</span></pre><h3><a name="0.2.5"></a>...find a point that's at a certain distance from a starting point in a given direction? : </h3>
<pre class="uscript">LocationTarget <span class="uscript-operator">=</span> LocationStart <span class="uscript-operator">+</span> vector<span class="uscript-operator">(</span>Rotation<span class="uscript-operator">)</span> <span class="uscript-operator">*</span> Distance<span class="uscript-operator">;</span></pre><h3><a name="0.2.6"></a>...find the (smallest) angle between <em class="em2">A</em> and <em class="em2">B</em>? </h3>
<p>Note: Acos is a built-in function in <a href="unreal-tournament-2003.html">UT2003</a>. It is not present in <a href="unreal-tournament.html">UT</a>, see <a href="useful-maths-functions.html">Useful Maths Functions</a>.<br>This assumes A and B are normalized (are unit vectors).  If either of them is not normalized you need to wrap them in a Normal().<br></p>
<pre class="uscript">angle_radians <span class="uscript-operator">=</span> Acos<span class="uscript-operator">(</span>A <span class="uscript-operator">dot</span> B<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
angle_degrees <span class="uscript-operator">=</span> Acos<span class="uscript-operator">(</span>A <span class="uscript-operator">dot</span> B<span class="uscript-operator">)</span> <span class="uscript-operator">*</span> <span class="uscript-number">180</span><span class="uscript-operator">/</span>pi<span class="uscript-operator">;</span></pre><p><em class="em2">DemonThing:</em> Just wanted to point out that the vector <em class="em2">A</em> dot <em class="em2">B</em> is defined as</p>
<pre class="uscript">A <span class="uscript-operator">dot</span> B <span class="uscript-operator">=</span> VSize<span class="uscript-operator">(</span>A<span class="uscript-operator">)</span> <span class="uscript-operator">*</span> VSize<span class="uscript-operator">(</span>B<span class="uscript-operator">)</span> <span class="uscript-operator">*</span> cos<span class="uscript-operator">(</span>angle<span class="uscript-operator">)</span>
<span class="uscript-comment">//or</span>
A <span class="uscript-operator">dot</span> B <span class="uscript-operator">=</span> <span class="uscript-keyword">vect</span><span class="uscript-operator">(</span>A<span class="uscript-operator">.</span>x <span class="uscript-operator">*</span> B<span class="uscript-operator">.</span>x<span class="uscript-operator">,</span> A<span class="uscript-operator">.</span>y <span class="uscript-operator">*</span> B<span class="uscript-operator">.</span>y<span class="uscript-operator">,</span> A<span class="uscript-operator">.</span>z <span class="uscript-operator">*</span> B<span class="uscript-operator">.</span>z<span class="uscript-operator">)</span></pre><p>if I remember correctly. Don't try this code out &ndash; it won't work!!! <img alt=":D" src="emoticons/biggrin.gif" align="middle"></p>
<p><em class="em2">Devi:</em> Umm, the result of <em class="em2">A</em> dot <em class="em2">B</em> is a float, not a vector. It's defined as:</p>
<pre class="uscript">A <span class="uscript-operator">dot</span> B <span class="uscript-operator">=</span> <span class="uscript-operator">(</span>A<span class="uscript-operator">.</span>x<span class="uscript-operator">*</span>B<span class="uscript-operator">.</span>x<span class="uscript-operator">)</span> <span class="uscript-operator">+</span> <span class="uscript-operator">(</span>A<span class="uscript-operator">.</span>y<span class="uscript-operator">*</span>B<span class="uscript-operator">.</span>y<span class="uscript-operator">)</span> <span class="uscript-operator">+</span> <span class="uscript-operator">(</span>A<span class="uscript-operator">.</span>z<span class="uscript-operator">*</span>B<span class="uscript-operator">.</span>z<span class="uscript-operator">)</span></pre><p>See <span class="interwiki"><img 
      alt="Wikipedia logo"
      title="Wikipedia"
      src="shared//InterWiki-Wikipedia.png">&nbsp;<a href="http://www.wikipedia.com/wiki/Dot product">Dot product</a></span>.</p>
<h3><a name="0.4.1"></a>...point to my left or right? : </h3>
<p>A vector that points at 90 degrees to the way you're looking can be given by the following. Note that it is horizontal; in the XY plane. (So for a rolling aeroplane, this <em class="em1">won't</em> point along the wing which will be slanted)</p>
<pre class="uscript"> resultingVector <span class="uscript-operator">=</span> Normal<span class="uscript-operator">(</span>vector <span class="uscript-operator">cross</span> <span class="uscript-keyword">vect</span><span class="uscript-operator">(</span><span class="uscript-number">0</span><span class="uscript-operator">,</span> <span class="uscript-number">0</span><span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span></pre><h3><a name="0.2.7"></a>...find out vector B that points x degrees to the left or right of vector A? </h3>
<p><em class="em2">Foxpaw:</em> I believe there are multiple vectors that could satisfy this. Can you be more specific?</p>
<p><em class="em2">Tarquin:</em> It depends on what you want &ndash; 'left' and 'right' doesn't mean much in 3D, it has to be on a plane. We can assume the horizontal though, as above.</p>
<p><em class="em2">smattbac:</em> Like in the example above this one, but instead of 90 degrees, any angle (or less than 90).</p>
<p><em class="em2">Tarquin:</em> Get a normal of the direction you're pointing in. Call it <em class="em2">i</em>. Get the 90 degrees to the left one. Call it <em class="em2">j</em>. Do some sine and cosine mojo with them.</p>
<p><em class="em2">Foxpaw:</em> I think it would be something along the lines of:</p>
<pre class="uscript">  Normal<span class="uscript-operator">(</span><span class="uscript-operator">(</span>Normal<span class="uscript-operator">(</span>vector<span class="uscript-operator">)</span> <span class="uscript-operator">*</span> <span class="uscript-operator">(</span><span class="uscript-number">1</span> <span class="uscript-operator">-</span> <span class="uscript-operator">(</span>AngleInDegrees <span class="uscript-operator">/</span> <span class="uscript-number">90</span><span class="uscript-operator">)</span> <span class="uscript-operator">)</span> <span class="uscript-operator">)</span> <span class="uscript-operator">+</span> <span class="uscript-operator">(</span>Normal<span class="uscript-operator">(</span>vector <span class="uscript-operator">cross</span> <span class="uscript-keyword">vect</span><span class="uscript-operator">(</span><span class="uscript-number">0</span><span class="uscript-operator">,</span> <span class="uscript-number">0</span><span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">*</span> <span class="uscript-operator">(</span>AngleInDegrees <span class="uscript-operator">/</span> <span class="uscript-number">90</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span></pre><p>I'm not sure if that would work or not. It seems to work for 0 degrees, 90 degrees, and 45 degrees, but I don't know if it will work for other ones or not.</p>
<p><em class="em2">Tarquin:</em> eek. What you need is this: i*cos(alpha) + j*sin(alpha). Alpha is angle in radians, obviously</p>
<h3><a name="0.2.8"></a>Rotate a rotator by another rotator</h3>
<p><em class="em2">Dirk Fist:</em> Ok, I have a demo (UT) map that shows arbitrary rotation in object coordinates, Its 10k </p>
<pre class="uscript"><span class="uscript-keyword">function</span> rotator rTurn<span class="uscript-operator">(</span>rotator rHeading<span class="uscript-operator">,</span>rotator rTurnAngle<span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
    <span class="uscript-comment">// Generate a turn in object coordinates </span>
    <span class="uscript-comment">//     this should handle any gymbal lock issues</span>

    <span class="uscript-keyword">local</span> vector vForward<span class="uscript-operator">,</span>vRight<span class="uscript-operator">,</span>vUpward<span class="uscript-operator">;</span>
    <span class="uscript-keyword">local</span> vector vForward2<span class="uscript-operator">,</span>vRight2<span class="uscript-operator">,</span>vUpward2<span class="uscript-operator">;</span>
    <span class="uscript-keyword">local</span> rotator T<span class="uscript-operator">;</span>
    <span class="uscript-keyword">local</span> vector  V<span class="uscript-operator">;</span>

    GetAxes<span class="uscript-operator">(</span>rotation<span class="uscript-operator">,</span>vForward<span class="uscript-operator">,</span>vRight<span class="uscript-operator">,</span>vUpward<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    <span class="uscript-comment">//  rotate in plane that contains vForward&amp;vRight</span>
    T<span class="uscript-operator">.</span>Yaw<span class="uscript-operator">=</span>rTurnAngle<span class="uscript-operator">.</span>Yaw<span class="uscript-operator">;</span> V<span class="uscript-operator">=</span>vector<span class="uscript-operator">(</span>T<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    vForward2<span class="uscript-operator">=</span>V<span class="uscript-operator">.</span>X<span class="uscript-operator">*</span>vForward <span class="uscript-operator">+</span> V<span class="uscript-operator">.</span>Y<span class="uscript-operator">*</span>vRight<span class="uscript-operator">;</span>
    vRight2<span class="uscript-operator">=</span>V<span class="uscript-operator">.</span>X<span class="uscript-operator">*</span>vRight <span class="uscript-operator">-</span> V<span class="uscript-operator">.</span>Y<span class="uscript-operator">*</span>vForward<span class="uscript-operator">;</span>
    vUpward2<span class="uscript-operator">=</span>vUpward<span class="uscript-operator">;</span>

    <span class="uscript-comment">// rotate in plane that contains vForward&amp;vUpward</span>
    T<span class="uscript-operator">.</span>Yaw<span class="uscript-operator">=</span>rTurnAngle<span class="uscript-operator">.</span>Pitch<span class="uscript-operator">;</span> V<span class="uscript-operator">=</span>vector<span class="uscript-operator">(</span>T<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    vForward<span class="uscript-operator">=</span>V<span class="uscript-operator">.</span>X<span class="uscript-operator">*</span>vForward2 <span class="uscript-operator">+</span> V<span class="uscript-operator">.</span>Y<span class="uscript-operator">*</span>vUpward2<span class="uscript-operator">;</span>
    vRight<span class="uscript-operator">=</span>vRight2<span class="uscript-operator">;</span>
    vUpward<span class="uscript-operator">=</span>V<span class="uscript-operator">.</span>X<span class="uscript-operator">*</span>vUpward2 <span class="uscript-operator">-</span> V<span class="uscript-operator">.</span>Y<span class="uscript-operator">*</span>vForward2<span class="uscript-operator">;</span>

    <span class="uscript-comment">// rotate in plane that contains vUpward&amp;vRight</span>
    T<span class="uscript-operator">.</span>Yaw<span class="uscript-operator">=</span>rTurnAngle<span class="uscript-operator">.</span>Roll<span class="uscript-operator">;</span> V<span class="uscript-operator">=</span>vector<span class="uscript-operator">(</span>T<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    vForward2<span class="uscript-operator">=</span>vForward<span class="uscript-operator">;</span>
    vRight2<span class="uscript-operator">=</span>V<span class="uscript-operator">.</span>X<span class="uscript-operator">*</span>vRight <span class="uscript-operator">+</span> V<span class="uscript-operator">.</span>Y<span class="uscript-operator">*</span>vUpward<span class="uscript-operator">;</span>
    vUpward2<span class="uscript-operator">=</span>V<span class="uscript-operator">.</span>X<span class="uscript-operator">*</span>vUpward <span class="uscript-operator">-</span> V<span class="uscript-operator">.</span>Y<span class="uscript-operator">*</span>vRight<span class="uscript-operator">;</span>
    
    T<span class="uscript-operator">=</span>OrthoRotation<span class="uscript-operator">(</span>vForward2<span class="uscript-operator">,</span>vRight2<span class="uscript-operator">,</span>vUpward2<span class="uscript-operator">)</span><span class="uscript-operator">;</span>

   <span class="uscript-keyword">return</span><span class="uscript-operator">(</span>T<span class="uscript-operator">)</span><span class="uscript-operator">;</span>    
<span class="uscript-operator">}</span></pre><h3><a name="0.2.9"></a>...damp a velocity vector toward a surface? </h3>
<pre class="uscript">Velocity <span class="uscript-operator">+=</span> SurfaceNormal <span class="uscript-operator">*</span> <span class="uscript-operator">(</span>Normal<span class="uscript-operator">(</span>Velocity<span class="uscript-operator">)</span> <span class="uscript-operator">dot</span> SurfaceNormal<span class="uscript-operator">)</span> <span class="uscript-operator">*</span> DampFactor<span class="uscript-operator">;</span></pre><p>Useful DampFactor is &gt;=-1, where -1 will make Velocity parallel to the surface, 0 will do nothing, and positive values will give a "pop up" effect by making the Velocity vector point further from the plane of the surface.</p>
<h3><a name="0.2.10"></a>...find point Q where a normal from point P to a line from A to B meets the line? </h3>
<p>Given a line AB and a point P, we want to find a point Q on that line such that PQ and AB are perpendicular.</p>
<p><img alt="[normal_to_a_line_01]" src="images/normal-to-a-line-01.png" class="image-inline"></p>
<pre class="uscript">Q <span class="uscript-operator">=</span> A <span class="uscript-operator">+</span> Normal<span class="uscript-operator">(</span> B <span class="uscript-operator">-</span> A <span class="uscript-operator">)</span> <span class="uscript-operator">*</span> <span class="uscript-operator">(</span><span class="uscript-operator">(</span><span class="uscript-operator">(</span> B <span class="uscript-operator">-</span> A <span class="uscript-operator">)</span> <span class="uscript-operator">dot</span> <span class="uscript-operator">(</span> P <span class="uscript-operator">-</span> A <span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">/</span> VSize<span class="uscript-operator">(</span> A <span class="uscript-operator">-</span> B <span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span></pre><p>This is perfect for that railgun with shockwave damage you always wanted:</p>
<pre class="uscript"><span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>P <span class="uscript-operator">=</span> Level<span class="uscript-operator">.</span>PawnList<span class="uscript-operator">;</span> P <span class="uscript-operator">!=</span> <span class="uscript-keyword">None</span><span class="uscript-operator">;</span> P <span class="uscript-operator">=</span> P<span class="uscript-operator">.</span>NextPawn<span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
    Q <span class="uscript-operator">=</span> StartTrace <span class="uscript-operator">+</span> Normal<span class="uscript-operator">(</span> HitLocation <span class="uscript-operator">-</span> StartTrace <span class="uscript-operator">)</span> <span class="uscript-operator">*</span> <span class="uscript-operator">(</span><span class="uscript-operator">(</span><span class="uscript-operator">(</span> HitLocation <span class="uscript-operator">-</span> StartTrace <span class="uscript-operator">)</span>
    <span class="uscript-operator">dot</span> <span class="uscript-operator">(</span> P<span class="uscript-operator">.</span>Location <span class="uscript-operator">-</span> StartTrace <span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">/</span> VSize<span class="uscript-operator">(</span> StartTrace <span class="uscript-operator">-</span> HitLocation <span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>

    <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>VSize<span class="uscript-operator">(</span> P<span class="uscript-operator">.</span>Location <span class="uscript-operator">-</span> Q <span class="uscript-operator">)</span> <span class="uscript-operator">&lt;</span> ShockwaveRadius<span class="uscript-operator">)</span>
    <span class="uscript-operator">{</span>
        <span class="uscript-comment">// Pawn is within ShockwaveRadius, do your mojo!</span>
    <span class="uscript-operator">}</span>
<span class="uscript-operator">}</span></pre><p>Note: Point Q is not restricted to the length of line AB, so remember to check that the victims are in front of StartTrace and behind HitLocation for that railgun (unless you want it to go through the whole level in either direction, ofcourse...)</p>
<p><em class="em2">DemonThing:</em> Q is relative to the origin, assuming A, B, and P are as well. Observe:</p>
<p>See my definition of dot product above (the first one). You will see that (B - A) dot (P - A) is equal to VSize(B - A) * VSize(P - A) * cos(angle). Divide that by VSize(A - B) (which is equal to VSize(B - A)) and you get VSize(P - A) * cos(angle). If you know a bit of trigonometry, you will see that this is equal to VSize(Q - A). When you multiply that by Normal(B - A) (which is equal to Normal(Q - A), since A, B, and Q are collinear), you get Q - A. We add A to that and we get Q, which is a location vector.</p>
<h3><a name="0.2.11"></a>...only affect certain components of a vector?</h3>
<p>In UnrealScript there's a component-by-component vector multiplication. You can use it to either only use two components of a vector for an operation and/or ignore certain components of the result.</p>
<pre class="uscript"><span class="uscript-comment">// do something with A but don't change the Z component of it</span>
vector <span class="uscript-operator">=</span> <span class="uscript-keyword">vect</span><span class="uscript-operator">(</span><span class="uscript-number">1</span><span class="uscript-operator">,</span><span class="uscript-number">1</span><span class="uscript-operator">,</span><span class="uscript-number">0</span><span class="uscript-operator">)</span> <span class="uscript-operator">*</span> DoSomethingWith<span class="uscript-operator">(</span>A<span class="uscript-operator">)</span> <span class="uscript-operator">+</span> <span class="uscript-keyword">vect</span><span class="uscript-operator">(</span><span class="uscript-number">0</span><span class="uscript-operator">,</span><span class="uscript-number">0</span><span class="uscript-operator">,</span><span class="uscript-number">1</span><span class="uscript-operator">)</span> <span class="uscript-operator">*</span> A<span class="uscript-operator">;</span>

<span class="uscript-comment">// do something with the X and Z components of A</span>
vector <span class="uscript-operator">=</span> DoSomethingWith<span class="uscript-operator">(</span><span class="uscript-keyword">vect</span><span class="uscript-operator">(</span><span class="uscript-number">1</span><span class="uscript-operator">,</span><span class="uscript-number">0</span><span class="uscript-operator">,</span><span class="uscript-number">1</span><span class="uscript-operator">)</span> <span class="uscript-operator">*</span> A<span class="uscript-operator">)</span><span class="uscript-operator">;</span>

<span class="uscript-comment">// do something with the Y and Z components of a vector and use its original X component</span>
vector <span class="uscript-operator">=</span> <span class="uscript-keyword">vect</span><span class="uscript-operator">(</span><span class="uscript-number">0</span><span class="uscript-operator">,</span><span class="uscript-number">1</span><span class="uscript-operator">,</span><span class="uscript-number">1</span><span class="uscript-operator">)</span> <span class="uscript-operator">*</span> DoSomethingWith<span class="uscript-operator">(</span><span class="uscript-keyword">vect</span><span class="uscript-operator">(</span><span class="uscript-number">0</span><span class="uscript-operator">,</span><span class="uscript-number">1</span><span class="uscript-operator">,</span><span class="uscript-number">1</span><span class="uscript-operator">)</span> <span class="uscript-operator">*</span> A<span class="uscript-operator">)</span> <span class="uscript-operator">+</span> <span class="uscript-keyword">vect</span><span class="uscript-operator">(</span><span class="uscript-number">1</span><span class="uscript-operator">,</span><span class="uscript-number">0</span><span class="uscript-operator">,</span><span class="uscript-number">0</span><span class="uscript-operator">)</span> <span class="uscript-operator">*</span> A<span class="uscript-operator">;</span></pre><h2><a name="0.3"></a>What does this do?</h2>
<pre class="uscript"> resultingVector <span class="uscript-operator">=</span> Normal<span class="uscript-operator">(</span>vector <span class="uscript-operator">cross</span> <span class="uscript-keyword">vect</span><span class="uscript-operator">(</span><span class="uscript-number">0</span><span class="uscript-operator">,</span> <span class="uscript-number">0</span><span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span></pre><p>The cross product of two vectors is perpendicular to both. Which means that (vector cross vect(0, 0, 1)) is a vector pependicular to the given vector AND the z-axis. Something perp to z is horizontal &ndash; it's confined to the XY plane. So it's a horizontal vector that is also perp to the given vector. It's then normalized. I can't remember <em class="em1">which</em> way the cross product points in Unreal. So it's either a unit vector that points to your right or left. </p>
<p><em class="em2">Devi</em> As an aside, if you want to rotate a 3D vector by 90 degrees on the XZ plane you can also do this:</p>
<pre class="uscript"><span class="uscript-keyword">local</span> <span class="uscript-type">float</span> t<span class="uscript-operator">;</span>
<span class="uscript-keyword">local</span> vector v<span class="uscript-operator">;</span>

t<span class="uscript-operator">=</span>v<span class="uscript-operator">.</span>x<span class="uscript-operator">;</span>
v<span class="uscript-operator">.</span>x<span class="uscript-operator">=</span>v<span class="uscript-operator">.</span>y<span class="uscript-operator">;</span>
v<span class="uscript-operator">.</span>y<span class="uscript-operator">=</span><span class="uscript-operator">-</span>t<span class="uscript-operator">;</span></pre><p>The output vector is identical in length to the ingoing one (i.e. If it was normal when it went in, it'll be normal when it came out) In C this would be far faster that the example beforehand, though whether it's faster in UScript is another matter...</p>
<p><em class="em2">AlphaOne:</em> What about this:</p>
<pre class="uscript"> vector <span class="uscript-operator">=</span> <span class="uscript-keyword">vect</span><span class="uscript-operator">(</span><span class="uscript-number">0</span><span class="uscript-operator">,</span> <span class="uscript-number">0</span><span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span> <span class="uscript-operator">&gt;&gt;</span> Rotation<span class="uscript-operator">;</span></pre><p>I believe that Rotation is also a vector (not a rotator). Is it?</p>
<p><em class="em2">Tarquin:</em> Be pretty cruddy coding if it were. &gt;&gt; is a rotator / vector operator. </p>
<p><em class="em2">Dade:</em> How would i go about modifying only the "XY" coordinates of a vector? I.E. Changes the vector's</p>
<p>location, but not its height. Or is this even possible? (haven't studied vectors yet) </p>
<p><em class="em2">VonStrohmen:</em> I'm not quite sure what you're asking, but if you mean can you change the X and Y components of a vector without modifying its Z, then sure. </p>
<pre class="uscript">Vector A<span class="uscript-operator">,</span>B<span class="uscript-operator">;</span>
B <span class="uscript-operator">=</span> <span class="uscript-keyword">vect</span><span class="uscript-operator">(</span>A<span class="uscript-operator">.</span>X <span class="uscript-operator">+</span><span class="uscript-number">50</span><span class="uscript-operator">,</span> A<span class="uscript-operator">.</span>Y <span class="uscript-operator">+</span> <span class="uscript-number">100</span><span class="uscript-operator">,</span> A<span class="uscript-operator">.</span>Z<span class="uscript-operator">)</span><span class="uscript-operator">;</span></pre><p><em class="em2">Dade:</em> Ah Ha! Thank you. That was exactly what i needed.</p>
<p><em class="em2">Wormbo:</em> Note that vect(x,y,z) and rot(p,y,r) are more like "a string" or 'aName', in other words a constant. Also note that you can "multiply" vectors in UnrealScript, i.e. vect(1,2,3) * vect(2,3,4) = vect(2,6,12). This is neither dot product nor cross product, it just multiplies the corresponding parts of the vector.</p>
<p><em class="em2">Mortal Monkey:</em> Hello good people! I just added the "...find vector Q" part, feel free to improve it.</p>
<p><em class="em2">Foxpaw:</em> What do &lt;&lt; and &gt;&gt; do with regards to vectors? One of them appears to do a coordinate rotation of the vector given that the rotator points along the X Axis of the target coordinate system, but what does the other one do?</p>
<p><em class="em2">inio:</em> I thought they rotated a vector by a rotator, and the reverse a of a rotator ((theVec &lt;&lt; theRot) &gt;&gt; theRot == theVec)</p>
<p><em class="em2">Foxpaw:</em> That may be. I know that one of them does the coordinate rotation, which is basically what you said. It is possible that the other just does it by the reverse of that rotator.</p>
<p><em class="em2">Sir_Brizz:</em> Is it too much to ask that someone PLEASE put some pictures up showing precisely how these all work? Imaginary directions and all are way too confusing to leave to the brain.</p>
<p><em class="em2">Tarquin:</em> Care to nominate some that need a picture particularly badly?</p>
<p><em class="em2">Sir_Brizz:</em> Well, I think there should at least be one explaining several at a time. I'm trying to figure out exactly how "...find where <em class="em2">A</em> is in relation to <em class="em2">B</em>?" works exactly.</p>
<p><em class="em2">Devi:</em> I just rewrote that section so it actually (at least to me <img alt=";)" src="emoticons/wink.gif" align="middle"> ) makes sense, by, you know, explaining what A and B actually are <img alt=":)" src="emoticons/smile.gif" align="middle"> Hope that helps... (Sorry, I'm a bit pants at making diagrams)</p>
<p><em class="em2">Devi:</em> heheh, just realised that both mine and the other guys example was finding where B was in relation to A, rather than vice-versa <img alt=":)" src="emoticons/smile.gif" align="middle"> Just renamed the subject title...</p>
<p><em class="em2">Unrealed:</em> Cool, it helped me a lot <img alt="=)" src="emoticons/smile.gif" align="middle">. It was simple and I didnt know how: SetRotation(rotator(NextEnemy.Location-Location));</p>
<h2><a name="0.4"></a>Related Topics</h2>
<ul><li><a href="vector.html">Vector</a></li>
<li><a href="built-in-struct.html">Built-In Struct</a></li>
<li><a href="global-function.html">Global Function</a></li>
<li><a href="operators.html">Operators</a></li>
<li><a href="useful-maths-functions.html">Useful Maths Functions</a></li>
</ul>
<hr class="thin"><p><a href="category-how-do-i.html">Category How Do I</a><br><a href="refactor-me.html">Refactor Me</a></p>
<script type="text/javascript"><!--
 menuItemAdd("Some basic work with locations", "#0.1");
menuItemAdd("<tt>&nbsp;&nbsp;</tt>A vector that points from <em class=\"em2\">A</em> to <em class=\"em2\">B</em>", "#0.1.1");
menuItemAdd("<tt>&nbsp;&nbsp;</tt>A unit vector pointing from <em class=\"em2\">A</em> to <em class=\"em2\">B</em>", "#0.1.2");
menuItemAdd("<tt>&nbsp;&nbsp;</tt>The distance between <em class=\"em2\">A</em> and <em class=\"em2\">B</em>", "#0.1.3");
menuItemAdd("Orientations", "#0.2");
menuItemAdd("<tt>&nbsp;&nbsp;</tt>A unit vector pointing in the direction a player is looking: ", "#0.2.1");
menuItemAdd("<tt>&nbsp;&nbsp;</tt>Rotate Actor <em class=\"em2\">A</em> to face point <em class=\"em2\">B</em>", "#0.2.2");
menuItemAdd("<tt>&nbsp;&nbsp;</tt>...find where <em class=\"em2\">B</em> is in relation to <em class=\"em2\">A</em>?: ", "#0.2.3");
menuItemAdd("<tt>&nbsp;&nbsp;</tt>...find where Actor A is in relation to Pawn B, taking into account B's ViewRotation? <em class=\"em1\">(make sure Pawn B has a Controller)</em>: ", "#0.2.4");
menuItemAdd("<tt>&nbsp;&nbsp;</tt>...find a point that's at a certain distance from a starting point in a given direction? : ", "#0.2.5");
menuItemAdd("<tt>&nbsp;&nbsp;</tt>...find the (smallest) angle between <em class=\"em2\">A</em> and <em class=\"em2\">B</em>? ", "#0.2.6");
menuItemAdd("<tt>&nbsp;&nbsp;</tt>...find out vector B that points x degrees to the left or right of vector A? ", "#0.2.7");
menuItemAdd("<tt>&nbsp;&nbsp;</tt>Rotate a rotator by another rotator", "#0.2.8");
menuItemAdd("<tt>&nbsp;&nbsp;</tt>...damp a velocity vector toward a surface? ", "#0.2.9");
menuItemAdd("<tt>&nbsp;&nbsp;</tt>...find point Q where a normal from point P to a line from A to B meets the line? ", "#0.2.10");
menuItemAdd("<tt>&nbsp;&nbsp;</tt>...only affect certain components of a vector?", "#0.2.11");
menuItemAdd("What does this do?", "#0.3");
menuItemAdd("Related Topics", "#0.4");
menuItemAdd("<tt>&nbsp;&nbsp;</tt>...point to my left or right? : ", "#0.4.1");
 menuWrite() //--></script></div>
</div>

<div id="footer" class="bar">
	<p><form method="post" action="http://wiki.beyondunreal.com/wiki" enctype="application/x-www-form-urlencoded">
<a href="../index.html">Home Page</a> | <a href="recent-changes.html">Recent Changes</a><br>
Last edited May 2, 2006 0:40 <a href="http://wiki.beyondunreal.com/wiki?action=browse&diff=1&id=UnrealScript_Vector_Maths">(diff)</a><br>Search: <input type="text" name="search"  size="20" /><input type="hidden" name="dosearch" value="1"  /><br><br><small><a href="http://wiki.beyondunreal.com/wiki/UnrealScript_Vector_Maths">Original page</a> &#150; copy created Sat, Jun 23, 2007</small><div></div>
</form>
	</p>
	<p>My program doesn't have bugs. It just develops random features.
</p>
</div>
</div><!-- close of "scrolling" div -->

<div id="quickbar">
	<div id="logo"><a href="../index.html"><img src="shared/wikilogo.jpg" width="143" height="100" border="0"></a>
		</div>
	<div class="qbsitename">
		<p>The Unreal Engine Documentation Site</p>
	</div>
	<div class="qbsection">
<p><a href="metatopics.html">Wiki Community</a></p>
<p><a href="category-category.html">Topic Categories</a></p>


<p><a href="recent-changes.html">Recent Changes</a></p>
<p><a href="offline-wiki.html">Offline Wiki</a></p>
</div><div class="qbsection">
<p><a href="unreal-engine.html">Unreal Engine</a></p>
<p><a href="console-commands.html">Console Commands</a></p>
<p><a href="terminology.html">Terminology</a></p>
<p><a href="category-faq.html">FAQs</a></p>
<p><a href="help-desk.html">Help Desk</a></p>
</div><div class="qbsection">
<p><a href="topics-on-mapping.html">Mapping Topics</a></p>
<p><a href="mapping-lessons.html">Mapping Lessons</a></p>
<p><a href="unrealed-3.html">UnrealEd Interface</a></p>
</div><div class="qbsection">
<p><a href="unrealscript.html">UnrealScript Topics</a></p>
<p><a href="unrealscript-lessons.html">UnrealScript Lessons</a></p>
<p><a href="making-mods.html">Making Mods</a></p>
<p><a href="class-tree.html">Class Tree</a></p>
</div><div class="qbsection">
<p><a href="topics-on-modeling.html">Modeling Topics</a></p>
</div><div class="qbsection">
<p><a href="chongqing-page.html">Chongqing Page</a></p>
<p><a href="log-in.html">Log In</a></p></div>
</div>

</body></html>
