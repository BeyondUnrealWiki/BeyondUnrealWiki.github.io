<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"  "http://www.w3.org/TR/html4/loose.dtd">

<html>
<head lang="en">
	<title>UnrealWiki: MD5</title>
	<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
	<link rel="stylesheet" type="text/css" media="screen, print"
		href="shared/stylebase.structural.css">	
	<link rel="stylesheet" type="text/css" media="screen"
		href="shared/template-default.css">
	<link rel="stylesheet" type="text/css" media="screen"
		href="shared/styles.chblue.css">
	<link rel="stylesheet" type="text/css" media="print"
		href="shared/template-default-print.css">
	<!--[if IE 6]>
			<style>
			/* dirty hack for IE6. */
			#quickbar {
				position: absolute;
				}
			</style>
	<![endif]-->
  <link rel="start" href="http://wiki.beyondunreal.com/">
  <link rel="glossary"  href="http://wiki.beyondunreal.com/wiki/Terminology">
  <link rel="help"  href="http://wiki.beyondunreal.com/wiki/Using_The_Wiki">
<script type="text/javascript" src="shared/dhtml.js"></script>
<script type="text/javascript" src="shared/dhtml-menu.js"></script>
<style type="text/css">#dhtml-menu    { background: #eee; padding: 5px 0px; margin-right: -20px; border: 1px solid #888; border-left: 1px solid #ccc; border-top: 1px solid #ccc;  border-right: 1px solid #888; border-bottom: 1px solid #888 }
#dhtml-menu td { color: #000; font-family: Arial,Helvetica,sans-serif; font-size: 9pt; line-height: 13pt; padding: 1px 10px; cursor: default }
#dhtml-menu a  { color: #000; font-family: Arial,Helvetica,sans-serif; font-size: 9pt; line-height: 13pt; text-decoration: none }
#dhtml-menu tt { font-family: monospace; font-size: 9pt }
#dhtml-menu-separator { height: 1px; background: red }
#dhtml-menu-anchor { cursor: default }
</style>
<script type="text/javascript" src="shared/expandable.js"></script>
</head>
<body onLoad="menuInit(); document.cookie='page=MD5; path=/'" class="default">
<div id="scrolling"><!-- contains all except the fixed sidebar -->
<div id="topbar"  class="bar">
	<div class="righthalf">
		<form class="inline" method="post" action="/wiki" enctype="application/x-www-form-urlencoded"><input type="text" name="search"  size="20" /> <input type="submit" name="search" value="search" /></form>
	</div>
	<div class="lefthalf">
		<script type="text/javascript"><!--
			menuAlignRight = false;
		//--></script>
		<span><script type="text/javascript"><!--
 menuWriteAnchor("Quick Navigation") //--></script></span> | <a href="(start).html">Home Page</a> | <a href="recent-changes.html">Recent Changes</a> | <a href="http://wiki.beyondunreal.com/wiki?action=editprefs">Preferences</a>
	</div>
</div>

<div id="content"><!-- contains the title and article -->
	<h1 class='pagetitle'><a href="http://wiki.beyondunreal.com/wiki?back=MD5">MD5</a></h1>
	<div class="wiki"><p>MD5 was developed by <a href="http://theory.lcs.mit.edu/~rivest/homepage.html">[Professor Ronald L. Rivest  of MIT]</a></p>
<p>The MD5 algorithm takes as input a message of arbitrary length and produces as output a 128-bit "fingerprint" or "message digest" of the input. It is conjectured that it is computationally infeasible to produce two messages having the same message digest, or to produce any message having a given prespecified target message digest. The MD5 algorithm is intended for digital signature applications, where a large file must be "compressed" in a secure manner before being encrypted with a private (secret) key under a public-key cryptosystem such as <a href="rsa.html">RSA</a>.</p>
<h2><a name="0.1"></a>Code</h2>
<pre class="uscript"><span class="uscript-comment">/** MD5 context */</span>
<span class="uscript-keyword">struct</span> MD5_CTX
<span class="uscript-operator">{</span>
    <span class="uscript-comment">/** state (ABCD) */</span>
    <span class="uscript-keyword">var</span> <span class="uscript-keyword">array</span><span class="uscript-operator">&lt;</span><span class="uscript-type">int</span><span class="uscript-operator">&gt;</span> <span class="uscript-keyword">state</span><span class="uscript-operator">;</span>
    <span class="uscript-comment">/** number of bits, modulo 2^64 (lsb first) */</span>
    <span class="uscript-keyword">var</span> <span class="uscript-keyword">array</span><span class="uscript-operator">&lt;</span><span class="uscript-type">int</span><span class="uscript-operator">&gt;</span> count<span class="uscript-operator">;</span>
    <span class="uscript-comment">/** input buffer */</span>
    <span class="uscript-keyword">var</span> <span class="uscript-keyword">array</span><span class="uscript-operator">&lt;</span><span class="uscript-type">byte</span><span class="uscript-operator">&gt;</span> buffer<span class="uscript-operator">;</span>
<span class="uscript-operator">}</span><span class="uscript-operator">;</span>

<span class="uscript-comment">/** return the MD5 of the input string */</span>
<span class="uscript-keyword">static</span> <span class="uscript-keyword">function</span> <span class="uscript-type">string</span> MD5String <span class="uscript-operator">(</span><span class="uscript-type">string</span> str<span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
    <span class="uscript-keyword">local</span> MD5_CTX context<span class="uscript-operator">;</span>
    <span class="uscript-keyword">local</span> <span class="uscript-keyword">array</span><span class="uscript-operator">&lt;</span><span class="uscript-type">byte</span><span class="uscript-operator">&gt;</span> digest<span class="uscript-operator">;</span>
    <span class="uscript-keyword">local</span> <span class="uscript-type">string</span> Hex<span class="uscript-operator">;</span>
    <span class="uscript-keyword">local</span> <span class="uscript-type">int</span> i<span class="uscript-operator">;</span>

    MD5Init <span class="uscript-operator">(</span>context<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    MD5Update <span class="uscript-operator">(</span>context<span class="uscript-operator">,</span> str<span class="uscript-operator">,</span> Len<span class="uscript-operator">(</span>str<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    digest<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span> <span class="uscript-operator">=</span> <span class="uscript-number">16</span><span class="uscript-operator">;</span>
    MD5Final <span class="uscript-operator">(</span>digest<span class="uscript-operator">,</span> context<span class="uscript-operator">)</span><span class="uscript-operator">;</span>

    <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i <span class="uscript-operator">=</span> <span class="uscript-number">0</span><span class="uscript-operator">;</span> i <span class="uscript-operator">&lt;</span> <span class="uscript-number">16</span><span class="uscript-operator">;</span> i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
        Hex <span class="uscript-operator">=</span> Hex <span class="uscript-operator">$</span> DecToHex<span class="uscript-operator">(</span>digest<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>

    <span class="uscript-keyword">return</span> Hex<span class="uscript-operator">;</span>
<span class="uscript-operator">}</span>

<span class="uscript-comment">/** initialize the MD5 context */</span>
<span class="uscript-keyword">static</span> <span class="uscript-keyword">final</span> <span class="uscript-keyword">function</span> MD5Init<span class="uscript-operator">(</span><span class="uscript-keyword">out</span> MD5_CTX context<span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
    context<span class="uscript-operator">.</span>count<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span> <span class="uscript-operator">=</span> <span class="uscript-number">2</span><span class="uscript-operator">;</span>
    context<span class="uscript-operator">.</span>count<span class="uscript-operator">[</span><span class="uscript-number">0</span><span class="uscript-operator">]</span> <span class="uscript-operator">=</span> <span class="uscript-number">0</span><span class="uscript-operator">;</span>
    context<span class="uscript-operator">.</span>count<span class="uscript-operator">[</span><span class="uscript-number">1</span><span class="uscript-operator">]</span> <span class="uscript-operator">=</span> <span class="uscript-number">0</span><span class="uscript-operator">;</span>
    context<span class="uscript-operator">.</span><span class="uscript-keyword">state</span><span class="uscript-operator">.</span><span class="uscript-keyword">Length</span> <span class="uscript-operator">=</span> <span class="uscript-number">4</span><span class="uscript-operator">;</span>
    context<span class="uscript-operator">.</span><span class="uscript-keyword">state</span><span class="uscript-operator">[</span><span class="uscript-number">0</span><span class="uscript-operator">]</span> <span class="uscript-operator">=</span> <span class="uscript-number">0x67452301</span><span class="uscript-operator">;</span>
    context<span class="uscript-operator">.</span><span class="uscript-keyword">state</span><span class="uscript-operator">[</span><span class="uscript-number">1</span><span class="uscript-operator">]</span> <span class="uscript-operator">=</span> <span class="uscript-number">0xefcdab89</span><span class="uscript-operator">;</span>
    context<span class="uscript-operator">.</span><span class="uscript-keyword">state</span><span class="uscript-operator">[</span><span class="uscript-number">2</span><span class="uscript-operator">]</span> <span class="uscript-operator">=</span> <span class="uscript-number">0x98badcfe</span><span class="uscript-operator">;</span>
    context<span class="uscript-operator">.</span><span class="uscript-keyword">state</span><span class="uscript-operator">[</span><span class="uscript-number">3</span><span class="uscript-operator">]</span> <span class="uscript-operator">=</span> <span class="uscript-number">0x10325476</span><span class="uscript-operator">;</span>
    context<span class="uscript-operator">.</span>buffer<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span> <span class="uscript-operator">=</span> <span class="uscript-number">64</span><span class="uscript-operator">;</span>
<span class="uscript-operator">}</span>

<span class="uscript-keyword">static</span> <span class="uscript-keyword">final</span> <span class="uscript-keyword">function</span> MD5Transform<span class="uscript-operator">(</span><span class="uscript-keyword">out</span> <span class="uscript-keyword">array</span><span class="uscript-operator">&lt;</span><span class="uscript-type">int</span><span class="uscript-operator">&gt;</span> Buf<span class="uscript-operator">,</span> <span class="uscript-keyword">array</span><span class="uscript-operator">&lt;</span><span class="uscript-type">byte</span><span class="uscript-operator">&gt;</span> block<span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
    <span class="uscript-keyword">local</span> <span class="uscript-type">int</span> A<span class="uscript-operator">,</span>B<span class="uscript-operator">,</span>C<span class="uscript-operator">,</span>D<span class="uscript-operator">;</span>
    <span class="uscript-keyword">local</span> <span class="uscript-keyword">array</span><span class="uscript-operator">&lt;</span><span class="uscript-type">int</span><span class="uscript-operator">&gt;</span> x<span class="uscript-operator">;</span>

    A <span class="uscript-operator">=</span> Buf<span class="uscript-operator">[</span><span class="uscript-number">0</span><span class="uscript-operator">]</span><span class="uscript-operator">;</span>
    B <span class="uscript-operator">=</span> Buf<span class="uscript-operator">[</span><span class="uscript-number">1</span><span class="uscript-operator">]</span><span class="uscript-operator">;</span>
    C <span class="uscript-operator">=</span> Buf<span class="uscript-operator">[</span><span class="uscript-number">2</span><span class="uscript-operator">]</span><span class="uscript-operator">;</span>
    D <span class="uscript-operator">=</span> Buf<span class="uscript-operator">[</span><span class="uscript-number">3</span><span class="uscript-operator">]</span><span class="uscript-operator">;</span>

    x<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span> <span class="uscript-operator">=</span> <span class="uscript-number">16</span><span class="uscript-operator">;</span>

    Decode <span class="uscript-operator">(</span>x<span class="uscript-operator">,</span> block<span class="uscript-operator">,</span> <span class="uscript-number">64</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>

    <span class="uscript-comment">/* Round 1 */</span>
    FF <span class="uscript-operator">(</span>a<span class="uscript-operator">,</span> b<span class="uscript-operator">,</span> c<span class="uscript-operator">,</span> d<span class="uscript-operator">,</span> x<span class="uscript-operator">[</span> <span class="uscript-number">0</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span>  <span class="uscript-number">7</span><span class="uscript-operator">,</span> <span class="uscript-number">0xd76aa478</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-comment">/* 1 */</span>
    FF <span class="uscript-operator">(</span>d<span class="uscript-operator">,</span> a<span class="uscript-operator">,</span> b<span class="uscript-operator">,</span> c<span class="uscript-operator">,</span> x<span class="uscript-operator">[</span> <span class="uscript-number">1</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span> <span class="uscript-number">12</span><span class="uscript-operator">,</span> <span class="uscript-number">0xe8c7b756</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-comment">/* 2 */</span>
    FF <span class="uscript-operator">(</span>c<span class="uscript-operator">,</span> d<span class="uscript-operator">,</span> a<span class="uscript-operator">,</span> b<span class="uscript-operator">,</span> x<span class="uscript-operator">[</span> <span class="uscript-number">2</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span> <span class="uscript-number">17</span><span class="uscript-operator">,</span> <span class="uscript-number">0x242070db</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-comment">/* 3 */</span>
    FF <span class="uscript-operator">(</span>b<span class="uscript-operator">,</span> c<span class="uscript-operator">,</span> d<span class="uscript-operator">,</span> a<span class="uscript-operator">,</span> x<span class="uscript-operator">[</span> <span class="uscript-number">3</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span> <span class="uscript-number">22</span><span class="uscript-operator">,</span> <span class="uscript-number">0xc1bdceee</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-comment">/* 4 */</span>
    FF <span class="uscript-operator">(</span>a<span class="uscript-operator">,</span> b<span class="uscript-operator">,</span> c<span class="uscript-operator">,</span> d<span class="uscript-operator">,</span> x<span class="uscript-operator">[</span> <span class="uscript-number">4</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span>  <span class="uscript-number">7</span><span class="uscript-operator">,</span> <span class="uscript-number">0xf57c0faf</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-comment">/* 5 */</span>
    FF <span class="uscript-operator">(</span>d<span class="uscript-operator">,</span> a<span class="uscript-operator">,</span> b<span class="uscript-operator">,</span> c<span class="uscript-operator">,</span> x<span class="uscript-operator">[</span> <span class="uscript-number">5</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span> <span class="uscript-number">12</span><span class="uscript-operator">,</span> <span class="uscript-number">0x4787c62a</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-comment">/* 6 */</span>
    FF <span class="uscript-operator">(</span>c<span class="uscript-operator">,</span> d<span class="uscript-operator">,</span> a<span class="uscript-operator">,</span> b<span class="uscript-operator">,</span> x<span class="uscript-operator">[</span> <span class="uscript-number">6</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span> <span class="uscript-number">17</span><span class="uscript-operator">,</span> <span class="uscript-number">0xa8304613</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-comment">/* 7 */</span>
    FF <span class="uscript-operator">(</span>b<span class="uscript-operator">,</span> c<span class="uscript-operator">,</span> d<span class="uscript-operator">,</span> a<span class="uscript-operator">,</span> x<span class="uscript-operator">[</span> <span class="uscript-number">7</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span> <span class="uscript-number">22</span><span class="uscript-operator">,</span> <span class="uscript-number">0xfd469501</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-comment">/* 8 */</span>
    FF <span class="uscript-operator">(</span>a<span class="uscript-operator">,</span> b<span class="uscript-operator">,</span> c<span class="uscript-operator">,</span> d<span class="uscript-operator">,</span> x<span class="uscript-operator">[</span> <span class="uscript-number">8</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span>  <span class="uscript-number">7</span><span class="uscript-operator">,</span> <span class="uscript-number">0x698098d8</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-comment">/* 9 */</span>
    FF <span class="uscript-operator">(</span>d<span class="uscript-operator">,</span> a<span class="uscript-operator">,</span> b<span class="uscript-operator">,</span> c<span class="uscript-operator">,</span> x<span class="uscript-operator">[</span> <span class="uscript-number">9</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span> <span class="uscript-number">12</span><span class="uscript-operator">,</span> <span class="uscript-number">0x8b44f7af</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-comment">/* 10 */</span>
    FF <span class="uscript-operator">(</span>c<span class="uscript-operator">,</span> d<span class="uscript-operator">,</span> a<span class="uscript-operator">,</span> b<span class="uscript-operator">,</span> x<span class="uscript-operator">[</span><span class="uscript-number">10</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span> <span class="uscript-number">17</span><span class="uscript-operator">,</span> <span class="uscript-number">0xffff5bb1</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-comment">/* 11 */</span>
    FF <span class="uscript-operator">(</span>b<span class="uscript-operator">,</span> c<span class="uscript-operator">,</span> d<span class="uscript-operator">,</span> a<span class="uscript-operator">,</span> x<span class="uscript-operator">[</span><span class="uscript-number">11</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span> <span class="uscript-number">22</span><span class="uscript-operator">,</span> <span class="uscript-number">0x895cd7be</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-comment">/* 12 */</span>
    FF <span class="uscript-operator">(</span>a<span class="uscript-operator">,</span> b<span class="uscript-operator">,</span> c<span class="uscript-operator">,</span> d<span class="uscript-operator">,</span> x<span class="uscript-operator">[</span><span class="uscript-number">12</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span>  <span class="uscript-number">7</span><span class="uscript-operator">,</span> <span class="uscript-number">0x6b901122</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-comment">/* 13 */</span>
    FF <span class="uscript-operator">(</span>d<span class="uscript-operator">,</span> a<span class="uscript-operator">,</span> b<span class="uscript-operator">,</span> c<span class="uscript-operator">,</span> x<span class="uscript-operator">[</span><span class="uscript-number">13</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span> <span class="uscript-number">12</span><span class="uscript-operator">,</span> <span class="uscript-number">0xfd987193</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-comment">/* 14 */</span>
    FF <span class="uscript-operator">(</span>c<span class="uscript-operator">,</span> d<span class="uscript-operator">,</span> a<span class="uscript-operator">,</span> b<span class="uscript-operator">,</span> x<span class="uscript-operator">[</span><span class="uscript-number">14</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span> <span class="uscript-number">17</span><span class="uscript-operator">,</span> <span class="uscript-number">0xa679438e</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-comment">/* 15 */</span>
    FF <span class="uscript-operator">(</span>b<span class="uscript-operator">,</span> c<span class="uscript-operator">,</span> d<span class="uscript-operator">,</span> a<span class="uscript-operator">,</span> x<span class="uscript-operator">[</span><span class="uscript-number">15</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span> <span class="uscript-number">22</span><span class="uscript-operator">,</span> <span class="uscript-number">0x49b40821</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-comment">/* 16 */</span>

    <span class="uscript-comment">/* Round 2 */</span>
    GG <span class="uscript-operator">(</span>a<span class="uscript-operator">,</span> b<span class="uscript-operator">,</span> c<span class="uscript-operator">,</span> d<span class="uscript-operator">,</span> x<span class="uscript-operator">[</span> <span class="uscript-number">1</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span>  <span class="uscript-number">5</span><span class="uscript-operator">,</span> <span class="uscript-number">0xf61e2562</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-comment">/* 17 */</span>
    GG <span class="uscript-operator">(</span>d<span class="uscript-operator">,</span> a<span class="uscript-operator">,</span> b<span class="uscript-operator">,</span> c<span class="uscript-operator">,</span> x<span class="uscript-operator">[</span> <span class="uscript-number">6</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span>  <span class="uscript-number">9</span><span class="uscript-operator">,</span> <span class="uscript-number">0xc040b340</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-comment">/* 18 */</span>
    GG <span class="uscript-operator">(</span>c<span class="uscript-operator">,</span> d<span class="uscript-operator">,</span> a<span class="uscript-operator">,</span> b<span class="uscript-operator">,</span> x<span class="uscript-operator">[</span><span class="uscript-number">11</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span> <span class="uscript-number">14</span><span class="uscript-operator">,</span> <span class="uscript-number">0x265e5a51</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-comment">/* 19 */</span>
    GG <span class="uscript-operator">(</span>b<span class="uscript-operator">,</span> c<span class="uscript-operator">,</span> d<span class="uscript-operator">,</span> a<span class="uscript-operator">,</span> x<span class="uscript-operator">[</span> <span class="uscript-number">0</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span> <span class="uscript-number">20</span><span class="uscript-operator">,</span> <span class="uscript-number">0xe9b6c7aa</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-comment">/* 20 */</span>
    GG <span class="uscript-operator">(</span>a<span class="uscript-operator">,</span> b<span class="uscript-operator">,</span> c<span class="uscript-operator">,</span> d<span class="uscript-operator">,</span> x<span class="uscript-operator">[</span> <span class="uscript-number">5</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span>  <span class="uscript-number">5</span><span class="uscript-operator">,</span> <span class="uscript-number">0xd62f105d</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-comment">/* 21 */</span>
    GG <span class="uscript-operator">(</span>d<span class="uscript-operator">,</span> a<span class="uscript-operator">,</span> b<span class="uscript-operator">,</span> c<span class="uscript-operator">,</span> x<span class="uscript-operator">[</span><span class="uscript-number">10</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span>  <span class="uscript-number">9</span><span class="uscript-operator">,</span>  <span class="uscript-number">0x2441453</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-comment">/* 22 */</span>
    GG <span class="uscript-operator">(</span>c<span class="uscript-operator">,</span> d<span class="uscript-operator">,</span> a<span class="uscript-operator">,</span> b<span class="uscript-operator">,</span> x<span class="uscript-operator">[</span><span class="uscript-number">15</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span> <span class="uscript-number">14</span><span class="uscript-operator">,</span> <span class="uscript-number">0xd8a1e681</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-comment">/* 23 */</span>
    GG <span class="uscript-operator">(</span>b<span class="uscript-operator">,</span> c<span class="uscript-operator">,</span> d<span class="uscript-operator">,</span> a<span class="uscript-operator">,</span> x<span class="uscript-operator">[</span> <span class="uscript-number">4</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span> <span class="uscript-number">20</span><span class="uscript-operator">,</span> <span class="uscript-number">0xe7d3fbc8</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-comment">/* 24 */</span>
    GG <span class="uscript-operator">(</span>a<span class="uscript-operator">,</span> b<span class="uscript-operator">,</span> c<span class="uscript-operator">,</span> d<span class="uscript-operator">,</span> x<span class="uscript-operator">[</span> <span class="uscript-number">9</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span>  <span class="uscript-number">5</span><span class="uscript-operator">,</span> <span class="uscript-number">0x21e1cde6</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-comment">/* 25 */</span>
    GG <span class="uscript-operator">(</span>d<span class="uscript-operator">,</span> a<span class="uscript-operator">,</span> b<span class="uscript-operator">,</span> c<span class="uscript-operator">,</span> x<span class="uscript-operator">[</span><span class="uscript-number">14</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span>  <span class="uscript-number">9</span><span class="uscript-operator">,</span> <span class="uscript-number">0xc33707d6</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-comment">/* 26 */</span>
    GG <span class="uscript-operator">(</span>c<span class="uscript-operator">,</span> d<span class="uscript-operator">,</span> a<span class="uscript-operator">,</span> b<span class="uscript-operator">,</span> x<span class="uscript-operator">[</span> <span class="uscript-number">3</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span> <span class="uscript-number">14</span><span class="uscript-operator">,</span> <span class="uscript-number">0xf4d50d87</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-comment">/* 27 */</span>
    GG <span class="uscript-operator">(</span>b<span class="uscript-operator">,</span> c<span class="uscript-operator">,</span> d<span class="uscript-operator">,</span> a<span class="uscript-operator">,</span> x<span class="uscript-operator">[</span> <span class="uscript-number">8</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span> <span class="uscript-number">20</span><span class="uscript-operator">,</span> <span class="uscript-number">0x455a14ed</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-comment">/* 28 */</span>
    GG <span class="uscript-operator">(</span>a<span class="uscript-operator">,</span> b<span class="uscript-operator">,</span> c<span class="uscript-operator">,</span> d<span class="uscript-operator">,</span> x<span class="uscript-operator">[</span><span class="uscript-number">13</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span>  <span class="uscript-number">5</span><span class="uscript-operator">,</span> <span class="uscript-number">0xa9e3e905</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-comment">/* 29 */</span>
    GG <span class="uscript-operator">(</span>d<span class="uscript-operator">,</span> a<span class="uscript-operator">,</span> b<span class="uscript-operator">,</span> c<span class="uscript-operator">,</span> x<span class="uscript-operator">[</span> <span class="uscript-number">2</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span>  <span class="uscript-number">9</span><span class="uscript-operator">,</span> <span class="uscript-number">0xfcefa3f8</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-comment">/* 30 */</span>
    GG <span class="uscript-operator">(</span>c<span class="uscript-operator">,</span> d<span class="uscript-operator">,</span> a<span class="uscript-operator">,</span> b<span class="uscript-operator">,</span> x<span class="uscript-operator">[</span> <span class="uscript-number">7</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span> <span class="uscript-number">14</span><span class="uscript-operator">,</span> <span class="uscript-number">0x676f02d9</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-comment">/* 31 */</span>
    GG <span class="uscript-operator">(</span>b<span class="uscript-operator">,</span> c<span class="uscript-operator">,</span> d<span class="uscript-operator">,</span> a<span class="uscript-operator">,</span> x<span class="uscript-operator">[</span><span class="uscript-number">12</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span> <span class="uscript-number">20</span><span class="uscript-operator">,</span> <span class="uscript-number">0x8d2a4c8a</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-comment">/* 32 */</span>

    <span class="uscript-comment">/* Round 3 */</span>
    HH <span class="uscript-operator">(</span>a<span class="uscript-operator">,</span> b<span class="uscript-operator">,</span> c<span class="uscript-operator">,</span> d<span class="uscript-operator">,</span> x<span class="uscript-operator">[</span> <span class="uscript-number">5</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span>  <span class="uscript-number">4</span><span class="uscript-operator">,</span> <span class="uscript-number">0xfffa3942</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-comment">/* 33 */</span>
    HH <span class="uscript-operator">(</span>d<span class="uscript-operator">,</span> a<span class="uscript-operator">,</span> b<span class="uscript-operator">,</span> c<span class="uscript-operator">,</span> x<span class="uscript-operator">[</span> <span class="uscript-number">8</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span> <span class="uscript-number">11</span><span class="uscript-operator">,</span> <span class="uscript-number">0x8771f681</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-comment">/* 34 */</span>
    HH <span class="uscript-operator">(</span>c<span class="uscript-operator">,</span> d<span class="uscript-operator">,</span> a<span class="uscript-operator">,</span> b<span class="uscript-operator">,</span> x<span class="uscript-operator">[</span><span class="uscript-number">11</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span> <span class="uscript-number">16</span><span class="uscript-operator">,</span> <span class="uscript-number">0x6d9d6122</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-comment">/* 35 */</span>
    HH <span class="uscript-operator">(</span>b<span class="uscript-operator">,</span> c<span class="uscript-operator">,</span> d<span class="uscript-operator">,</span> a<span class="uscript-operator">,</span> x<span class="uscript-operator">[</span><span class="uscript-number">14</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span> <span class="uscript-number">23</span><span class="uscript-operator">,</span> <span class="uscript-number">0xfde5380c</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-comment">/* 36 */</span>
    HH <span class="uscript-operator">(</span>a<span class="uscript-operator">,</span> b<span class="uscript-operator">,</span> c<span class="uscript-operator">,</span> d<span class="uscript-operator">,</span> x<span class="uscript-operator">[</span> <span class="uscript-number">1</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span>  <span class="uscript-number">4</span><span class="uscript-operator">,</span> <span class="uscript-number">0xa4beea44</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-comment">/* 37 */</span>
    HH <span class="uscript-operator">(</span>d<span class="uscript-operator">,</span> a<span class="uscript-operator">,</span> b<span class="uscript-operator">,</span> c<span class="uscript-operator">,</span> x<span class="uscript-operator">[</span> <span class="uscript-number">4</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span> <span class="uscript-number">11</span><span class="uscript-operator">,</span> <span class="uscript-number">0x4bdecfa9</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-comment">/* 38 */</span>
    HH <span class="uscript-operator">(</span>c<span class="uscript-operator">,</span> d<span class="uscript-operator">,</span> a<span class="uscript-operator">,</span> b<span class="uscript-operator">,</span> x<span class="uscript-operator">[</span> <span class="uscript-number">7</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span> <span class="uscript-number">16</span><span class="uscript-operator">,</span> <span class="uscript-number">0xf6bb4b60</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-comment">/* 39 */</span>
    HH <span class="uscript-operator">(</span>b<span class="uscript-operator">,</span> c<span class="uscript-operator">,</span> d<span class="uscript-operator">,</span> a<span class="uscript-operator">,</span> x<span class="uscript-operator">[</span><span class="uscript-number">10</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span> <span class="uscript-number">23</span><span class="uscript-operator">,</span> <span class="uscript-number">0xbebfbc70</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-comment">/* 40 */</span>
    HH <span class="uscript-operator">(</span>a<span class="uscript-operator">,</span> b<span class="uscript-operator">,</span> c<span class="uscript-operator">,</span> d<span class="uscript-operator">,</span> x<span class="uscript-operator">[</span><span class="uscript-number">13</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span>  <span class="uscript-number">4</span><span class="uscript-operator">,</span> <span class="uscript-number">0x289b7ec6</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-comment">/* 41 */</span>
    HH <span class="uscript-operator">(</span>d<span class="uscript-operator">,</span> a<span class="uscript-operator">,</span> b<span class="uscript-operator">,</span> c<span class="uscript-operator">,</span> x<span class="uscript-operator">[</span> <span class="uscript-number">0</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span> <span class="uscript-number">11</span><span class="uscript-operator">,</span> <span class="uscript-number">0xeaa127fa</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-comment">/* 42 */</span>
    HH <span class="uscript-operator">(</span>c<span class="uscript-operator">,</span> d<span class="uscript-operator">,</span> a<span class="uscript-operator">,</span> b<span class="uscript-operator">,</span> x<span class="uscript-operator">[</span> <span class="uscript-number">3</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span> <span class="uscript-number">16</span><span class="uscript-operator">,</span> <span class="uscript-number">0xd4ef3085</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-comment">/* 43 */</span>
    HH <span class="uscript-operator">(</span>b<span class="uscript-operator">,</span> c<span class="uscript-operator">,</span> d<span class="uscript-operator">,</span> a<span class="uscript-operator">,</span> x<span class="uscript-operator">[</span> <span class="uscript-number">6</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span> <span class="uscript-number">23</span><span class="uscript-operator">,</span>  <span class="uscript-number">0x4881d05</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-comment">/* 44 */</span>
    HH <span class="uscript-operator">(</span>a<span class="uscript-operator">,</span> b<span class="uscript-operator">,</span> c<span class="uscript-operator">,</span> d<span class="uscript-operator">,</span> x<span class="uscript-operator">[</span> <span class="uscript-number">9</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span>  <span class="uscript-number">4</span><span class="uscript-operator">,</span> <span class="uscript-number">0xd9d4d039</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-comment">/* 45 */</span>
    HH <span class="uscript-operator">(</span>d<span class="uscript-operator">,</span> a<span class="uscript-operator">,</span> b<span class="uscript-operator">,</span> c<span class="uscript-operator">,</span> x<span class="uscript-operator">[</span><span class="uscript-number">12</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span> <span class="uscript-number">11</span><span class="uscript-operator">,</span> <span class="uscript-number">0xe6db99e5</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-comment">/* 46 */</span>
    HH <span class="uscript-operator">(</span>c<span class="uscript-operator">,</span> d<span class="uscript-operator">,</span> a<span class="uscript-operator">,</span> b<span class="uscript-operator">,</span> x<span class="uscript-operator">[</span><span class="uscript-number">15</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span> <span class="uscript-number">16</span><span class="uscript-operator">,</span> <span class="uscript-number">0x1fa27cf8</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-comment">/* 47 */</span>
    HH <span class="uscript-operator">(</span>b<span class="uscript-operator">,</span> c<span class="uscript-operator">,</span> d<span class="uscript-operator">,</span> a<span class="uscript-operator">,</span> x<span class="uscript-operator">[</span> <span class="uscript-number">2</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span> <span class="uscript-number">23</span><span class="uscript-operator">,</span> <span class="uscript-number">0xc4ac5665</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-comment">/* 48 */</span>

    <span class="uscript-comment">/* Round 4 */</span>
    II <span class="uscript-operator">(</span>a<span class="uscript-operator">,</span> b<span class="uscript-operator">,</span> c<span class="uscript-operator">,</span> d<span class="uscript-operator">,</span> x<span class="uscript-operator">[</span> <span class="uscript-number">0</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span>  <span class="uscript-number">6</span><span class="uscript-operator">,</span> <span class="uscript-number">0xf4292244</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-comment">/* 49 */</span>
    II <span class="uscript-operator">(</span>d<span class="uscript-operator">,</span> a<span class="uscript-operator">,</span> b<span class="uscript-operator">,</span> c<span class="uscript-operator">,</span> x<span class="uscript-operator">[</span> <span class="uscript-number">7</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span> <span class="uscript-number">10</span><span class="uscript-operator">,</span> <span class="uscript-number">0x432aff97</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-comment">/* 50 */</span>
    II <span class="uscript-operator">(</span>c<span class="uscript-operator">,</span> d<span class="uscript-operator">,</span> a<span class="uscript-operator">,</span> b<span class="uscript-operator">,</span> x<span class="uscript-operator">[</span><span class="uscript-number">14</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span> <span class="uscript-number">15</span><span class="uscript-operator">,</span> <span class="uscript-number">0xab9423a7</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-comment">/* 51 */</span>
    II <span class="uscript-operator">(</span>b<span class="uscript-operator">,</span> c<span class="uscript-operator">,</span> d<span class="uscript-operator">,</span> a<span class="uscript-operator">,</span> x<span class="uscript-operator">[</span> <span class="uscript-number">5</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span> <span class="uscript-number">21</span><span class="uscript-operator">,</span> <span class="uscript-number">0xfc93a039</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-comment">/* 52 */</span>
    II <span class="uscript-operator">(</span>a<span class="uscript-operator">,</span> b<span class="uscript-operator">,</span> c<span class="uscript-operator">,</span> d<span class="uscript-operator">,</span> x<span class="uscript-operator">[</span><span class="uscript-number">12</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span>  <span class="uscript-number">6</span><span class="uscript-operator">,</span> <span class="uscript-number">0x655b59c3</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-comment">/* 53 */</span>
    II <span class="uscript-operator">(</span>d<span class="uscript-operator">,</span> a<span class="uscript-operator">,</span> b<span class="uscript-operator">,</span> c<span class="uscript-operator">,</span> x<span class="uscript-operator">[</span> <span class="uscript-number">3</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span> <span class="uscript-number">10</span><span class="uscript-operator">,</span> <span class="uscript-number">0x8f0ccc92</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-comment">/* 54 */</span>
    II <span class="uscript-operator">(</span>c<span class="uscript-operator">,</span> d<span class="uscript-operator">,</span> a<span class="uscript-operator">,</span> b<span class="uscript-operator">,</span> x<span class="uscript-operator">[</span><span class="uscript-number">10</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span> <span class="uscript-number">15</span><span class="uscript-operator">,</span> <span class="uscript-number">0xffeff47d</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-comment">/* 55 */</span>
    II <span class="uscript-operator">(</span>b<span class="uscript-operator">,</span> c<span class="uscript-operator">,</span> d<span class="uscript-operator">,</span> a<span class="uscript-operator">,</span> x<span class="uscript-operator">[</span> <span class="uscript-number">1</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span> <span class="uscript-number">21</span><span class="uscript-operator">,</span> <span class="uscript-number">0x85845dd1</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-comment">/* 56 */</span>
    II <span class="uscript-operator">(</span>a<span class="uscript-operator">,</span> b<span class="uscript-operator">,</span> c<span class="uscript-operator">,</span> d<span class="uscript-operator">,</span> x<span class="uscript-operator">[</span> <span class="uscript-number">8</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span>  <span class="uscript-number">6</span><span class="uscript-operator">,</span> <span class="uscript-number">0x6fa87e4f</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-comment">/* 57 */</span>
    II <span class="uscript-operator">(</span>d<span class="uscript-operator">,</span> a<span class="uscript-operator">,</span> b<span class="uscript-operator">,</span> c<span class="uscript-operator">,</span> x<span class="uscript-operator">[</span><span class="uscript-number">15</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span> <span class="uscript-number">10</span><span class="uscript-operator">,</span> <span class="uscript-number">0xfe2ce6e0</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-comment">/* 58 */</span>
    II <span class="uscript-operator">(</span>c<span class="uscript-operator">,</span> d<span class="uscript-operator">,</span> a<span class="uscript-operator">,</span> b<span class="uscript-operator">,</span> x<span class="uscript-operator">[</span> <span class="uscript-number">6</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span> <span class="uscript-number">15</span><span class="uscript-operator">,</span> <span class="uscript-number">0xa3014314</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-comment">/* 59 */</span>
    II <span class="uscript-operator">(</span>b<span class="uscript-operator">,</span> c<span class="uscript-operator">,</span> d<span class="uscript-operator">,</span> a<span class="uscript-operator">,</span> x<span class="uscript-operator">[</span><span class="uscript-number">13</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span> <span class="uscript-number">21</span><span class="uscript-operator">,</span> <span class="uscript-number">0x4e0811a1</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-comment">/* 60 */</span>
    II <span class="uscript-operator">(</span>a<span class="uscript-operator">,</span> b<span class="uscript-operator">,</span> c<span class="uscript-operator">,</span> d<span class="uscript-operator">,</span> x<span class="uscript-operator">[</span> <span class="uscript-number">4</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span>  <span class="uscript-number">6</span><span class="uscript-operator">,</span> <span class="uscript-number">0xf7537e82</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-comment">/* 61 */</span>
    II <span class="uscript-operator">(</span>d<span class="uscript-operator">,</span> a<span class="uscript-operator">,</span> b<span class="uscript-operator">,</span> c<span class="uscript-operator">,</span> x<span class="uscript-operator">[</span><span class="uscript-number">11</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span> <span class="uscript-number">10</span><span class="uscript-operator">,</span> <span class="uscript-number">0xbd3af235</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-comment">/* 62 */</span>
    II <span class="uscript-operator">(</span>c<span class="uscript-operator">,</span> d<span class="uscript-operator">,</span> a<span class="uscript-operator">,</span> b<span class="uscript-operator">,</span> x<span class="uscript-operator">[</span> <span class="uscript-number">2</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span> <span class="uscript-number">15</span><span class="uscript-operator">,</span> <span class="uscript-number">0x2ad7d2bb</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-comment">/* 63 */</span>
    II <span class="uscript-operator">(</span>b<span class="uscript-operator">,</span> c<span class="uscript-operator">,</span> d<span class="uscript-operator">,</span> a<span class="uscript-operator">,</span> x<span class="uscript-operator">[</span> <span class="uscript-number">9</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span> <span class="uscript-number">21</span><span class="uscript-operator">,</span> <span class="uscript-number">0xeb86d391</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-comment">/* 64 */</span>

    Buf<span class="uscript-operator">[</span><span class="uscript-number">0</span><span class="uscript-operator">]</span> <span class="uscript-operator">+=</span> A<span class="uscript-operator">;</span>
    Buf<span class="uscript-operator">[</span><span class="uscript-number">1</span><span class="uscript-operator">]</span> <span class="uscript-operator">+=</span> B<span class="uscript-operator">;</span>
    Buf<span class="uscript-operator">[</span><span class="uscript-number">2</span><span class="uscript-operator">]</span> <span class="uscript-operator">+=</span> C<span class="uscript-operator">;</span>
    Buf<span class="uscript-operator">[</span><span class="uscript-number">3</span><span class="uscript-operator">]</span> <span class="uscript-operator">+=</span> D<span class="uscript-operator">;</span>
<span class="uscript-operator">}</span>

<span class="uscript-comment">/** update MD5 context */</span>
<span class="uscript-keyword">static</span> <span class="uscript-keyword">final</span> <span class="uscript-keyword">function</span> MD5Update<span class="uscript-operator">(</span><span class="uscript-keyword">out</span> MD5_CTX Context<span class="uscript-operator">,</span> <span class="uscript-type">string</span> Data<span class="uscript-operator">,</span> <span class="uscript-type">int</span> inputLen<span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
    <span class="uscript-keyword">local</span> <span class="uscript-type">int</span> i<span class="uscript-operator">,</span> index<span class="uscript-operator">,</span> partlen<span class="uscript-operator">;</span>
    <span class="uscript-keyword">local</span> <span class="uscript-keyword">array</span><span class="uscript-operator">&lt;</span><span class="uscript-type">byte</span><span class="uscript-operator">&gt;</span> tmpbuf<span class="uscript-operator">;</span>

    tmpbuf<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span> <span class="uscript-operator">=</span> <span class="uscript-number">64</span><span class="uscript-operator">;</span>
    index <span class="uscript-operator">=</span> <span class="uscript-operator">(</span><span class="uscript-operator">(</span>context<span class="uscript-operator">.</span>count<span class="uscript-operator">[</span><span class="uscript-number">0</span><span class="uscript-operator">]</span> <span class="uscript-operator">&gt;&gt;&gt;</span> <span class="uscript-number">3</span><span class="uscript-operator">)</span> <span class="uscript-operator">&amp;</span> <span class="uscript-number">0x3F</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">(</span>context<span class="uscript-operator">.</span>count<span class="uscript-operator">[</span><span class="uscript-number">0</span><span class="uscript-operator">]</span> <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span>inputLen <span class="uscript-operator">&lt;&lt;</span> <span class="uscript-number">3</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">&lt;</span> <span class="uscript-operator">(</span>inputLen <span class="uscript-operator">&lt;&lt;</span> <span class="uscript-number">3</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
        context<span class="uscript-operator">.</span>count<span class="uscript-operator">[</span><span class="uscript-number">1</span><span class="uscript-operator">]</span><span class="uscript-operator">++</span><span class="uscript-operator">;</span>
    context<span class="uscript-operator">.</span>count<span class="uscript-operator">[</span><span class="uscript-number">1</span><span class="uscript-operator">]</span> <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span>inputLen <span class="uscript-operator">&gt;&gt;&gt;</span> <span class="uscript-number">29</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    partLen <span class="uscript-operator">=</span> <span class="uscript-number">64</span> <span class="uscript-operator">-</span> index<span class="uscript-operator">;</span>

    <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>inputLen <span class="uscript-operator">&gt;=</span> partLen<span class="uscript-operator">)</span>
    <span class="uscript-operator">{</span>
        MD5Move<span class="uscript-operator">(</span>Data<span class="uscript-operator">,</span> <span class="uscript-number">0</span><span class="uscript-operator">,</span> context<span class="uscript-operator">.</span>buffer<span class="uscript-operator">,</span> index<span class="uscript-operator">,</span> partLen<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
        MD5Transform <span class="uscript-operator">(</span>context<span class="uscript-operator">.</span><span class="uscript-keyword">state</span><span class="uscript-operator">,</span> context<span class="uscript-operator">.</span>buffer<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
        <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i <span class="uscript-operator">=</span> partLen<span class="uscript-operator">;</span> i <span class="uscript-operator">+</span> <span class="uscript-number">63</span> <span class="uscript-operator">&lt;</span> inputLen<span class="uscript-operator">;</span> i <span class="uscript-operator">+=</span> <span class="uscript-number">64</span><span class="uscript-operator">)</span>
        <span class="uscript-operator">{</span>
            MD5Move<span class="uscript-operator">(</span>Data<span class="uscript-operator">,</span> i<span class="uscript-operator">,</span> tmpbuf<span class="uscript-operator">,</span> <span class="uscript-number">0</span><span class="uscript-operator">,</span> <span class="uscript-number">64</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
            MD5Transform <span class="uscript-operator">(</span>context<span class="uscript-operator">.</span><span class="uscript-keyword">state</span><span class="uscript-operator">,</span> tmpbuf<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
        <span class="uscript-operator">}</span>
        index <span class="uscript-operator">=</span> <span class="uscript-number">0</span><span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>
    <span class="uscript-keyword">else</span>
        i <span class="uscript-operator">=</span> <span class="uscript-number">0</span><span class="uscript-operator">;</span>

    MD5Move<span class="uscript-operator">(</span>Data<span class="uscript-operator">,</span> i<span class="uscript-operator">,</span> context<span class="uscript-operator">.</span>buffer<span class="uscript-operator">,</span> index<span class="uscript-operator">,</span> inputLen<span class="uscript-operator">-</span>i<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-operator">}</span>

<span class="uscript-comment">/** finalize the MD5 context */</span>
<span class="uscript-keyword">static</span> <span class="uscript-keyword">final</span> <span class="uscript-keyword">function</span> MD5Final <span class="uscript-operator">(</span><span class="uscript-keyword">out</span> <span class="uscript-keyword">array</span><span class="uscript-operator">&lt;</span><span class="uscript-type">byte</span><span class="uscript-operator">&gt;</span> digest<span class="uscript-operator">,</span> <span class="uscript-keyword">out</span> MD5_CTX context<span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
    <span class="uscript-keyword">local</span> <span class="uscript-keyword">array</span><span class="uscript-operator">&lt;</span><span class="uscript-type">byte</span><span class="uscript-operator">&gt;</span> bits<span class="uscript-operator">;</span>
    <span class="uscript-keyword">local</span> <span class="uscript-type">int</span> i<span class="uscript-operator">,</span> index<span class="uscript-operator">,</span> padLen<span class="uscript-operator">;</span>
    <span class="uscript-keyword">local</span> <span class="uscript-type">string</span> strbits<span class="uscript-operator">;</span>
    <span class="uscript-keyword">local</span> <span class="uscript-type">string</span> PADDING<span class="uscript-operator">;</span>

    PADDING <span class="uscript-operator">=</span> chr<span class="uscript-operator">(</span><span class="uscript-number">0x80</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i <span class="uscript-operator">=</span> <span class="uscript-number">1</span><span class="uscript-operator">;</span> i <span class="uscript-operator">&lt;</span> <span class="uscript-number">64</span><span class="uscript-operator">;</span> i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
        PADDING <span class="uscript-operator">=</span> PADDING<span class="uscript-operator">$</span>chr<span class="uscript-operator">(</span><span class="uscript-number">0</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>

    Encode <span class="uscript-operator">(</span>bits<span class="uscript-operator">,</span> context<span class="uscript-operator">.</span>count<span class="uscript-operator">,</span> <span class="uscript-number">8</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>

    index <span class="uscript-operator">=</span> <span class="uscript-operator">(</span><span class="uscript-operator">(</span>context<span class="uscript-operator">.</span>count<span class="uscript-operator">[</span><span class="uscript-number">0</span><span class="uscript-operator">]</span> <span class="uscript-operator">&gt;&gt;&gt;</span> <span class="uscript-number">3</span><span class="uscript-operator">)</span> <span class="uscript-operator">&amp;</span> <span class="uscript-number">0x3f</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>index <span class="uscript-operator">&lt;</span> <span class="uscript-number">56</span><span class="uscript-operator">)</span>
        padLen <span class="uscript-operator">=</span> <span class="uscript-operator">(</span><span class="uscript-number">56</span> <span class="uscript-operator">-</span> index<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    <span class="uscript-keyword">else</span>
        padLen <span class="uscript-operator">=</span> <span class="uscript-operator">(</span><span class="uscript-number">120</span> <span class="uscript-operator">-</span> index<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    MD5Update <span class="uscript-operator">(</span>context<span class="uscript-operator">,</span> PADDING<span class="uscript-operator">,</span> padLen<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    strbits <span class="uscript-operator">=</span> <span class="uscript-string">""</span><span class="uscript-operator">;</span>
    <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>i<span class="uscript-operator">&lt;</span><span class="uscript-number">8</span><span class="uscript-operator">;</span>i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
        strbits <span class="uscript-operator">=</span> strbits<span class="uscript-operator">$</span>Chr<span class="uscript-operator">(</span>bits<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    MD5Update <span class="uscript-operator">(</span>context<span class="uscript-operator">,</span> strbits<span class="uscript-operator">,</span> <span class="uscript-number">8</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    Encode <span class="uscript-operator">(</span>digest<span class="uscript-operator">,</span> context<span class="uscript-operator">.</span><span class="uscript-keyword">state</span><span class="uscript-operator">,</span> <span class="uscript-number">16</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>

    <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i <span class="uscript-operator">=</span> <span class="uscript-number">0</span><span class="uscript-operator">;</span> i <span class="uscript-operator">&lt;</span> <span class="uscript-number">64</span><span class="uscript-operator">;</span> i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
    <span class="uscript-operator">{</span>
        context<span class="uscript-operator">.</span>buffer<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span> <span class="uscript-operator">=</span> <span class="uscript-number">0</span><span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>
<span class="uscript-operator">}</span>

<span class="uscript-keyword">static</span> <span class="uscript-keyword">final</span> <span class="uscript-keyword">function</span> Encode <span class="uscript-operator">(</span><span class="uscript-keyword">out</span> <span class="uscript-keyword">array</span><span class="uscript-operator">&lt;</span><span class="uscript-type">byte</span><span class="uscript-operator">&gt;</span> output<span class="uscript-operator">,</span> <span class="uscript-keyword">array</span><span class="uscript-operator">&lt;</span><span class="uscript-type">int</span><span class="uscript-operator">&gt;</span> <span class="uscript-keyword">input</span><span class="uscript-operator">,</span> <span class="uscript-type">int</span> len<span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
    <span class="uscript-keyword">local</span> <span class="uscript-type">int</span> i<span class="uscript-operator">,</span> j<span class="uscript-operator">;</span>

    i <span class="uscript-operator">=</span> <span class="uscript-number">0</span><span class="uscript-operator">;</span>
    <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>j <span class="uscript-operator">=</span> <span class="uscript-number">0</span><span class="uscript-operator">;</span> j <span class="uscript-operator">&lt;</span> len<span class="uscript-operator">;</span> j <span class="uscript-operator">+=</span> <span class="uscript-number">4</span><span class="uscript-operator">)</span>
    <span class="uscript-operator">{</span>
        output<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span> <span class="uscript-operator">=</span> <span class="uscript-operator">(</span><span class="uscript-keyword">input</span><span class="uscript-operator">[</span>i<span class="uscript-operator">]</span> <span class="uscript-operator">&amp;</span> <span class="uscript-number">0xff</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
        output<span class="uscript-operator">[</span>j<span class="uscript-number">+1</span><span class="uscript-operator">]</span> <span class="uscript-operator">=</span> <span class="uscript-operator">(</span><span class="uscript-operator">(</span><span class="uscript-keyword">input</span><span class="uscript-operator">[</span>i<span class="uscript-operator">]</span> <span class="uscript-operator">&gt;&gt;</span> <span class="uscript-number">8</span><span class="uscript-operator">)</span> <span class="uscript-operator">&amp;</span> <span class="uscript-number">0xff</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
        output<span class="uscript-operator">[</span>j<span class="uscript-number">+2</span><span class="uscript-operator">]</span> <span class="uscript-operator">=</span> <span class="uscript-operator">(</span><span class="uscript-operator">(</span><span class="uscript-keyword">input</span><span class="uscript-operator">[</span>i<span class="uscript-operator">]</span> <span class="uscript-operator">&gt;&gt;</span> <span class="uscript-number">16</span><span class="uscript-operator">)</span> <span class="uscript-operator">&amp;</span> <span class="uscript-number">0xff</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
        output<span class="uscript-operator">[</span>j<span class="uscript-number">+3</span><span class="uscript-operator">]</span> <span class="uscript-operator">=</span> <span class="uscript-operator">(</span><span class="uscript-operator">(</span><span class="uscript-keyword">input</span><span class="uscript-operator">[</span>i<span class="uscript-operator">]</span> <span class="uscript-operator">&gt;&gt;</span> <span class="uscript-number">24</span><span class="uscript-operator">)</span> <span class="uscript-operator">&amp;</span> <span class="uscript-number">0xff</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
        i<span class="uscript-operator">++</span><span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>
<span class="uscript-operator">}</span>


<span class="uscript-keyword">static</span> <span class="uscript-keyword">final</span> <span class="uscript-keyword">function</span> Decode<span class="uscript-operator">(</span><span class="uscript-keyword">out</span> <span class="uscript-keyword">array</span><span class="uscript-operator">&lt;</span><span class="uscript-type">int</span><span class="uscript-operator">&gt;</span> output<span class="uscript-operator">,</span> <span class="uscript-keyword">array</span><span class="uscript-operator">&lt;</span><span class="uscript-type">byte</span><span class="uscript-operator">&gt;</span> <span class="uscript-keyword">input</span><span class="uscript-operator">,</span> <span class="uscript-type">int</span> len<span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
    <span class="uscript-keyword">local</span> <span class="uscript-type">int</span> i<span class="uscript-operator">,</span> j<span class="uscript-operator">;</span>

    i <span class="uscript-operator">=</span> <span class="uscript-number">0</span><span class="uscript-operator">;</span>
    <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>j <span class="uscript-operator">=</span> <span class="uscript-number">0</span><span class="uscript-operator">;</span> j <span class="uscript-operator">&lt;</span> len<span class="uscript-operator">;</span> j <span class="uscript-operator">+=</span> <span class="uscript-number">4</span><span class="uscript-operator">)</span>
    <span class="uscript-operator">{</span>
        output<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span> <span class="uscript-operator">=</span> <span class="uscript-operator">(</span><span class="uscript-operator">(</span><span class="uscript-keyword">input</span><span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">)</span> <span class="uscript-operator">|</span> <span class="uscript-operator">(</span><span class="uscript-type">int</span><span class="uscript-operator">(</span><span class="uscript-keyword">input</span><span class="uscript-operator">[</span>j<span class="uscript-number">+1</span><span class="uscript-operator">]</span><span class="uscript-operator">)</span> <span class="uscript-operator">&lt;&lt;</span> <span class="uscript-number">8</span><span class="uscript-operator">)</span> <span class="uscript-operator">|</span> <span class="uscript-operator">(</span><span class="uscript-type">int</span><span class="uscript-operator">(</span><span class="uscript-keyword">input</span><span class="uscript-operator">[</span>j<span class="uscript-number">+2</span><span class="uscript-operator">]</span><span class="uscript-operator">)</span> <span class="uscript-operator">&lt;&lt;</span> <span class="uscript-number">16</span><span class="uscript-operator">)</span> <span class="uscript-operator">|</span> <span class="uscript-operator">(</span><span class="uscript-type">int</span><span class="uscript-operator">(</span><span class="uscript-keyword">input</span><span class="uscript-operator">[</span>j<span class="uscript-number">+3</span><span class="uscript-operator">]</span><span class="uscript-operator">)</span> <span class="uscript-operator">&lt;&lt;</span> <span class="uscript-number">24</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
        i<span class="uscript-operator">++</span><span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>
<span class="uscript-operator">}</span>


<span class="uscript-keyword">static</span> <span class="uscript-keyword">final</span> <span class="uscript-keyword">function</span> MD5Move<span class="uscript-operator">(</span><span class="uscript-type">string</span> src<span class="uscript-operator">,</span> <span class="uscript-type">int</span> srcindex<span class="uscript-operator">,</span> <span class="uscript-keyword">out</span> <span class="uscript-keyword">array</span><span class="uscript-operator">&lt;</span><span class="uscript-type">byte</span><span class="uscript-operator">&gt;</span> buffer<span class="uscript-operator">,</span> <span class="uscript-type">int</span> bufindex<span class="uscript-operator">,</span> <span class="uscript-type">int</span> len<span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
    <span class="uscript-keyword">local</span> <span class="uscript-type">int</span> i<span class="uscript-operator">,</span>j<span class="uscript-operator">;</span>

    j <span class="uscript-operator">=</span> bufindex<span class="uscript-operator">;</span>
    <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i <span class="uscript-operator">=</span> srcindex<span class="uscript-operator">;</span> i <span class="uscript-operator">&lt;</span> srcindex<span class="uscript-operator">+</span>len<span class="uscript-operator">;</span> i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
    <span class="uscript-operator">{</span>
        buffer<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span> <span class="uscript-operator">=</span> Asc<span class="uscript-operator">(</span>Mid<span class="uscript-operator">(</span>src<span class="uscript-operator">,</span> i<span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
        j<span class="uscript-operator">++</span><span class="uscript-operator">;</span>
        <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>j <span class="uscript-operator">==</span> <span class="uscript-number">64</span><span class="uscript-operator">)</span>
            <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>
<span class="uscript-operator">}</span>


<span class="uscript-keyword">static</span> <span class="uscript-keyword">final</span> <span class="uscript-keyword">function</span> <span class="uscript-type">int</span> ROTATE_LEFT <span class="uscript-operator">(</span><span class="uscript-type">int</span> x<span class="uscript-operator">,</span> <span class="uscript-type">int</span> n<span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
    <span class="uscript-keyword">return</span> <span class="uscript-operator">(</span><span class="uscript-operator">(</span><span class="uscript-operator">(</span>x<span class="uscript-operator">)</span> <span class="uscript-operator">&lt;&lt;</span> <span class="uscript-operator">(</span>n<span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">|</span> <span class="uscript-operator">(</span><span class="uscript-operator">(</span>x<span class="uscript-operator">)</span> <span class="uscript-operator">&gt;&gt;&gt;</span> <span class="uscript-operator">(</span><span class="uscript-number">32</span><span class="uscript-operator">-</span><span class="uscript-operator">(</span>n<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-operator">}</span>

<span class="uscript-keyword">static</span> <span class="uscript-keyword">final</span> <span class="uscript-keyword">function</span> <span class="uscript-type">int</span> F <span class="uscript-operator">(</span><span class="uscript-type">int</span> x<span class="uscript-operator">,</span> <span class="uscript-type">int</span> y<span class="uscript-operator">,</span> <span class="uscript-type">int</span> z<span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
    <span class="uscript-keyword">return</span> <span class="uscript-operator">(</span><span class="uscript-operator">(</span><span class="uscript-operator">(</span>x<span class="uscript-operator">)</span> <span class="uscript-operator">&amp;</span> <span class="uscript-operator">(</span>y<span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">|</span> <span class="uscript-operator">(</span><span class="uscript-operator">(</span><span class="uscript-operator">~</span>x<span class="uscript-operator">)</span> <span class="uscript-operator">&amp;</span> <span class="uscript-operator">(</span>z<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-operator">}</span>

<span class="uscript-keyword">static</span> <span class="uscript-keyword">final</span> <span class="uscript-keyword">function</span> <span class="uscript-type">int</span> G <span class="uscript-operator">(</span><span class="uscript-type">int</span> x<span class="uscript-operator">,</span> <span class="uscript-type">int</span> y<span class="uscript-operator">,</span> <span class="uscript-type">int</span> z<span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
    <span class="uscript-keyword">return</span> <span class="uscript-operator">(</span><span class="uscript-operator">(</span>x <span class="uscript-operator">&amp;</span> z<span class="uscript-operator">)</span> <span class="uscript-operator">|</span> <span class="uscript-operator">(</span>y <span class="uscript-operator">&amp;</span> <span class="uscript-operator">(</span><span class="uscript-operator">~</span>z<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-operator">}</span>

<span class="uscript-keyword">static</span> <span class="uscript-keyword">final</span> <span class="uscript-keyword">function</span> <span class="uscript-type">int</span> H <span class="uscript-operator">(</span><span class="uscript-type">int</span> x<span class="uscript-operator">,</span> <span class="uscript-type">int</span> y<span class="uscript-operator">,</span> <span class="uscript-type">int</span> z<span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
    <span class="uscript-keyword">return</span> <span class="uscript-operator">(</span>x <span class="uscript-operator">^</span> y <span class="uscript-operator">^</span> z<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-operator">}</span>

<span class="uscript-keyword">static</span> <span class="uscript-keyword">final</span> <span class="uscript-keyword">function</span> <span class="uscript-type">int</span> I <span class="uscript-operator">(</span><span class="uscript-type">int</span> x<span class="uscript-operator">,</span> <span class="uscript-type">int</span> y<span class="uscript-operator">,</span> <span class="uscript-type">int</span> z<span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
    <span class="uscript-keyword">return</span> <span class="uscript-operator">(</span>y <span class="uscript-operator">^</span> <span class="uscript-operator">(</span>x <span class="uscript-operator">|</span> <span class="uscript-operator">(</span><span class="uscript-operator">~</span>z<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-operator">}</span>

<span class="uscript-keyword">static</span> <span class="uscript-keyword">final</span> <span class="uscript-keyword">function</span> FF<span class="uscript-operator">(</span><span class="uscript-keyword">out</span> <span class="uscript-type">int</span> a<span class="uscript-operator">,</span> <span class="uscript-type">int</span> b<span class="uscript-operator">,</span> <span class="uscript-type">int</span> c<span class="uscript-operator">,</span> <span class="uscript-type">int</span> d<span class="uscript-operator">,</span> <span class="uscript-type">int</span> x<span class="uscript-operator">,</span> <span class="uscript-type">int</span> s<span class="uscript-operator">,</span> <span class="uscript-type">int</span> ac<span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
    a <span class="uscript-operator">+=</span> F<span class="uscript-operator">(</span>b<span class="uscript-operator">,</span> c<span class="uscript-operator">,</span> d<span class="uscript-operator">)</span> <span class="uscript-operator">+</span> x <span class="uscript-operator">+</span> ac<span class="uscript-operator">;</span>
    a <span class="uscript-operator">=</span> ROTATE_LEFT <span class="uscript-operator">(</span>a<span class="uscript-operator">,</span> s<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    a <span class="uscript-operator">+=</span> b<span class="uscript-operator">;</span>
<span class="uscript-operator">}</span>

<span class="uscript-keyword">static</span> <span class="uscript-keyword">final</span> <span class="uscript-keyword">function</span> GG<span class="uscript-operator">(</span><span class="uscript-keyword">out</span> <span class="uscript-type">int</span> a<span class="uscript-operator">,</span> <span class="uscript-type">int</span> b<span class="uscript-operator">,</span> <span class="uscript-type">int</span> c<span class="uscript-operator">,</span> <span class="uscript-type">int</span> d<span class="uscript-operator">,</span> <span class="uscript-type">int</span> x<span class="uscript-operator">,</span> <span class="uscript-type">int</span> s<span class="uscript-operator">,</span> <span class="uscript-type">int</span> ac<span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
    a <span class="uscript-operator">+=</span> G<span class="uscript-operator">(</span>b<span class="uscript-operator">,</span> c<span class="uscript-operator">,</span> d<span class="uscript-operator">)</span> <span class="uscript-operator">+</span> x <span class="uscript-operator">+</span> ac<span class="uscript-operator">;</span>
    a <span class="uscript-operator">=</span> rotate_left <span class="uscript-operator">(</span>a<span class="uscript-operator">,</span> s<span class="uscript-operator">)</span> <span class="uscript-operator">+</span>b<span class="uscript-operator">;</span>
<span class="uscript-operator">}</span>

<span class="uscript-keyword">static</span> <span class="uscript-keyword">final</span> <span class="uscript-keyword">function</span> HH<span class="uscript-operator">(</span><span class="uscript-keyword">out</span> <span class="uscript-type">int</span> a<span class="uscript-operator">,</span> <span class="uscript-type">int</span> b<span class="uscript-operator">,</span> <span class="uscript-type">int</span> c<span class="uscript-operator">,</span> <span class="uscript-type">int</span> d<span class="uscript-operator">,</span> <span class="uscript-type">int</span> x<span class="uscript-operator">,</span> <span class="uscript-type">int</span> s<span class="uscript-operator">,</span> <span class="uscript-type">int</span> ac<span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
    a <span class="uscript-operator">+=</span> H<span class="uscript-operator">(</span>b<span class="uscript-operator">,</span> c<span class="uscript-operator">,</span> d<span class="uscript-operator">)</span> <span class="uscript-operator">+</span> x <span class="uscript-operator">+</span> ac<span class="uscript-operator">;</span>
    a <span class="uscript-operator">=</span> rotate_left <span class="uscript-operator">(</span>a<span class="uscript-operator">,</span> s<span class="uscript-operator">)</span> <span class="uscript-operator">+</span>b<span class="uscript-operator">;</span>
<span class="uscript-operator">}</span>

<span class="uscript-keyword">static</span> <span class="uscript-keyword">final</span> <span class="uscript-keyword">function</span> II<span class="uscript-operator">(</span><span class="uscript-keyword">out</span> <span class="uscript-type">int</span> a<span class="uscript-operator">,</span> <span class="uscript-type">int</span> b<span class="uscript-operator">,</span> <span class="uscript-type">int</span> c<span class="uscript-operator">,</span> <span class="uscript-type">int</span> d<span class="uscript-operator">,</span> <span class="uscript-type">int</span> x<span class="uscript-operator">,</span> <span class="uscript-type">int</span> s<span class="uscript-operator">,</span> <span class="uscript-type">int</span> ac<span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
    a <span class="uscript-operator">+=</span> I<span class="uscript-operator">(</span>b<span class="uscript-operator">,</span> c<span class="uscript-operator">,</span> d<span class="uscript-operator">)</span> <span class="uscript-operator">+</span> x <span class="uscript-operator">+</span> ac<span class="uscript-operator">;</span>
    a <span class="uscript-operator">=</span> rotate_left <span class="uscript-operator">(</span>a<span class="uscript-operator">,</span> s<span class="uscript-operator">)</span> <span class="uscript-operator">+</span>b<span class="uscript-operator">;</span>
<span class="uscript-operator">}</span>

<span class="uscript-keyword">static</span> <span class="uscript-keyword">final</span> <span class="uscript-keyword">function</span> <span class="uscript-type">string</span> DecToHex<span class="uscript-operator">(</span><span class="uscript-type">int</span> dec<span class="uscript-operator">,</span> <span class="uscript-type">int</span> size<span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
    <span class="uscript-keyword">const</span> hex <span class="uscript-operator">=</span> <span class="uscript-string">"0123456789ABCDEF"</span><span class="uscript-operator">;</span>
    <span class="uscript-keyword">local</span> <span class="uscript-type">string</span> s<span class="uscript-operator">;</span>
    <span class="uscript-keyword">local</span> <span class="uscript-type">int</span> i<span class="uscript-operator">;</span>

    <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i <span class="uscript-operator">=</span> <span class="uscript-number">0</span><span class="uscript-operator">;</span> i <span class="uscript-operator">&lt;</span> size<span class="uscript-operator">*</span><span class="uscript-number">2</span><span class="uscript-operator">;</span> i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
    <span class="uscript-operator">{</span>
        s <span class="uscript-operator">=</span> mid<span class="uscript-operator">(</span>hex<span class="uscript-operator">,</span> dec <span class="uscript-operator">&amp;</span> <span class="uscript-number">0xf</span><span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span> <span class="uscript-operator">$</span> s<span class="uscript-operator">;</span>
        dec <span class="uscript-operator">=</span> dec <span class="uscript-operator">&gt;&gt;&gt;</span> <span class="uscript-number">4</span><span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>

    <span class="uscript-keyword">return</span> s<span class="uscript-operator">;</span>
<span class="uscript-operator">}</span></pre><h2><a name="0.2"></a>License</h2>
<p>Copyright 2004 (c) Petr Jelinek</p>
<p>Released under the <a href="lesseropenunrealmodlicense.html">LesserOpenUnrealModLicense</a> </p>
<h2><a name="0.3"></a>Discussion</h2>
<p><em class="em2">Wormbo:</em> This implementation is suboptimal due to the way UnrealScript's handles parameters and function calls. It probably spends 30-50% of the execution time only passing parameters and calling functions &ndash; two things UnrealScript isn't particularly good at (especially with large parameters like the MD5 context here) because it involves assigning values to variables.<br>I'm currently working on implementations of <a href="md5hash.html">MD5Hash</a> and <a href="sha1hash.html">SHA1Hash</a> for UnrealScript and the MD5 algorithm generally out-performs this one by 30-40%.</p>
<h2><a name="0.4"></a>Related Articles</h2>
<ul><li><a href="crc32.html">CRC32</a></li>
<li><a href="sha1hash.html">SHA1</a></li>
<li><span class="interwiki"><img 
      alt="Wikipedia logo"
      title="Wikipedia"
      src="shared//InterWiki-Wikipedia.png">&nbsp;<a href="http://www.wikipedia.com/wiki/MD5">MD5</a></span></li>
</ul>
<hr class="thin"><p><a href="category-algorithm.html">Category Algorithm</a></p>
<script type="text/javascript"><!--
 menuItemAdd("Code", "#0.1");
menuItemAdd("License", "#0.2");
menuItemAdd("Discussion", "#0.3");
menuItemAdd("Related Articles", "#0.4");
 menuWrite() //--></script></div>
</div>

<div id="footer" class="bar">
	<p><form method="post" action="http://wiki.beyondunreal.com/wiki" enctype="application/x-www-form-urlencoded">
<a href="(start).html">Home Page</a> | <a href="recent-changes.html">Recent Changes</a> | <a href="http://wiki.beyondunreal.com/wiki?action=editprefs">Preferences</a><br>
<a href="http://wiki.beyondunreal.com/wiki?action=edit&id=MD5">Edit text of this page</a> | <a href="http://wiki.beyondunreal.com/wiki?action=history&id=MD5">View other revisions</a><br>Last edited April 6, 2006 18:19 <a href="http://wiki.beyondunreal.com/wiki?action=browse&diff=1&id=MD5">(diff)</a><br>Search: <input type="text" name="search"  size="20" /><input type="hidden" name="dosearch" value="1"  /><br><br><small><a href="http://wiki.beyondunreal.com/wiki/MD5">Original page</a> &#150; copy created Sat, Jun 23, 2007</small><div></div>
</form>
	</p>
	<p>Always snap to grid
</p>
</div>
</div><!-- close of "scrolling" div -->

<div id="quickbar">
	<div id="logo"><a href="http://wiki.beyondunreal.com/"><img src="shared/wikilogo.jpg" width="143" height="100" border="0"></a>
		</div>
	<div class="qbsitename">
		<p>The Unreal Engine Documentation Site</p>
	</div>
	<div class="qbsection">
<p><a href="metatopics.html">Wiki Community</a></p>
<p><a href="category-category.html">Topic Categories</a></p>
<p><a href="/cgi-bin/imageupload.cgi/wiki-ext/imageupload.htt" target="_blank ">Image Uploads</a></p>
<p><a href="http://wiki.beyondunreal.com/wiki?action=random">Random Page</a></p>
<p><a href="recent-changes.html">Recent Changes</a></p>
<p><a href="offline-wiki.html">Offline Wiki</a></p>
</div><div class="qbsection">
<p><a href="unreal-engine.html">Unreal Engine</a></p>
<p><a href="console-commands.html">Console Commands</a></p>
<p><a href="terminology.html">Terminology</a></p>
<p><a href="category-faq.html">FAQs</a></p>
<p><a href="help-desk.html">Help Desk</a></p>
</div><div class="qbsection">
<p><a href="topics-on-mapping.html">Mapping Topics</a></p>
<p><a href="mapping-lessons.html">Mapping Lessons</a></p>
<p><a href="unrealed-3.html">UnrealEd Interface</a></p>
</div><div class="qbsection">
<p><a href="unrealscript.html">UnrealScript Topics</a></p>
<p><a href="unrealscript-lessons.html">UnrealScript Lessons</a></p>
<p><a href="making-mods.html">Making Mods</a></p>
<p><a href="class-tree.html">Class Tree</a></p>
</div><div class="qbsection">
<p><a href="topics-on-modeling.html">Modeling Topics</a></p>
</div><div class="qbsection">
<p><a href="chongqing-page.html">Chongqing Page</a></p>
<p><a href="log-in.html">Log In</a></p></div>
</div>

</body></html>
