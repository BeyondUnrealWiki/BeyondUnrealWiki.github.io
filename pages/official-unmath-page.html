<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"  "http://www.w3.org/TR/html4/loose.dtd">

<html>
<head lang="en">
	<title>UnrealWiki: Official UnMath Page</title>
	<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
	<link rel="stylesheet" type="text/css" media="screen, print"
		href="shared/stylebase.structural.css">	
	<link rel="stylesheet" type="text/css" media="screen"
		href="shared/template-default.css">
	<link rel="stylesheet" type="text/css" media="screen"
		href="shared/styles.chblue.css">
	<link rel="stylesheet" type="text/css" media="print"
		href="shared/template-default-print.css">
	<!--[if IE 6]>
			<style>
			/* dirty hack for IE6. */
			#quickbar {
				position: absolute;
				}
			</style>
	<![endif]-->
  <link rel="start" href="http://wiki.beyondunreal.com/">
  <link rel="glossary"  href="http://wiki.beyondunreal.com/wiki/Terminology">
  <link rel="help"  href="http://wiki.beyondunreal.com/wiki/Using_The_Wiki">
<script type="text/javascript" src="shared/dhtml.js"></script>
<script type="text/javascript" src="shared/dhtml-menu.js"></script>
<style type="text/css">#dhtml-menu    { background: #eee; padding: 5px 0px; margin-right: -20px; border: 1px solid #888; border-left: 1px solid #ccc; border-top: 1px solid #ccc;  border-right: 1px solid #888; border-bottom: 1px solid #888 }
#dhtml-menu td { color: #000; font-family: Arial,Helvetica,sans-serif; font-size: 9pt; line-height: 13pt; padding: 1px 10px; cursor: default }
#dhtml-menu a  { color: #000; font-family: Arial,Helvetica,sans-serif; font-size: 9pt; line-height: 13pt; text-decoration: none }
#dhtml-menu tt { font-family: monospace; font-size: 9pt }
#dhtml-menu-separator { height: 1px; background: red }
#dhtml-menu-anchor { cursor: default }
</style>
<script type="text/javascript" src="shared/expandable.js"></script>
</head>
<body onLoad="menuInit(); document.cookie='page=Official_UnMath_Page; path=/'" class="default">
<div id="scrolling"><!-- contains all except the fixed sidebar -->
<div id="topbar"  class="bar">
	<div class="righthalf">
		<form class="inline" method="post" action="/wiki" enctype="application/x-www-form-urlencoded"><input type="text" name="search"  size="20" /> <input type="submit" name="search" value="search" /></form>
	</div>
	<div class="lefthalf">
		<script type="text/javascript"><!--
			menuAlignRight = false;
		//--></script>
		<span><script type="text/javascript"><!--
 menuWriteAnchor("Quick Navigation") //--></script></span> | <a href="../index.html">Home Page</a> | <a href="recent-changes.html">Recent Changes</a>
	</div>
</div>

<div id="content"><!-- contains the title and article -->
	<h1 class='pagetitle'><a href="http://wiki.beyondunreal.com/wiki?back=Official UnMath Page">Official UnMath Page</a></h1>
	<div class="wiki"><h2><a name="0.1"></a>Introduction</h2>
<p>The UnMath.h Header File (from, <a href="http://unreal.epicgames.com/files/ut432pubsrc.zip">[Unreal Tournament 432 C++ Publicly Released Headers]</a>) might more properly belong in the Unreal Engine Core section, since it is integral to every critical process that the Engine performs.<br> </p>
<p>The Official UnMath Page is derived from that Header File Released from Epic Games and coded in C++. The following is just a section from the file, that describes FVectors. It appears in the original Tim Sweeney code; an uncompiled text file. <br> </p>
<p>The complete UnMath.h file contains all the mathematical routines used by the Unreal Engine for collision detection, the Artificial Intelligence of Bots, and the physics (yes, even the Quaternion Rotations), and, ultimately, the rendering of the scene. It's WAY l33t<a href="http://wiki.beyondunreal.com/wiki?action=edit&id=L33t&referrerid=Official_UnMath_Page">?</a>,...but, unfortunately, WAY humungeous.<br> </p>
<p>We should have an analysis page to acompany it.<br> </p>
<p>It will take you at least 5 years to read it all,...and by that time the Engine hierarchy will have evolved into something incomprehensible and extremely highly advanced. </p>
<p><em class="em1">Preface:</em> The acronym API stands for Application Programming Interface. Just to give you an idea of the insane complexity of the UnMath routines, I have included a snippet of code for an important function <u><b>FuzzVectors</b></u>:</p>
<pre class="uscript"><span class="uscript-comment">/*-----------------------------------------------------------------------------
    FVector.
 -----------------------------------------------------------------------------*/</span>
 <span class="uscript-comment">// Information associated with a floating point vector, describing its</span>
 <span class="uscript-comment">// status as a point in a rendering context.</span>
 <span class="uscript-keyword">enum</span> EVectorFlags
 <span class="uscript-operator">{</span>
    FVF_OutXMin     <span class="uscript-operator">=</span> <span class="uscript-number">0x04</span><span class="uscript-operator">,</span> <span class="uscript-comment">// Outcode rejection, off left hand side of screen.</span>
    FVF_OutXMax     <span class="uscript-operator">=</span> <span class="uscript-number">0x08</span><span class="uscript-operator">,</span> <span class="uscript-comment">// Outcode rejection, off right hand side of screen.</span>
    FVF_OutYMin     <span class="uscript-operator">=</span> <span class="uscript-number">0x10</span><span class="uscript-operator">,</span> <span class="uscript-comment">// Outcode rejection, off top of screen.</span>
    FVF_OutYMax     <span class="uscript-operator">=</span> <span class="uscript-number">0x20</span><span class="uscript-operator">,</span> <span class="uscript-comment">// Outcode rejection, off bottom of screen.</span>
    FVF_OutNear     <span class="uscript-operator">=</span> <span class="uscript-number">0x40</span><span class="uscript-operator">,</span> <span class="uscript-comment">// Near clipping plane.</span>
    FVF_OutFar      <span class="uscript-operator">=</span> <span class="uscript-number">0x80</span><span class="uscript-operator">,</span> <span class="uscript-comment">// Far clipping plane.</span>
    FVF_OutReject   <span class="uscript-operator">=</span> <span class="uscript-operator">(</span>FVF_OutXMin <span class="uscript-operator">|</span> FVF_OutXMax <span class="uscript-operator">|</span> FVF_OutYMin <span class="uscript-operator">|</span> FVF_OutYMax<span class="uscript-operator">)</span><span class="uscript-operator">,</span> <span class="uscript-comment">//  Outcode rejectable.</span>
    FVF_OutSkip     <span class="uscript-operator">=</span> <span class="uscript-operator">(</span>FVF_OutXMin <span class="uscript-operator">|</span> FVF_OutXMax <span class="uscript-operator">|</span> FVF_OutYMin <span class="uscript-operator">|</span> FVF_OutYMax<span class="uscript-operator">)</span><span class="uscript-operator">,</span> <span class="uscript-comment">// Outcode clippable.</span>
 <span class="uscript-operator">}</span><span class="uscript-operator">;</span>

 <span class="uscript-comment">//</span>
 <span class="uscript-comment">// Floating point vector.</span>
 <span class="uscript-comment">// Playstation2 vectors are 16 bytes.</span>
 <span class="uscript-comment">//</span>
 #<span class="uscript-keyword">if</span> __PSX2_EE__
 #define FVECTOR_ALIGNMENT <span class="uscript-number">16</span>
 <span class="uscript-keyword">class</span> CORE_API FVector 
 <span class="uscript-operator">{</span>
 public:
    <span class="uscript-comment">// Variables.</span>
    <span class="uscript-type">FLOAT</span> X<span class="uscript-operator">,</span> Y<span class="uscript-operator">,</span> Z<span class="uscript-operator">,</span> W<span class="uscript-operator">;</span>

    <span class="uscript-comment">// Constructors.</span>
    FVector<span class="uscript-operator">(</span><span class="uscript-operator">)</span>
    <span class="uscript-operator">{</span><span class="uscript-operator">}</span>

    FVector<span class="uscript-operator">(</span> <span class="uscript-type">FLOAT</span> InX<span class="uscript-operator">,</span> <span class="uscript-type">FLOAT</span> InY<span class="uscript-operator">,</span> <span class="uscript-type">FLOAT</span> InZ <span class="uscript-operator">)</span>
    :   X<span class="uscript-operator">(</span>InX<span class="uscript-operator">)</span><span class="uscript-operator">,</span> Y<span class="uscript-operator">(</span>InY<span class="uscript-operator">)</span><span class="uscript-operator">,</span> Z<span class="uscript-operator">(</span>InZ<span class="uscript-operator">)</span><span class="uscript-operator">,</span> W<span class="uscript-operator">(</span><span class="uscript-number">1</span><span class="uscript-operator">.</span>f<span class="uscript-operator">)</span>
    <span class="uscript-operator">{</span><span class="uscript-operator">}</span>

    <span class="uscript-comment">// Binary math operators.</span>
    inline FVector <span class="uscript-keyword">operator</span><span class="uscript-operator">^</span><span class="uscript-operator">(</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> V <span class="uscript-operator">)</span> <span class="uscript-keyword">const</span>
    <span class="uscript-operator">{</span>
        FVector r<span class="uscript-operator">;</span>
        asm volatile <span class="uscript-operator">(</span><span class="uscript-string">"</span>
            lqc2        vf2<span class="uscript-operator">,</span> <span class="uscript-number">0x00</span><span class="uscript-operator">(</span><span class="uscript-operator">%</span><span class="uscript-number">1</span><span class="uscript-operator">)</span>
            lqc2        vf3<span class="uscript-operator">,</span> <span class="uscript-number">0x00</span><span class="uscript-operator">(</span><span class="uscript-operator">%</span><span class="uscript-number">2</span><span class="uscript-operator">)</span>
            vopmula<span class="uscript-operator">.</span>xyz ACCxyz<span class="uscript-operator">,</span> vf2xyz<span class="uscript-operator">,</span> vf3xyz
            vopmsub<span class="uscript-operator">.</span>xyz vf1xyz<span class="uscript-operator">,</span> vf3xyz<span class="uscript-operator">,</span> vf2xyz
            sqc2        vf1<span class="uscript-operator">,</span> <span class="uscript-number">0x00</span><span class="uscript-operator">(</span><span class="uscript-operator">%</span><span class="uscript-number">0</span><span class="uscript-operator">)</span>
        <span class="uscript-string">"</span>
        :
        : <span class="uscript-string">"r"</span> <span class="uscript-operator">(</span><span class="uscript-operator">&amp;</span>r<span class="uscript-operator">)</span><span class="uscript-operator">,</span> <span class="uscript-string">"r"</span> <span class="uscript-operator">(</span>this<span class="uscript-operator">)</span><span class="uscript-operator">,</span> <span class="uscript-string">"r"</span> <span class="uscript-operator">(</span><span class="uscript-operator">&amp;</span>V<span class="uscript-operator">)</span>
        : <span class="uscript-string">"memory"</span>
        <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
        <span class="uscript-keyword">return</span> r<span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>
    inline <span class="uscript-type">FLOAT</span> <span class="uscript-keyword">operator</span><span class="uscript-operator">|</span><span class="uscript-operator">(</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> V <span class="uscript-operator">)</span> <span class="uscript-keyword">const</span>
    <span class="uscript-operator">{</span>
        FVector r<span class="uscript-operator">;</span>
        asm volatile <span class="uscript-operator">(</span><span class="uscript-string">"</span>
            lqc2        vf2<span class="uscript-operator">,</span> <span class="uscript-number">0x00</span><span class="uscript-operator">(</span><span class="uscript-operator">%</span><span class="uscript-number">1</span><span class="uscript-operator">)</span>
            lqc2        vf3<span class="uscript-operator">,</span> <span class="uscript-number">0x00</span><span class="uscript-operator">(</span><span class="uscript-operator">%</span><span class="uscript-number">2</span><span class="uscript-operator">)</span>
            vmul<span class="uscript-operator">.</span>xyz    vf1<span class="uscript-operator">,</span> vf2<span class="uscript-operator">,</span> vf3
            sqc2        vf1<span class="uscript-operator">,</span> <span class="uscript-number">0x00</span><span class="uscript-operator">(</span><span class="uscript-operator">%</span><span class="uscript-number">0</span><span class="uscript-operator">)</span>
        <span class="uscript-string">"</span>
        :
        : <span class="uscript-string">"r"</span> <span class="uscript-operator">(</span><span class="uscript-operator">&amp;</span>r<span class="uscript-operator">)</span><span class="uscript-operator">,</span> <span class="uscript-string">"r"</span> <span class="uscript-operator">(</span>this<span class="uscript-operator">)</span><span class="uscript-operator">,</span> <span class="uscript-string">"r"</span> <span class="uscript-operator">(</span><span class="uscript-operator">&amp;</span>V<span class="uscript-operator">)</span>
        : <span class="uscript-string">"memory"</span>
        <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
        <span class="uscript-keyword">return</span> r<span class="uscript-operator">.</span>X <span class="uscript-operator">+</span> r<span class="uscript-operator">.</span>Y <span class="uscript-operator">+</span> r<span class="uscript-operator">.</span>Z<span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>
    friend FVector <span class="uscript-keyword">operator</span><span class="uscript-operator">*</span><span class="uscript-operator">(</span> <span class="uscript-type">FLOAT</span> Scale<span class="uscript-operator">,</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> V <span class="uscript-operator">)</span>
    <span class="uscript-operator">{</span>
        <span class="uscript-keyword">return</span> FVector<span class="uscript-operator">(</span> V<span class="uscript-operator">.</span>X <span class="uscript-operator">*</span> Scale<span class="uscript-operator">,</span> V<span class="uscript-operator">.</span>Y <span class="uscript-operator">*</span> Scale<span class="uscript-operator">,</span> V<span class="uscript-operator">.</span>Z <span class="uscript-operator">*</span> Scale <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>
    inline FVector <span class="uscript-keyword">operator</span><span class="uscript-operator">+</span><span class="uscript-operator">(</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> V <span class="uscript-operator">)</span> <span class="uscript-keyword">const</span>
    <span class="uscript-operator">{</span>
        FVector r<span class="uscript-operator">;</span>
        asm volatile <span class="uscript-operator">(</span><span class="uscript-string">"</span>
            lqc2        vf2<span class="uscript-operator">,</span> <span class="uscript-number">0x00</span><span class="uscript-operator">(</span><span class="uscript-operator">%</span><span class="uscript-number">1</span><span class="uscript-operator">)</span>
            lqc2        vf3<span class="uscript-operator">,</span> <span class="uscript-number">0x00</span><span class="uscript-operator">(</span><span class="uscript-operator">%</span><span class="uscript-number">2</span><span class="uscript-operator">)</span>
            vadd<span class="uscript-operator">.</span>xyz    vf1<span class="uscript-operator">,</span> vf2<span class="uscript-operator">,</span> vf3
            sqc2        vf1<span class="uscript-operator">,</span> <span class="uscript-number">0x00</span><span class="uscript-operator">(</span><span class="uscript-operator">%</span><span class="uscript-number">0</span><span class="uscript-operator">)</span>
        <span class="uscript-string">"</span>
        :
        : <span class="uscript-string">"r"</span> <span class="uscript-operator">(</span><span class="uscript-operator">&amp;</span>r<span class="uscript-operator">)</span><span class="uscript-operator">,</span> <span class="uscript-string">"r"</span> <span class="uscript-operator">(</span>this<span class="uscript-operator">)</span><span class="uscript-operator">,</span> <span class="uscript-string">"r"</span> <span class="uscript-operator">(</span><span class="uscript-operator">&amp;</span>V<span class="uscript-operator">)</span>
        : <span class="uscript-string">"memory"</span>
        <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
        <span class="uscript-keyword">return</span> r<span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>
    inline FVector <span class="uscript-keyword">operator</span><span class="uscript-operator">-</span><span class="uscript-operator">(</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> V <span class="uscript-operator">)</span> <span class="uscript-keyword">const</span>
    <span class="uscript-operator">{</span>
        FVector r<span class="uscript-operator">;</span>
        asm volatile <span class="uscript-operator">(</span><span class="uscript-string">"</span>
            lqc2        vf2<span class="uscript-operator">,</span> <span class="uscript-number">0x00</span><span class="uscript-operator">(</span><span class="uscript-operator">%</span><span class="uscript-number">1</span><span class="uscript-operator">)</span>
            lqc2        vf3<span class="uscript-operator">,</span> <span class="uscript-number">0x00</span><span class="uscript-operator">(</span><span class="uscript-operator">%</span><span class="uscript-number">2</span><span class="uscript-operator">)</span>
            vsub<span class="uscript-operator">.</span>xyz    vf1<span class="uscript-operator">,</span> vf2<span class="uscript-operator">,</span> vf3
            sqc2        vf1<span class="uscript-operator">,</span> <span class="uscript-number">0x00</span><span class="uscript-operator">(</span><span class="uscript-operator">%</span><span class="uscript-number">0</span><span class="uscript-operator">)</span>
        <span class="uscript-string">"</span>
        :
        : <span class="uscript-string">"r"</span> <span class="uscript-operator">(</span><span class="uscript-operator">&amp;</span>r<span class="uscript-operator">)</span><span class="uscript-operator">,</span> <span class="uscript-string">"r"</span> <span class="uscript-operator">(</span>this<span class="uscript-operator">)</span><span class="uscript-operator">,</span> <span class="uscript-string">"r"</span> <span class="uscript-operator">(</span><span class="uscript-operator">&amp;</span>V<span class="uscript-operator">)</span>
        : <span class="uscript-string">"memory"</span>
        <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
        <span class="uscript-keyword">return</span> r<span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>
    inline FVector <span class="uscript-keyword">operator</span><span class="uscript-operator">*</span><span class="uscript-operator">(</span> <span class="uscript-type">FLOAT</span> Scale <span class="uscript-operator">)</span> <span class="uscript-keyword">const</span>
    <span class="uscript-operator">{</span>
        FVector r<span class="uscript-operator">;</span>
        asm volatile <span class="uscript-operator">(</span><span class="uscript-string">"</span>
            ctc2        <span class="uscript-operator">%</span><span class="uscript-number">2</span><span class="uscript-operator">,</span>  <span class="uscript-operator">$</span><span class="uscript-number">21</span>
            lqc2        vf2<span class="uscript-operator">,</span> <span class="uscript-number">0x00</span><span class="uscript-operator">(</span><span class="uscript-operator">%</span><span class="uscript-number">1</span><span class="uscript-operator">)</span>
            vmuli<span class="uscript-operator">.</span>xyz   vf1<span class="uscript-operator">,</span> vf2<span class="uscript-operator">,</span> I
            sqc2        vf1<span class="uscript-operator">,</span> <span class="uscript-number">0x00</span><span class="uscript-operator">(</span><span class="uscript-operator">%</span><span class="uscript-number">0</span><span class="uscript-operator">)</span>
        <span class="uscript-string">"</span>
        :
        : <span class="uscript-string">"r"</span> <span class="uscript-operator">(</span><span class="uscript-operator">&amp;</span>r<span class="uscript-operator">)</span><span class="uscript-operator">,</span> <span class="uscript-string">"r"</span> <span class="uscript-operator">(</span>this<span class="uscript-operator">)</span><span class="uscript-operator">,</span> <span class="uscript-string">"r"</span> <span class="uscript-operator">(</span>Scale<span class="uscript-operator">)</span>
        : <span class="uscript-string">"memory"</span>
        <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
        <span class="uscript-keyword">return</span> r<span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>
    inline FVector <span class="uscript-keyword">operator</span><span class="uscript-operator">/</span><span class="uscript-operator">(</span> <span class="uscript-type">FLOAT</span> Scale <span class="uscript-operator">)</span> <span class="uscript-keyword">const</span>
    <span class="uscript-operator">{</span>
        <span class="uscript-type">FLOAT</span> RScale <span class="uscript-operator">=</span> <span class="uscript-number">1</span><span class="uscript-operator">.</span>f<span class="uscript-operator">/</span>Scale<span class="uscript-operator">;</span>
        FVector r<span class="uscript-operator">;</span>
        asm volatile <span class="uscript-operator">(</span><span class="uscript-string">"</span>
            ctc2        <span class="uscript-operator">%</span><span class="uscript-number">2</span><span class="uscript-operator">,</span>  <span class="uscript-operator">$</span><span class="uscript-number">21</span>
            lqc2        vf2<span class="uscript-operator">,</span> <span class="uscript-number">0x00</span><span class="uscript-operator">(</span><span class="uscript-operator">%</span><span class="uscript-number">1</span><span class="uscript-operator">)</span>
            vmuli<span class="uscript-operator">.</span>xyz   vf1<span class="uscript-operator">,</span> vf2<span class="uscript-operator">,</span> I
            sqc2        vf1<span class="uscript-operator">,</span> <span class="uscript-number">0x00</span><span class="uscript-operator">(</span><span class="uscript-operator">%</span><span class="uscript-number">0</span><span class="uscript-operator">)</span>
        <span class="uscript-string">"</span>
        :
        : <span class="uscript-string">"r"</span> <span class="uscript-operator">(</span><span class="uscript-operator">&amp;</span>r<span class="uscript-operator">)</span><span class="uscript-operator">,</span> <span class="uscript-string">"r"</span> <span class="uscript-operator">(</span>this<span class="uscript-operator">)</span><span class="uscript-operator">,</span> <span class="uscript-string">"r"</span> <span class="uscript-operator">(</span>RScale<span class="uscript-operator">)</span>
        : <span class="uscript-string">"memory"</span>
        <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
        <span class="uscript-keyword">return</span> r<span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>
    inline FVector <span class="uscript-keyword">operator</span><span class="uscript-operator">*</span><span class="uscript-operator">(</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> V <span class="uscript-operator">)</span> <span class="uscript-keyword">const</span>
    <span class="uscript-operator">{</span>
        FVector r<span class="uscript-operator">;</span>
        asm volatile <span class="uscript-operator">(</span><span class="uscript-string">"</span>
            lqc2        vf2<span class="uscript-operator">,</span> <span class="uscript-number">0x00</span><span class="uscript-operator">(</span><span class="uscript-operator">%</span><span class="uscript-number">1</span><span class="uscript-operator">)</span>
            lqc2        vf3<span class="uscript-operator">,</span> <span class="uscript-number">0x00</span><span class="uscript-operator">(</span><span class="uscript-operator">%</span><span class="uscript-number">2</span><span class="uscript-operator">)</span>
            vmul<span class="uscript-operator">.</span>xyz    vf1<span class="uscript-operator">,</span> vf2<span class="uscript-operator">,</span> vf3
            sqc2        vf1<span class="uscript-operator">,</span> <span class="uscript-number">0x00</span><span class="uscript-operator">(</span><span class="uscript-operator">%</span><span class="uscript-number">0</span><span class="uscript-operator">)</span>
        <span class="uscript-string">"</span>
        :
        : <span class="uscript-string">"r"</span> <span class="uscript-operator">(</span><span class="uscript-operator">&amp;</span>r<span class="uscript-operator">)</span><span class="uscript-operator">,</span> <span class="uscript-string">"r"</span> <span class="uscript-operator">(</span>this<span class="uscript-operator">)</span><span class="uscript-operator">,</span> <span class="uscript-string">"r"</span> <span class="uscript-operator">(</span><span class="uscript-operator">&amp;</span>V<span class="uscript-operator">)</span>
        : <span class="uscript-string">"memory"</span>
        <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
        <span class="uscript-keyword">return</span> r<span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>

    <span class="uscript-comment">// Binary comparison operators.</span>
    UBOOL <span class="uscript-keyword">operator</span><span class="uscript-operator">==</span><span class="uscript-operator">(</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> V <span class="uscript-operator">)</span> <span class="uscript-keyword">const</span>
    <span class="uscript-operator">{</span>
        <span class="uscript-keyword">return</span> X<span class="uscript-operator">==</span>V<span class="uscript-operator">.</span>X <span class="uscript-operator">&amp;&amp;</span> Y<span class="uscript-operator">==</span>V<span class="uscript-operator">.</span>Y <span class="uscript-operator">&amp;&amp;</span> Z<span class="uscript-operator">==</span>V<span class="uscript-operator">.</span>Z<span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>
    UBOOL <span class="uscript-keyword">operator</span><span class="uscript-operator">!=</span><span class="uscript-operator">(</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> V <span class="uscript-operator">)</span> <span class="uscript-keyword">const</span>
    <span class="uscript-operator">{</span>
        <span class="uscript-keyword">return</span> X<span class="uscript-operator">!=</span>V<span class="uscript-operator">.</span>X <span class="uscript-operator">||</span> Y<span class="uscript-operator">!=</span>V<span class="uscript-operator">.</span>Y <span class="uscript-operator">||</span> Z<span class="uscript-operator">!=</span>V<span class="uscript-operator">.</span>Z<span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>

    <span class="uscript-comment">// Unary operators.</span>
    FVector <span class="uscript-keyword">operator</span><span class="uscript-operator">-</span><span class="uscript-operator">(</span><span class="uscript-operator">)</span> <span class="uscript-keyword">const</span>
    <span class="uscript-operator">{</span>
        <span class="uscript-keyword">return</span> FVector<span class="uscript-operator">(</span> <span class="uscript-operator">-</span>X<span class="uscript-operator">,</span> <span class="uscript-operator">-</span>Y<span class="uscript-operator">,</span> <span class="uscript-operator">-</span>Z <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>

    <span class="uscript-comment">// Assignment operators.</span>
    inline FVector <span class="uscript-keyword">operator</span><span class="uscript-operator">+=</span><span class="uscript-operator">(</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> V <span class="uscript-operator">)</span>
    <span class="uscript-operator">{</span>
        asm volatile <span class="uscript-operator">(</span><span class="uscript-string">"</span>
            lqc2        vf2<span class="uscript-operator">,</span> <span class="uscript-number">0x00</span><span class="uscript-operator">(</span><span class="uscript-operator">%</span><span class="uscript-number">0</span><span class="uscript-operator">)</span>
            lqc2        vf3<span class="uscript-operator">,</span> <span class="uscript-number">0x00</span><span class="uscript-operator">(</span><span class="uscript-operator">%</span><span class="uscript-number">1</span><span class="uscript-operator">)</span>
            vadd<span class="uscript-operator">.</span>xyz    vf1<span class="uscript-operator">,</span> vf2<span class="uscript-operator">,</span> vf3
            sqc2        vf1<span class="uscript-operator">,</span> <span class="uscript-number">0x00</span><span class="uscript-operator">(</span><span class="uscript-operator">%</span><span class="uscript-number">0</span><span class="uscript-operator">)</span>
        <span class="uscript-string">"</span>
        : 
        : <span class="uscript-string">"r"</span> <span class="uscript-operator">(</span>this<span class="uscript-operator">)</span><span class="uscript-operator">,</span> <span class="uscript-string">"r"</span> <span class="uscript-operator">(</span><span class="uscript-operator">&amp;</span>V<span class="uscript-operator">)</span>
        : <span class="uscript-string">"memory"</span>
        <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
        <span class="uscript-keyword">return</span> <span class="uscript-operator">*</span>this<span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>
    inline FVector <span class="uscript-keyword">operator</span><span class="uscript-operator">-=</span><span class="uscript-operator">(</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> V <span class="uscript-operator">)</span>
    <span class="uscript-operator">{</span>
        asm volatile <span class="uscript-operator">(</span><span class="uscript-string">"</span>
            lqc2        vf2<span class="uscript-operator">,</span> <span class="uscript-number">0x00</span><span class="uscript-operator">(</span><span class="uscript-operator">%</span><span class="uscript-number">0</span><span class="uscript-operator">)</span>
            lqc2        vf3<span class="uscript-operator">,</span> <span class="uscript-number">0x00</span><span class="uscript-operator">(</span><span class="uscript-operator">%</span><span class="uscript-number">1</span><span class="uscript-operator">)</span>
            vsub<span class="uscript-operator">.</span>xyz    vf1<span class="uscript-operator">,</span> vf2<span class="uscript-operator">,</span> vf3
            sqc2        vf1<span class="uscript-operator">,</span> <span class="uscript-number">0x00</span><span class="uscript-operator">(</span><span class="uscript-operator">%</span><span class="uscript-number">0</span><span class="uscript-operator">)</span>
        <span class="uscript-string">"</span>
        : 
        : <span class="uscript-string">"r"</span> <span class="uscript-operator">(</span>this<span class="uscript-operator">)</span><span class="uscript-operator">,</span> <span class="uscript-string">"r"</span> <span class="uscript-operator">(</span><span class="uscript-operator">&amp;</span>V<span class="uscript-operator">)</span>
        : <span class="uscript-string">"memory"</span>
        <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
        <span class="uscript-keyword">return</span> <span class="uscript-operator">*</span>this<span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>
    inline FVector <span class="uscript-keyword">operator</span><span class="uscript-operator">*=</span><span class="uscript-operator">(</span> <span class="uscript-type">FLOAT</span> Scale <span class="uscript-operator">)</span>
    <span class="uscript-operator">{</span>
        asm volatile <span class="uscript-operator">(</span><span class="uscript-string">"</span>
            ctc2        <span class="uscript-operator">%</span><span class="uscript-number">1</span><span class="uscript-operator">,</span>  <span class="uscript-operator">$</span><span class="uscript-number">21</span>
            lqc2        vf2<span class="uscript-operator">,</span> <span class="uscript-number">0x00</span><span class="uscript-operator">(</span><span class="uscript-operator">%</span><span class="uscript-number">0</span><span class="uscript-operator">)</span>
            vmuli<span class="uscript-operator">.</span>xyz   vf1<span class="uscript-operator">,</span> vf2<span class="uscript-operator">,</span> I
            sqc2        vf1<span class="uscript-operator">,</span> <span class="uscript-number">0x00</span><span class="uscript-operator">(</span><span class="uscript-operator">%</span><span class="uscript-number">0</span><span class="uscript-operator">)</span>
        <span class="uscript-string">"</span>
        :
        : <span class="uscript-string">"r"</span> <span class="uscript-operator">(</span>this<span class="uscript-operator">)</span><span class="uscript-operator">,</span> <span class="uscript-string">"r"</span> <span class="uscript-operator">(</span>Scale<span class="uscript-operator">)</span>
        : <span class="uscript-string">"memory"</span>
        <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
        <span class="uscript-keyword">return</span> <span class="uscript-operator">*</span>this<span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>
    inline FVector <span class="uscript-keyword">operator</span><span class="uscript-operator">/=</span><span class="uscript-operator">(</span> <span class="uscript-type">FLOAT</span> V <span class="uscript-operator">)</span>
    <span class="uscript-operator">{</span>
        <span class="uscript-type">FLOAT</span> RScale <span class="uscript-operator">=</span> <span class="uscript-number">1</span><span class="uscript-operator">.</span>f<span class="uscript-operator">/</span>V<span class="uscript-operator">;</span>
        asm volatile <span class="uscript-operator">(</span><span class="uscript-string">"</span>
            ctc2        <span class="uscript-operator">%</span><span class="uscript-number">1</span><span class="uscript-operator">,</span>  <span class="uscript-operator">$</span><span class="uscript-number">21</span>
            lqc2        vf2<span class="uscript-operator">,</span> <span class="uscript-number">0x00</span><span class="uscript-operator">(</span><span class="uscript-operator">%</span><span class="uscript-number">0</span><span class="uscript-operator">)</span>
            vmuli<span class="uscript-operator">.</span>xyz   vf1<span class="uscript-operator">,</span> vf2<span class="uscript-operator">,</span> I
            sqc2        vf1<span class="uscript-operator">,</span> <span class="uscript-number">0x00</span><span class="uscript-operator">(</span><span class="uscript-operator">%</span><span class="uscript-number">0</span><span class="uscript-operator">)</span>
        <span class="uscript-string">"</span>
        :
        : <span class="uscript-string">"r"</span> <span class="uscript-operator">(</span>this<span class="uscript-operator">)</span><span class="uscript-operator">,</span> <span class="uscript-string">"r"</span> <span class="uscript-operator">(</span>RScale<span class="uscript-operator">)</span>
        : <span class="uscript-string">"memory"</span>
        <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
        <span class="uscript-keyword">return</span> <span class="uscript-operator">*</span>this<span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>
    inline FVector <span class="uscript-keyword">operator</span><span class="uscript-operator">*=</span><span class="uscript-operator">(</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> V <span class="uscript-operator">)</span>
    <span class="uscript-operator">{</span>
        asm volatile <span class="uscript-operator">(</span><span class="uscript-string">"</span>
            lqc2        vf2<span class="uscript-operator">,</span> <span class="uscript-number">0x00</span><span class="uscript-operator">(</span><span class="uscript-operator">%</span><span class="uscript-number">0</span><span class="uscript-operator">)</span>
            lqc2        vf3<span class="uscript-operator">,</span> <span class="uscript-number">0x00</span><span class="uscript-operator">(</span><span class="uscript-operator">%</span><span class="uscript-number">1</span><span class="uscript-operator">)</span>
            vmul<span class="uscript-operator">.</span>xyz    vf1<span class="uscript-operator">,</span> vf2<span class="uscript-operator">,</span> vf3
            sqc2        vf1<span class="uscript-operator">,</span> <span class="uscript-number">0x00</span><span class="uscript-operator">(</span><span class="uscript-operator">%</span><span class="uscript-number">0</span><span class="uscript-operator">)</span>
        <span class="uscript-string">"</span>
        :
        : <span class="uscript-string">"r"</span> <span class="uscript-operator">(</span>this<span class="uscript-operator">)</span><span class="uscript-operator">,</span> <span class="uscript-string">"r"</span> <span class="uscript-operator">(</span><span class="uscript-operator">&amp;</span>V<span class="uscript-operator">)</span>
        : <span class="uscript-string">"memory"</span>
        <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
        <span class="uscript-keyword">return</span> <span class="uscript-operator">*</span>this<span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>
    FVector <span class="uscript-keyword">operator</span><span class="uscript-operator">/=</span><span class="uscript-operator">(</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> V <span class="uscript-operator">)</span>
    <span class="uscript-operator">{</span>
        X <span class="uscript-operator">/=</span> V<span class="uscript-operator">.</span>X<span class="uscript-operator">;</span> Y <span class="uscript-operator">/=</span> V<span class="uscript-operator">.</span>Y<span class="uscript-operator">;</span> Z <span class="uscript-operator">/=</span> V<span class="uscript-operator">.</span>Z<span class="uscript-operator">;</span>
        <span class="uscript-keyword">return</span> <span class="uscript-operator">*</span>this<span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>

    <span class="uscript-comment">// Simple functions.</span>
    <span class="uscript-type">FLOAT</span> Size<span class="uscript-operator">(</span><span class="uscript-operator">)</span> <span class="uscript-keyword">const</span>
    <span class="uscript-operator">{</span>
        <span class="uscript-keyword">return</span> appSqrt<span class="uscript-operator">(</span> X<span class="uscript-operator">*</span>X <span class="uscript-operator">+</span> Y<span class="uscript-operator">*</span>Y <span class="uscript-operator">+</span> Z<span class="uscript-operator">*</span>Z <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>
    <span class="uscript-type">FLOAT</span> SizeSquared<span class="uscript-operator">(</span><span class="uscript-operator">)</span> <span class="uscript-keyword">const</span>
    <span class="uscript-operator">{</span>
        <span class="uscript-keyword">return</span> X<span class="uscript-operator">*</span>X <span class="uscript-operator">+</span> Y<span class="uscript-operator">*</span>Y <span class="uscript-operator">+</span> Z<span class="uscript-operator">*</span>Z<span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>
    <span class="uscript-type">FLOAT</span> Size2D<span class="uscript-operator">(</span><span class="uscript-operator">)</span> <span class="uscript-keyword">const</span> 
    <span class="uscript-operator">{</span>
        <span class="uscript-keyword">return</span> appSqrt<span class="uscript-operator">(</span> X<span class="uscript-operator">*</span>X <span class="uscript-operator">+</span> Y<span class="uscript-operator">*</span>Y <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>
    <span class="uscript-type">FLOAT</span> SizeSquared2D<span class="uscript-operator">(</span><span class="uscript-operator">)</span> <span class="uscript-keyword">const</span> 
    <span class="uscript-operator">{</span>
        <span class="uscript-keyword">return</span> X<span class="uscript-operator">*</span>X <span class="uscript-operator">+</span> Y<span class="uscript-operator">*</span>Y<span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>
    <span class="uscript-type">int</span> IsNearlyZero<span class="uscript-operator">(</span><span class="uscript-operator">)</span> <span class="uscript-keyword">const</span>
    <span class="uscript-operator">{</span>
        <span class="uscript-keyword">return</span>
                Abs<span class="uscript-operator">(</span>X<span class="uscript-operator">)</span><span class="uscript-operator">&lt;</span>KINDA_SMALL_NUMBER
            <span class="uscript-operator">&amp;&amp;</span>  Abs<span class="uscript-operator">(</span>Y<span class="uscript-operator">)</span><span class="uscript-operator">&lt;</span>KINDA_SMALL_NUMBER
            <span class="uscript-operator">&amp;&amp;</span>  Abs<span class="uscript-operator">(</span>Z<span class="uscript-operator">)</span><span class="uscript-operator">&lt;</span>KINDA_SMALL_NUMBER<span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>
    UBOOL IsZero<span class="uscript-operator">(</span><span class="uscript-operator">)</span> <span class="uscript-keyword">const</span>
    <span class="uscript-operator">{</span>
        <span class="uscript-keyword">return</span> X<span class="uscript-operator">==</span><span class="uscript-number">0</span><span class="uscript-operator">.</span>f <span class="uscript-operator">&amp;&amp;</span> Y<span class="uscript-operator">==</span><span class="uscript-number">0</span><span class="uscript-operator">.</span>f <span class="uscript-operator">&amp;&amp;</span> Z<span class="uscript-operator">==</span><span class="uscript-number">0</span><span class="uscript-operator">.</span>f<span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>
    UBOOL Normalize<span class="uscript-operator">(</span><span class="uscript-operator">)</span>
    <span class="uscript-operator">{</span>
        <span class="uscript-type">FLOAT</span> SquareSum <span class="uscript-operator">=</span> X<span class="uscript-operator">*</span>X<span class="uscript-operator">+</span>Y<span class="uscript-operator">*</span>Y<span class="uscript-operator">+</span>Z<span class="uscript-operator">*</span>Z<span class="uscript-operator">;</span>
        <span class="uscript-keyword">if</span><span class="uscript-operator">(</span> SquareSum <span class="uscript-operator">&gt;=</span> SMALL_NUMBER <span class="uscript-operator">)</span>
        <span class="uscript-operator">{</span>
            <span class="uscript-type">FLOAT</span> Scale <span class="uscript-operator">=</span> <span class="uscript-number">1</span><span class="uscript-operator">.</span>f<span class="uscript-operator">/</span>appSqrt<span class="uscript-operator">(</span>SquareSum<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
            X <span class="uscript-operator">*=</span> Scale<span class="uscript-operator">;</span> Y <span class="uscript-operator">*=</span> Scale<span class="uscript-operator">;</span> Z <span class="uscript-operator">*=</span> Scale<span class="uscript-operator">;</span>
            <span class="uscript-keyword">return</span> <span class="uscript-number">1</span><span class="uscript-operator">;</span>
        <span class="uscript-operator">}</span>
        <span class="uscript-keyword">else</span> <span class="uscript-keyword">return</span> <span class="uscript-number">0</span><span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>
    FVector Projection<span class="uscript-operator">(</span><span class="uscript-operator">)</span> <span class="uscript-keyword">const</span>
    <span class="uscript-operator">{</span>
        <span class="uscript-type">FLOAT</span> RZ <span class="uscript-operator">=</span> <span class="uscript-number">1</span><span class="uscript-operator">.</span>f<span class="uscript-operator">/</span>Z<span class="uscript-operator">;</span>
        <span class="uscript-keyword">return</span> FVector<span class="uscript-operator">(</span> X<span class="uscript-operator">*</span>RZ<span class="uscript-operator">,</span> Y<span class="uscript-operator">*</span>RZ<span class="uscript-operator">,</span> <span class="uscript-number">1</span> <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>
    FVector UnsafeNormal<span class="uscript-operator">(</span><span class="uscript-operator">)</span> <span class="uscript-keyword">const</span>
    <span class="uscript-operator">{</span>
        <span class="uscript-type">FLOAT</span> Scale <span class="uscript-operator">=</span> <span class="uscript-number">1</span><span class="uscript-operator">.</span>f<span class="uscript-operator">/</span>appSqrt<span class="uscript-operator">(</span>X<span class="uscript-operator">*</span>X<span class="uscript-operator">+</span>Y<span class="uscript-operator">*</span>Y<span class="uscript-operator">+</span>Z<span class="uscript-operator">*</span>Z<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
        <span class="uscript-keyword">return</span> FVector<span class="uscript-operator">(</span> X<span class="uscript-operator">*</span>Scale<span class="uscript-operator">,</span> Y<span class="uscript-operator">*</span>Scale<span class="uscript-operator">,</span> Z<span class="uscript-operator">*</span>Scale <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>
    FVector GridSnap<span class="uscript-operator">(</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> Grid <span class="uscript-operator">)</span>
    <span class="uscript-operator">{</span>
        <span class="uscript-keyword">return</span> FVector<span class="uscript-operator">(</span> FSnap<span class="uscript-operator">(</span>X<span class="uscript-operator">,</span> Grid<span class="uscript-operator">.</span>X<span class="uscript-operator">)</span><span class="uscript-operator">,</span>FSnap<span class="uscript-operator">(</span>Y<span class="uscript-operator">,</span> Grid<span class="uscript-operator">.</span>Y<span class="uscript-operator">)</span><span class="uscript-operator">,</span>FSnap<span class="uscript-operator">(</span>Z<span class="uscript-operator">,</span> Grid<span class="uscript-operator">.</span>Z<span class="uscript-operator">)</span> <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>
    FVector BoundToCube<span class="uscript-operator">(</span> <span class="uscript-type">FLOAT</span> Radius <span class="uscript-operator">)</span>
    <span class="uscript-operator">{</span>
        <span class="uscript-keyword">return</span> FVector
        <span class="uscript-operator">(</span>
            Clamp<span class="uscript-operator">(</span>X<span class="uscript-operator">,</span><span class="uscript-operator">-</span>Radius<span class="uscript-operator">,</span>Radius<span class="uscript-operator">)</span><span class="uscript-operator">,</span>
            Clamp<span class="uscript-operator">(</span>Y<span class="uscript-operator">,</span><span class="uscript-operator">-</span>Radius<span class="uscript-operator">,</span>Radius<span class="uscript-operator">)</span><span class="uscript-operator">,</span>
            Clamp<span class="uscript-operator">(</span>Z<span class="uscript-operator">,</span><span class="uscript-operator">-</span>Radius<span class="uscript-operator">,</span>Radius<span class="uscript-operator">)</span>
        <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>
    void AddBounded<span class="uscript-operator">(</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> V<span class="uscript-operator">,</span> <span class="uscript-type">FLOAT</span> Radius<span class="uscript-operator">=</span>MAXSWORD <span class="uscript-operator">)</span>
    <span class="uscript-operator">{</span>
        <span class="uscript-operator">*</span>this <span class="uscript-operator">=</span> <span class="uscript-operator">(</span><span class="uscript-operator">*</span>this <span class="uscript-operator">+</span> V<span class="uscript-operator">)</span><span class="uscript-operator">.</span>BoundToCube<span class="uscript-operator">(</span>Radius<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>
    <span class="uscript-type">FLOAT</span><span class="uscript-operator">&amp;</span> Component<span class="uscript-operator">(</span> <span class="uscript-type">INT</span> Index <span class="uscript-operator">)</span>
    <span class="uscript-operator">{</span>
        <span class="uscript-keyword">return</span> <span class="uscript-operator">(</span><span class="uscript-operator">&amp;</span>X<span class="uscript-operator">)</span><span class="uscript-operator">[</span>Index<span class="uscript-operator">]</span><span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>

    <span class="uscript-comment">// Return a boolean that is based on the vector's direction.</span>
    <span class="uscript-comment">// When      V==(0,0,0) Booleanize(0)=1.</span>
    <span class="uscript-comment">// Otherwise Booleanize(V) &lt;-&gt; !Booleanize(!B).</span>
    UBOOL Booleanize<span class="uscript-operator">(</span><span class="uscript-operator">)</span>
    <span class="uscript-operator">{</span>
        <span class="uscript-keyword">return</span>
            X <span class="uscript-operator">&gt;</span>  <span class="uscript-number">0</span><span class="uscript-operator">.</span>f ? <span class="uscript-number">1</span> :
            X <span class="uscript-operator">&lt;</span>  <span class="uscript-number">0</span><span class="uscript-operator">.</span>f ? <span class="uscript-number">0</span> :
            Y <span class="uscript-operator">&gt;</span>  <span class="uscript-number">0</span><span class="uscript-operator">.</span>f ? <span class="uscript-number">1</span> :
            Y <span class="uscript-operator">&lt;</span>  <span class="uscript-number">0</span><span class="uscript-operator">.</span>f ? <span class="uscript-number">0</span> :
            Z <span class="uscript-operator">&gt;=</span> <span class="uscript-number">0</span><span class="uscript-operator">.</span>f ? <span class="uscript-number">1</span> : <span class="uscript-number">0</span><span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>

    <span class="uscript-comment">// Transformation.</span>
    FVector TransformVectorBy<span class="uscript-operator">(</span> <span class="uscript-keyword">const</span> FCoords<span class="uscript-operator">&amp;</span> Coords <span class="uscript-operator">)</span> <span class="uscript-keyword">const</span><span class="uscript-operator">;</span>
    FVector TransformPointBy<span class="uscript-operator">(</span> <span class="uscript-keyword">const</span> FCoords<span class="uscript-operator">&amp;</span> Coords <span class="uscript-operator">)</span> <span class="uscript-keyword">const</span><span class="uscript-operator">;</span>
    FVector MirrorByVector<span class="uscript-operator">(</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> MirrorNormal <span class="uscript-operator">)</span> <span class="uscript-keyword">const</span><span class="uscript-operator">;</span>
    FVector MirrorByPlane<span class="uscript-operator">(</span> <span class="uscript-keyword">const</span> FPlane<span class="uscript-operator">&amp;</span> MirrorPlane <span class="uscript-operator">)</span> <span class="uscript-keyword">const</span><span class="uscript-operator">;</span>
    FVector PivotTransform<span class="uscript-operator">(</span><span class="uscript-keyword">const</span> FCoords<span class="uscript-operator">&amp;</span> Coords<span class="uscript-operator">)</span> <span class="uscript-keyword">const</span><span class="uscript-operator">;</span>

    <span class="uscript-comment">// Complicated functions.</span>
    FRotator Rotation<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    void FindBestAxisVectors<span class="uscript-operator">(</span> FVector<span class="uscript-operator">&amp;</span> Axis1<span class="uscript-operator">,</span> FVector<span class="uscript-operator">&amp;</span> Axis2 <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    FVector SafeNormal<span class="uscript-operator">(</span><span class="uscript-operator">)</span> <span class="uscript-keyword">const</span><span class="uscript-operator">;</span> <span class="uscript-comment">//warning: Not inline because of compiler bug.</span>

    <span class="uscript-comment">// Friends.</span>
    friend <span class="uscript-type">FLOAT</span> FDist<span class="uscript-operator">(</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> V1<span class="uscript-operator">,</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> V2 <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    friend <span class="uscript-type">FLOAT</span> FDistSquared<span class="uscript-operator">(</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> V1<span class="uscript-operator">,</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> V2 <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    friend UBOOL FPointsAreSame<span class="uscript-operator">(</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> P<span class="uscript-operator">,</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> Q <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    friend UBOOL FPointsAreNear<span class="uscript-operator">(</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> Point1<span class="uscript-operator">,</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> Point2<span class="uscript-operator">,</span> <span class="uscript-type">FLOAT</span> Dist<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    friend <span class="uscript-type">FLOAT</span> FPointPlaneDist<span class="uscript-operator">(</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> Point<span class="uscript-operator">,</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> PlaneBase<span class="uscript-operator">,</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> PlaneNormal <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    friend FVector FLinePlaneIntersection<span class="uscript-operator">(</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> Point1<span class="uscript-operator">,</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> Point2<span class="uscript-operator">,</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> PlaneOrigin<span class="uscript-operator">,</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> PlaneNormal <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    friend FVector FLinePlaneIntersection<span class="uscript-operator">(</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> Point1<span class="uscript-operator">,</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> Point2<span class="uscript-operator">,</span> <span class="uscript-keyword">const</span> FPlane<span class="uscript-operator">&amp;</span> Plane <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    friend UBOOL FParallel<span class="uscript-operator">(</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> Normal1<span class="uscript-operator">,</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> Normal2 <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    friend UBOOL FCoplanar<span class="uscript-operator">(</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> Base1<span class="uscript-operator">,</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> Normal1<span class="uscript-operator">,</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> Base2<span class="uscript-operator">,</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> Normal2 <span class="uscript-operator">)</span><span class="uscript-operator">;</span>

    <span class="uscript-comment">// Serializer.</span>
    friend FArchive<span class="uscript-operator">&amp;</span> <span class="uscript-keyword">operator</span><span class="uscript-operator">&lt;&lt;</span><span class="uscript-operator">(</span> FArchive<span class="uscript-operator">&amp;</span> Ar<span class="uscript-operator">,</span> FVector<span class="uscript-operator">&amp;</span> V <span class="uscript-operator">)</span>
    <span class="uscript-operator">{</span>
        <span class="uscript-keyword">return</span> Ar <span class="uscript-operator">&lt;&lt;</span> V<span class="uscript-operator">.</span>X <span class="uscript-operator">&lt;&lt;</span> V<span class="uscript-operator">.</span>Y <span class="uscript-operator">&lt;&lt;</span> V<span class="uscript-operator">.</span>Z<span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>
 <span class="uscript-operator">}</span> GCC_ALIGN<span class="uscript-operator">(</span><span class="uscript-number">16</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>



 #<span class="uscript-keyword">else</span>



 #define FVECTOR_ALIGNMENT DEFAULT_ALIGNMENT
 <span class="uscript-keyword">class</span> CORE_API FVector 
 <span class="uscript-operator">{</span>
 public:
    <span class="uscript-comment">// Variables.</span>
    <span class="uscript-type">FLOAT</span> X<span class="uscript-operator">,</span>Y<span class="uscript-operator">,</span>Z<span class="uscript-operator">;</span>

    <span class="uscript-comment">// Constructors.</span>
    FVector<span class="uscript-operator">(</span><span class="uscript-operator">)</span>
    <span class="uscript-operator">{</span><span class="uscript-operator">}</span>

    FVector<span class="uscript-operator">(</span> <span class="uscript-type">FLOAT</span> InX<span class="uscript-operator">,</span> <span class="uscript-type">FLOAT</span> InY<span class="uscript-operator">,</span> <span class="uscript-type">FLOAT</span> InZ <span class="uscript-operator">)</span>
    :   X<span class="uscript-operator">(</span>InX<span class="uscript-operator">)</span><span class="uscript-operator">,</span> Y<span class="uscript-operator">(</span>InY<span class="uscript-operator">)</span><span class="uscript-operator">,</span> Z<span class="uscript-operator">(</span>InZ<span class="uscript-operator">)</span>
    <span class="uscript-operator">{</span><span class="uscript-operator">}</span>

    <span class="uscript-comment">// Binary math operators.</span>
    FVector <span class="uscript-keyword">operator</span><span class="uscript-operator">^</span><span class="uscript-operator">(</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> V <span class="uscript-operator">)</span> <span class="uscript-keyword">const</span>
    <span class="uscript-operator">{</span>
        <span class="uscript-keyword">return</span> FVector
        <span class="uscript-operator">(</span>
            Y <span class="uscript-operator">*</span> V<span class="uscript-operator">.</span>Z <span class="uscript-operator">-</span> Z <span class="uscript-operator">*</span> V<span class="uscript-operator">.</span>Y<span class="uscript-operator">,</span>
            Z <span class="uscript-operator">*</span> V<span class="uscript-operator">.</span>X <span class="uscript-operator">-</span> X <span class="uscript-operator">*</span> V<span class="uscript-operator">.</span>Z<span class="uscript-operator">,</span>
            X <span class="uscript-operator">*</span> V<span class="uscript-operator">.</span>Y <span class="uscript-operator">-</span> Y <span class="uscript-operator">*</span> V<span class="uscript-operator">.</span>X
        <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>
    <span class="uscript-type">FLOAT</span> <span class="uscript-keyword">operator</span><span class="uscript-operator">|</span><span class="uscript-operator">(</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> V <span class="uscript-operator">)</span> <span class="uscript-keyword">const</span>
    <span class="uscript-operator">{</span>
        <span class="uscript-keyword">return</span> X<span class="uscript-operator">*</span>V<span class="uscript-operator">.</span>X <span class="uscript-operator">+</span> Y<span class="uscript-operator">*</span>V<span class="uscript-operator">.</span>Y <span class="uscript-operator">+</span> Z<span class="uscript-operator">*</span>V<span class="uscript-operator">.</span>Z<span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>
    friend FVector <span class="uscript-keyword">operator</span><span class="uscript-operator">*</span><span class="uscript-operator">(</span> <span class="uscript-type">FLOAT</span> Scale<span class="uscript-operator">,</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> V <span class="uscript-operator">)</span>
    <span class="uscript-operator">{</span>
        <span class="uscript-keyword">return</span> FVector<span class="uscript-operator">(</span> V<span class="uscript-operator">.</span>X <span class="uscript-operator">*</span> Scale<span class="uscript-operator">,</span> V<span class="uscript-operator">.</span>Y <span class="uscript-operator">*</span> Scale<span class="uscript-operator">,</span> V<span class="uscript-operator">.</span>Z <span class="uscript-operator">*</span> Scale <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>
    FVector <span class="uscript-keyword">operator</span><span class="uscript-operator">+</span><span class="uscript-operator">(</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> V <span class="uscript-operator">)</span> <span class="uscript-keyword">const</span>
    <span class="uscript-operator">{</span>
        <span class="uscript-keyword">return</span> FVector<span class="uscript-operator">(</span> X <span class="uscript-operator">+</span> V<span class="uscript-operator">.</span>X<span class="uscript-operator">,</span> Y <span class="uscript-operator">+</span> V<span class="uscript-operator">.</span>Y<span class="uscript-operator">,</span> Z <span class="uscript-operator">+</span> V<span class="uscript-operator">.</span>Z <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>
    FVector <span class="uscript-keyword">operator</span><span class="uscript-operator">-</span><span class="uscript-operator">(</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> V <span class="uscript-operator">)</span> <span class="uscript-keyword">const</span>
    <span class="uscript-operator">{</span>
        <span class="uscript-keyword">return</span> FVector<span class="uscript-operator">(</span> X <span class="uscript-operator">-</span> V<span class="uscript-operator">.</span>X<span class="uscript-operator">,</span> Y <span class="uscript-operator">-</span> V<span class="uscript-operator">.</span>Y<span class="uscript-operator">,</span> Z <span class="uscript-operator">-</span> V<span class="uscript-operator">.</span>Z <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>
    FVector <span class="uscript-keyword">operator</span><span class="uscript-operator">*</span><span class="uscript-operator">(</span> <span class="uscript-type">FLOAT</span> Scale <span class="uscript-operator">)</span> <span class="uscript-keyword">const</span>
    <span class="uscript-operator">{</span>
        <span class="uscript-keyword">return</span> FVector<span class="uscript-operator">(</span> X <span class="uscript-operator">*</span> Scale<span class="uscript-operator">,</span> Y <span class="uscript-operator">*</span> Scale<span class="uscript-operator">,</span> Z <span class="uscript-operator">*</span> Scale <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>
    FVector <span class="uscript-keyword">operator</span><span class="uscript-operator">/</span><span class="uscript-operator">(</span> <span class="uscript-type">FLOAT</span> Scale <span class="uscript-operator">)</span> <span class="uscript-keyword">const</span>
    <span class="uscript-operator">{</span>
        <span class="uscript-type">FLOAT</span> RScale <span class="uscript-operator">=</span> <span class="uscript-number">1</span><span class="uscript-operator">.</span>f<span class="uscript-operator">/</span>Scale<span class="uscript-operator">;</span>
        <span class="uscript-keyword">return</span> FVector<span class="uscript-operator">(</span> X <span class="uscript-operator">*</span> RScale<span class="uscript-operator">,</span> Y <span class="uscript-operator">*</span> RScale<span class="uscript-operator">,</span> Z <span class="uscript-operator">*</span> RScale <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>
    FVector <span class="uscript-keyword">operator</span><span class="uscript-operator">*</span><span class="uscript-operator">(</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> V <span class="uscript-operator">)</span> <span class="uscript-keyword">const</span>
    <span class="uscript-operator">{</span>
        <span class="uscript-keyword">return</span> FVector<span class="uscript-operator">(</span> X <span class="uscript-operator">*</span> V<span class="uscript-operator">.</span>X<span class="uscript-operator">,</span> Y <span class="uscript-operator">*</span> V<span class="uscript-operator">.</span>Y<span class="uscript-operator">,</span> Z <span class="uscript-operator">*</span> V<span class="uscript-operator">.</span>Z <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>

    <span class="uscript-comment">// Binary comparison operators.</span>
    UBOOL <span class="uscript-keyword">operator</span><span class="uscript-operator">==</span><span class="uscript-operator">(</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> V <span class="uscript-operator">)</span> <span class="uscript-keyword">const</span>
    <span class="uscript-operator">{</span>
        <span class="uscript-keyword">return</span> X<span class="uscript-operator">==</span>V<span class="uscript-operator">.</span>X <span class="uscript-operator">&amp;&amp;</span> Y<span class="uscript-operator">==</span>V<span class="uscript-operator">.</span>Y <span class="uscript-operator">&amp;&amp;</span> Z<span class="uscript-operator">==</span>V<span class="uscript-operator">.</span>Z<span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>
    UBOOL <span class="uscript-keyword">operator</span><span class="uscript-operator">!=</span><span class="uscript-operator">(</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> V <span class="uscript-operator">)</span> <span class="uscript-keyword">const</span>
    <span class="uscript-operator">{</span>
        <span class="uscript-keyword">return</span> X<span class="uscript-operator">!=</span>V<span class="uscript-operator">.</span>X <span class="uscript-operator">||</span> Y<span class="uscript-operator">!=</span>V<span class="uscript-operator">.</span>Y <span class="uscript-operator">||</span> Z<span class="uscript-operator">!=</span>V<span class="uscript-operator">.</span>Z<span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>

    <span class="uscript-comment">// Unary operators.</span>
    FVector <span class="uscript-keyword">operator</span><span class="uscript-operator">-</span><span class="uscript-operator">(</span><span class="uscript-operator">)</span> <span class="uscript-keyword">const</span>
    <span class="uscript-operator">{</span>
        <span class="uscript-keyword">return</span> FVector<span class="uscript-operator">(</span> <span class="uscript-operator">-</span>X<span class="uscript-operator">,</span> <span class="uscript-operator">-</span>Y<span class="uscript-operator">,</span> <span class="uscript-operator">-</span>Z <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>

    <span class="uscript-comment">// Assignment operators.</span>
    FVector <span class="uscript-keyword">operator</span><span class="uscript-operator">+=</span><span class="uscript-operator">(</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> V <span class="uscript-operator">)</span>
    <span class="uscript-operator">{</span>
        X <span class="uscript-operator">+=</span> V<span class="uscript-operator">.</span>X<span class="uscript-operator">;</span> Y <span class="uscript-operator">+=</span> V<span class="uscript-operator">.</span>Y<span class="uscript-operator">;</span> Z <span class="uscript-operator">+=</span> V<span class="uscript-operator">.</span>Z<span class="uscript-operator">;</span>
        <span class="uscript-keyword">return</span> <span class="uscript-operator">*</span>this<span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>
    FVector <span class="uscript-keyword">operator</span><span class="uscript-operator">-=</span><span class="uscript-operator">(</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> V <span class="uscript-operator">)</span>
    <span class="uscript-operator">{</span>
        X <span class="uscript-operator">-=</span> V<span class="uscript-operator">.</span>X<span class="uscript-operator">;</span> Y <span class="uscript-operator">-=</span> V<span class="uscript-operator">.</span>Y<span class="uscript-operator">;</span> Z <span class="uscript-operator">-=</span> V<span class="uscript-operator">.</span>Z<span class="uscript-operator">;</span>
        <span class="uscript-keyword">return</span> <span class="uscript-operator">*</span>this<span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>
    FVector <span class="uscript-keyword">operator</span><span class="uscript-operator">*=</span><span class="uscript-operator">(</span> <span class="uscript-type">FLOAT</span> Scale <span class="uscript-operator">)</span>
    <span class="uscript-operator">{</span>
        X <span class="uscript-operator">*=</span> Scale<span class="uscript-operator">;</span> Y <span class="uscript-operator">*=</span> Scale<span class="uscript-operator">;</span> Z <span class="uscript-operator">*=</span> Scale<span class="uscript-operator">;</span>
        <span class="uscript-keyword">return</span> <span class="uscript-operator">*</span>this<span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>
    FVector <span class="uscript-keyword">operator</span><span class="uscript-operator">/=</span><span class="uscript-operator">(</span> <span class="uscript-type">FLOAT</span> V <span class="uscript-operator">)</span>
    <span class="uscript-operator">{</span>
        <span class="uscript-type">FLOAT</span> RV <span class="uscript-operator">=</span> <span class="uscript-number">1</span><span class="uscript-operator">.</span>f<span class="uscript-operator">/</span>V<span class="uscript-operator">;</span>
        X <span class="uscript-operator">*=</span> RV<span class="uscript-operator">;</span> Y <span class="uscript-operator">*=</span> RV<span class="uscript-operator">;</span> Z <span class="uscript-operator">*=</span> RV<span class="uscript-operator">;</span>
        <span class="uscript-keyword">return</span> <span class="uscript-operator">*</span>this<span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>
    FVector <span class="uscript-keyword">operator</span><span class="uscript-operator">*=</span><span class="uscript-operator">(</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> V <span class="uscript-operator">)</span>
    <span class="uscript-operator">{</span>
        X <span class="uscript-operator">*=</span> V<span class="uscript-operator">.</span>X<span class="uscript-operator">;</span> Y <span class="uscript-operator">*=</span> V<span class="uscript-operator">.</span>Y<span class="uscript-operator">;</span> Z <span class="uscript-operator">*=</span> V<span class="uscript-operator">.</span>Z<span class="uscript-operator">;</span>
        <span class="uscript-keyword">return</span> <span class="uscript-operator">*</span>this<span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>
    FVector <span class="uscript-keyword">operator</span><span class="uscript-operator">/=</span><span class="uscript-operator">(</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> V <span class="uscript-operator">)</span>
    <span class="uscript-operator">{</span>
        X <span class="uscript-operator">/=</span> V<span class="uscript-operator">.</span>X<span class="uscript-operator">;</span> Y <span class="uscript-operator">/=</span> V<span class="uscript-operator">.</span>Y<span class="uscript-operator">;</span> Z <span class="uscript-operator">/=</span> V<span class="uscript-operator">.</span>Z<span class="uscript-operator">;</span>
        <span class="uscript-keyword">return</span> <span class="uscript-operator">*</span>this<span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>

    <span class="uscript-comment">// Simple functions.</span>
    <span class="uscript-type">FLOAT</span> Size<span class="uscript-operator">(</span><span class="uscript-operator">)</span> <span class="uscript-keyword">const</span>
    <span class="uscript-operator">{</span>
        <span class="uscript-keyword">return</span> appSqrt<span class="uscript-operator">(</span> X<span class="uscript-operator">*</span>X <span class="uscript-operator">+</span> Y<span class="uscript-operator">*</span>Y <span class="uscript-operator">+</span> Z<span class="uscript-operator">*</span>Z <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>
    <span class="uscript-type">FLOAT</span> SizeSquared<span class="uscript-operator">(</span><span class="uscript-operator">)</span> <span class="uscript-keyword">const</span>
    <span class="uscript-operator">{</span>
        <span class="uscript-keyword">return</span> X<span class="uscript-operator">*</span>X <span class="uscript-operator">+</span> Y<span class="uscript-operator">*</span>Y <span class="uscript-operator">+</span> Z<span class="uscript-operator">*</span>Z<span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>
    <span class="uscript-type">FLOAT</span> Size2D<span class="uscript-operator">(</span><span class="uscript-operator">)</span> <span class="uscript-keyword">const</span> 
    <span class="uscript-operator">{</span>
        <span class="uscript-keyword">return</span> appSqrt<span class="uscript-operator">(</span> X<span class="uscript-operator">*</span>X <span class="uscript-operator">+</span> Y<span class="uscript-operator">*</span>Y <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>
    <span class="uscript-type">FLOAT</span> SizeSquared2D<span class="uscript-operator">(</span><span class="uscript-operator">)</span> <span class="uscript-keyword">const</span> 
    <span class="uscript-operator">{</span>
        <span class="uscript-keyword">return</span> X<span class="uscript-operator">*</span>X <span class="uscript-operator">+</span> Y<span class="uscript-operator">*</span>Y<span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>
    <span class="uscript-type">int</span> IsNearlyZero<span class="uscript-operator">(</span><span class="uscript-operator">)</span> <span class="uscript-keyword">const</span>
    <span class="uscript-operator">{</span>
        <span class="uscript-keyword">return</span>
                Abs<span class="uscript-operator">(</span>X<span class="uscript-operator">)</span><span class="uscript-operator">&lt;</span>KINDA_SMALL_NUMBER
            <span class="uscript-operator">&amp;&amp;</span>  Abs<span class="uscript-operator">(</span>Y<span class="uscript-operator">)</span><span class="uscript-operator">&lt;</span>KINDA_SMALL_NUMBER
            <span class="uscript-operator">&amp;&amp;</span>  Abs<span class="uscript-operator">(</span>Z<span class="uscript-operator">)</span><span class="uscript-operator">&lt;</span>KINDA_SMALL_NUMBER<span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>
    UBOOL IsZero<span class="uscript-operator">(</span><span class="uscript-operator">)</span> <span class="uscript-keyword">const</span>
    <span class="uscript-operator">{</span>
        <span class="uscript-keyword">return</span> X<span class="uscript-operator">==</span><span class="uscript-number">0</span><span class="uscript-operator">.</span>f <span class="uscript-operator">&amp;&amp;</span> Y<span class="uscript-operator">==</span><span class="uscript-number">0</span><span class="uscript-operator">.</span>f <span class="uscript-operator">&amp;&amp;</span> Z<span class="uscript-operator">==</span><span class="uscript-number">0</span><span class="uscript-operator">.</span>f<span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>
    UBOOL Normalize<span class="uscript-operator">(</span><span class="uscript-operator">)</span>
    <span class="uscript-operator">{</span>
        <span class="uscript-type">FLOAT</span> SquareSum <span class="uscript-operator">=</span> X<span class="uscript-operator">*</span>X<span class="uscript-operator">+</span>Y<span class="uscript-operator">*</span>Y<span class="uscript-operator">+</span>Z<span class="uscript-operator">*</span>Z<span class="uscript-operator">;</span>
        <span class="uscript-keyword">if</span><span class="uscript-operator">(</span> SquareSum <span class="uscript-operator">&gt;=</span> SMALL_NUMBER <span class="uscript-operator">)</span>
        <span class="uscript-operator">{</span>
            <span class="uscript-type">FLOAT</span> Scale <span class="uscript-operator">=</span> <span class="uscript-number">1</span><span class="uscript-operator">.</span>f<span class="uscript-operator">/</span>appSqrt<span class="uscript-operator">(</span>SquareSum<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
            X <span class="uscript-operator">*=</span> Scale<span class="uscript-operator">;</span> Y <span class="uscript-operator">*=</span> Scale<span class="uscript-operator">;</span> Z <span class="uscript-operator">*=</span> Scale<span class="uscript-operator">;</span>
            <span class="uscript-keyword">return</span> <span class="uscript-number">1</span><span class="uscript-operator">;</span>
        <span class="uscript-operator">}</span>
        <span class="uscript-keyword">else</span> <span class="uscript-keyword">return</span> <span class="uscript-number">0</span><span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>
    FVector Projection<span class="uscript-operator">(</span><span class="uscript-operator">)</span> <span class="uscript-keyword">const</span>
    <span class="uscript-operator">{</span>
        <span class="uscript-type">FLOAT</span> RZ <span class="uscript-operator">=</span> <span class="uscript-number">1</span><span class="uscript-operator">.</span>f<span class="uscript-operator">/</span>Z<span class="uscript-operator">;</span>
        <span class="uscript-keyword">return</span> FVector<span class="uscript-operator">(</span> X<span class="uscript-operator">*</span>RZ<span class="uscript-operator">,</span> Y<span class="uscript-operator">*</span>RZ<span class="uscript-operator">,</span> <span class="uscript-number">1</span> <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>
    FVector UnsafeNormal<span class="uscript-operator">(</span><span class="uscript-operator">)</span> <span class="uscript-keyword">const</span>
    <span class="uscript-operator">{</span>
        <span class="uscript-type">FLOAT</span> Scale <span class="uscript-operator">=</span> <span class="uscript-number">1</span><span class="uscript-operator">.</span>f<span class="uscript-operator">/</span>appSqrt<span class="uscript-operator">(</span>X<span class="uscript-operator">*</span>X<span class="uscript-operator">+</span>Y<span class="uscript-operator">*</span>Y<span class="uscript-operator">+</span>Z<span class="uscript-operator">*</span>Z<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
        <span class="uscript-keyword">return</span> FVector<span class="uscript-operator">(</span> X<span class="uscript-operator">*</span>Scale<span class="uscript-operator">,</span> Y<span class="uscript-operator">*</span>Scale<span class="uscript-operator">,</span> Z<span class="uscript-operator">*</span>Scale <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>
    FVector GridSnap<span class="uscript-operator">(</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> Grid <span class="uscript-operator">)</span>
    <span class="uscript-operator">{</span>
        <span class="uscript-keyword">return</span> FVector<span class="uscript-operator">(</span> FSnap<span class="uscript-operator">(</span>X<span class="uscript-operator">,</span> Grid<span class="uscript-operator">.</span>X<span class="uscript-operator">)</span><span class="uscript-operator">,</span>FSnap<span class="uscript-operator">(</span>Y<span class="uscript-operator">,</span> Grid<span class="uscript-operator">.</span>Y<span class="uscript-operator">)</span><span class="uscript-operator">,</span>FSnap<span class="uscript-operator">(</span>Z<span class="uscript-operator">,</span> Grid<span class="uscript-operator">.</span>Z<span class="uscript-operator">)</span> <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>
    FVector BoundToCube<span class="uscript-operator">(</span> <span class="uscript-type">FLOAT</span> Radius <span class="uscript-operator">)</span>
    <span class="uscript-operator">{</span>
        <span class="uscript-keyword">return</span> FVector
        <span class="uscript-operator">(</span>
            Clamp<span class="uscript-operator">(</span>X<span class="uscript-operator">,</span><span class="uscript-operator">-</span>Radius<span class="uscript-operator">,</span>Radius<span class="uscript-operator">)</span><span class="uscript-operator">,</span>
            Clamp<span class="uscript-operator">(</span>Y<span class="uscript-operator">,</span><span class="uscript-operator">-</span>Radius<span class="uscript-operator">,</span>Radius<span class="uscript-operator">)</span><span class="uscript-operator">,</span>
            Clamp<span class="uscript-operator">(</span>Z<span class="uscript-operator">,</span><span class="uscript-operator">-</span>Radius<span class="uscript-operator">,</span>Radius<span class="uscript-operator">)</span>
        <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>
    void AddBounded<span class="uscript-operator">(</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> V<span class="uscript-operator">,</span> <span class="uscript-type">FLOAT</span> Radius<span class="uscript-operator">=</span>MAXSWORD <span class="uscript-operator">)</span>
    <span class="uscript-operator">{</span>
        <span class="uscript-operator">*</span>this <span class="uscript-operator">=</span> <span class="uscript-operator">(</span><span class="uscript-operator">*</span>this <span class="uscript-operator">+</span> V<span class="uscript-operator">)</span><span class="uscript-operator">.</span>BoundToCube<span class="uscript-operator">(</span>Radius<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>
    <span class="uscript-type">FLOAT</span><span class="uscript-operator">&amp;</span> Component<span class="uscript-operator">(</span> <span class="uscript-type">INT</span> Index <span class="uscript-operator">)</span>
    <span class="uscript-operator">{</span>
        <span class="uscript-keyword">return</span> <span class="uscript-operator">(</span><span class="uscript-operator">&amp;</span>X<span class="uscript-operator">)</span><span class="uscript-operator">[</span>Index<span class="uscript-operator">]</span><span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>

    <span class="uscript-comment">// Return a boolean that is based on the vector's direction.</span>
    <span class="uscript-comment">// When      V==(0,0,0) Booleanize(0)=1.</span>
    <span class="uscript-comment">// Otherwise Booleanize(V) &lt;-&gt; !Booleanize(!B).</span>
    UBOOL Booleanize<span class="uscript-operator">(</span><span class="uscript-operator">)</span>
    <span class="uscript-operator">{</span>
        <span class="uscript-keyword">return</span>
            X <span class="uscript-operator">&gt;</span>  <span class="uscript-number">0</span><span class="uscript-operator">.</span>f ? <span class="uscript-number">1</span> :
            X <span class="uscript-operator">&lt;</span>  <span class="uscript-number">0</span><span class="uscript-operator">.</span>f ? <span class="uscript-number">0</span> :
            Y <span class="uscript-operator">&gt;</span>  <span class="uscript-number">0</span><span class="uscript-operator">.</span>f ? <span class="uscript-number">1</span> :
            Y <span class="uscript-operator">&lt;</span>  <span class="uscript-number">0</span><span class="uscript-operator">.</span>f ? <span class="uscript-number">0</span> :
            Z <span class="uscript-operator">&gt;=</span> <span class="uscript-number">0</span><span class="uscript-operator">.</span>f ? <span class="uscript-number">1</span> : <span class="uscript-number">0</span><span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>

    <span class="uscript-comment">// Transformation.</span>
    FVector TransformVectorBy<span class="uscript-operator">(</span> <span class="uscript-keyword">const</span> FCoords<span class="uscript-operator">&amp;</span> Coords <span class="uscript-operator">)</span> <span class="uscript-keyword">const</span><span class="uscript-operator">;</span>
    FVector TransformPointBy<span class="uscript-operator">(</span> <span class="uscript-keyword">const</span> FCoords<span class="uscript-operator">&amp;</span> Coords <span class="uscript-operator">)</span> <span class="uscript-keyword">const</span><span class="uscript-operator">;</span>
    FVector MirrorByVector<span class="uscript-operator">(</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> MirrorNormal <span class="uscript-operator">)</span> <span class="uscript-keyword">const</span><span class="uscript-operator">;</span>
    FVector MirrorByPlane<span class="uscript-operator">(</span> <span class="uscript-keyword">const</span> FPlane<span class="uscript-operator">&amp;</span> MirrorPlane <span class="uscript-operator">)</span> <span class="uscript-keyword">const</span><span class="uscript-operator">;</span>
    FVector PivotTransform<span class="uscript-operator">(</span><span class="uscript-keyword">const</span> FCoords<span class="uscript-operator">&amp;</span> Coords<span class="uscript-operator">)</span> <span class="uscript-keyword">const</span><span class="uscript-operator">;</span>

    <span class="uscript-comment">// Complicated functions.</span>
    FRotator Rotation<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    void FindBestAxisVectors<span class="uscript-operator">(</span> FVector<span class="uscript-operator">&amp;</span> Axis1<span class="uscript-operator">,</span> FVector<span class="uscript-operator">&amp;</span> Axis2 <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    FVector SafeNormal<span class="uscript-operator">(</span><span class="uscript-operator">)</span> <span class="uscript-keyword">const</span><span class="uscript-operator">;</span> <span class="uscript-comment">//warning: Not inline because of compiler bug.</span>

    <span class="uscript-comment">// Friends.</span>
    friend <span class="uscript-type">FLOAT</span> FDist<span class="uscript-operator">(</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> V1<span class="uscript-operator">,</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> V2 <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    friend <span class="uscript-type">FLOAT</span> FDistSquared<span class="uscript-operator">(</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> V1<span class="uscript-operator">,</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> V2 <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    friend UBOOL FPointsAreSame<span class="uscript-operator">(</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> P<span class="uscript-operator">,</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> Q <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    friend UBOOL FPointsAreNear<span class="uscript-operator">(</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> Point1<span class="uscript-operator">,</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> Point2<span class="uscript-operator">,</span> <span class="uscript-type">FLOAT</span> Dist<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    friend <span class="uscript-type">FLOAT</span> FPointPlaneDist<span class="uscript-operator">(</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> Point<span class="uscript-operator">,</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> PlaneBase<span class="uscript-operator">,</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> PlaneNormal <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    friend FVector FLinePlaneIntersection<span class="uscript-operator">(</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> Point1<span class="uscript-operator">,</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> Point2<span class="uscript-operator">,</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> PlaneOrigin<span class="uscript-operator">,</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> PlaneNormal <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    friend FVector FLinePlaneIntersection<span class="uscript-operator">(</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> Point1<span class="uscript-operator">,</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> Point2<span class="uscript-operator">,</span> <span class="uscript-keyword">const</span> FPlane<span class="uscript-operator">&amp;</span> Plane <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    friend UBOOL FParallel<span class="uscript-operator">(</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> Normal1<span class="uscript-operator">,</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> Normal2 <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    friend UBOOL FCoplanar<span class="uscript-operator">(</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> Base1<span class="uscript-operator">,</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> Normal1<span class="uscript-operator">,</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> Base2<span class="uscript-operator">,</span> <span class="uscript-keyword">const</span> FVector<span class="uscript-operator">&amp;</span> Normal2 <span class="uscript-operator">)</span><span class="uscript-operator">;</span>

    <span class="uscript-comment">// Serializer.</span>
    friend FArchive<span class="uscript-operator">&amp;</span> <span class="uscript-keyword">operator</span><span class="uscript-operator">&lt;&lt;</span><span class="uscript-operator">(</span> FArchive<span class="uscript-operator">&amp;</span> Ar<span class="uscript-operator">,</span> FVector<span class="uscript-operator">&amp;</span> V <span class="uscript-operator">)</span>
    <span class="uscript-operator">{</span>
        <span class="uscript-keyword">return</span> Ar <span class="uscript-operator">&lt;&lt;</span> V<span class="uscript-operator">.</span>X <span class="uscript-operator">&lt;&lt;</span> V<span class="uscript-operator">.</span>Y <span class="uscript-operator">&lt;&lt;</span> V<span class="uscript-operator">.</span>Z<span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>
 <span class="uscript-operator">}</span><span class="uscript-operator">;</span>
 #endif</pre><hr class="thin"><p><em class="em2">DJPaul:</em> Interesting page, rubbish on itself.  What about we make a new page that we can put this - and other notes about the Unreal Engine's Native Classes we've gotten out of Epic?  Perhaps hack0rz <a href="native-coding.html">Native Coding</a> around a bit.</p>
<p>That way we can link to this, the few UT2003 native classes we've gotten out of epic via ut2003mods, the Deus Ex native sources, etc.</p>
<p><em class="em2">Tarquin:</em> What is this page?</p>
<script type="text/javascript"><!--
 menuItemAdd("Introduction", "#0.1");
 menuWrite() //--></script></div>
</div>

<div id="footer" class="bar">
	<p><form method="post" action="http://wiki.beyondunreal.com/wiki" enctype="application/x-www-form-urlencoded">
<a href="../index.html">Home Page</a> | <a href="recent-changes.html">Recent Changes</a><br>
Last edited February 14, 2004 17:44 <a href="http://wiki.beyondunreal.com/wiki?action=browse&diff=1&id=Official_UnMath_Page">(diff)</a><br>Search: <input type="text" name="search"  size="20" /><input type="hidden" name="dosearch" value="1"  /><br><br><small><a href="http://wiki.beyondunreal.com/wiki/Official_UnMath_Page">Original page</a> &#150; copy created Sat, Jun 23, 2007</small><div></div>
</form>
	</p>
	<p>Always snap to grid
</p>
</div>
</div><!-- close of "scrolling" div -->

<div id="quickbar">
	<div id="logo"><a href="../index.html"><img src="shared/wikilogo.jpg" width="143" height="100" border="0"></a>
		</div>
	<div class="qbsitename">
		<p>The Unreal Engine Documentation Site</p>
	</div>
	<div class="qbsection">
<p><a href="metatopics.html">Wiki Community</a></p>
<p><a href="category-category.html">Topic Categories</a></p>


<p><a href="recent-changes.html">Recent Changes</a></p>
<p><a href="offline-wiki.html">Offline Wiki</a></p>
</div><div class="qbsection">
<p><a href="unreal-engine.html">Unreal Engine</a></p>
<p><a href="console-commands.html">Console Commands</a></p>
<p><a href="terminology.html">Terminology</a></p>
<p><a href="category-faq.html">FAQs</a></p>
<p><a href="help-desk.html">Help Desk</a></p>
</div><div class="qbsection">
<p><a href="topics-on-mapping.html">Mapping Topics</a></p>
<p><a href="mapping-lessons.html">Mapping Lessons</a></p>
<p><a href="unrealed-3.html">UnrealEd Interface</a></p>
</div><div class="qbsection">
<p><a href="unrealscript.html">UnrealScript Topics</a></p>
<p><a href="unrealscript-lessons.html">UnrealScript Lessons</a></p>
<p><a href="making-mods.html">Making Mods</a></p>
<p><a href="class-tree.html">Class Tree</a></p>
</div><div class="qbsection">
<p><a href="topics-on-modeling.html">Modeling Topics</a></p>
</div><div class="qbsection">
<p><a href="chongqing-page.html">Chongqing Page</a></p>
<p><a href="log-in.html">Log In</a></p></div>
</div>

</body></html>
