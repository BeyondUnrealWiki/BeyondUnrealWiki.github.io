<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"  "http://www.w3.org/TR/html4/loose.dtd">

<html>
<head lang="en">
	<title>UnrealWiki: DoubleMetaPhone</title>
	<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
	<link rel="stylesheet" type="text/css" media="screen, print"
		href="shared/stylebase.structural.css">	
	<link rel="stylesheet" type="text/css" media="screen"
		href="shared/template-default.css">
	<link rel="stylesheet" type="text/css" media="screen"
		href="shared/styles.chblue.css">
	<link rel="stylesheet" type="text/css" media="print"
		href="shared/template-default-print.css">
	<!--[if IE 6]>
			<style>
			/* dirty hack for IE6. */
			#quickbar {
				position: absolute;
				}
			</style>
	<![endif]-->
  <link rel="start" href="http://wiki.beyondunreal.com/">
  <link rel="glossary"  href="http://wiki.beyondunreal.com/wiki/Terminology">
  <link rel="help"  href="http://wiki.beyondunreal.com/wiki/Using_The_Wiki">
<script type="text/javascript" src="shared/dhtml.js"></script>
<script type="text/javascript" src="shared/dhtml-menu.js"></script>
<style type="text/css">#dhtml-menu    { background: #eee; padding: 5px 0px; margin-right: -20px; border: 1px solid #888; border-left: 1px solid #ccc; border-top: 1px solid #ccc;  border-right: 1px solid #888; border-bottom: 1px solid #888 }
#dhtml-menu td { color: #000; font-family: Arial,Helvetica,sans-serif; font-size: 9pt; line-height: 13pt; padding: 1px 10px; cursor: default }
#dhtml-menu a  { color: #000; font-family: Arial,Helvetica,sans-serif; font-size: 9pt; line-height: 13pt; text-decoration: none }
#dhtml-menu tt { font-family: monospace; font-size: 9pt }
#dhtml-menu-separator { height: 1px; background: red }
#dhtml-menu-anchor { cursor: default }
</style>
<script type="text/javascript" src="shared/expandable.js"></script>
</head>
<body onLoad="menuInit(); document.cookie='page=DoubleMetaPhone; path=/'" class="default">
<div id="scrolling"><!-- contains all except the fixed sidebar -->
<div id="topbar"  class="bar">
	<div class="righthalf">
		<form class="inline" method="post" action="/wiki" enctype="application/x-www-form-urlencoded"><input type="text" name="search"  size="20" /> <input type="submit" name="search" value="search" /></form>
	</div>
	<div class="lefthalf">
		<script type="text/javascript"><!--
			menuAlignRight = false;
		//--></script>
		<span><script type="text/javascript"><!--
 menuWriteAnchor("Quick Navigation") //--></script></span> | <a href="(start).html">Home Page</a> | <a href="recent-changes.html">Recent Changes</a> | <a href="http://wiki.beyondunreal.com/wiki?action=editprefs">Preferences</a>
	</div>
</div>

<div id="content"><!-- contains the title and article -->
	<h1 class='pagetitle'><a href="http://wiki.beyondunreal.com/wiki?back=DoubleMetaPhone">DoubleMetaPhone</a></h1>
	<div class="wiki"><p>This document implements a "sounds like" algorithm developed by Lawrence Philips which he published in the June, 2000 issue of <a href="http://www.cuj.com/documents/s=8038/cuj0006philips/">[C/C++ Users Journal.]</a></p>
<p>Double Metaphone is an improved version of Philips' original Metaphone algorithm.</p>
<p>The UnrealScript implementation has been adapted from Stephen Woodbridge's <a href="http://swoodbridge.com/DoubleMetaPhone/">[PHP implementation]</a> by <a href="el-muerte.html">El Muerte</a>. </p>
<p><em class="em1">Note:</em> Because of the size of the algorithm there might be errors in it.</p>
<h2><a name="0.1"></a>The algorithm</h2>
<pre class="uscript"><span class="uscript-comment">/**
    Returns the double metaphone value of in.
    The array always contains two values.
*/</span>
<span class="uscript-keyword">static</span> <span class="uscript-keyword">final</span> <span class="uscript-keyword">function</span> <span class="uscript-keyword">array</span><span class="uscript-operator">&lt;</span><span class="uscript-type">string</span><span class="uscript-operator">&gt;</span> DoubleMetaPhone<span class="uscript-operator">(</span><span class="uscript-keyword">coerce</span> <span class="uscript-type">string</span> in<span class="uscript-operator">,</span> <span class="uscript-keyword">optional</span> <span class="uscript-type">int</span> mlen<span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
    <span class="uscript-keyword">local</span> <span class="uscript-keyword">array</span><span class="uscript-operator">&lt;</span><span class="uscript-type">string</span><span class="uscript-operator">&gt;</span> res<span class="uscript-operator">;</span>
    <span class="uscript-keyword">local</span> <span class="uscript-type">string</span> prim<span class="uscript-operator">,</span> sec<span class="uscript-operator">,</span> tmp<span class="uscript-operator">;</span>
    <span class="uscript-keyword">local</span> <span class="uscript-type">int</span> cur<span class="uscript-operator">,</span> last<span class="uscript-operator">,</span> slen<span class="uscript-operator">;</span>

    <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>mlen <span class="uscript-operator">==</span> <span class="uscript-number">0</span><span class="uscript-operator">)</span> mlen <span class="uscript-operator">=</span> <span class="uscript-number">4</span><span class="uscript-operator">;</span>
    slen <span class="uscript-operator">=</span> Len<span class="uscript-operator">(</span>in<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    last <span class="uscript-operator">=</span> slen<span class="uscript-number">-1</span><span class="uscript-operator">;</span>
    in <span class="uscript-operator">=</span> caps<span class="uscript-operator">(</span>in<span class="uscript-operator">$</span><span class="uscript-string">"     "</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    <span class="uscript-comment">// skip this at beginning of word</span>
    <span class="uscript-keyword">switch</span> <span class="uscript-operator">(</span>Left<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> <span class="uscript-number">2</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
    <span class="uscript-operator">{</span>
        <span class="uscript-keyword">case</span> <span class="uscript-string">"GN"</span>:
        <span class="uscript-keyword">case</span> <span class="uscript-string">"KN"</span>:
        <span class="uscript-keyword">case</span> <span class="uscript-string">"PN"</span>:
        <span class="uscript-keyword">case</span> <span class="uscript-string">"WR"</span>:
        <span class="uscript-keyword">case</span> <span class="uscript-string">"PS"</span>:
            cur<span class="uscript-operator">++</span><span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>
    <span class="uscript-comment">// Initial 'X' is pronounced 'Z' e.g. 'Xavier'</span>
    <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>Left<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"X"</span><span class="uscript-operator">)</span>
    <span class="uscript-operator">{</span>
        prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"S"</span><span class="uscript-operator">;</span> <span class="uscript-comment">// 'Z' maps to 'S'</span>
        sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"S"</span><span class="uscript-operator">;</span>
        cur<span class="uscript-operator">++</span><span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>
    <span class="uscript-comment">// main loop</span>
    <span class="uscript-keyword">while</span> <span class="uscript-operator">(</span>len<span class="uscript-operator">(</span>prim<span class="uscript-operator">)</span> <span class="uscript-operator">&lt;</span> mlen <span class="uscript-operator">||</span> len<span class="uscript-operator">(</span>sec<span class="uscript-operator">)</span> <span class="uscript-operator">&lt;</span> mlen<span class="uscript-operator">)</span>
    <span class="uscript-operator">{</span>
        <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>cur <span class="uscript-operator">&gt;=</span> slen<span class="uscript-operator">)</span> <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>
        <span class="uscript-keyword">switch</span> <span class="uscript-operator">(</span>mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur<span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
        <span class="uscript-operator">{</span>
            <span class="uscript-keyword">case</span> <span class="uscript-string">"A"</span>:
            <span class="uscript-keyword">case</span> <span class="uscript-string">"E"</span>:
            <span class="uscript-keyword">case</span> <span class="uscript-string">"I"</span>:
            <span class="uscript-keyword">case</span> <span class="uscript-string">"O"</span>:
            <span class="uscript-keyword">case</span> <span class="uscript-string">"U"</span>:
            <span class="uscript-keyword">case</span> <span class="uscript-string">"Y"</span>:
                <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>cur <span class="uscript-operator">==</span> <span class="uscript-number">0</span><span class="uscript-operator">)</span> <span class="uscript-comment">// all init vowels now map to 'A'</span>
                <span class="uscript-operator">{</span>
                    prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"A"</span><span class="uscript-operator">;</span>
                    sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"A"</span><span class="uscript-operator">;</span>
                <span class="uscript-operator">}</span>
                cur<span class="uscript-operator">++</span><span class="uscript-operator">;</span>
                <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>

            <span class="uscript-keyword">case</span> <span class="uscript-string">"B"</span>: <span class="uscript-comment">// '-mb', e.g. "dumb", already skipped over ...</span>
                prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"P"</span><span class="uscript-operator">;</span>
                sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"P"</span><span class="uscript-operator">;</span>
                <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur<span class="uscript-number">+1</span><span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"B"</span><span class="uscript-operator">)</span> cur <span class="uscript-operator">+=</span> <span class="uscript-number">2</span><span class="uscript-operator">;</span>
                <span class="uscript-keyword">else</span> cur<span class="uscript-operator">++</span><span class="uscript-operator">;</span>
                <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>

            <span class="uscript-keyword">case</span> <span class="uscript-string">"Ç"</span>:
                prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"S"</span><span class="uscript-operator">;</span>
                sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"S"</span><span class="uscript-operator">;</span>
                cur<span class="uscript-operator">++</span><span class="uscript-operator">;</span>
                <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>

            <span class="uscript-keyword">case</span> <span class="uscript-string">"C"</span>: <span class="uscript-comment">// various gremanic</span>
                <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">(</span>cur <span class="uscript-operator">&gt;</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span>
                    <span class="uscript-operator">&amp;&amp;</span> <span class="uscript-operator">(</span><span class="uscript-operator">!</span>is_vowel<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur<span class="uscript-number">-2</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
                    <span class="uscript-operator">&amp;&amp;</span> <span class="uscript-operator">(</span>mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur <span class="uscript-operator">-</span> <span class="uscript-number">1</span><span class="uscript-operator">,</span> <span class="uscript-number">3</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"ACH"</span><span class="uscript-operator">)</span>
                    <span class="uscript-operator">&amp;&amp;</span> <span class="uscript-operator">(</span><span class="uscript-operator">(</span>mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur <span class="uscript-operator">+</span> <span class="uscript-number">2</span><span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span> <span class="uscript-operator">!=</span> <span class="uscript-string">"I"</span><span class="uscript-operator">)</span>
                        <span class="uscript-operator">&amp;&amp;</span> <span class="uscript-operator">(</span><span class="uscript-operator">(</span>mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur <span class="uscript-operator">+</span> <span class="uscript-number">2</span><span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span> <span class="uscript-operator">!=</span> <span class="uscript-string">"E"</span><span class="uscript-operator">)</span>
                            <span class="uscript-operator">||</span> smid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur <span class="uscript-operator">-</span> <span class="uscript-number">2</span><span class="uscript-operator">,</span> <span class="uscript-number">6</span><span class="uscript-operator">,</span> tmp<span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"BACHER"</span><span class="uscript-operator">)</span>
                            <span class="uscript-operator">||</span> tmp <span class="uscript-operator">==</span> <span class="uscript-string">"MACHER"</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
                <span class="uscript-operator">{</span>
                    prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"K"</span><span class="uscript-operator">;</span>
                    sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"K"</span><span class="uscript-operator">;</span>
                    cur <span class="uscript-operator">+=</span> <span class="uscript-number">2</span><span class="uscript-operator">;</span>
                    <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>
                <span class="uscript-operator">}</span>

                <span class="uscript-comment">// special case 'caesar'</span>
                <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">(</span>cur <span class="uscript-operator">==</span> <span class="uscript-number">0</span><span class="uscript-operator">)</span> <span class="uscript-operator">&amp;&amp;</span> <span class="uscript-operator">(</span>mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur<span class="uscript-operator">,</span> <span class="uscript-number">6</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"CAESAR"</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
                <span class="uscript-operator">{</span>
                    prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"S"</span><span class="uscript-operator">;</span>
                    sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"S"</span><span class="uscript-operator">;</span>
                    cur <span class="uscript-operator">+=</span> <span class="uscript-number">2</span><span class="uscript-operator">;</span>
                    <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>
                <span class="uscript-operator">}</span>

                <span class="uscript-comment">// italian 'chianti'</span>
                <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur<span class="uscript-operator">,</span> <span class="uscript-number">4</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"CHIA"</span><span class="uscript-operator">)</span>
                <span class="uscript-operator">{</span>
                    prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"K"</span><span class="uscript-operator">;</span>
                    sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"K"</span><span class="uscript-operator">;</span>
                    cur <span class="uscript-operator">+=</span> <span class="uscript-number">2</span><span class="uscript-operator">;</span>
                    <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>
                <span class="uscript-operator">}</span>

                <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur<span class="uscript-operator">,</span> <span class="uscript-number">2</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"CH"</span><span class="uscript-operator">)</span>
                <span class="uscript-operator">{</span>
                    <span class="uscript-comment">// find 'michael'</span>
                    <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">(</span>cur <span class="uscript-operator">&gt;</span> <span class="uscript-number">0</span><span class="uscript-operator">)</span> <span class="uscript-operator">&amp;&amp;</span> <span class="uscript-operator">(</span>mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur<span class="uscript-operator">,</span> <span class="uscript-number">4</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"CHAE"</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
                    <span class="uscript-operator">{</span>
                        prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"K"</span><span class="uscript-operator">;</span>
                        sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"X"</span><span class="uscript-operator">;</span>
                        cur <span class="uscript-operator">+=</span> <span class="uscript-number">2</span><span class="uscript-operator">;</span>
                        <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>
                    <span class="uscript-operator">}</span>

                    <span class="uscript-comment">// greek roots e.g. 'chemistry', 'chorus'</span>
                    <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">(</span>cur <span class="uscript-operator">==</span> <span class="uscript-number">0</span><span class="uscript-operator">)</span>
                        <span class="uscript-operator">&amp;&amp;</span> <span class="uscript-operator">(</span>smid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur<span class="uscript-number">+1</span><span class="uscript-operator">,</span> <span class="uscript-number">5</span><span class="uscript-operator">,</span> tmp<span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"HARAC"</span>
                            <span class="uscript-operator">||</span> tmp <span class="uscript-operator">==</span> <span class="uscript-string">"HARIS"</span><span class="uscript-operator">)</span>
                        <span class="uscript-operator">||</span> <span class="uscript-operator">(</span>smid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur<span class="uscript-number">+1</span><span class="uscript-operator">,</span> <span class="uscript-number">3</span><span class="uscript-operator">,</span> tmp<span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"HOR"</span>
                            <span class="uscript-operator">||</span> tmp <span class="uscript-operator">==</span> <span class="uscript-string">"HYM"</span>
                            <span class="uscript-operator">||</span> tmp <span class="uscript-operator">==</span> <span class="uscript-string">"HIA"</span>
                            <span class="uscript-operator">||</span> tmp <span class="uscript-operator">==</span> <span class="uscript-string">"HEM"</span><span class="uscript-operator">)</span>
                        <span class="uscript-operator">&amp;&amp;</span> <span class="uscript-operator">(</span>mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> <span class="uscript-number">0</span><span class="uscript-operator">,</span> <span class="uscript-number">5</span><span class="uscript-operator">)</span> <span class="uscript-operator">!=</span> <span class="uscript-string">"CHORE"</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
                    <span class="uscript-operator">{</span>
                        prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"K"</span><span class="uscript-operator">;</span>
                        sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"K"</span><span class="uscript-operator">;</span>
                        cur <span class="uscript-operator">+=</span> <span class="uscript-number">2</span><span class="uscript-operator">;</span>
                        <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>
                    <span class="uscript-operator">}</span>

                    <span class="uscript-comment">// germanic, greek, or otherwise 'ch' for 'kh' sound</span>
                    <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">(</span>   <span class="uscript-operator">(</span>smid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> <span class="uscript-number">0</span><span class="uscript-operator">,</span> <span class="uscript-number">4</span><span class="uscript-operator">,</span> tmp<span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"VAN "</span><span class="uscript-operator">)</span>
                            <span class="uscript-operator">||</span> <span class="uscript-operator">(</span>tmp <span class="uscript-operator">==</span> <span class="uscript-string">"VON "</span><span class="uscript-operator">)</span>
                            <span class="uscript-operator">||</span> <span class="uscript-operator">(</span>tmp <span class="uscript-operator">==</span> <span class="uscript-string">"SCH"</span><span class="uscript-operator">)</span>
                        <span class="uscript-operator">)</span>
                        <span class="uscript-comment">// 'architect' but not 'arch', orchestra', 'orchid'</span>
                        <span class="uscript-operator">||</span> <span class="uscript-operator">(</span>    <span class="uscript-operator">(</span>smid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur<span class="uscript-number">-2</span><span class="uscript-operator">,</span> <span class="uscript-number">6</span><span class="uscript-operator">,</span> tmp<span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"ORCHES"</span><span class="uscript-operator">)</span>
                                <span class="uscript-operator">||</span> <span class="uscript-operator">(</span>tmp <span class="uscript-operator">==</span> <span class="uscript-string">"ARCHIT"</span><span class="uscript-operator">)</span>
                                <span class="uscript-operator">||</span> <span class="uscript-operator">(</span>tmp <span class="uscript-operator">==</span> <span class="uscript-string">"ORCHID"</span><span class="uscript-operator">)</span>
                            <span class="uscript-operator">)</span>
                        <span class="uscript-operator">||</span> <span class="uscript-operator">(</span>InStr<span class="uscript-operator">(</span><span class="uscript-string">"TS"</span><span class="uscript-operator">,</span> Mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur<span class="uscript-number">+2</span><span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">&gt;</span> <span class="uscript-operator">-</span><span class="uscript-number">1</span><span class="uscript-operator">)</span>
                        <span class="uscript-operator">||</span> <span class="uscript-operator">(</span>
                            <span class="uscript-operator">(</span><span class="uscript-operator">(</span>InStr<span class="uscript-operator">(</span><span class="uscript-string">"AOUE"</span><span class="uscript-operator">,</span> Mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur<span class="uscript-number">-1</span><span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">&gt;</span> <span class="uscript-operator">-</span><span class="uscript-number">1</span><span class="uscript-operator">)</span>
                                <span class="uscript-operator">||</span> <span class="uscript-operator">(</span>cur <span class="uscript-operator">==</span> <span class="uscript-number">0</span><span class="uscript-operator">)</span>
                            <span class="uscript-operator">)</span>
                            <span class="uscript-comment">// e.g. 'wachtler', 'weschsler', but not 'tichner'</span>
                            <span class="uscript-operator">&amp;&amp;</span> <span class="uscript-operator">(</span>InStr<span class="uscript-operator">(</span><span class="uscript-string">"LRNMBHFVW"</span><span class="uscript-operator">,</span> Mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur<span class="uscript-number">+2</span><span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">&gt;</span> <span class="uscript-operator">-</span><span class="uscript-number">1</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
                        <span class="uscript-operator">)</span>
                    <span class="uscript-operator">{</span>
                        prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"K"</span><span class="uscript-operator">;</span>
                        sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"K"</span><span class="uscript-operator">;</span>
                    <span class="uscript-operator">}</span>
                    <span class="uscript-keyword">else</span> <span class="uscript-operator">{</span>
                        <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>cur <span class="uscript-operator">&gt;</span> <span class="uscript-number">0</span><span class="uscript-operator">)</span>
                        <span class="uscript-operator">{</span>
                            <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> <span class="uscript-number">0</span><span class="uscript-operator">,</span> <span class="uscript-number">2</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"MC"</span><span class="uscript-operator">)</span>
                            <span class="uscript-operator">{</span>
                                <span class="uscript-comment">// e.g. 'McHugh'</span>
                                prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"K"</span><span class="uscript-operator">;</span>
                                sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"K"</span><span class="uscript-operator">;</span>
                            <span class="uscript-operator">}</span>
                            <span class="uscript-keyword">else</span> <span class="uscript-operator">{</span>
                                prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"X"</span><span class="uscript-operator">;</span>
                                sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"K"</span><span class="uscript-operator">;</span>
                            <span class="uscript-operator">}</span>
                        <span class="uscript-operator">}</span>
                        <span class="uscript-keyword">else</span> <span class="uscript-operator">{</span>
                            prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"X"</span><span class="uscript-operator">;</span>
                            sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"X"</span><span class="uscript-operator">;</span>
                        <span class="uscript-operator">}</span>
                    <span class="uscript-operator">}</span>
                    cur <span class="uscript-operator">+=</span> <span class="uscript-number">2</span><span class="uscript-operator">;</span>
                    <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>
                <span class="uscript-operator">}</span>

                <span class="uscript-comment">// e.g. 'czerny'</span>
                <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur<span class="uscript-operator">,</span> <span class="uscript-number">2</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"CZ"</span>
                    <span class="uscript-operator">&amp;&amp;</span> mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur<span class="uscript-number">-2</span><span class="uscript-operator">,</span> <span class="uscript-number">4</span><span class="uscript-operator">)</span> <span class="uscript-operator">!=</span> <span class="uscript-string">"WICZ"</span><span class="uscript-operator">)</span>
                <span class="uscript-operator">{</span>
                    prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"S"</span><span class="uscript-operator">;</span>
                    sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"X"</span><span class="uscript-operator">;</span>
                    cur <span class="uscript-operator">+=</span> <span class="uscript-number">2</span><span class="uscript-operator">;</span>
                    <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>
                <span class="uscript-operator">}</span>

                <span class="uscript-comment">// e.g. 'focaccia'</span>
                <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur <span class="uscript-operator">+</span> <span class="uscript-number">1</span><span class="uscript-operator">,</span> <span class="uscript-number">3</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"CIA"</span><span class="uscript-operator">)</span>
                <span class="uscript-operator">{</span>
                    prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"X"</span><span class="uscript-operator">;</span>
                    sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"X"</span><span class="uscript-operator">;</span>
                    cur <span class="uscript-operator">+=</span> <span class="uscript-number">3</span><span class="uscript-operator">;</span>
                    <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>
                <span class="uscript-operator">}</span>

                <span class="uscript-comment">// double 'C', but not McClellan'</span>
                <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur<span class="uscript-operator">,</span> <span class="uscript-number">2</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"CC"</span>
                        <span class="uscript-operator">&amp;&amp;</span> <span class="uscript-operator">!</span><span class="uscript-operator">(</span><span class="uscript-operator">(</span>cur <span class="uscript-operator">==</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span>
                            <span class="uscript-operator">&amp;&amp;</span> <span class="uscript-operator">(</span>mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> <span class="uscript-number">0</span><span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"M"</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
                <span class="uscript-operator">{</span>
                    <span class="uscript-comment">// 'bellocchio' but not 'bacchus'</span>
                    <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">(</span>InStr<span class="uscript-operator">(</span><span class="uscript-string">"IEH"</span><span class="uscript-operator">,</span> mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur <span class="uscript-operator">+</span> <span class="uscript-number">2</span><span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">&gt;</span> <span class="uscript-operator">-</span><span class="uscript-number">1</span><span class="uscript-operator">)</span>
                        <span class="uscript-operator">&amp;&amp;</span> <span class="uscript-operator">(</span>mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur <span class="uscript-operator">+</span> <span class="uscript-number">2</span><span class="uscript-operator">,</span> <span class="uscript-number">2</span><span class="uscript-operator">)</span> <span class="uscript-operator">!=</span> <span class="uscript-string">"HU"</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
                    <span class="uscript-operator">{</span>
                        <span class="uscript-comment">// 'accident', 'accede', 'succeed'</span>
                        <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">(</span><span class="uscript-operator">(</span>cur <span class="uscript-operator">==</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span>
                            <span class="uscript-operator">&amp;&amp;</span> <span class="uscript-operator">(</span>mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur <span class="uscript-operator">-</span> <span class="uscript-number">1</span><span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"A"</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
                            <span class="uscript-operator">||</span> <span class="uscript-operator">(</span>smid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur<span class="uscript-number">-1</span><span class="uscript-operator">,</span> <span class="uscript-number">5</span><span class="uscript-operator">,</span> tmp<span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"UCCEE"</span><span class="uscript-operator">)</span>
                            <span class="uscript-operator">||</span> <span class="uscript-operator">(</span>tmp <span class="uscript-operator">==</span> <span class="uscript-string">"UCCES"</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
                        <span class="uscript-operator">{</span>
                            prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"KS"</span><span class="uscript-operator">;</span>
                            sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"KS"</span><span class="uscript-operator">;</span>
                            <span class="uscript-comment">// 'bacci', 'bertucci', other italian</span>
                        <span class="uscript-operator">}</span>
                        <span class="uscript-keyword">else</span> <span class="uscript-operator">{</span>
                            prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"X"</span><span class="uscript-operator">;</span>
                            sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"X"</span><span class="uscript-operator">;</span>
                        <span class="uscript-operator">}</span>
                        cur <span class="uscript-operator">+=</span> <span class="uscript-number">3</span><span class="uscript-operator">;</span>
                        <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>
                    <span class="uscript-operator">}</span>
                    <span class="uscript-keyword">else</span> <span class="uscript-operator">{</span>
                        <span class="uscript-comment">// Pierce's rule</span>
                        prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"K"</span><span class="uscript-operator">;</span>
                        sec <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"K"</span><span class="uscript-operator">;</span>
                        cur <span class="uscript-operator">+=</span> <span class="uscript-number">2</span><span class="uscript-operator">;</span>
                        <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>
                    <span class="uscript-operator">}</span>
                <span class="uscript-operator">}</span>

                <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">(</span>smid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur<span class="uscript-operator">,</span> <span class="uscript-number">2</span><span class="uscript-operator">,</span> tmp<span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"CK"</span><span class="uscript-operator">)</span>
                    <span class="uscript-operator">||</span> <span class="uscript-operator">(</span>tmp <span class="uscript-operator">==</span> <span class="uscript-string">"CG"</span><span class="uscript-operator">)</span>
                    <span class="uscript-operator">||</span> <span class="uscript-operator">(</span>tmp <span class="uscript-operator">==</span> <span class="uscript-string">"CQ"</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
                <span class="uscript-operator">{</span>
                    prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"K"</span><span class="uscript-operator">;</span>
                    sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"K"</span><span class="uscript-operator">;</span>
                    cur <span class="uscript-operator">+=</span> <span class="uscript-number">2</span><span class="uscript-operator">;</span>
                    <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>
                <span class="uscript-operator">}</span>

                <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">(</span>smid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur<span class="uscript-operator">,</span> <span class="uscript-number">2</span><span class="uscript-operator">,</span> tmp<span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"CI"</span><span class="uscript-operator">)</span>
                    <span class="uscript-operator">||</span> <span class="uscript-operator">(</span>tmp <span class="uscript-operator">==</span> <span class="uscript-string">"CE"</span><span class="uscript-operator">)</span>
                    <span class="uscript-operator">||</span> <span class="uscript-operator">(</span>tmp <span class="uscript-operator">==</span> <span class="uscript-string">"CY"</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
                <span class="uscript-operator">{</span>
                    <span class="uscript-comment">// italian vs. english</span>
                    <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">(</span>smid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur<span class="uscript-operator">,</span> <span class="uscript-number">3</span><span class="uscript-operator">,</span> tmp<span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"CIO"</span><span class="uscript-operator">)</span>
                        <span class="uscript-operator">||</span> <span class="uscript-operator">(</span>tmp <span class="uscript-operator">==</span> <span class="uscript-string">"CIE"</span><span class="uscript-operator">)</span>
                        <span class="uscript-operator">||</span> <span class="uscript-operator">(</span>tmp <span class="uscript-operator">==</span> <span class="uscript-string">"CIA"</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
                    <span class="uscript-operator">{</span>
                        prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"S"</span><span class="uscript-operator">;</span>
                        sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"X"</span><span class="uscript-operator">;</span>
                    <span class="uscript-operator">}</span>
                    <span class="uscript-keyword">else</span> <span class="uscript-operator">{</span>
                        prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"S"</span><span class="uscript-operator">;</span>
                        sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"S"</span><span class="uscript-operator">;</span>
                    <span class="uscript-operator">}</span>
                    cur <span class="uscript-operator">+=</span> <span class="uscript-number">2</span><span class="uscript-operator">;</span>
                    <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>
                <span class="uscript-operator">}</span>

                <span class="uscript-comment">// else</span>
                prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"K"</span><span class="uscript-operator">;</span>
                sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"K"</span><span class="uscript-operator">;</span>

                <span class="uscript-comment">// name sent in 'mac caffrey', 'mac gregor'</span>
                <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">(</span>smid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur<span class="uscript-number">+1</span><span class="uscript-operator">,</span> <span class="uscript-number">2</span><span class="uscript-operator">,</span> tmp<span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">" C"</span><span class="uscript-operator">)</span>
                    <span class="uscript-operator">||</span> <span class="uscript-operator">(</span>tmp <span class="uscript-operator">==</span> <span class="uscript-string">" Q"</span><span class="uscript-operator">)</span>
                    <span class="uscript-operator">||</span> <span class="uscript-operator">(</span>tmp <span class="uscript-operator">==</span> <span class="uscript-string">" G"</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
                <span class="uscript-operator">{</span>
                    cur <span class="uscript-operator">+=</span> <span class="uscript-number">3</span><span class="uscript-operator">;</span>
                <span class="uscript-operator">}</span>
                <span class="uscript-keyword">else</span> <span class="uscript-operator">{</span>
                    <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">(</span>InStr<span class="uscript-operator">(</span><span class="uscript-string">"CKQ"</span><span class="uscript-operator">,</span> mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur <span class="uscript-operator">+</span> <span class="uscript-number">1</span><span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">&gt;</span> <span class="uscript-operator">-</span><span class="uscript-number">1</span><span class="uscript-operator">)</span>
                        <span class="uscript-operator">&amp;&amp;</span> <span class="uscript-operator">!</span><span class="uscript-operator">(</span><span class="uscript-operator">(</span>smid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur<span class="uscript-number">+1</span><span class="uscript-operator">,</span> <span class="uscript-number">2</span><span class="uscript-operator">,</span> tmp<span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"CE"</span><span class="uscript-operator">)</span>
                            <span class="uscript-operator">||</span> <span class="uscript-operator">(</span>tmp <span class="uscript-operator">==</span> <span class="uscript-string">"CI"</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
                        <span class="uscript-operator">)</span>
                    <span class="uscript-operator">{</span>
                        cur <span class="uscript-operator">+=</span> <span class="uscript-number">2</span><span class="uscript-operator">;</span>
                    <span class="uscript-operator">}</span>
                    <span class="uscript-keyword">else</span> <span class="uscript-operator">{</span>
                        cur<span class="uscript-operator">++</span><span class="uscript-operator">;</span>
                    <span class="uscript-operator">}</span>
                <span class="uscript-operator">}</span>
                <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>

            <span class="uscript-keyword">case</span> <span class="uscript-string">"D"</span>:
                <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur<span class="uscript-operator">,</span> <span class="uscript-number">2</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"DG"</span><span class="uscript-operator">)</span>
                <span class="uscript-operator">{</span>
                    <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>InStr<span class="uscript-operator">(</span><span class="uscript-string">"IEY"</span><span class="uscript-operator">,</span> mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur <span class="uscript-operator">+</span> <span class="uscript-number">2</span><span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">&gt;</span> <span class="uscript-operator">-</span><span class="uscript-number">1</span><span class="uscript-operator">)</span>
                    <span class="uscript-operator">{</span>
                        <span class="uscript-comment">// e.g. 'edge'</span>
                        prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"J"</span><span class="uscript-operator">;</span>
                        sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"J"</span><span class="uscript-operator">;</span>
                        cur <span class="uscript-operator">+=</span> <span class="uscript-number">3</span><span class="uscript-operator">;</span>
                        <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>
                    <span class="uscript-operator">}</span>
                    <span class="uscript-keyword">else</span> <span class="uscript-operator">{</span>
                        <span class="uscript-comment">// e.g. 'edgar'</span>
                        prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"TK"</span><span class="uscript-operator">;</span>
                        sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"TK"</span><span class="uscript-operator">;</span>
                        cur <span class="uscript-operator">+=</span> <span class="uscript-number">2</span><span class="uscript-operator">;</span>
                        <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>
                    <span class="uscript-operator">}</span>
                <span class="uscript-operator">}</span>

                <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">(</span>smid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur<span class="uscript-operator">,</span> <span class="uscript-number">2</span><span class="uscript-operator">,</span> tmp<span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"DT"</span><span class="uscript-operator">)</span>
                    <span class="uscript-operator">||</span> <span class="uscript-operator">(</span>tmp <span class="uscript-operator">==</span> <span class="uscript-string">"DD"</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
                <span class="uscript-operator">{</span>
                    prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"T"</span><span class="uscript-operator">;</span>
                    sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"T"</span><span class="uscript-operator">;</span>
                    cur <span class="uscript-operator">+=</span> <span class="uscript-number">2</span><span class="uscript-operator">;</span>
                    <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>
                <span class="uscript-operator">}</span>

                <span class="uscript-comment">// else</span>
                prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"T"</span><span class="uscript-operator">;</span>
                sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"T"</span><span class="uscript-operator">;</span>
                cur<span class="uscript-operator">++</span><span class="uscript-operator">;</span>
                <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>

            <span class="uscript-keyword">case</span> <span class="uscript-string">"F"</span>:
                <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur <span class="uscript-operator">+</span> <span class="uscript-number">1</span><span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"F"</span><span class="uscript-operator">)</span> cur <span class="uscript-operator">+=</span> <span class="uscript-number">2</span><span class="uscript-operator">;</span>
                <span class="uscript-keyword">else</span> cur<span class="uscript-operator">++</span><span class="uscript-operator">;</span>
                prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"F"</span><span class="uscript-operator">;</span>
                sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"F"</span><span class="uscript-operator">;</span>
                <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>

            <span class="uscript-comment">// TODO: optimize</span>
            <span class="uscript-keyword">case</span> <span class="uscript-string">"G"</span>:
                <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur <span class="uscript-operator">+</span> <span class="uscript-number">1</span><span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"H"</span><span class="uscript-operator">)</span>
                <span class="uscript-operator">{</span>
                    <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">(</span>cur <span class="uscript-operator">&gt;</span> <span class="uscript-number">0</span><span class="uscript-operator">)</span> <span class="uscript-operator">&amp;&amp;</span> <span class="uscript-operator">!</span>is_vowel<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur<span class="uscript-number">-1</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
                    <span class="uscript-operator">{</span>
                        prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"K"</span><span class="uscript-operator">;</span>
                        sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"K"</span><span class="uscript-operator">;</span>
                        cur <span class="uscript-operator">+=</span> <span class="uscript-number">2</span><span class="uscript-operator">;</span>
                        <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>
                    <span class="uscript-operator">}</span>

                    <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>cur <span class="uscript-operator">&lt;</span> <span class="uscript-number">3</span><span class="uscript-operator">)</span>
                    <span class="uscript-operator">{</span>
                        <span class="uscript-comment">// 'ghislane', 'ghiradelli'</span>
                        <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>cur <span class="uscript-operator">==</span> <span class="uscript-number">0</span><span class="uscript-operator">)</span>
                        <span class="uscript-operator">{</span>
                            <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur <span class="uscript-operator">+</span> <span class="uscript-number">2</span><span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"I"</span><span class="uscript-operator">)</span>
                            <span class="uscript-operator">{</span>
                                prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"J"</span><span class="uscript-operator">;</span>
                                sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"J"</span><span class="uscript-operator">;</span>
                            <span class="uscript-operator">}</span>
                            <span class="uscript-keyword">else</span> <span class="uscript-operator">{</span>
                                prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"K"</span><span class="uscript-operator">;</span>
                                sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"K"</span><span class="uscript-operator">;</span>
                            <span class="uscript-operator">}</span>
                            cur <span class="uscript-operator">+=</span> <span class="uscript-number">2</span><span class="uscript-operator">;</span>
                            <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>
                        <span class="uscript-operator">}</span>
                    <span class="uscript-operator">}</span>

                    <span class="uscript-comment">// Parker's rule (with some further refinements) - e.g. 'hugh'</span>
                    <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">(</span><span class="uscript-operator">(</span>cur <span class="uscript-operator">&gt;</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span> <span class="uscript-operator">&amp;&amp;</span> <span class="uscript-operator">(</span>InStr<span class="uscript-operator">(</span><span class="uscript-string">"BHD"</span><span class="uscript-operator">,</span> mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur <span class="uscript-operator">-</span> <span class="uscript-number">2</span><span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">&gt;</span> <span class="uscript-operator">-</span><span class="uscript-number">1</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
                        <span class="uscript-comment">// e.g. 'bough'</span>
                        <span class="uscript-operator">||</span> <span class="uscript-operator">(</span><span class="uscript-operator">(</span>cur <span class="uscript-operator">&gt;</span> <span class="uscript-number">2</span><span class="uscript-operator">)</span> <span class="uscript-operator">&amp;&amp;</span> <span class="uscript-operator">(</span>InStr<span class="uscript-operator">(</span><span class="uscript-string">"BHD"</span><span class="uscript-operator">,</span> mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur <span class="uscript-operator">-</span> <span class="uscript-number">3</span><span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">&gt;</span> <span class="uscript-operator">-</span><span class="uscript-number">1</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
                        <span class="uscript-comment">// e.g. 'broughton'</span>
                        <span class="uscript-operator">||</span> <span class="uscript-operator">(</span><span class="uscript-operator">(</span>cur <span class="uscript-operator">&gt;</span> <span class="uscript-number">3</span><span class="uscript-operator">)</span> <span class="uscript-operator">&amp;&amp;</span> <span class="uscript-operator">(</span>InStr<span class="uscript-operator">(</span><span class="uscript-string">"BH"</span><span class="uscript-operator">,</span> mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur <span class="uscript-operator">-</span> <span class="uscript-number">4</span><span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">&gt;</span> <span class="uscript-operator">-</span><span class="uscript-number">1</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
                    <span class="uscript-operator">{</span>
                        cur <span class="uscript-operator">+=</span> <span class="uscript-number">2</span><span class="uscript-operator">;</span>
                        <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>
                    <span class="uscript-operator">}</span>
                    <span class="uscript-keyword">else</span> <span class="uscript-operator">{</span>
                        <span class="uscript-comment">// e.g. 'laugh', 'McLaughlin', 'cough', 'gough', 'rough', 'tough'</span>
                        <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">(</span>cur <span class="uscript-operator">&gt;</span> <span class="uscript-number">2</span><span class="uscript-operator">)</span>
                            <span class="uscript-operator">&amp;&amp;</span> <span class="uscript-operator">(</span>Mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur <span class="uscript-operator">-</span> <span class="uscript-number">1</span><span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"U"</span><span class="uscript-operator">)</span>
                            <span class="uscript-operator">&amp;&amp;</span> <span class="uscript-operator">(</span>InStr<span class="uscript-operator">(</span><span class="uscript-string">"CGLRT"</span><span class="uscript-operator">,</span> mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur <span class="uscript-operator">-</span> <span class="uscript-number">3</span><span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">&gt;</span> <span class="uscript-operator">-</span><span class="uscript-number">1</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
                        <span class="uscript-operator">{</span>
                            prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"F"</span><span class="uscript-operator">;</span>
                            sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"F"</span><span class="uscript-operator">;</span>
                        <span class="uscript-operator">}</span>
                        <span class="uscript-keyword">else</span> <span class="uscript-operator">{</span>
                            <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">(</span>cur <span class="uscript-operator">&gt;</span> <span class="uscript-number">0</span><span class="uscript-operator">)</span> <span class="uscript-operator">&amp;&amp;</span> mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur <span class="uscript-operator">-</span> <span class="uscript-number">1</span><span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span> <span class="uscript-operator">!=</span> <span class="uscript-string">"I"</span><span class="uscript-operator">)</span>
                            <span class="uscript-operator">{</span>
                                prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"K"</span><span class="uscript-operator">;</span>
                                sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"K"</span><span class="uscript-operator">;</span>
                            <span class="uscript-operator">}</span>
                            cur <span class="uscript-operator">+=</span> <span class="uscript-number">2</span><span class="uscript-operator">;</span>
                            <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>
                        <span class="uscript-operator">}</span>
                    <span class="uscript-operator">}</span>
                <span class="uscript-operator">}</span>

                <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur <span class="uscript-operator">+</span> <span class="uscript-number">1</span><span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"N"</span><span class="uscript-operator">)</span>
                <span class="uscript-operator">{</span>
                    <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">(</span>cur <span class="uscript-operator">==</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span> <span class="uscript-operator">&amp;&amp;</span> is_vowel<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> <span class="uscript-number">0</span><span class="uscript-operator">)</span> <span class="uscript-operator">&amp;&amp;</span> <span class="uscript-operator">!</span>Slavo_Germanic<span class="uscript-operator">(</span>in<span class="uscript-operator">)</span><span class="uscript-operator">)</span>
                    <span class="uscript-operator">{</span>
                        prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"KN"</span><span class="uscript-operator">;</span>
                        sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"N"</span><span class="uscript-operator">;</span>
                    <span class="uscript-operator">}</span>
                    <span class="uscript-keyword">else</span> <span class="uscript-operator">{</span>
                        <span class="uscript-comment">// not e.g. 'cagney'</span>
                        <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">(</span>mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur <span class="uscript-operator">+</span> <span class="uscript-number">2</span><span class="uscript-operator">,</span> <span class="uscript-number">2</span><span class="uscript-operator">)</span> <span class="uscript-operator">!=</span> <span class="uscript-string">"EY"</span><span class="uscript-operator">)</span>
                            <span class="uscript-operator">&amp;&amp;</span> <span class="uscript-operator">(</span>mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur <span class="uscript-operator">+</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span> <span class="uscript-operator">!=</span> <span class="uscript-string">"Y"</span><span class="uscript-operator">)</span>
                            <span class="uscript-operator">&amp;&amp;</span> <span class="uscript-operator">!</span>Slavo_Germanic<span class="uscript-operator">(</span>in<span class="uscript-operator">)</span><span class="uscript-operator">)</span>
                        <span class="uscript-operator">{</span>
                            prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"N"</span><span class="uscript-operator">;</span>
                            sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"KN"</span><span class="uscript-operator">;</span>
                        <span class="uscript-operator">}</span>
                        <span class="uscript-keyword">else</span> <span class="uscript-operator">{</span>
                            prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"KN"</span><span class="uscript-operator">;</span>
                            sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"KN"</span><span class="uscript-operator">;</span>
                        <span class="uscript-operator">}</span>
                    <span class="uscript-operator">}</span>
                    cur <span class="uscript-operator">+=</span> <span class="uscript-number">2</span><span class="uscript-operator">;</span>
                    <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>
                <span class="uscript-operator">}</span>

                <span class="uscript-comment">// 'tagliaro'</span>
                <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">(</span>mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur <span class="uscript-operator">+</span> <span class="uscript-number">1</span><span class="uscript-operator">,</span> <span class="uscript-number">2</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"LI"</span><span class="uscript-operator">)</span> <span class="uscript-operator">&amp;&amp;</span> <span class="uscript-operator">!</span>Slavo_Germanic<span class="uscript-operator">(</span>in<span class="uscript-operator">)</span><span class="uscript-operator">)</span>
                <span class="uscript-operator">{</span>
                    prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"KL"</span><span class="uscript-operator">;</span>
                    sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"L"</span><span class="uscript-operator">;</span>
                    cur <span class="uscript-operator">+=</span> <span class="uscript-number">2</span><span class="uscript-operator">;</span>
                    <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>
                <span class="uscript-operator">}</span>

                <span class="uscript-comment">// -ges-, -gep-, -gel- at beginning</span>
                <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">(</span>cur <span class="uscript-operator">==</span> <span class="uscript-number">0</span><span class="uscript-operator">)</span>
                    <span class="uscript-operator">&amp;&amp;</span> <span class="uscript-operator">(</span><span class="uscript-operator">(</span>mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur <span class="uscript-operator">+</span> <span class="uscript-number">1</span><span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"Y"</span><span class="uscript-operator">)</span>
                        <span class="uscript-operator">||</span> <span class="uscript-operator">(</span><span class="uscript-operator">(</span>smid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur <span class="uscript-operator">+</span> <span class="uscript-number">1</span><span class="uscript-operator">,</span> <span class="uscript-number">2</span><span class="uscript-operator">,</span> tmp<span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"ES"</span><span class="uscript-operator">)</span>
                            <span class="uscript-operator">||</span> <span class="uscript-operator">(</span>tmp <span class="uscript-operator">==</span> <span class="uscript-string">"EP"</span><span class="uscript-operator">)</span>
                            <span class="uscript-operator">||</span> <span class="uscript-operator">(</span>tmp <span class="uscript-operator">==</span> <span class="uscript-string">"EB"</span><span class="uscript-operator">)</span>
                            <span class="uscript-operator">||</span> <span class="uscript-operator">(</span>tmp <span class="uscript-operator">==</span> <span class="uscript-string">"EL"</span><span class="uscript-operator">)</span>
                            <span class="uscript-operator">||</span> <span class="uscript-operator">(</span>tmp <span class="uscript-operator">==</span> <span class="uscript-string">"EY"</span><span class="uscript-operator">)</span>
                            <span class="uscript-operator">||</span> <span class="uscript-operator">(</span>tmp <span class="uscript-operator">==</span> <span class="uscript-string">"IB"</span><span class="uscript-operator">)</span>
                            <span class="uscript-operator">||</span> <span class="uscript-operator">(</span>tmp <span class="uscript-operator">==</span> <span class="uscript-string">"IL"</span><span class="uscript-operator">)</span>
                            <span class="uscript-operator">||</span> <span class="uscript-operator">(</span>tmp <span class="uscript-operator">==</span> <span class="uscript-string">"IN"</span><span class="uscript-operator">)</span>
                            <span class="uscript-operator">||</span> <span class="uscript-operator">(</span>tmp <span class="uscript-operator">==</span> <span class="uscript-string">"IE"</span><span class="uscript-operator">)</span>
                            <span class="uscript-operator">||</span> <span class="uscript-operator">(</span>tmp <span class="uscript-operator">==</span> <span class="uscript-string">"EI"</span><span class="uscript-operator">)</span>
                            <span class="uscript-operator">||</span> <span class="uscript-operator">(</span>tmp <span class="uscript-operator">==</span> <span class="uscript-string">"ER"</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
                        <span class="uscript-operator">)</span>
                    <span class="uscript-operator">)</span>
                <span class="uscript-operator">{</span>
                    prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"K"</span><span class="uscript-operator">;</span>
                    sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"J"</span><span class="uscript-operator">;</span>
                    cur <span class="uscript-operator">+=</span> <span class="uscript-number">2</span><span class="uscript-operator">;</span>
                    <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>
                <span class="uscript-operator">}</span>

                <span class="uscript-comment">// -ger-, -gy-</span>
                <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">(</span><span class="uscript-operator">(</span>mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur <span class="uscript-operator">+</span> <span class="uscript-number">1</span><span class="uscript-operator">,</span> <span class="uscript-number">2</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"ER"</span><span class="uscript-operator">)</span>
                    <span class="uscript-operator">||</span> <span class="uscript-operator">(</span>mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur <span class="uscript-operator">+</span> <span class="uscript-number">1</span><span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"Y"</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
                    <span class="uscript-operator">&amp;&amp;</span> <span class="uscript-operator">!</span><span class="uscript-operator">(</span>smid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> <span class="uscript-number">0</span><span class="uscript-operator">,</span> <span class="uscript-number">6</span><span class="uscript-operator">,</span> tmp<span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"DANGER"</span>
                        <span class="uscript-operator">||</span> tmp <span class="uscript-operator">==</span> <span class="uscript-string">"RANGER"</span>
                        <span class="uscript-operator">||</span> tmp <span class="uscript-operator">==</span> <span class="uscript-string">"MANGER"</span>
                    <span class="uscript-operator">)</span>
                    <span class="uscript-operator">&amp;&amp;</span> <span class="uscript-operator">(</span>InStr<span class="uscript-operator">(</span><span class="uscript-string">"EI"</span><span class="uscript-operator">,</span> mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur<span class="uscript-number">-1</span><span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-operator">-</span><span class="uscript-number">1</span><span class="uscript-operator">)</span>
                    <span class="uscript-operator">&amp;&amp;</span> <span class="uscript-operator">!</span><span class="uscript-operator">(</span>smid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur<span class="uscript-number">-1</span><span class="uscript-operator">,</span> <span class="uscript-number">3</span><span class="uscript-operator">,</span> tmp<span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"RGY"</span>
                        <span class="uscript-operator">||</span> tmp <span class="uscript-operator">==</span> <span class="uscript-string">"OGY"</span>
                    <span class="uscript-operator">)</span><span class="uscript-operator">)</span>
                <span class="uscript-operator">{</span>
                    prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"K"</span><span class="uscript-operator">;</span>
                    sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"J"</span><span class="uscript-operator">;</span>
                    cur <span class="uscript-operator">+=</span> <span class="uscript-number">2</span><span class="uscript-operator">;</span>
                    <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>
                <span class="uscript-operator">}</span>

                <span class="uscript-comment">// italian e.g. 'biaggi'</span>
                <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">(</span>InStr<span class="uscript-operator">(</span><span class="uscript-string">"EIY"</span><span class="uscript-operator">,</span> mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur <span class="uscript-operator">+</span> <span class="uscript-number">1</span><span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">&gt;</span> <span class="uscript-operator">-</span><span class="uscript-number">1</span><span class="uscript-operator">)</span>
                    <span class="uscript-operator">||</span> smid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur<span class="uscript-number">-1</span><span class="uscript-operator">,</span> <span class="uscript-number">4</span><span class="uscript-operator">,</span> tmp<span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"AGGI"</span>
                    <span class="uscript-operator">||</span> tmp <span class="uscript-operator">==</span> <span class="uscript-string">"OGGI"</span><span class="uscript-operator">)</span>
                <span class="uscript-operator">{</span>
                    <span class="uscript-comment">// obvious germanic</span>
                    <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">(</span><span class="uscript-operator">(</span>smid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> <span class="uscript-number">0</span><span class="uscript-operator">,</span> <span class="uscript-number">4</span><span class="uscript-operator">,</span> tmp<span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"VAN "</span>
                            <span class="uscript-operator">||</span> tmp <span class="uscript-operator">==</span> <span class="uscript-string">"VON "</span><span class="uscript-operator">)</span>
                        <span class="uscript-operator">||</span> <span class="uscript-operator">(</span>mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> <span class="uscript-number">0</span><span class="uscript-operator">,</span> <span class="uscript-number">3</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"SCH"</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
                        <span class="uscript-operator">||</span> <span class="uscript-operator">(</span>mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur <span class="uscript-operator">+</span> <span class="uscript-number">1</span><span class="uscript-operator">,</span> <span class="uscript-number">2</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"ET"</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
                    <span class="uscript-operator">{</span>
                        prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"K"</span><span class="uscript-operator">;</span>
                        sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"K"</span><span class="uscript-operator">;</span>
                    <span class="uscript-operator">}</span>
                    <span class="uscript-keyword">else</span> <span class="uscript-operator">{</span>
                        <span class="uscript-comment">// always soft if french ending</span>
                        <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur <span class="uscript-operator">+</span> <span class="uscript-number">1</span><span class="uscript-operator">,</span> <span class="uscript-number">4</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"IER "</span><span class="uscript-operator">)</span>
                        <span class="uscript-operator">{</span>
                            prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"J"</span><span class="uscript-operator">;</span>
                            sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"J"</span><span class="uscript-operator">;</span>
                        <span class="uscript-operator">}</span>
                        <span class="uscript-keyword">else</span> <span class="uscript-operator">{</span>
                            prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"J"</span><span class="uscript-operator">;</span>
                            sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"K"</span><span class="uscript-operator">;</span>
                        <span class="uscript-operator">}</span>
                    <span class="uscript-operator">}</span>
                    cur <span class="uscript-operator">+=</span> <span class="uscript-number">2</span><span class="uscript-operator">;</span>
                    <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>
                <span class="uscript-operator">}</span>

                <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur <span class="uscript-operator">+</span><span class="uscript-number">1</span><span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"G"</span><span class="uscript-operator">)</span> cur <span class="uscript-operator">+=</span> <span class="uscript-number">2</span><span class="uscript-operator">;</span>
                <span class="uscript-keyword">else</span> cur<span class="uscript-operator">++</span><span class="uscript-operator">;</span>

                prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"K"</span><span class="uscript-operator">;</span>
                sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"K"</span><span class="uscript-operator">;</span>
                <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>

            <span class="uscript-keyword">case</span> <span class="uscript-string">"H"</span>:
                <span class="uscript-comment">// only keep if first &amp; before vowel or btw. 2 vowels</span>
                <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">(</span><span class="uscript-operator">(</span>cur <span class="uscript-operator">==</span> <span class="uscript-number">0</span><span class="uscript-operator">)</span> <span class="uscript-operator">||</span> is_vowel<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur <span class="uscript-operator">-</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">&amp;&amp;</span> is_vowel<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur <span class="uscript-operator">+</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
                <span class="uscript-operator">{</span>
                    prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"H"</span><span class="uscript-operator">;</span>
                    sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"H"</span><span class="uscript-operator">;</span>
                    cur <span class="uscript-operator">+=</span> <span class="uscript-number">2</span><span class="uscript-operator">;</span>
                <span class="uscript-operator">}</span>
                <span class="uscript-keyword">else</span> cur<span class="uscript-operator">++</span><span class="uscript-operator">;</span>
                <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>

            <span class="uscript-keyword">case</span> <span class="uscript-string">"J"</span>:
                <span class="uscript-comment">// obvious spanish, 'jose', 'san jacinto'</span>
                <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">(</span>mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur<span class="uscript-operator">,</span> <span class="uscript-number">4</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"JOSE"</span><span class="uscript-operator">)</span>
                    <span class="uscript-operator">||</span> <span class="uscript-operator">(</span>mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> <span class="uscript-number">0</span><span class="uscript-operator">,</span> <span class="uscript-number">4</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"SAN "</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
                <span class="uscript-operator">{</span>
                    <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">(</span><span class="uscript-operator">(</span>cur <span class="uscript-operator">==</span> <span class="uscript-number">0</span><span class="uscript-operator">)</span> <span class="uscript-operator">&amp;&amp;</span> <span class="uscript-operator">(</span>mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur <span class="uscript-operator">+</span> <span class="uscript-number">4</span><span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">" "</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
                        <span class="uscript-operator">||</span> <span class="uscript-operator">(</span>mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> <span class="uscript-number">0</span><span class="uscript-operator">,</span> <span class="uscript-number">4</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"SAN "</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
                    <span class="uscript-operator">{</span>
                        prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"H"</span><span class="uscript-operator">;</span>
                        sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"H"</span><span class="uscript-operator">;</span>
                    <span class="uscript-operator">}</span>
                    <span class="uscript-keyword">else</span> <span class="uscript-operator">{</span>
                        prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"J"</span><span class="uscript-operator">;</span>
                        sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"H"</span><span class="uscript-operator">;</span>
                    <span class="uscript-operator">}</span>
                    cur<span class="uscript-operator">++</span><span class="uscript-operator">;</span>
                    <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>
                <span class="uscript-operator">}</span>

                <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">(</span>cur <span class="uscript-operator">==</span> <span class="uscript-number">0</span><span class="uscript-operator">)</span> <span class="uscript-operator">&amp;&amp;</span> <span class="uscript-operator">(</span>mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur<span class="uscript-operator">,</span> <span class="uscript-number">4</span><span class="uscript-operator">)</span> <span class="uscript-operator">!=</span> <span class="uscript-string">"JOSE"</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
                <span class="uscript-operator">{</span>
                    prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"J"</span><span class="uscript-operator">;</span>  <span class="uscript-comment">// Yankelovich/Jankelowicz</span>
                    sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"A"</span><span class="uscript-operator">;</span>
                <span class="uscript-operator">}</span>
                <span class="uscript-keyword">else</span> <span class="uscript-operator">{</span>
                    <span class="uscript-comment">// spanish pron. of .e.g. 'bajador'</span>
                    <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>is_vowel<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur <span class="uscript-operator">-</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span>
                        <span class="uscript-operator">&amp;&amp;</span> <span class="uscript-operator">!</span>Slavo_Germanic<span class="uscript-operator">(</span>in<span class="uscript-operator">)</span>
                        <span class="uscript-operator">&amp;&amp;</span> <span class="uscript-operator">(</span><span class="uscript-operator">(</span>mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur <span class="uscript-operator">+</span> <span class="uscript-number">1</span><span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"A"</span><span class="uscript-operator">)</span>
                        <span class="uscript-operator">||</span> <span class="uscript-operator">(</span>mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur <span class="uscript-operator">+</span> <span class="uscript-number">1</span><span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"O"</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
                    <span class="uscript-operator">{</span>
                        prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"J"</span><span class="uscript-operator">;</span>
                        sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"H"</span><span class="uscript-operator">;</span>
                    <span class="uscript-operator">}</span>
                    <span class="uscript-keyword">else</span> <span class="uscript-operator">{</span>
                        <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>cur <span class="uscript-operator">==</span> last<span class="uscript-operator">)</span>
                        <span class="uscript-operator">{</span>
                            prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"J"</span><span class="uscript-operator">;</span>
                            sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">""</span><span class="uscript-operator">;</span>
                        <span class="uscript-operator">}</span>
                        <span class="uscript-keyword">else</span> <span class="uscript-operator">{</span>
                            <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">(</span>InStr<span class="uscript-operator">(</span><span class="uscript-string">"LTKSNMBZ"</span><span class="uscript-operator">,</span> mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur <span class="uscript-operator">+</span> <span class="uscript-number">1</span><span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-operator">-</span><span class="uscript-number">1</span><span class="uscript-operator">)</span>
                                <span class="uscript-operator">&amp;&amp;</span> <span class="uscript-operator">(</span>InStr<span class="uscript-operator">(</span><span class="uscript-string">"SKL"</span><span class="uscript-operator">,</span> mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur <span class="uscript-operator">-</span> <span class="uscript-number">1</span><span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-operator">-</span><span class="uscript-number">1</span><span class="uscript-operator">)</span> <span class="uscript-operator">)</span>
                            <span class="uscript-operator">{</span>
                                prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"J"</span><span class="uscript-operator">;</span>
                                sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"J"</span><span class="uscript-operator">;</span>
                            <span class="uscript-operator">}</span>
                        <span class="uscript-operator">}</span>
                    <span class="uscript-operator">}</span>
                <span class="uscript-operator">}</span>

                <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur <span class="uscript-operator">+</span> <span class="uscript-number">1</span><span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"J"</span><span class="uscript-operator">)</span> <span class="uscript-comment">// it could happen</span>
                    cur <span class="uscript-operator">+=</span> <span class="uscript-number">2</span><span class="uscript-operator">;</span>
                <span class="uscript-keyword">else</span>
                    cur<span class="uscript-operator">++</span><span class="uscript-operator">;</span>
                <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>

            <span class="uscript-keyword">case</span> <span class="uscript-string">"K"</span>:
                <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur <span class="uscript-operator">+</span> <span class="uscript-number">1</span><span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"K"</span><span class="uscript-operator">)</span> cur <span class="uscript-operator">+=</span> <span class="uscript-number">2</span><span class="uscript-operator">;</span>
                <span class="uscript-keyword">else</span> cur<span class="uscript-operator">++</span><span class="uscript-operator">;</span>
                prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"K"</span><span class="uscript-operator">;</span>
                sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"K"</span><span class="uscript-operator">;</span>
                <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>

            <span class="uscript-keyword">case</span> <span class="uscript-string">"L"</span>:
                <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur <span class="uscript-operator">+</span> <span class="uscript-number">1</span><span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"L"</span><span class="uscript-operator">)</span>
                <span class="uscript-operator">{</span>
                    <span class="uscript-comment">// spanish e.g. 'cabrillo', 'gallegos'</span>
                    <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">(</span><span class="uscript-operator">(</span>cur <span class="uscript-operator">==</span> <span class="uscript-operator">(</span>slen <span class="uscript-operator">-</span> <span class="uscript-number">3</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
                        <span class="uscript-operator">&amp;&amp;</span> <span class="uscript-operator">(</span>smid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur<span class="uscript-number">-1</span><span class="uscript-operator">,</span> <span class="uscript-number">4</span><span class="uscript-operator">,</span> tmp<span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"ILLO"</span>
                            <span class="uscript-operator">||</span> tmp <span class="uscript-operator">==</span> <span class="uscript-string">"ILLA"</span>
                            <span class="uscript-operator">||</span> tmp <span class="uscript-operator">==</span> <span class="uscript-string">"ALLE"</span>
                        <span class="uscript-operator">)</span>
                        <span class="uscript-operator">||</span> <span class="uscript-operator">(</span>
                            <span class="uscript-operator">(</span><span class="uscript-operator">(</span>smid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> last<span class="uscript-number">-1</span><span class="uscript-operator">,</span> <span class="uscript-number">2</span><span class="uscript-operator">,</span> tmp<span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"AS"</span>
                                <span class="uscript-operator">||</span> tmp <span class="uscript-operator">==</span> <span class="uscript-string">"OS"</span><span class="uscript-operator">)</span>
                                <span class="uscript-operator">||</span> <span class="uscript-operator">(</span>InStr<span class="uscript-operator">(</span><span class="uscript-string">"AO"</span><span class="uscript-operator">,</span> mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> last<span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">&gt;</span> <span class="uscript-operator">-</span><span class="uscript-number">1</span><span class="uscript-operator">)</span>
                            <span class="uscript-operator">)</span>
                            <span class="uscript-operator">&amp;&amp;</span> <span class="uscript-operator">(</span>mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur <span class="uscript-operator">-</span> <span class="uscript-number">1</span><span class="uscript-operator">,</span> <span class="uscript-number">4</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"ALLE"</span><span class="uscript-operator">)</span>
                            <span class="uscript-operator">)</span>
                        <span class="uscript-operator">)</span><span class="uscript-operator">)</span>
                    <span class="uscript-operator">{</span>
                        prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"L"</span><span class="uscript-operator">;</span>
                        sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">""</span><span class="uscript-operator">;</span>
                        cur <span class="uscript-operator">+=</span> <span class="uscript-number">2</span><span class="uscript-operator">;</span>
                        <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>
                    <span class="uscript-operator">}</span>
                    cur <span class="uscript-operator">+=</span> <span class="uscript-number">2</span><span class="uscript-operator">;</span>
                <span class="uscript-operator">}</span> <span class="uscript-keyword">else</span> cur<span class="uscript-operator">++</span><span class="uscript-operator">;</span>
                prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"L"</span><span class="uscript-operator">;</span>
                sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"L"</span><span class="uscript-operator">;</span>
                <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>

            <span class="uscript-keyword">case</span> <span class="uscript-string">"M"</span>:
                <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">(</span><span class="uscript-operator">(</span>mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur<span class="uscript-number">-1</span><span class="uscript-operator">,</span> <span class="uscript-number">3</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"UMB"</span><span class="uscript-operator">)</span>
                    <span class="uscript-operator">&amp;&amp;</span> <span class="uscript-operator">(</span><span class="uscript-operator">(</span><span class="uscript-operator">(</span>cur <span class="uscript-operator">+</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> last<span class="uscript-operator">)</span>
                    <span class="uscript-operator">||</span> <span class="uscript-operator">(</span>mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur<span class="uscript-number">+2</span><span class="uscript-operator">,</span> <span class="uscript-number">2</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"ER"</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
                    <span class="uscript-comment">// 'dumb', 'thumb'</span>
                    <span class="uscript-operator">||</span> <span class="uscript-operator">(</span>mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur <span class="uscript-operator">+</span> <span class="uscript-number">1</span><span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"M"</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
                <span class="uscript-operator">{</span>
                    cur <span class="uscript-operator">+=</span> <span class="uscript-number">2</span><span class="uscript-operator">;</span>
                <span class="uscript-operator">}</span>
                <span class="uscript-keyword">else</span> <span class="uscript-operator">{</span>
                    cur<span class="uscript-operator">++</span><span class="uscript-operator">;</span>
                <span class="uscript-operator">}</span>
                prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"M"</span><span class="uscript-operator">;</span>
                sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"M"</span><span class="uscript-operator">;</span>
                <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>

            <span class="uscript-keyword">case</span> <span class="uscript-string">"N"</span>:
                <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur <span class="uscript-operator">+</span> <span class="uscript-number">1</span><span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"N"</span><span class="uscript-operator">)</span> cur <span class="uscript-operator">+=</span> <span class="uscript-number">2</span><span class="uscript-operator">;</span>
                <span class="uscript-keyword">else</span> cur<span class="uscript-operator">++</span><span class="uscript-operator">;</span>
                prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"N"</span><span class="uscript-operator">;</span>
                sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"N"</span><span class="uscript-operator">;</span>
                <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>

            <span class="uscript-keyword">case</span> <span class="uscript-string">"Ñ"</span>:
                cur<span class="uscript-operator">++</span><span class="uscript-operator">;</span>
                prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"N"</span><span class="uscript-operator">;</span>
                sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"N"</span><span class="uscript-operator">;</span>
                <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>

            <span class="uscript-keyword">case</span> <span class="uscript-string">"P"</span>:
                <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur <span class="uscript-operator">+</span> <span class="uscript-number">1</span><span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"H"</span><span class="uscript-operator">)</span>
                <span class="uscript-operator">{</span>
                    cur <span class="uscript-operator">+=</span> <span class="uscript-number">2</span><span class="uscript-operator">;</span>
                    prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"F"</span><span class="uscript-operator">;</span>
                    sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"F"</span><span class="uscript-operator">;</span>
                    <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>
                <span class="uscript-operator">}</span>

                <span class="uscript-comment">// also account for "campbell" and "raspberry"</span>
                <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>InStr<span class="uscript-operator">(</span><span class="uscript-string">"PB"</span><span class="uscript-operator">,</span> Mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur <span class="uscript-operator">+</span> <span class="uscript-number">1</span><span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">&gt;</span> <span class="uscript-operator">-</span><span class="uscript-number">1</span><span class="uscript-operator">)</span>
                    cur <span class="uscript-operator">+=</span> <span class="uscript-number">2</span><span class="uscript-operator">;</span>
                <span class="uscript-keyword">else</span>
                    cur<span class="uscript-operator">++</span><span class="uscript-operator">;</span>
                prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"P"</span><span class="uscript-operator">;</span>
                sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"P"</span><span class="uscript-operator">;</span>
                <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>

            <span class="uscript-keyword">case</span> <span class="uscript-string">"Q"</span>:
                <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur <span class="uscript-operator">+</span> <span class="uscript-number">1</span><span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"Q"</span><span class="uscript-operator">)</span> cur <span class="uscript-operator">+=</span> <span class="uscript-number">2</span><span class="uscript-operator">;</span>
                <span class="uscript-keyword">else</span> cur<span class="uscript-operator">++</span><span class="uscript-operator">;</span>
                prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"K"</span><span class="uscript-operator">;</span>
                sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"K"</span><span class="uscript-operator">;</span>
                <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>

            <span class="uscript-keyword">case</span> <span class="uscript-string">"R"</span>:
                <span class="uscript-comment">// french e.g. 'rogier', but exclude 'hochmeier'</span>
                <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">(</span>cur <span class="uscript-operator">==</span> last<span class="uscript-operator">)</span>
                    <span class="uscript-operator">&amp;&amp;</span> <span class="uscript-operator">!</span>Slavo_Germanic<span class="uscript-operator">(</span>in<span class="uscript-operator">)</span>
                    <span class="uscript-operator">&amp;&amp;</span> <span class="uscript-operator">(</span>mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur <span class="uscript-operator">-</span> <span class="uscript-number">2</span><span class="uscript-operator">,</span> <span class="uscript-number">2</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"IE"</span><span class="uscript-operator">)</span>
                    <span class="uscript-operator">&amp;&amp;</span> <span class="uscript-operator">!</span><span class="uscript-operator">(</span>smid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur<span class="uscript-number">-4</span><span class="uscript-operator">,</span> <span class="uscript-number">2</span><span class="uscript-operator">,</span> tmp<span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"ME"</span>
                        <span class="uscript-operator">||</span> tmp <span class="uscript-operator">==</span> <span class="uscript-string">"MA"</span>
                    <span class="uscript-operator">)</span><span class="uscript-operator">)</span>
                <span class="uscript-operator">{</span>
                    prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">""</span><span class="uscript-operator">;</span>
                    sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"R"</span><span class="uscript-operator">;</span>
                <span class="uscript-operator">}</span>
                <span class="uscript-keyword">else</span> <span class="uscript-operator">{</span>
                    prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"R"</span><span class="uscript-operator">;</span>
                    sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"R"</span><span class="uscript-operator">;</span>
                <span class="uscript-operator">}</span>
                <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur <span class="uscript-operator">+</span> <span class="uscript-number">1</span><span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"R"</span><span class="uscript-operator">)</span> cur <span class="uscript-operator">+=</span> <span class="uscript-number">2</span><span class="uscript-operator">;</span>
                <span class="uscript-keyword">else</span> cur<span class="uscript-operator">++</span><span class="uscript-operator">;</span>
                <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>

            <span class="uscript-keyword">case</span> <span class="uscript-string">"S"</span>:
                <span class="uscript-comment">// special cases 'island', 'isle', 'carlisle', 'carlysle'</span>
                <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">(</span>smid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur <span class="uscript-operator">-</span> <span class="uscript-number">1</span><span class="uscript-operator">,</span> <span class="uscript-number">3</span><span class="uscript-operator">,</span> tmp<span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"ISL"</span><span class="uscript-operator">)</span>
                    <span class="uscript-operator">||</span> <span class="uscript-operator">(</span>tmp <span class="uscript-operator">==</span> <span class="uscript-string">"YSL"</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
                <span class="uscript-operator">{</span>
                    cur<span class="uscript-operator">++</span><span class="uscript-operator">;</span>
                    <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>
                <span class="uscript-operator">}</span>

                <span class="uscript-comment">// special case 'sugar-'</span>
                <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">(</span>cur <span class="uscript-operator">==</span> <span class="uscript-number">0</span><span class="uscript-operator">)</span> <span class="uscript-operator">&amp;&amp;</span> <span class="uscript-operator">(</span>mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur<span class="uscript-operator">,</span> <span class="uscript-number">5</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"SUGAR"</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
                <span class="uscript-operator">{</span>
                    prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"X"</span><span class="uscript-operator">;</span>
                    sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"S"</span><span class="uscript-operator">;</span>
                    cur<span class="uscript-operator">++</span><span class="uscript-operator">;</span>
                    <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>
                <span class="uscript-operator">}</span>

                <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur<span class="uscript-operator">,</span> <span class="uscript-number">2</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"SH"</span><span class="uscript-operator">)</span>
                <span class="uscript-operator">{</span>
                    <span class="uscript-comment">// germanic</span>
                    <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>smid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur <span class="uscript-operator">+</span> <span class="uscript-number">1</span><span class="uscript-operator">,</span> <span class="uscript-number">4</span><span class="uscript-operator">,</span> tmp<span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"HEIM"</span>
                        <span class="uscript-operator">||</span> tmp <span class="uscript-operator">==</span> <span class="uscript-string">"HOEK"</span>
                        <span class="uscript-operator">||</span> tmp <span class="uscript-operator">==</span> <span class="uscript-string">"HOLM"</span>
                        <span class="uscript-operator">||</span> tmp <span class="uscript-operator">==</span> <span class="uscript-string">"HOLZ"</span><span class="uscript-operator">)</span>
                    <span class="uscript-operator">{</span>
                        prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"S"</span><span class="uscript-operator">;</span>
                        sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"S"</span><span class="uscript-operator">;</span>
                    <span class="uscript-operator">}</span>
                    <span class="uscript-keyword">else</span> <span class="uscript-operator">{</span>
                        prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"X"</span><span class="uscript-operator">;</span>
                        sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"X"</span><span class="uscript-operator">;</span>
                    <span class="uscript-operator">}</span>
                    cur <span class="uscript-operator">+=</span> <span class="uscript-number">2</span><span class="uscript-operator">;</span>
                    <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>
                <span class="uscript-operator">}</span>

                <span class="uscript-comment">// italian &amp; armenian</span>
                <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>smid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur<span class="uscript-operator">,</span> <span class="uscript-number">3</span><span class="uscript-operator">,</span> tmp<span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"SIO"</span>
                    <span class="uscript-operator">||</span> tmp <span class="uscript-operator">==</span> <span class="uscript-string">"SIA"</span>
                    <span class="uscript-operator">||</span> mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur<span class="uscript-operator">,</span> <span class="uscript-number">4</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"SIAN"</span><span class="uscript-operator">)</span>
                <span class="uscript-operator">{</span>
                    <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">!</span>Slavo_Germanic<span class="uscript-operator">(</span>in<span class="uscript-operator">)</span><span class="uscript-operator">)</span>
                    <span class="uscript-operator">{</span>
                        prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"S"</span><span class="uscript-operator">;</span>
                        sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"X"</span><span class="uscript-operator">;</span>
                    <span class="uscript-operator">}</span>
                    <span class="uscript-keyword">else</span> <span class="uscript-operator">{</span>
                        prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"S"</span><span class="uscript-operator">;</span>
                        sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"S"</span><span class="uscript-operator">;</span>
                    <span class="uscript-operator">}</span>
                    cur <span class="uscript-operator">+=</span> <span class="uscript-number">3</span><span class="uscript-operator">;</span>
                    <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>
                <span class="uscript-operator">}</span>

                <span class="uscript-comment">// german &amp; anglicisations, e.g. 'smith' match 'schmidt', 'snider' match 'schneider'</span>
                <span class="uscript-comment">// also, -sz- in slavic language altho in hungarian it is pronounced 's'</span>
                <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">(</span>
                        <span class="uscript-operator">(</span>cur <span class="uscript-operator">==</span> <span class="uscript-number">0</span><span class="uscript-operator">)</span>
                        <span class="uscript-operator">&amp;&amp;</span> <span class="uscript-operator">(</span>InStr<span class="uscript-operator">(</span><span class="uscript-string">"MNLW"</span><span class="uscript-operator">,</span> mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur <span class="uscript-operator">+</span> <span class="uscript-number">1</span><span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">&gt;</span> <span class="uscript-operator">-</span><span class="uscript-number">1</span><span class="uscript-operator">)</span>
                    <span class="uscript-operator">)</span>
                    <span class="uscript-operator">||</span> mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur <span class="uscript-operator">+</span> <span class="uscript-number">1</span><span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"Z"</span><span class="uscript-operator">)</span>
                <span class="uscript-operator">{</span>
                    prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"S"</span><span class="uscript-operator">;</span>
                    sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"X"</span><span class="uscript-operator">;</span>
                    <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur <span class="uscript-operator">+</span> <span class="uscript-number">1</span><span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"Z"</span><span class="uscript-operator">)</span> cur <span class="uscript-operator">+=</span> <span class="uscript-number">2</span><span class="uscript-operator">;</span>
                    <span class="uscript-keyword">else</span> cur<span class="uscript-operator">++</span><span class="uscript-operator">;</span>
                    <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>
                <span class="uscript-operator">}</span>

                <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur<span class="uscript-operator">,</span> <span class="uscript-number">2</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"SC"</span><span class="uscript-operator">)</span>
                <span class="uscript-operator">{</span>
                    <span class="uscript-comment">// Schlesinger's rule</span>
                    <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur <span class="uscript-operator">+</span> <span class="uscript-number">2</span><span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"H"</span><span class="uscript-operator">)</span>
                    <span class="uscript-operator">{</span>
                        <span class="uscript-comment">// dutch origin, e.g. 'school', 'schooner'</span>
                        <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>smid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur <span class="uscript-operator">+</span> <span class="uscript-number">3</span><span class="uscript-operator">,</span> <span class="uscript-number">2</span><span class="uscript-operator">,</span> tmp<span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"OO"</span>
                            <span class="uscript-operator">||</span> tmp <span class="uscript-operator">==</span> <span class="uscript-string">"ER"</span>
                            <span class="uscript-operator">||</span> tmp <span class="uscript-operator">==</span> <span class="uscript-string">"EN"</span>
                            <span class="uscript-operator">||</span> tmp <span class="uscript-operator">==</span> <span class="uscript-string">"UY"</span>
                            <span class="uscript-operator">||</span> tmp <span class="uscript-operator">==</span> <span class="uscript-string">"ED"</span>
                            <span class="uscript-operator">||</span> tmp <span class="uscript-operator">==</span> <span class="uscript-string">"EM"</span><span class="uscript-operator">)</span>
                        <span class="uscript-operator">{</span>
                            <span class="uscript-comment">// 'schermerhorn', 'schenker'</span>
                            <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>smid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur <span class="uscript-operator">+</span> <span class="uscript-number">3</span><span class="uscript-operator">,</span> <span class="uscript-number">2</span><span class="uscript-operator">,</span> tmp<span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"ER"</span>
                                <span class="uscript-operator">||</span> tmp <span class="uscript-operator">==</span> <span class="uscript-string">"EN"</span><span class="uscript-operator">)</span>
                            <span class="uscript-operator">{</span>
                                prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"X"</span><span class="uscript-operator">;</span>
                                sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"SK"</span><span class="uscript-operator">;</span>
                            <span class="uscript-operator">}</span> <span class="uscript-keyword">else</span> <span class="uscript-operator">{</span>
                                prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"SK"</span><span class="uscript-operator">;</span>
                                sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"SK"</span><span class="uscript-operator">;</span>
                            <span class="uscript-operator">}</span>
                            cur <span class="uscript-operator">+=</span> <span class="uscript-number">3</span><span class="uscript-operator">;</span>
                            <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>
                        <span class="uscript-operator">}</span> <span class="uscript-keyword">else</span> <span class="uscript-operator">{</span>
                            <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">(</span>cur <span class="uscript-operator">==</span> <span class="uscript-number">0</span><span class="uscript-operator">)</span>
                                <span class="uscript-operator">&amp;&amp;</span> <span class="uscript-operator">!</span>is_vowel<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> <span class="uscript-number">3</span><span class="uscript-operator">)</span>
                                <span class="uscript-operator">&amp;&amp;</span> <span class="uscript-operator">(</span>mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur <span class="uscript-operator">+</span> <span class="uscript-number">3</span><span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span> <span class="uscript-operator">!=</span> <span class="uscript-string">"W"</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
                            <span class="uscript-operator">{</span>
                                prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"X"</span><span class="uscript-operator">;</span>
                                sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"S"</span><span class="uscript-operator">;</span>
                            <span class="uscript-operator">}</span> <span class="uscript-keyword">else</span> <span class="uscript-operator">{</span>
                                prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"X"</span><span class="uscript-operator">;</span>
                                sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"X"</span><span class="uscript-operator">;</span>
                            <span class="uscript-operator">}</span>
                            cur <span class="uscript-operator">+=</span> <span class="uscript-number">3</span><span class="uscript-operator">;</span>
                            <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>
                        <span class="uscript-operator">}</span>

                        <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>InStr<span class="uscript-operator">(</span><span class="uscript-string">"IEY"</span><span class="uscript-operator">,</span> mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur <span class="uscript-operator">+</span> <span class="uscript-number">2</span><span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">&gt;</span> <span class="uscript-operator">-</span><span class="uscript-number">1</span><span class="uscript-operator">)</span>
                        <span class="uscript-operator">{</span>
                            prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"S"</span><span class="uscript-operator">;</span>
                            sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"S"</span><span class="uscript-operator">;</span>
                            cur <span class="uscript-operator">+=</span> <span class="uscript-number">3</span><span class="uscript-operator">;</span>
                            <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>
                        <span class="uscript-operator">}</span>
                    <span class="uscript-operator">}</span>

                    <span class="uscript-comment">// else</span>
                    prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"SK"</span><span class="uscript-operator">;</span>
                    sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"SK"</span><span class="uscript-operator">;</span>
                    cur <span class="uscript-operator">+=</span> <span class="uscript-number">3</span><span class="uscript-operator">;</span>
                    <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>
                <span class="uscript-operator">}</span>

                <span class="uscript-comment">// french e.g. 'resnais', 'artois'</span>
                <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">(</span>cur <span class="uscript-operator">==</span> last<span class="uscript-operator">)</span>
                    <span class="uscript-operator">&amp;&amp;</span> <span class="uscript-operator">(</span>
                        smid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur<span class="uscript-number">-2</span><span class="uscript-operator">,</span> <span class="uscript-number">2</span><span class="uscript-operator">,</span> tmp<span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"AI"</span>
                        <span class="uscript-operator">||</span> tmp <span class="uscript-operator">==</span> <span class="uscript-string">"OI"</span>
                    <span class="uscript-operator">)</span><span class="uscript-operator">)</span>
                <span class="uscript-operator">{</span>
                    prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">""</span><span class="uscript-operator">;</span>
                    sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"S"</span><span class="uscript-operator">;</span>
                <span class="uscript-operator">}</span> <span class="uscript-keyword">else</span> <span class="uscript-operator">{</span>
                    prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"S"</span><span class="uscript-operator">;</span>
                    sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"S"</span><span class="uscript-operator">;</span>
                <span class="uscript-operator">}</span>

                <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>InStr<span class="uscript-operator">(</span><span class="uscript-string">"SZ"</span><span class="uscript-operator">,</span> mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur <span class="uscript-operator">+</span> <span class="uscript-number">1</span><span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">&gt;</span> <span class="uscript-operator">-</span><span class="uscript-number">1</span><span class="uscript-operator">)</span>
                    cur <span class="uscript-operator">+=</span> <span class="uscript-number">2</span><span class="uscript-operator">;</span>
                <span class="uscript-keyword">else</span>
                    cur<span class="uscript-operator">++</span><span class="uscript-operator">;</span>
                <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>

            <span class="uscript-keyword">case</span> <span class="uscript-string">"T"</span>:
                <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur<span class="uscript-operator">,</span> <span class="uscript-number">4</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"TION"</span><span class="uscript-operator">)</span>
                <span class="uscript-operator">{</span>
                    prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"X"</span><span class="uscript-operator">;</span>
                    sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"X"</span><span class="uscript-operator">;</span>
                    cur <span class="uscript-operator">+=</span> <span class="uscript-number">3</span><span class="uscript-operator">;</span>
                    <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>
                <span class="uscript-operator">}</span>

                <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>smid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur<span class="uscript-operator">,</span> <span class="uscript-number">3</span><span class="uscript-operator">,</span> tmp<span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"TIA"</span>
                    <span class="uscript-operator">||</span> tmp <span class="uscript-operator">==</span> <span class="uscript-string">"TCH"</span><span class="uscript-operator">)</span>
                <span class="uscript-operator">{</span>
                    prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"X"</span><span class="uscript-operator">;</span>
                    sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"X"</span><span class="uscript-operator">;</span>
                    cur <span class="uscript-operator">+=</span> <span class="uscript-number">3</span><span class="uscript-operator">;</span>
                    <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>
                <span class="uscript-operator">}</span>

                <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">(</span>mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur<span class="uscript-operator">,</span> <span class="uscript-number">2</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"TH"</span><span class="uscript-operator">)</span>
                    <span class="uscript-operator">||</span> <span class="uscript-operator">(</span>mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur<span class="uscript-operator">,</span> <span class="uscript-number">3</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"TTH"</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
                <span class="uscript-operator">{</span>
                    <span class="uscript-comment">// special case 'thomas', 'thames' or germanic</span>
                    <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>smid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur <span class="uscript-operator">+</span> <span class="uscript-number">2</span><span class="uscript-operator">,</span> <span class="uscript-number">2</span><span class="uscript-operator">,</span> tmp<span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"OM"</span>
                        <span class="uscript-operator">||</span> tmp <span class="uscript-operator">==</span> <span class="uscript-string">"AM"</span>
                        <span class="uscript-operator">||</span> smid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> <span class="uscript-number">0</span><span class="uscript-operator">,</span> <span class="uscript-number">4</span><span class="uscript-operator">,</span> tmp<span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"VAN"</span>
                        <span class="uscript-operator">||</span> tmp <span class="uscript-operator">==</span> <span class="uscript-string">"VON"</span>
                        <span class="uscript-operator">||</span> mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> <span class="uscript-number">0</span><span class="uscript-operator">,</span> <span class="uscript-number">3</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"SCH"</span><span class="uscript-operator">)</span>
                    <span class="uscript-operator">{</span>
                        prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"T"</span><span class="uscript-operator">;</span>
                        sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"T"</span><span class="uscript-operator">;</span>
                    <span class="uscript-operator">}</span> <span class="uscript-keyword">else</span> <span class="uscript-operator">{</span>
                        prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"O"</span><span class="uscript-operator">;</span>
                        sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"T"</span><span class="uscript-operator">;</span>
                    <span class="uscript-operator">}</span>
                    cur <span class="uscript-operator">+=</span> <span class="uscript-number">2</span><span class="uscript-operator">;</span>
                    <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>
                <span class="uscript-operator">}</span>

                <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>InStr<span class="uscript-operator">(</span><span class="uscript-string">"TD"</span><span class="uscript-operator">,</span> mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur <span class="uscript-operator">+</span> <span class="uscript-number">1</span><span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">&gt;</span> <span class="uscript-operator">-</span><span class="uscript-number">1</span><span class="uscript-operator">)</span>
                    cur <span class="uscript-operator">+=</span> <span class="uscript-number">2</span><span class="uscript-operator">;</span>
                <span class="uscript-keyword">else</span>
                    cur<span class="uscript-operator">++</span><span class="uscript-operator">;</span>
                prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"T"</span><span class="uscript-operator">;</span>
                sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"T"</span><span class="uscript-operator">;</span>
                <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>

            <span class="uscript-keyword">case</span> <span class="uscript-string">"V"</span>:
                <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur <span class="uscript-operator">+</span> <span class="uscript-number">1</span><span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"V"</span><span class="uscript-operator">)</span>
                    cur <span class="uscript-operator">+=</span> <span class="uscript-number">2</span><span class="uscript-operator">;</span>
                <span class="uscript-keyword">else</span>
                    cur<span class="uscript-operator">++</span><span class="uscript-operator">;</span>
                prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"F"</span><span class="uscript-operator">;</span>
                sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"F"</span><span class="uscript-operator">;</span>
                <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>

            <span class="uscript-keyword">case</span> <span class="uscript-string">"W"</span>:
                <span class="uscript-comment">// can also be in middle of word</span>
                <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur<span class="uscript-operator">,</span> <span class="uscript-number">2</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"WR"</span><span class="uscript-operator">)</span> <span class="uscript-operator">{</span>
                    prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"R"</span><span class="uscript-operator">;</span>
                    sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"R"</span><span class="uscript-operator">;</span>
                    cur <span class="uscript-operator">+=</span> <span class="uscript-number">2</span><span class="uscript-operator">;</span>
                    <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>
                <span class="uscript-operator">}</span>

                <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">(</span>cur <span class="uscript-operator">==</span> <span class="uscript-number">0</span><span class="uscript-operator">)</span>
                    <span class="uscript-operator">&amp;&amp;</span> <span class="uscript-operator">(</span>is_vowel<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur <span class="uscript-operator">+</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span>
                        <span class="uscript-operator">||</span> mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur<span class="uscript-operator">,</span> <span class="uscript-number">2</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"WH"</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
                <span class="uscript-operator">{</span>
                    <span class="uscript-comment">// Wasserman should match Vasserman</span>
                    <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>is_vowel<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur <span class="uscript-operator">+</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
                    <span class="uscript-operator">{</span>
                        prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"A"</span><span class="uscript-operator">;</span>
                        sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"F"</span><span class="uscript-operator">;</span>
                    <span class="uscript-operator">}</span>
                    <span class="uscript-keyword">else</span> <span class="uscript-operator">{</span>
                        <span class="uscript-comment">// need Uomo to match Womo</span>
                        prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"A"</span><span class="uscript-operator">;</span>
                        sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"A"</span><span class="uscript-operator">;</span>
                    <span class="uscript-operator">}</span>
                <span class="uscript-operator">}</span>

                <span class="uscript-comment">// Arnow should match Arnoff</span>
                <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">(</span><span class="uscript-operator">(</span>cur <span class="uscript-operator">==</span> last<span class="uscript-operator">)</span>
                        <span class="uscript-operator">&amp;&amp;</span> is_vowel<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur <span class="uscript-operator">-</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
                    <span class="uscript-operator">||</span> smid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur <span class="uscript-operator">-</span> <span class="uscript-number">1</span><span class="uscript-operator">,</span> <span class="uscript-number">5</span><span class="uscript-operator">,</span> tmp<span class="uscript-operator">)</span> <span class="uscript-operator">==</span><span class="uscript-string">"EWSKI"</span>
                    <span class="uscript-operator">||</span> tmp <span class="uscript-operator">==</span> <span class="uscript-string">"EWSKY"</span>
                    <span class="uscript-operator">||</span> tmp <span class="uscript-operator">==</span> <span class="uscript-string">"OWSKI"</span>
                    <span class="uscript-operator">||</span> tmp <span class="uscript-operator">==</span> <span class="uscript-string">"OWSKY"</span>
                    <span class="uscript-operator">||</span> mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> <span class="uscript-number">0</span><span class="uscript-operator">,</span> <span class="uscript-number">3</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"SCH"</span><span class="uscript-operator">)</span>
                <span class="uscript-operator">{</span>
                    prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">""</span><span class="uscript-operator">;</span>
                    sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"F"</span><span class="uscript-operator">;</span>
                    cur<span class="uscript-operator">++</span><span class="uscript-operator">;</span>
                    <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>
                <span class="uscript-operator">}</span>

                <span class="uscript-comment">// polish e.g. 'filipowicz'</span>
                <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>smid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur<span class="uscript-operator">,</span> <span class="uscript-number">4</span><span class="uscript-operator">,</span> tmp<span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"WICZ"</span>
                    <span class="uscript-operator">||</span> tmp <span class="uscript-operator">==</span> <span class="uscript-string">"WITZ"</span><span class="uscript-operator">)</span>
                <span class="uscript-operator">{</span>
                    prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"TS"</span><span class="uscript-operator">;</span>
                    sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"FX"</span><span class="uscript-operator">;</span>
                    cur <span class="uscript-operator">+=</span> <span class="uscript-number">4</span><span class="uscript-operator">;</span>
                    <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>
                <span class="uscript-operator">}</span>

                <span class="uscript-comment">// else skip it</span>
                cur<span class="uscript-operator">++</span><span class="uscript-operator">;</span>
                <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>

            <span class="uscript-keyword">case</span> <span class="uscript-string">"X"</span>:
                <span class="uscript-comment">// french e.g. breaux</span>
                <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">!</span><span class="uscript-operator">(</span><span class="uscript-operator">(</span>cur <span class="uscript-operator">==</span> last<span class="uscript-operator">)</span>
                    <span class="uscript-operator">&amp;&amp;</span> <span class="uscript-operator">(</span>smid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur <span class="uscript-operator">-</span> <span class="uscript-number">3</span><span class="uscript-operator">,</span> <span class="uscript-number">3</span><span class="uscript-operator">,</span> tmp<span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"IAU"</span>
                        <span class="uscript-operator">||</span> tmp <span class="uscript-operator">==</span> <span class="uscript-string">"EAU"</span>
                        <span class="uscript-operator">||</span> smid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur <span class="uscript-operator">-</span> <span class="uscript-number">2</span><span class="uscript-operator">,</span> <span class="uscript-number">2</span><span class="uscript-operator">,</span> tmp<span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"AU"</span>
                        <span class="uscript-operator">||</span> tmp <span class="uscript-operator">==</span> <span class="uscript-string">"OU"</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
                <span class="uscript-operator">{</span>
                    prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"KS"</span><span class="uscript-operator">;</span>
                    sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"KS"</span><span class="uscript-operator">;</span>
                <span class="uscript-operator">}</span>

                <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>InStr<span class="uscript-operator">(</span><span class="uscript-string">"CX"</span><span class="uscript-operator">,</span> mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur <span class="uscript-operator">+</span> <span class="uscript-number">1</span><span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">&gt;</span> <span class="uscript-operator">-</span><span class="uscript-number">1</span><span class="uscript-operator">)</span>
                    cur <span class="uscript-operator">+=</span> <span class="uscript-number">2</span><span class="uscript-operator">;</span>
                <span class="uscript-keyword">else</span>
                    cur<span class="uscript-operator">++</span><span class="uscript-operator">;</span>
                <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>


            <span class="uscript-keyword">case</span> <span class="uscript-string">"Z"</span>:
                <span class="uscript-comment">// chinese pinyin e.g. 'zhao'</span>
                <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur <span class="uscript-operator">+</span> <span class="uscript-number">1</span><span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"H"</span><span class="uscript-operator">)</span>
                <span class="uscript-operator">{</span>
                    prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"J"</span><span class="uscript-operator">;</span>
                    sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"J"</span><span class="uscript-operator">;</span>
                    cur <span class="uscript-operator">+=</span> <span class="uscript-number">2</span><span class="uscript-operator">;</span>
                    <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>
                <span class="uscript-operator">}</span>
                <span class="uscript-keyword">else</span>
                    <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>smid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur <span class="uscript-operator">+</span> <span class="uscript-number">1</span><span class="uscript-operator">,</span> <span class="uscript-number">2</span><span class="uscript-operator">,</span> tmp<span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"ZO"</span>
                        <span class="uscript-operator">||</span> tmp <span class="uscript-operator">==</span> <span class="uscript-string">"ZI"</span>
                        <span class="uscript-operator">||</span> tmp <span class="uscript-operator">==</span> <span class="uscript-string">"ZA"</span>
                        <span class="uscript-operator">||</span> <span class="uscript-operator">(</span>Slavo_Germanic<span class="uscript-operator">(</span>in<span class="uscript-operator">)</span>
                        <span class="uscript-operator">&amp;&amp;</span> <span class="uscript-operator">(</span><span class="uscript-operator">(</span>cur <span class="uscript-operator">&gt;</span> <span class="uscript-number">0</span><span class="uscript-operator">)</span> <span class="uscript-operator">&amp;&amp;</span> mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur <span class="uscript-operator">-</span> <span class="uscript-number">1</span><span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span> <span class="uscript-operator">!=</span> <span class="uscript-string">"T"</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
                    <span class="uscript-operator">{</span>
                    prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"S"</span><span class="uscript-operator">;</span>
                    sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"TS"</span><span class="uscript-operator">;</span>
                <span class="uscript-operator">}</span> <span class="uscript-keyword">else</span> <span class="uscript-operator">{</span>
                    prim <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"S"</span><span class="uscript-operator">;</span>
                    sec  <span class="uscript-operator">$</span><span class="uscript-operator">=</span> <span class="uscript-string">"S"</span><span class="uscript-operator">;</span>
                <span class="uscript-operator">}</span>

                <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> cur <span class="uscript-operator">+</span> <span class="uscript-number">1</span><span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-string">"Z"</span><span class="uscript-operator">)</span>
                    cur <span class="uscript-operator">+=</span> <span class="uscript-number">2</span><span class="uscript-operator">;</span>
                <span class="uscript-keyword">else</span>
                    cur<span class="uscript-operator">++</span><span class="uscript-operator">;</span>
                <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>

            <span class="uscript-keyword">default</span>:
                cur<span class="uscript-operator">++</span><span class="uscript-operator">;</span>
        <span class="uscript-operator">}</span>
    <span class="uscript-operator">}</span>

    res<span class="uscript-operator">[</span><span class="uscript-number">0</span><span class="uscript-operator">]</span> <span class="uscript-operator">=</span> Left<span class="uscript-operator">(</span>prim<span class="uscript-operator">,</span> mlen<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    res<span class="uscript-operator">[</span><span class="uscript-number">1</span><span class="uscript-operator">]</span> <span class="uscript-operator">=</span> Left<span class="uscript-operator">(</span>sec<span class="uscript-operator">,</span> mlen<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    <span class="uscript-keyword">return</span> res<span class="uscript-operator">;</span>
<span class="uscript-operator">}</span></pre><h2><a name="0.2"></a>Helper functions</h2>
<pre class="uscript"><span class="uscript-comment">/**
    Same as mid, except that is has a 4th param that will also get the result. &lt;br /&gt;
    Use this for caching the result.
*/</span>
<span class="uscript-keyword">static</span> <span class="uscript-keyword">final</span> <span class="uscript-keyword">function</span> <span class="uscript-type">string</span> smid<span class="uscript-operator">(</span><span class="uscript-keyword">coerce</span> <span class="uscript-type">string</span> in<span class="uscript-operator">,</span> <span class="uscript-type">int</span> off<span class="uscript-operator">,</span> <span class="uscript-type">int</span> len<span class="uscript-operator">,</span> <span class="uscript-keyword">out</span> <span class="uscript-type">string</span> s<span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
    s <span class="uscript-operator">=</span> mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> off<span class="uscript-operator">,</span> len<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    <span class="uscript-keyword">return</span> s<span class="uscript-operator">;</span>
<span class="uscript-operator">}</span>

<span class="uscript-comment">/**
    returns true if the character at pos is a vowel.
*/</span>
<span class="uscript-keyword">static</span> <span class="uscript-keyword">final</span> <span class="uscript-keyword">function</span> <span class="uscript-type">bool</span> is_vowel<span class="uscript-operator">(</span><span class="uscript-keyword">coerce</span> <span class="uscript-type">string</span> in<span class="uscript-operator">,</span> <span class="uscript-type">int</span> pos<span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
    <span class="uscript-keyword">return</span> <span class="uscript-operator">(</span>InStr<span class="uscript-operator">(</span><span class="uscript-string">"AEIOUY"</span><span class="uscript-operator">,</span> mid<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> pos<span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">&gt;</span> <span class="uscript-operator">-</span><span class="uscript-number">1</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-operator">}</span>

<span class="uscript-comment">/**
    helper function for the metaphone algorithm to determain if this word is
    "slave germanic"
*/</span>
<span class="uscript-keyword">static</span> <span class="uscript-keyword">final</span> <span class="uscript-keyword">function</span> <span class="uscript-type">bool</span> Slavo_Germanic<span class="uscript-operator">(</span><span class="uscript-keyword">coerce</span> <span class="uscript-type">string</span> in<span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
    <span class="uscript-keyword">return</span> <span class="uscript-operator">(</span>InStr<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> <span class="uscript-string">"W"</span><span class="uscript-operator">)</span> <span class="uscript-operator">&gt;</span> <span class="uscript-operator">-</span><span class="uscript-number">1</span><span class="uscript-operator">)</span>
        <span class="uscript-operator">||</span> <span class="uscript-operator">(</span>InStr<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> <span class="uscript-string">"K"</span><span class="uscript-operator">)</span> <span class="uscript-operator">&gt;</span> <span class="uscript-operator">-</span><span class="uscript-number">1</span><span class="uscript-operator">)</span>
        <span class="uscript-operator">||</span> <span class="uscript-operator">(</span>InStr<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> <span class="uscript-string">"CZ"</span><span class="uscript-operator">)</span> <span class="uscript-operator">&gt;</span> <span class="uscript-operator">-</span><span class="uscript-number">1</span><span class="uscript-operator">)</span>
        <span class="uscript-operator">||</span> <span class="uscript-operator">(</span>InStr<span class="uscript-operator">(</span>in<span class="uscript-operator">,</span> <span class="uscript-string">"WITZ"</span><span class="uscript-operator">)</span> <span class="uscript-operator">&gt;</span> <span class="uscript-operator">-</span><span class="uscript-number">1</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-operator">}</span></pre><h2><a name="0.3"></a>Copyright</h2>
<pre class="paraverbatim">    Copyright 2004, Michiel Hendriks &lt;<a href="mailto:elmuerte@drunksnipers.com">elmuerte@drunksnipers.com</a>&gt;
    All rights reserved.
 
    This UnrealScript translation is based heavily on the PHP 
    implementation by Stephen Woodbridge &lt;<a href="mailto:woodbri@swoodbridge.com">woodbri@swoodbridge.com</a>&gt;, 
    which in turn is based on the C implementation
    by Maurice Aubrey &lt;<a href="mailto:maurice@hevanet.com">maurice@hevanet.com</a>&gt;, which in turn
    is based heavily on the C++ implementation by
    Lawrence Philips and incorporates several bug fixes courtesy
    of Kevin Atkinson &lt;<a href="mailto:kevina@users.sourceforge.net">kevina@users.sourceforge.net</a>&gt;.
 
    This module is free software; you may redistribute it and/or
    modify it under the same terms as Perl itself.</pre><p>The <a href="http://www.perl.com/pub/a/language/misc/Artistic.html">[Perl Artistic License]</a>.</p>
<p>Note that that page currently appears to be blank, the Perl Artistic License is almost similar to the <a href="http://www.opensource.org/licenses/artistic-license.php">[Artistic License]</a></p>
<p><em class="em2">Wormbo:</em> Erm... Perl?</p>
<p><em class="em2">El Muerte:</em> Yeah go figure, just pasting a long the license notice. The implementation of Maurice Aubrey has been released under that license, and so is the PHP implementation, thus this implementation should also be released under the same license. The license isn't very restrictive, it allows you to do even more than the <a href="lesseropenunrealmodlicense.html">LesserOpenUnrealModLicense</a> would do.</p>
<h2><a name="0.4"></a>Related Topics</h2>
<ul><li><a href="soundex.html">SoundEx</a></li>
<li><a href="http://aspell.sourceforge.net/metaphone/">[More about metaphone]</a> &ndash; and implementations in other languages</li>
</ul>
<hr class="thin"><p><a href="category-algorithm.html">Category Algorithm</a></p>
<script type="text/javascript"><!--
 menuItemAdd("The algorithm", "#0.1");
menuItemAdd("Helper functions", "#0.2");
menuItemAdd("Copyright", "#0.3");
menuItemAdd("Related Topics", "#0.4");
 menuWrite() //--></script></div>
</div>

<div id="footer" class="bar">
	<p><form method="post" action="http://wiki.beyondunreal.com/wiki" enctype="application/x-www-form-urlencoded">
<a href="(start).html">Home Page</a> | <a href="recent-changes.html">Recent Changes</a> | <a href="http://wiki.beyondunreal.com/wiki?action=editprefs">Preferences</a><br>
<a href="http://wiki.beyondunreal.com/wiki?action=edit&id=DoubleMetaPhone">Edit text of this page</a> | <a href="http://wiki.beyondunreal.com/wiki?action=history&id=DoubleMetaPhone">View other revisions</a><br>Last edited August 19, 2004 9:15 <a href="http://wiki.beyondunreal.com/wiki?action=browse&diff=1&id=DoubleMetaPhone">(diff)</a><br>Search: <input type="text" name="search"  size="20" /><input type="hidden" name="dosearch" value="1"  /><br><br><small><a href="http://wiki.beyondunreal.com/wiki/DoubleMetaPhone">Original page</a> &#150; copy created Sat, Jun 23, 2007</small><div></div>
</form>
	</p>
	<p>I don't need to test my programs. I have an error-correcting modem.
</p>
</div>
</div><!-- close of "scrolling" div -->

<div id="quickbar">
	<div id="logo"><a href="http://wiki.beyondunreal.com/"><img src="shared/wikilogo.jpg" width="143" height="100" border="0"></a>
		</div>
	<div class="qbsitename">
		<p>The Unreal Engine Documentation Site</p>
	</div>
	<div class="qbsection">
<p><a href="metatopics.html">Wiki Community</a></p>
<p><a href="category-category.html">Topic Categories</a></p>
<p><a href="/cgi-bin/imageupload.cgi/wiki-ext/imageupload.htt" target="_blank ">Image Uploads</a></p>
<p><a href="http://wiki.beyondunreal.com/wiki?action=random">Random Page</a></p>
<p><a href="recent-changes.html">Recent Changes</a></p>
<p><a href="offline-wiki.html">Offline Wiki</a></p>
</div><div class="qbsection">
<p><a href="unreal-engine.html">Unreal Engine</a></p>
<p><a href="console-commands.html">Console Commands</a></p>
<p><a href="terminology.html">Terminology</a></p>
<p><a href="category-faq.html">FAQs</a></p>
<p><a href="help-desk.html">Help Desk</a></p>
</div><div class="qbsection">
<p><a href="topics-on-mapping.html">Mapping Topics</a></p>
<p><a href="mapping-lessons.html">Mapping Lessons</a></p>
<p><a href="unrealed-3.html">UnrealEd Interface</a></p>
</div><div class="qbsection">
<p><a href="unrealscript.html">UnrealScript Topics</a></p>
<p><a href="unrealscript-lessons.html">UnrealScript Lessons</a></p>
<p><a href="making-mods.html">Making Mods</a></p>
<p><a href="class-tree.html">Class Tree</a></p>
</div><div class="qbsection">
<p><a href="topics-on-modeling.html">Modeling Topics</a></p>
</div><div class="qbsection">
<p><a href="chongqing-page.html">Chongqing Page</a></p>
<p><a href="log-in.html">Log In</a></p></div>
</div>

</body></html>
