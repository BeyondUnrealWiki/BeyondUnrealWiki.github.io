<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"  "http://www.w3.org/TR/html4/loose.dtd">

<html>
<head lang="en">
	<title>UnrealWiki: Embedding Code</title>
	<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
	<link rel="stylesheet" type="text/css" media="screen, print"
		href="shared/stylebase.structural.css">	
	<link rel="stylesheet" type="text/css" media="screen"
		href="shared/template-default.css">
	<link rel="stylesheet" type="text/css" media="screen"
		href="shared/styles.chblue.css">
	<link rel="stylesheet" type="text/css" media="print"
		href="shared/template-default-print.css">
	<!--[if IE 6]>
			<style>
			/* dirty hack for IE6. */
			#quickbar {
				position: absolute;
				}
			</style>
	<![endif]-->
  <link rel="start" href="http://wiki.beyondunreal.com/">
  <link rel="glossary"  href="http://wiki.beyondunreal.com/wiki/Terminology">
  <link rel="help"  href="http://wiki.beyondunreal.com/wiki/Using_The_Wiki">
<script type="text/javascript" src="shared/dhtml.js"></script>
<script type="text/javascript" src="shared/dhtml-menu.js"></script>
<style type="text/css">#dhtml-menu    { background: #eee; padding: 5px 0px; margin-right: -20px; border: 1px solid #888; border-left: 1px solid #ccc; border-top: 1px solid #ccc;  border-right: 1px solid #888; border-bottom: 1px solid #888 }
#dhtml-menu td { color: #000; font-family: Arial,Helvetica,sans-serif; font-size: 9pt; line-height: 13pt; padding: 1px 10px; cursor: default }
#dhtml-menu a  { color: #000; font-family: Arial,Helvetica,sans-serif; font-size: 9pt; line-height: 13pt; text-decoration: none }
#dhtml-menu tt { font-family: monospace; font-size: 9pt }
#dhtml-menu-separator { height: 1px; background: red }
#dhtml-menu-anchor { cursor: default }
</style>
<script type="text/javascript" src="shared/expandable.js"></script>
</head>
<body onLoad="menuInit(); document.cookie='page=Embedding_Code; path=/'" class="default">
<div id="scrolling"><!-- contains all except the fixed sidebar -->
<div id="topbar"  class="bar">
	<div class="righthalf">
		<form class="inline" method="post" action="/wiki" enctype="application/x-www-form-urlencoded"><input type="text" name="search"  size="20" /> <input type="submit" name="search" value="search" /></form>
	</div>
	<div class="lefthalf">
		<script type="text/javascript"><!--
			menuAlignRight = false;
		//--></script>
		<span><script type="text/javascript"><!--
 menuWriteAnchor("Quick Navigation") //--></script></span> | <a href="(start).html">Home Page</a> | <a href="recent-changes.html">Recent Changes</a> | <a href="http://wiki.beyondunreal.com/wiki?action=editprefs">Preferences</a>
	</div>
</div>

<div id="content"><!-- contains the title and article -->
	<h1 class='pagetitle'><a href="http://wiki.beyondunreal.com/wiki?back=Embedding Code">Embedding Code</a></h1>
	<div class="wiki"><p>Since <a href="map-file.html">Map File</a>s are simply Unreal packages, they can contain all sorts of different resources in addition to geometry and <a href="texture-ut.html">Texture (UT)</a>s.  That includes UnrealScript code.  Rather than including a bunch of small .u files with your map distribution, embed their code into your <a href="map-file.html">Map File</a>s.  Apart from being neater, that'll make a much more professional appearance than a cluttered .zip file.</p>
<p><em class="em2">Don't embed code without permission.</em>  (That's clear, but unfortunately not to everyone.) Be sure that the code's author is content with having his/her code embedded in maps. Besides, embedding code makes only sense for small code packages, and if being able to do a centralized update of the code package is not an issue.</p>
<h2><a name="0.1"></a>Creating Code in MyLevel</h2>
<p>You can create new classes in UnrealEd and store them directly into MyLevel. You might want to do this if:</p>
<ul><li>you're pasting in a complete script from one of the <a href="third-party-components.html">Third-Party Components</a> or <a href="open-source.html">Open Source</a> pages</li>
<li>you're daring </li>
<li>you're desperate</li>
</ul>
<p>See <a href="create-a-subclass.html">Create A Subclass</a> for instructions.</p>
<p>The usual pitfalls of creating code in UnrealEd apply: Can't delete classes, can't rename classes, can't change a superclass, UnrealEd crashes when you change the property declarations of a class that is used in the map. If you're simply pasting a script (a custom one from this site for example), that's not a problem though.</p>
<h2><a name="0.2"></a>Importing Code into MyLevel</h2>
<h3><a name="0.2.1"></a>...from a .u file</h3>
<p>If you have a pre-existing .u file that you want to import in MyLevel, do it as follows:</p>
<ol><li>Make sure that you're not already using that .u file externally in your map; in other words, make the .u file import the first step of using the actors defined in that .u file.  <i>If</i> you already have added actors from that .u file in your map, cut them into the clipboard, save your map, and close UnrealEd.</li>
<li>Make sure that the .u package you're about to import isn't automatically loaded when UnrealEd starts.  Check the <tt>EditPackages</tt> lines in <a href="unrealtournament-ini.html">UnrealTournament.ini</a> and delete any line pointing to that .u package if necessary (then restart UnrealEd). Also, place the .u file you would like to import into the \UnrealTournament\System directory.</li>
<li><p>Do <a href="unrealed-main-menu.html">UnrealEd Main Menu</a> &rarr; View &rarr; Log to open the [log window]<a href="http://wiki.beyondunreal.com/wiki?action=edit&id=Log_Window&referrerid=Embedding_Code">?</a> or click the button on the <a href="console-bar.html">Console Bar</a>.  At the prompt, enter:</p>
<pre class="paraverbatim"> obj load file=whatever.u package=MyLevel</pre><p>(substitute "whatever" by the name of the package you want to import, of course).  If everything works out, you'll see some log entries along the lines of "New file, existing package."  If you made a typo in the file name, UnrealEd crashes (courtesy of the <a href="unrealed-goblin.html">UnrealEd Goblin</a>).</p>
</li>
<li>If you previously had cut/removed existing actors from that package from your map, paste/re-add them.</li>
<li>Do a <em class="em2">full rebuild,</em> then save.</li>
</ol>
<p><em class="em2">Notes:</em>  After importing a package in this way, the <a href="actor-overview.html">actor browser</a> in UnrealEd 2 will not show any imported actors that are direct descendants of actor (and possibly some others deeper in the tree too) unless you first deselect then reselect the <em class="em1">Show Actor Classes Only</em> checkbox to force a reload of the tree.</p>
<p>To get imported music to show up in the music browser, click the docked/undocked button and your imported music file will show up.</p>
<p>Only actors that are referenced in the map and their parent classes get saved in <a href="mylevel.html">MyLevel</a> with the map so if you have actors that only get spawned in runtime and are in the package you just imported you need to add an example in your map somewhere out of sight so they get stored in MyLevel and can be spawned properly in game. This would apply to projectiles in custom weapon types etc. </p>
<p>Be sure to test your new map on a virgin install of Unreal Tournament that has none of the packages you've imported classes from in it. Otherwise it's dead easy for a reference to something that isn't sucessfully stored in MyLevel to get missed and what you thought would be a triumphant release of your latest project gets off to a bad start when your map crashes the game on load thanks to missing resources...</p>
<h3><a name="0.2.2"></a>...from another map file</h3>
<p>Some authors distribute their scripts already embedded in <a href="map-file.html">Map File</a>s.  To use them (the "with permission" clause above applies, of course), do the following:</p>
<ol><li>Restart UnrealEd.  (Always a good idea before working with <a href="mylevel.html">MyLevel</a>.)</li>
<li>Open the map file that contains the code you want to import.</li>
<li>Without closing UnrealEd, open your own map file you want to import the code into.</li>
</ol>
<p>UnrealEd doesn't remove the code classes from the first map file you opened when you open the second one; if you use any of those classes in your own map, they will automatically be saved along with your map.</p>
<p class="indent1"><em class="em2">Tip:</em>  If you're planning to distribute your <em class="em1">own</em> code via the second method (which is handy because it <em class="em1">forces</em> mappers to embed the code into their maps rather than bundling an .u file), be sure that you <em class="em2">only place code</em> in your distribution map's MyLevel.  UnrealEd is prone to crashing if there are, for instance, <a href="texture.html">Texture</a>s left from a previously loaded map file in MyLevel when the user loads his/her own map after yours.</p>
<h2><a name="0.3"></a>Updating Code in MyLevel</h2>
<p>Sometimes you might have to update the code of components embedded in <a href="mylevel.html">MyLevel</a>.</p>
<ol><li>Open the map the code is embedded in.</li>
<li>In the <a href="actor-overview.html">actor browser</a>, browse to the embedded actor class and double-click it.  A script editor window with the component's source code opens.</li>
<li>Select all of the old source code in the script editor window and delete it.</li>
<li>Copy all of the new source code <em class="em2">up to, but not including</em> the <code>defaultproperties</code> section (if there is one).</li>
<li>Paste the copied source code into the script editor window (click into the empty window and press Ctrl+V).</li>
<li>Select <em class="em1">Tools</em> &rarr; <em class="em1">Compile Changed</em> from the script editor's menu.  After a brief processing delay, the script editor's status bar says something along the lines of "Success: Compiled xx line(s), xx statement(s)."  (You might have to move the script editor window up a bit in order to see its status bar.)</li>
<li>Save your map.</li>
</ol>
<h2><a name="0.4"></a>Related Topics </h2>
<ul><li><a href="writing-and-using-an-embedd.html">Writing And Using An Embedded Mutator</a></li>
</ul>
<h2><a name="0.5"></a>Discussion</h2>
<p><em class="em2">SabbathCat:</em> Models can be imported too!!  I've not tried with anything more complex than simple decorations, but you can definitely do it. <img alt=":)" src="emoticons/smile.gif" align="middle"> So cool, no worries about "version mismatch". I had a bunch of flagbase meshes I was always including with my maps, but keeping track of which version was out with which map can be difficult. What a great solution to package everything into the map. <img alt=":)" src="emoticons/smile.gif" align="middle"></p>
<p><em class="em2">Foxpaw:</em> Yes, you should be able to package anything into a map including code, textures, sounds, models, static meshes, and prefabs. Like it says above a map is just a package like any other. In theory you could probrably even package multiple maps into a package, but you might need a third party application to do that and I'm not sure how you would go about loading the different maps.</p>
<p><em class="em2">Wormbo:</em> Loading a map into a map? Should be possible through <code>OBJ LOAD File=..\Maps\TheMap.ut2 Package=myLevel</code>, but I doubt this works without crashing or rendering the existing map useless.</p>
<p><em class="em2">Mychaeel:</em> The map loading code probably either assumes that all objects in a map file belong to the same map, or it always just loads all those objects connected to the first LevelInfo object it finds in the map file.  While it should be possible to <em class="em1">store</em> two maps in the same Unreal package without problems, I strongly suppose it's not actually possible to <em class="em1">use</em> those packages without some native code changes.</p>
<p><em class="em2">SabbathCat:</em> There's a pitfall.. I recently embedded a bunch of mesh files and one music file, all well and good, the map plays and runs without a glitch, but now  when I open it in the editor, I just get a blank screen. <img alt=":(" src="emoticons/sad.gif" align="middle"></p>
<p>It may perhaps be the music thing, The imported music didn't show up until I loaded another music package, I could then the MyLevel.musicname track to apply in the level properties.</p>
<p>Is it best to do all your importing once the map is near complete?</p>
<p>ah well, on the up side of course you could consider this an excellent way to safeguard maps from being re-built or plundered without permission. <img alt=":)" src="emoticons/smile.gif" align="middle"></p>
<p>Maybe I should try impoting the map into a new map?</p>
<p><em class="em2">inio:</em> blank viewports or one big white screen?  if it's the later, do viewports&rarr;configure&rarr;ok</p>
<p><em class="em2">Wormbo:</em> Music package? You're talking about UT, right? Blank screen problem in UEd is described on <a href="unrealed-viewport.html">UnrealEd viewport</a>.</p>
<p><em class="em2">SabbathCat:</em> Er, no. <img alt=":)" src="emoticons/smile.gif" align="middle"> A blank screen as in a totally empty map. I stuck back all the .u files I'd removed from the system directory and the .umx in the music directory post-import, and it opened again.</p>
<p><em class="em2">Ch3z:</em> This is very helpful. Answered my question. A related topics section could help too. I now wonder how to call the mutator I embedded into action. A link in the related topics secton to a page that explained that would be perfect.</p>
<p><em class="em2">Foxpaw:</em> I'm not sure if there's a wiki page on it or not, but if you want to embed a mutator you will probrably need to also make a custom actor to load the mutator. You can then embed the actor and place one on your map. That actor can load the mutator in it's postbeginplay function and then destroy itself once the mutator is loaded.</p>
<p><em class="em2">Ch3z:</em> Thx Fox. And I knew I had seen more on this somewhere. Finally came across it again and addeed "Related" section.</p>
<p><em class="em2">Jimbo:</em> I've imported a vertex mesh into mylevel in UT2003 using the aforementioned procedure and it works quite fine. Strangely however, the mesh is not visible over netplay to the client who connects to me. I still see the mesh but he doesn't. If he disconnects from me and runs his own server or just plays an instant action match, the mesh is visible. Anyone have any ideas what might be causing this problem?</p>
<p><em class="em2">Kamek:</em> Can OGG files be embedded into maps?</p>
<p><em class="em2">Wormbo:</em> No. They are no package files themselves and UT200x doesn't provide any option to import generic binary files into packages.</p>
<hr class="thin"><p><a href="category-mapping.html">Category Mapping</a><br><a href="category-tutorial.html">Category Tutorial</a></p>
<script type="text/javascript"><!--
 menuItemAdd("Creating Code in MyLevel", "#0.1");
menuItemAdd("Importing Code into MyLevel", "#0.2");
menuItemAdd("<tt>&nbsp;&nbsp;</tt>...from a .u file", "#0.2.1");
menuItemAdd("<tt>&nbsp;&nbsp;</tt>...from another map file", "#0.2.2");
menuItemAdd("Updating Code in MyLevel", "#0.3");
menuItemAdd("Related Topics ", "#0.4");
menuItemAdd("Discussion", "#0.5");
 menuWrite() //--></script></div>
</div>

<div id="footer" class="bar">
	<p><form method="post" action="http://wiki.beyondunreal.com/wiki" enctype="application/x-www-form-urlencoded">
<a href="(start).html">Home Page</a> | <a href="recent-changes.html">Recent Changes</a> | <a href="http://wiki.beyondunreal.com/wiki?action=editprefs">Preferences</a><br>
<a href="http://wiki.beyondunreal.com/wiki?action=edit&id=Embedding_Code">Edit text of this page</a> | <a href="http://wiki.beyondunreal.com/wiki?action=history&id=Embedding_Code">View other revisions</a><br>Last edited November 27, 2006 23:49 <a href="http://wiki.beyondunreal.com/wiki?action=browse&diff=1&id=Embedding_Code">(diff)</a><br>Search: <input type="text" name="search"  size="20" /><input type="hidden" name="dosearch" value="1"  /><br><br><small><a href="http://wiki.beyondunreal.com/wiki/Embedding_Code">Original page</a> &#150; copy created Sat, Jun 23, 2007</small><div></div>
</form>
	</p>
	<p>I don't need to test my programs. I have an error-correcting modem.
</p>
</div>
</div><!-- close of "scrolling" div -->

<div id="quickbar">
	<div id="logo"><a href="http://wiki.beyondunreal.com/"><img src="shared/wikilogo.jpg" width="143" height="100" border="0"></a>
		</div>
	<div class="qbsitename">
		<p>The Unreal Engine Documentation Site</p>
	</div>
	<div class="qbsection">
<p><a href="metatopics.html">Wiki Community</a></p>
<p><a href="category-category.html">Topic Categories</a></p>
<p><a href="/cgi-bin/imageupload.cgi/wiki-ext/imageupload.htt" target="_blank ">Image Uploads</a></p>
<p><a href="http://wiki.beyondunreal.com/wiki?action=random">Random Page</a></p>
<p><a href="recent-changes.html">Recent Changes</a></p>
<p><a href="offline-wiki.html">Offline Wiki</a></p>
</div><div class="qbsection">
<p><a href="unreal-engine.html">Unreal Engine</a></p>
<p><a href="console-commands.html">Console Commands</a></p>
<p><a href="terminology.html">Terminology</a></p>
<p><a href="category-faq.html">FAQs</a></p>
<p><a href="help-desk.html">Help Desk</a></p>
</div><div class="qbsection">
<p><a href="topics-on-mapping.html">Mapping Topics</a></p>
<p><a href="mapping-lessons.html">Mapping Lessons</a></p>
<p><a href="unrealed-3.html">UnrealEd Interface</a></p>
</div><div class="qbsection">
<p><a href="unrealscript.html">UnrealScript Topics</a></p>
<p><a href="unrealscript-lessons.html">UnrealScript Lessons</a></p>
<p><a href="making-mods.html">Making Mods</a></p>
<p><a href="class-tree.html">Class Tree</a></p>
</div><div class="qbsection">
<p><a href="topics-on-modeling.html">Modeling Topics</a></p>
</div><div class="qbsection">
<p><a href="chongqing-page.html">Chongqing Page</a></p>
<p><a href="log-in.html">Log In</a></p></div>
</div>

</body></html>
