<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"  "http://www.w3.org/TR/html4/loose.dtd">

<html>
<head lang="en">
	<title>UnrealWiki: VitalOverdose/Ejection Trigger</title>
	<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
	<link rel="stylesheet" type="text/css" media="screen, print"
		href="shared/stylebase.structural.css">	
	<link rel="stylesheet" type="text/css" media="screen"
		href="shared/template-default.css">
	<link rel="stylesheet" type="text/css" media="screen"
		href="shared/styles.chblue.css">
	<link rel="stylesheet" type="text/css" media="print"
		href="shared/template-default-print.css">
	<!--[if IE 6]>
			<style>
			/* dirty hack for IE6. */
			#quickbar {
				position: absolute;
				}
			</style>
	<![endif]-->
  <link rel="start" href="http://wiki.beyondunreal.com/">
  <link rel="glossary"  href="http://wiki.beyondunreal.com/wiki/Terminology">
  <link rel="help"  href="http://wiki.beyondunreal.com/wiki/Using_The_Wiki">
<script type="text/javascript" src="shared/dhtml.js"></script>
<script type="text/javascript" src="shared/dhtml-menu.js"></script>
<style type="text/css">#dhtml-menu    { background: #eee; padding: 5px 0px; margin-right: -20px; border: 1px solid #888; border-left: 1px solid #ccc; border-top: 1px solid #ccc;  border-right: 1px solid #888; border-bottom: 1px solid #888 }
#dhtml-menu td { color: #000; font-family: Arial,Helvetica,sans-serif; font-size: 9pt; line-height: 13pt; padding: 1px 10px; cursor: default }
#dhtml-menu a  { color: #000; font-family: Arial,Helvetica,sans-serif; font-size: 9pt; line-height: 13pt; text-decoration: none }
#dhtml-menu tt { font-family: monospace; font-size: 9pt }
#dhtml-menu-separator { height: 1px; background: red }
#dhtml-menu-anchor { cursor: default }
</style>
<script type="text/javascript" src="shared/expandable.js"></script>
</head>
<body onLoad="menuInit(); document.cookie='page=VitalOverdose/Ejection_Trigger; path=/'" class="default">
<div id="scrolling"><!-- contains all except the fixed sidebar -->
<div id="topbar"  class="bar">
	<div class="righthalf">
		<form class="inline" method="post" action="/wiki" enctype="application/x-www-form-urlencoded"><input type="text" name="search"  size="20" /> <input type="submit" name="search" value="search" /></form>
	</div>
	<div class="lefthalf">
		<script type="text/javascript"><!--
			menuAlignRight = false;
		//--></script>
		<span><script type="text/javascript"><!--
 menuWriteAnchor("Quick Navigation") //--></script></span> | <a href="(start).html">Home Page</a> | <a href="recent-changes.html">Recent Changes</a> | <a href="http://wiki.beyondunreal.com/wiki?action=editprefs">Preferences</a>
	</div>
</div>

<div id="content"><!-- contains the title and article -->
	<h1 class='pagetitle'><a href="vitaloverdose.html">VitalOverdose</a>/<a href="http://wiki.beyondunreal.com/wiki?back=VitalOverdose/Ejection+Trigger">Ejection Trigger</a></h1>
	<div class="wiki"><div class="classpath"><img src="shared//gameicons/icon-ut2004.png"> <a href="unreal-tournament-2004.html">UT2004</a> :: <a href="actor.html">Actor</a> &gt;&gt; <a href="trigger.html">Trigger</a> &gt;&gt; Ejection Trigger(Package: custom)<br></div>
<h3><a name="0.0.1"></a>OverView</h3>
<p>This custom <em class="em2">Trigger</em> actor is designed quite simply to detect any vehicles that come within a cetain distance and if a driver is present ..eject the driver.//</p>
<h3><a name="0.0.2"></a>Basic Concept</h3>
<p>This is the basic concept for the full script;-</p>
<h4><a name="0.0.2.1"></a>Function Touch()</h4>
<p>(Custom).</p>
<ul><li>is it a vehicle? &amp; does it have a driver?<ul><li>(true) Use the valid ref gained through touch() to set its property bejectdriver to true.</li>
</ul>
</li>
</ul>
<pre class="paraverbatim"> </pre><pre class="uscript"> 
<span class="uscript-keyword">Class</span> Ejection_Trigger <span class="uscript-keyword">extends</span> Trigger
<span class="uscript-keyword">Placeable</span><span class="uscript-operator">;</span>

<span class="uscript-keyword">function</span> Touch<span class="uscript-operator">(</span> Actor Other<span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
<span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">(</span>other<span class="uscript-operator">.</span>isa<span class="uscript-operator">(</span><span class="uscript-name">'vehicle'</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">&amp;&amp;</span> <span class="uscript-operator">(</span>Vehicle<span class="uscript-operator">(</span>other<span class="uscript-operator">)</span><span class="uscript-operator">.</span>driver <span class="uscript-operator">!=</span> <span class="uscript-keyword">None</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> 
   Vehicle<span class="uscript-operator">(</span>other<span class="uscript-operator">)</span><span class="uscript-operator">.</span>bEjectDriver <span class="uscript-operator">=</span> <span class="uscript-keyword">True</span><span class="uscript-operator">;</span> a start and 
<span class="uscript-operator">}</span></pre><pre class="paraverbatim"> </pre><p>While this will work fine its not very practical for placement in a map as there is no way to see it for a start and definatley no control over it. So in this script were going to add some 'cosmetic' effects to make someone actually want to use it in a map.</p>
<p>This features;-</p>
<ul><li>Random AmbiantFx as a visual marker.</li>
<li>Random ContactFX for this actor as a result of a valid contact from a vac.</li>
<li>EjectScale Muliplyer.</li>
<li>Random tagfx for the ejected driver.</li>
<li>Vehicle can be damaged as a result of coming in contact with this actor</li>
<li>The driver can be dealt pain as well as the vehicle  </li>
</ul>
<h3><a name="0.0.3"></a>Global Variables</h3>
<pre class="paraverbatim"> VecDamag              = Optional How Much Damage the vehicle should recive on contact.
 DriverDamage          = OptionalHow Much Diver the vehicle should recive on contact.
 EjectSpeedmultiplyer  = Optional Multiplyer to apply to the vehicles ejectspeed on contact.
 EjectSoundFx          = Optional eject fx for The Vehicle that causes the contact.
 ValidContactSoundFx   = Optional sound fx for The Vehicle that causes the contact.
 DriverDamageType      = The damage type to apply to the driver when giveing him damage.
 VecDamageType         = The damage type to apply to the vehicle when causing it damage.
 DriverTagFxPool       = Optional Dynamic array for holding random fx for Tagging the driver on eject.
 AmbiantFxPool;        = Optional Dynamic array for holding random fx for ambiantFX for this actor 
 ValidContactFxPool;   = Optional Dynamic array for holding random fx for when a valid contact is caused</pre><pre class="uscript"><span class="uscript-keyword">Var</span> <span class="uscript-operator">(</span><span class="uscript-operator">)</span> <span class="uscript-type">Int</span>                            VecDamage<span class="uscript-operator">;</span>             <span class="uscript-comment">// Mapper can set in unrealEd.</span>
<span class="uscript-keyword">Var</span> <span class="uscript-operator">(</span><span class="uscript-operator">)</span> <span class="uscript-type">Int</span>                            DriverDamage<span class="uscript-operator">;</span>          <span class="uscript-comment">// Mapper can set in unrealEd.</span>
<span class="uscript-keyword">Var</span> <span class="uscript-operator">(</span><span class="uscript-operator">)</span> <span class="uscript-type">Float</span>                          EjectSpeedmultiplyer<span class="uscript-operator">;</span>  <span class="uscript-comment">// Mapper can set in unrealEd.</span>
<span class="uscript-keyword">Var</span> <span class="uscript-operator">(</span><span class="uscript-operator">)</span> Sound                          EjectSoundFx<span class="uscript-operator">;</span>          <span class="uscript-comment">// Mapper can set in unrealEd.</span>
<span class="uscript-keyword">Var</span> <span class="uscript-operator">(</span><span class="uscript-operator">)</span> Sound                          ValidContactSoundFx<span class="uscript-operator">;</span>   <span class="uscript-comment">// Mapper can set in unrealEd.</span>
<span class="uscript-keyword">Var</span> <span class="uscript-operator">(</span><span class="uscript-operator">)</span> <span class="uscript-keyword">Class</span><span class="uscript-operator">&lt;</span> Damagetype <span class="uscript-operator">&gt;</span>            DriverDamageType<span class="uscript-operator">;</span>      <span class="uscript-comment">// Mapper can set in unrealEd.</span>
<span class="uscript-keyword">Var</span> <span class="uscript-operator">(</span><span class="uscript-operator">)</span> <span class="uscript-keyword">Class</span><span class="uscript-operator">&lt;</span> DamageType <span class="uscript-operator">&gt;</span>            VecDamageType<span class="uscript-operator">;</span>         <span class="uscript-comment">// Mapper can set in unrealEd.</span>
<span class="uscript-keyword">Var</span> <span class="uscript-operator">(</span><span class="uscript-operator">)</span> <span class="uscript-keyword">Array</span><span class="uscript-operator">&lt;</span> <span class="uscript-keyword">Class</span><span class="uscript-operator">&lt;</span> Emitter <span class="uscript-operator">&gt;</span> <span class="uscript-operator">&gt;</span>      DriverTagFxPool<span class="uscript-operator">;</span>       <span class="uscript-comment">// Mapper can set in unrealEd.</span>
<span class="uscript-keyword">Var</span> <span class="uscript-operator">(</span><span class="uscript-operator">)</span> <span class="uscript-keyword">Array</span><span class="uscript-operator">&lt;</span> <span class="uscript-keyword">Class</span><span class="uscript-operator">&lt;</span> Emitter <span class="uscript-operator">&gt;</span> <span class="uscript-operator">&gt;</span>      AmbiantFxPool<span class="uscript-operator">;</span>         <span class="uscript-comment">// Mapper can set in unrealEd.</span>
<span class="uscript-keyword">Var</span> <span class="uscript-operator">(</span><span class="uscript-operator">)</span> <span class="uscript-keyword">Array</span><span class="uscript-operator">&lt;</span> <span class="uscript-keyword">Class</span><span class="uscript-operator">&lt;</span> Emitter <span class="uscript-operator">&gt;</span> <span class="uscript-operator">&gt;</span>      ValidContactFxPool<span class="uscript-operator">;</span>    <span class="uscript-comment">// Mapper can set in unrealEd.</span></pre><h4><a name="0.0.3.1"></a>Function PostBeginPlay()</h4>
<p>(Generic:called by system)</p>
<p>Here the postbeginplay() function is overwritten to include a single argument that checks to see if there are any emitters stored in the dynamic array AmbiantFxPool by asking if its length (how many used slots/elements) != 0. </p>
<pre class="uscript"><span class="uscript-keyword">Function</span> PostBeginPlay<span class="uscript-operator">(</span><span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
<span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>AmbiantFxPool<span class="uscript-operator">.</span><span class="uscript-keyword">length</span> <span class="uscript-operator">!=</span><span class="uscript-number">0</span> <span class="uscript-operator">)</span>
    SpawnFx<span class="uscript-operator">(</span><span class="uscript-keyword">self</span><span class="uscript-operator">,</span>AmbiantFxPool<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-operator">}</span></pre><h4><a name="0.0.3.2"></a>Function Touch()</h4>
<p>(generic:called when touched)</p>
<p>The touch function is over written so that when this actor is touched by another actor is fir checked to see if it is a vehicle...if it is a vehicle then we can get access to the properties preasent in in the vehicle class by typecasting other (which we know is a onsvec) to ONSVehicle. Using this new Typecasted ref to the ons vehicle check to see if there is a driver present to eject. If there isnt then this actor goes back to sleep and waits to be touched again. If there is a driver that can be ejected then the function EjectandTag is called and a vehcile typecasted ref to what touched us.</p>
<pre class="uscript"><span class="uscript-keyword">function</span> Touch<span class="uscript-operator">(</span> Actor Other<span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
 <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span> <span class="uscript-operator">(</span>Other<span class="uscript-operator">.</span>IsA<span class="uscript-operator">(</span><span class="uscript-name">'onsVehicle'</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">&amp;&amp;</span> <span class="uscript-operator">(</span>onsVehicle<span class="uscript-operator">(</span>Other<span class="uscript-operator">)</span><span class="uscript-operator">.</span>Driver <span class="uscript-operator">!=</span> <span class="uscript-keyword">None</span><span class="uscript-operator">)</span> <span class="uscript-operator">)</span>
    <span class="uscript-operator">{</span>
     <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>ValidContactFxPool <span class="uscript-operator">!=</span> <span class="uscript-keyword">None</span><span class="uscript-operator">)</span> 
        spawnFX<span class="uscript-operator">(</span><span class="uscript-keyword">self</span><span class="uscript-operator">,</span>ValidContactFxPool<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
     
     EjectAndTag<span class="uscript-operator">(</span> OnsVehicle<span class="uscript-operator">(</span>Other<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
     <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>ValidContactSoundFx<span class="uscript-operator">!=</span><span class="uscript-keyword">None</span><span class="uscript-operator">)</span>
         Playsound<span class="uscript-operator">(</span>ValidContactSoundFx<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>
 <span class="uscript-keyword">Super</span><span class="uscript-operator">.</span>touch<span class="uscript-operator">(</span>other<span class="uscript-operator">)</span>
<span class="uscript-operator">}</span></pre><h4><a name="0.0.3.3"></a>Function EjectAndTag()</h4>
<p>(custom:called from touch()).</p>
<p>in this function the new ejection speed for the driver is calculated and then passed back to the vehicle. Then a copy of the Drivers Valid Ref is taken (as once ejected hes no longer the driver and we would lose and valid to it) brfore the driver is finally ejected. All the 'cosmetic' fx such as the sound and the tagging of the driver are done in PostEject(), as this provides a convienient place for someone to add code at a later date.</p>
<pre class="uscript"><span class="uscript-keyword">Function</span> EjectAndTag<span class="uscript-operator">(</span> OnsVehicle Vec <span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
 <span class="uscript-keyword">Local</span> Actor       EjectedDriver<span class="uscript-operator">;</span>
 
 Vec<span class="uscript-operator">.</span>EjectMomentum  <span class="uscript-operator">*=</span> Ejectmultiplyer<span class="uscript-operator">;</span>
 EjectedDriver       <span class="uscript-operator">=</span> Vec<span class="uscript-operator">.</span>Driver<span class="uscript-operator">;</span>
 Vec<span class="uscript-operator">.</span>EjectDriver<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
 <span class="uscript-keyword">If</span> <span class="uscript-operator">(</span> EjectedDriver <span class="uscript-operator">!=</span> <span class="uscript-keyword">None</span> <span class="uscript-operator">)</span>
      PostEject<span class="uscript-operator">(</span>onsvehicle TheVec<span class="uscript-operator">,</span>pawn EjectedDriver<span class="uscript-operator">,</span>emitter SpawnedTag<span class="uscript-operator">)</span>
<span class="uscript-operator">}</span></pre><h4><a name="0.0.3.4"></a>Function SpawnFx()</h4>
<p>(Custom:called from EjectAndTag()).</p>
<p>There are 3 spawn functions in this actor;- </p>
<ul><li>ambiant  fx ;- Is really nothing more than a visual marker to where the Trigger eject is when playing.</li>
<li>Contact  fx ;- Optional fx to spawn as a visual indication of a valid contact whith a vec.</li>
<li>Tag      FX ;- Optional emitter that gets hard attached to the driver when being ejected to make a trail effect.</li>
</ul>
<p>So for the sake of efficiancy the if a SpawnFx function that is designed to do the job of all 3. To run this function you have to pass it a dynamic array of emitters and an actor to attach it to. It then randomly selects an emitter from the 'spawnPool' spawns, then hard attches it to whatever is in the property ActorPos. As the ambiant aand contact get attached to the  Trigger Eject but for the tagFX its the driver that wants tagging.</p>
<p>Note: The is no qulifying of the length of the array at this point because its more efficiant to check each individual spawnpool before the actual call to spawn as then we dont have to pass an entire array of emitters to another function to find out.</p>
<pre class="uscript"><span class="uscript-keyword">Function</span> SpawnFx <span class="uscript-operator">(</span>actor ActorPos<span class="uscript-operator">,</span><span class="uscript-keyword">array</span><span class="uscript-operator">&lt;</span> <span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span> emiktter<span class="uscript-operator">&gt;</span> <span class="uscript-operator">&gt;</span> SpawnPool<span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
 <span class="uscript-keyword">Local</span> Emitter           SpawnedTagFX<span class="uscript-operator">;</span>
 <span class="uscript-keyword">Local</span> <span class="uscript-type">int</span>               PickedNumb<span class="uscript-operator">;</span>
 <span class="uscript-keyword">Local</span> <span class="uscript-keyword">Class</span><span class="uscript-operator">&lt;</span> Emitter <span class="uscript-operator">&gt;</span>  PickedTagFxClass<span class="uscript-operator">;</span>

 PickedNumb       <span class="uscript-operator">=</span> Rand<span class="uscript-operator">(</span>SpawnPool<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-number">-1</span><span class="uscript-operator">)</span><span class="uscript-operator">+</span><span class="uscript-number">1</span><span class="uscript-operator">;</span>
 PickedTagFxClass <span class="uscript-operator">=</span> SpawnPool<span class="uscript-operator">[</span>PickedNumb<span class="uscript-operator">]</span><span class="uscript-operator">;</span>
 SpawnedTagFX     <span class="uscript-operator">=</span> Spawn<span class="uscript-operator">(</span>PickedTagFxClass<span class="uscript-operator">,</span>ActorPos<span class="uscript-operator">,</span><span class="uscript-operator">,</span>ActorPos<span class="uscript-operator">.</span>Location <span class="uscript-operator">,</span>ActorPos<span class="uscript-operator">.</span>Rotation <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
 <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span> SpawnedTag <span class="uscript-operator">!=</span> <span class="uscript-keyword">none</span> <span class="uscript-operator">)</span>
      SpawnedTagFX<span class="uscript-operator">.</span>setbase<span class="uscript-operator">(</span>ActorPos<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-operator">}</span></pre><h4><a name="0.0.3.5"></a>Function PostEject()</h4>
<p>(Custom:Called by EjectAndTag())</p>
<p>Here all of the cosmetic fx for this actor take place after the driver has finally been ejected from the vehicle. </p>
<h4><a name="0.0.3.6"></a>The logic;</h4>
<ul><li>(Does the DriverTagFxPool array contain some emitters?)<ul><li>(True): Call function SpawnFx and pass to it the ValidRef of the ejecteddriver &amp; the contents of the DriverTagFxPool.</li>
</ul>
</li>
<li>(is there something in the property EjectSoundFx?)<ul><li>(true): get the vehicle to play the 'EjectSoundFx' </li>
</ul>
</li>
<li>(is the property DriverDamage greater than 0?)<ul><li>(True): Damage The ejected driver, Cause DriverDamage of damage.</li>
</ul>
</li>
<li>(is the property VecDamage greater than 0?)<ul><li>(True): Damage ValidVehicle and  Cause VecDamage worth of damage.</li>
</ul>
</li>
</ul>
<pre class="uscript"><span class="uscript-keyword">Simulated</span> <span class="uscript-keyword">function</span> PostEject<span class="uscript-operator">(</span>onsvehicle TheVec<span class="uscript-operator">,</span>pawn EjectedDriver<span class="uscript-operator">,</span>emitter SpawnedTag<span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
 <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span> DriverTagFxPool<span class="uscript-operator">.</span><span class="uscript-keyword">length</span> <span class="uscript-operator">!=</span> <span class="uscript-number">0</span><span class="uscript-operator">)</span>
      spawnfx<span class="uscript-operator">(</span>EjectedDriver<span class="uscript-operator">,</span>DriverTagFxPool<span class="uscript-operator">)</span>
 
 <span class="uscript-keyword">If</span> <span class="uscript-operator">(</span> EjectSoundFx <span class="uscript-operator">!=</span> <span class="uscript-keyword">none</span> <span class="uscript-operator">)</span>
      TheVec<span class="uscript-operator">.</span>PlaySound<span class="uscript-operator">(</span> EjectSoundFx <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
 
 <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span> DriverDamage <span class="uscript-operator">&gt;</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span>
      EjectedDriver<span class="uscript-operator">.</span>TakeDamage<span class="uscript-operator">(</span>DriverDamage <span class="uscript-operator">,</span> Instigator <span class="uscript-operator">,</span> EjectedDriver<span class="uscript-operator">.</span>Location <span class="uscript-operator">,</span> <span class="uscript-keyword">vect</span><span class="uscript-operator">(</span><span class="uscript-number">0</span><span class="uscript-operator">,</span><span class="uscript-number">0</span><span class="uscript-operator">,</span><span class="uscript-number">10000</span><span class="uscript-operator">)</span><span class="uscript-operator">,</span>DriverDamagetype <span class="uscript-operator">)</span> <span class="uscript-operator">;</span>
 
 <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span> VecDamage <span class="uscript-operator">&gt;</span> <span class="uscript-number">1</span> <span class="uscript-operator">)</span>
      TheVec<span class="uscript-operator">.</span>TakeDamage<span class="uscript-operator">(</span>VecDamage <span class="uscript-operator">,</span> Instigator <span class="uscript-operator">,</span> Thevec<span class="uscript-operator">.</span>Location <span class="uscript-operator">,</span> <span class="uscript-keyword">vect</span><span class="uscript-operator">(</span><span class="uscript-number">0</span><span class="uscript-operator">,</span><span class="uscript-number">0</span><span class="uscript-operator">,</span><span class="uscript-number">10000</span><span class="uscript-operator">)</span><span class="uscript-operator">,</span>VecDamagetype <span class="uscript-operator">)</span> <span class="uscript-operator">;</span>
<span class="uscript-operator">}</span></pre><h3><a name="0.0.4"></a>The Full Script</h3>
<p>Here is the complete Script wi all the cosmetic fx added to it;-</p>
<pre class="uscript"> <span class="uscript-comment">/////////////////////////////////////////////////////////////////////</span>
<span class="uscript-comment">// SFX_Ejecting by VitalOverdose</span>
<span class="uscript-comment">// Feb 2006.</span>
<span class="uscript-comment">// Http://www.vitaloverdose.com</span>
<span class="uscript-comment">///////////////////////////////////////////////////////////////////////</span>
<span class="uscript-keyword">class</span> SFX_Ejecting <span class="uscript-keyword">extends</span> Trigger
<span class="uscript-keyword">Placeable</span><span class="uscript-operator">;</span>

<span class="uscript-keyword">Var</span> <span class="uscript-operator">(</span><span class="uscript-operator">)</span> <span class="uscript-type">Int</span>                            VecDamage<span class="uscript-operator">;</span>             <span class="uscript-comment">// Mapper can set in unrealEd.</span>
<span class="uscript-keyword">Var</span> <span class="uscript-operator">(</span><span class="uscript-operator">)</span> <span class="uscript-type">Int</span>                            DriverDamage<span class="uscript-operator">;</span>          <span class="uscript-comment">// Mapper can set in unrealEd.</span>
<span class="uscript-keyword">Var</span> <span class="uscript-operator">(</span><span class="uscript-operator">)</span> <span class="uscript-type">Float</span>                          EjectSpeedmultiplyer<span class="uscript-operator">;</span>  <span class="uscript-comment">// Mapper can set in unrealEd.</span>
<span class="uscript-keyword">Var</span> <span class="uscript-operator">(</span><span class="uscript-operator">)</span> Sound                          EjectSoundFx<span class="uscript-operator">;</span>          <span class="uscript-comment">// Mapper can set in unrealEd.</span>
<span class="uscript-keyword">Var</span> <span class="uscript-operator">(</span><span class="uscript-operator">)</span> Sound                          ValidContactSoundFx<span class="uscript-operator">;</span>   <span class="uscript-comment">// Mapper can set in unrealEd.</span>
<span class="uscript-keyword">Var</span> <span class="uscript-operator">(</span><span class="uscript-operator">)</span> <span class="uscript-keyword">Class</span><span class="uscript-operator">&lt;</span> Damagetype <span class="uscript-operator">&gt;</span>            DriverDamageType<span class="uscript-operator">;</span>      <span class="uscript-comment">// Mapper can set in unrealEd.</span>
<span class="uscript-keyword">Var</span> <span class="uscript-operator">(</span><span class="uscript-operator">)</span> <span class="uscript-keyword">Class</span><span class="uscript-operator">&lt;</span> DamageType <span class="uscript-operator">&gt;</span>            VecDamageType<span class="uscript-operator">;</span>         <span class="uscript-comment">// Mapper can set in unrealEd.</span>
<span class="uscript-keyword">Var</span> <span class="uscript-operator">(</span><span class="uscript-operator">)</span> <span class="uscript-keyword">Array</span><span class="uscript-operator">&lt;</span> <span class="uscript-keyword">Class</span><span class="uscript-operator">&lt;</span> Emitter <span class="uscript-operator">&gt;</span> <span class="uscript-operator">&gt;</span>      DriverTagFxPool<span class="uscript-operator">;</span>       <span class="uscript-comment">// Mapper can set in unrealEd.</span>
<span class="uscript-keyword">Var</span> <span class="uscript-operator">(</span><span class="uscript-operator">)</span> <span class="uscript-keyword">Array</span><span class="uscript-operator">&lt;</span> <span class="uscript-keyword">Class</span><span class="uscript-operator">&lt;</span> Emitter <span class="uscript-operator">&gt;</span> <span class="uscript-operator">&gt;</span>      AmbiantFxPool<span class="uscript-operator">;</span>         <span class="uscript-comment">// Mapper can set in unrealEd.</span>
<span class="uscript-keyword">Var</span> <span class="uscript-operator">(</span><span class="uscript-operator">)</span> <span class="uscript-keyword">Array</span><span class="uscript-operator">&lt;</span> <span class="uscript-keyword">Class</span><span class="uscript-operator">&lt;</span> Emitter <span class="uscript-operator">&gt;</span> <span class="uscript-operator">&gt;</span>      ValidContactFxPool<span class="uscript-operator">;</span>    <span class="uscript-comment">// Mapper can set in unrealEd.</span>

<span class="uscript-keyword">Function</span> PostBeginPlay<span class="uscript-operator">(</span><span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
<span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>AmbiantFxPool<span class="uscript-operator">.</span><span class="uscript-keyword">length</span> <span class="uscript-operator">!=</span><span class="uscript-number">0</span> <span class="uscript-operator">)</span>
    SpawnFx<span class="uscript-operator">(</span><span class="uscript-keyword">self</span><span class="uscript-operator">,</span>AmbiantFxPool<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-operator">}</span>

<span class="uscript-keyword">Function</span> Touch<span class="uscript-operator">(</span> Actor Other<span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
 <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span> <span class="uscript-operator">(</span>Other<span class="uscript-operator">.</span>IsA<span class="uscript-operator">(</span><span class="uscript-name">'onsVehicle'</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">&amp;&amp;</span> <span class="uscript-operator">(</span>onsVehicle<span class="uscript-operator">(</span>Other<span class="uscript-operator">)</span><span class="uscript-operator">.</span>Driver <span class="uscript-operator">!=</span> <span class="uscript-keyword">None</span><span class="uscript-operator">)</span> <span class="uscript-operator">)</span>
    <span class="uscript-operator">{</span>
     <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>ValidContactFxPool <span class="uscript-operator">!=</span> <span class="uscript-keyword">None</span><span class="uscript-operator">)</span>
         spawnFX<span class="uscript-operator">(</span><span class="uscript-keyword">self</span><span class="uscript-operator">,</span>ValidContactFxPool<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
     EjectAndTag<span class="uscript-operator">(</span> OnsVehicle<span class="uscript-operator">(</span>Other<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>

     <span class="uscript-keyword">If</span> <span class="uscript-operator">(</span>ValidContactSoundFx<span class="uscript-operator">!=</span><span class="uscript-keyword">None</span><span class="uscript-operator">)</span>
         Playsound<span class="uscript-operator">(</span>ValidContactSoundFx<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>
 <span class="uscript-keyword">Super</span><span class="uscript-operator">.</span>touch<span class="uscript-operator">(</span>other<span class="uscript-operator">)</span>
<span class="uscript-operator">}</span>

<span class="uscript-keyword">Function</span> EjectAndTag<span class="uscript-operator">(</span> OnsVehicle Vec <span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
 <span class="uscript-keyword">Local</span> Actor       EjectedDriver<span class="uscript-operator">;</span>

 Vec<span class="uscript-operator">.</span>EjectMomentum <span class="uscript-operator">*=</span> Ejectmultiplyer<span class="uscript-operator">;</span>
 EjectedDriver      <span class="uscript-operator">=</span> Vec<span class="uscript-operator">.</span>Driver<span class="uscript-operator">;</span>
 Vec<span class="uscript-operator">.</span>EjectDriver<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
 <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span> EjectedDriver <span class="uscript-operator">!=</span> <span class="uscript-keyword">None</span> <span class="uscript-operator">)</span>
      PostEject<span class="uscript-operator">(</span>onsvehicle TheVec<span class="uscript-operator">,</span>pawn EjectedDriver<span class="uscript-operator">,</span>emitter SpawnedTag<span class="uscript-operator">)</span>
<span class="uscript-operator">}</span>

<span class="uscript-keyword">Function</span> SpawnFx <span class="uscript-operator">(</span>actor ActorPos<span class="uscript-operator">,</span><span class="uscript-keyword">array</span><span class="uscript-operator">&lt;</span> <span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span> emiktter<span class="uscript-operator">&gt;</span> <span class="uscript-operator">&gt;</span> SpawnPool<span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
 <span class="uscript-keyword">Local</span> Emitter           SpawnedTagFX<span class="uscript-operator">;</span>
 <span class="uscript-keyword">Local</span> <span class="uscript-type">int</span>               PickedNumb<span class="uscript-operator">;</span>
 <span class="uscript-keyword">Local</span> <span class="uscript-keyword">Class</span><span class="uscript-operator">&lt;</span> Emitter <span class="uscript-operator">&gt;</span>  PickedTagFxClass<span class="uscript-operator">;</span>

 PickedNumb       <span class="uscript-operator">=</span> Rand<span class="uscript-operator">(</span>SpawnPool<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-number">-1</span><span class="uscript-operator">)</span><span class="uscript-operator">+</span><span class="uscript-number">1</span><span class="uscript-operator">;</span>
 PickedTagFxClass <span class="uscript-operator">=</span> SpawnPool<span class="uscript-operator">[</span>PickedNumb<span class="uscript-operator">]</span><span class="uscript-operator">;</span>
 SpawnedTagFX     <span class="uscript-operator">=</span> Spawn<span class="uscript-operator">(</span>PickedTagFxClass<span class="uscript-operator">,</span>ActorPos<span class="uscript-operator">,</span><span class="uscript-operator">,</span>ActorPos<span class="uscript-operator">.</span>Location <span class="uscript-operator">,</span>ActorPos<span class="uscript-operator">.</span>Rotation <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
 <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span> SpawnedTag <span class="uscript-operator">!=</span> <span class="uscript-keyword">none</span> <span class="uscript-operator">)</span>
      SpawnedTagFX<span class="uscript-operator">.</span>setbase<span class="uscript-operator">(</span>ActorPos<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-operator">}</span>

<span class="uscript-keyword">Simulated</span> <span class="uscript-keyword">function</span> PostEject<span class="uscript-operator">(</span>onsvehicle TheVec<span class="uscript-operator">,</span>pawn EjectedDriver<span class="uscript-operator">,</span>emitter SpawnedTag<span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
 <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span> DriverTagFxPool<span class="uscript-operator">.</span><span class="uscript-keyword">length</span> <span class="uscript-operator">!=</span> <span class="uscript-number">0</span><span class="uscript-operator">)</span>
      spawnfx<span class="uscript-operator">(</span>EjectedDriver<span class="uscript-operator">,</span>DriverTagFxPool<span class="uscript-operator">)</span>

 <span class="uscript-keyword">If</span> <span class="uscript-operator">(</span> EjectSoundFx <span class="uscript-operator">!=</span> <span class="uscript-keyword">none</span> <span class="uscript-operator">)</span>
      TheVec<span class="uscript-operator">.</span>PlaySound<span class="uscript-operator">(</span> EjectSoundFx <span class="uscript-operator">)</span><span class="uscript-operator">;</span>

 <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span> DriverDamage <span class="uscript-operator">&gt;</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span>
      EjectedDriver<span class="uscript-operator">.</span>TakeDamage<span class="uscript-operator">(</span>DriverDamage <span class="uscript-operator">,</span> Instigator <span class="uscript-operator">,</span> EjectedDriver<span class="uscript-operator">.</span>Location <span class="uscript-operator">,</span> <span class="uscript-keyword">vect</span><span class="uscript-operator">(</span><span class="uscript-number">0</span><span class="uscript-operator">,</span><span class="uscript-number">0</span><span class="uscript-operator">,</span><span class="uscript-number">10000</span><span class="uscript-operator">)</span><span class="uscript-operator">,</span>DriverDamagetype <span class="uscript-operator">)</span> <span class="uscript-operator">;</span>

 <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span> VecDamage <span class="uscript-operator">&gt;</span> <span class="uscript-number">1</span> <span class="uscript-operator">)</span>
      TheVec<span class="uscript-operator">.</span>TakeDamage<span class="uscript-operator">(</span>VecDamage <span class="uscript-operator">,</span> Instigator <span class="uscript-operator">,</span> Thevec<span class="uscript-operator">.</span>Location <span class="uscript-operator">,</span> <span class="uscript-keyword">vect</span><span class="uscript-operator">(</span><span class="uscript-number">0</span><span class="uscript-operator">,</span><span class="uscript-number">0</span><span class="uscript-operator">,</span><span class="uscript-number">10000</span><span class="uscript-operator">)</span><span class="uscript-operator">,</span>VecDamagetype <span class="uscript-operator">)</span> <span class="uscript-operator">;</span>
<span class="uscript-operator">}</span></pre><pre class="paraverbatim"> </pre><h3><a name="0.0.5"></a>Related</h3>
<p><a href="vitaloverdose-vecbooster.html">VitalOverdose/VecBooster</a></p>
<p><a href="vitaloverdose-vehicletelepo.html">VitalOverdose/VehicleTeleporter</a></p>
<p><a href="vitaloverdose-randomrelocat.html">VitalOverdose/RandomRelocator</a></p>
<h2><a name="0.1"></a>discusion</h2>
<hr class="thin"><p><a href="category-custom-class.html">Category Custom Class</a></p>
<script type="text/javascript"><!--
 menuItemAdd("OverView", "#0.0.1");
menuItemAdd("Basic Concept", "#0.0.2");
menuItemAdd("<tt>&nbsp;&nbsp;</tt>Function Touch()", "#0.0.2.1");
menuItemAdd("Global Variables", "#0.0.3");
menuItemAdd("<tt>&nbsp;&nbsp;</tt>Function PostBeginPlay()", "#0.0.3.1");
menuItemAdd("<tt>&nbsp;&nbsp;</tt>Function Touch()", "#0.0.3.2");
menuItemAdd("<tt>&nbsp;&nbsp;</tt>Function EjectAndTag()", "#0.0.3.3");
menuItemAdd("<tt>&nbsp;&nbsp;</tt>Function SpawnFx()", "#0.0.3.4");
menuItemAdd("<tt>&nbsp;&nbsp;</tt>Function PostEject()", "#0.0.3.5");
menuItemAdd("<tt>&nbsp;&nbsp;</tt>The logic;", "#0.0.3.6");
menuItemAdd("The Full Script", "#0.0.4");
menuItemAdd("Related", "#0.0.5");
menuItemAdd("discusion", "#0.1");
 menuWrite() //--></script></div>
</div>

<div id="footer" class="bar">
	<p><form method="post" action="http://wiki.beyondunreal.com/wiki" enctype="application/x-www-form-urlencoded">
<a href="(start).html">Home Page</a> | <a href="vitaloverdose.html">VitalOverdose</a> | <a href="recent-changes.html">Recent Changes</a> | <a href="http://wiki.beyondunreal.com/wiki?action=editprefs">Preferences</a><br>
<a href="http://wiki.beyondunreal.com/wiki?action=edit&id=VitalOverdose/Ejection_Trigger">Edit text of this page</a> | <a href="http://wiki.beyondunreal.com/wiki?action=history&id=VitalOverdose/Ejection_Trigger">View other revisions</a><br>Last edited June 15, 2006 14:12 <a href="http://wiki.beyondunreal.com/wiki?action=browse&diff=1&id=VitalOverdose/Ejection_Trigger">(diff)</a><br>Search: <input type="text" name="search"  size="20" /><input type="hidden" name="dosearch" value="1"  /><br><br><small><a href="http://wiki.beyondunreal.com/wiki/VitalOverdose/Ejection_Trigger">Original page</a> &#150; copy created Sat, Jun 23, 2007</small><div></div>
</form>
	</p>
	<p>Always snap to grid
</p>
</div>
</div><!-- close of "scrolling" div -->

<div id="quickbar">
	<div id="logo"><a href="http://wiki.beyondunreal.com/"><img src="shared/wikilogo.jpg" width="143" height="100" border="0"></a>
		</div>
	<div class="qbsitename">
		<p>The Unreal Engine Documentation Site</p>
	</div>
	<div class="qbsection">
<p><a href="metatopics.html">Wiki Community</a></p>
<p><a href="category-category.html">Topic Categories</a></p>
<p><a href="/cgi-bin/imageupload.cgi/wiki-ext/imageupload.htt" target="_blank ">Image Uploads</a></p>
<p><a href="http://wiki.beyondunreal.com/wiki?action=random">Random Page</a></p>
<p><a href="recent-changes.html">Recent Changes</a></p>
<p><a href="offline-wiki.html">Offline Wiki</a></p>
</div><div class="qbsection">
<p><a href="unreal-engine.html">Unreal Engine</a></p>
<p><a href="console-commands.html">Console Commands</a></p>
<p><a href="terminology.html">Terminology</a></p>
<p><a href="category-faq.html">FAQs</a></p>
<p><a href="help-desk.html">Help Desk</a></p>
</div><div class="qbsection">
<p><a href="topics-on-mapping.html">Mapping Topics</a></p>
<p><a href="mapping-lessons.html">Mapping Lessons</a></p>
<p><a href="unrealed-3.html">UnrealEd Interface</a></p>
</div><div class="qbsection">
<p><a href="unrealscript.html">UnrealScript Topics</a></p>
<p><a href="unrealscript-lessons.html">UnrealScript Lessons</a></p>
<p><a href="making-mods.html">Making Mods</a></p>
<p><a href="class-tree.html">Class Tree</a></p>
</div><div class="qbsection">
<p><a href="topics-on-modeling.html">Modeling Topics</a></p>
</div><div class="qbsection">
<p><a href="chongqing-page.html">Chongqing Page</a></p>
<p><a href="log-in.html">Log In</a></p></div>
</div>

</body></html>
