<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"  "http://www.w3.org/TR/html4/loose.dtd">

<html>
<head lang="en">
	<title>UnrealWiki: VampireShoppers</title>
	<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
	<link rel="stylesheet" type="text/css" media="screen, print"
		href="shared/stylebase.structural.css">	
	<link rel="stylesheet" type="text/css" media="screen"
		href="shared/template-default.css">
	<link rel="stylesheet" type="text/css" media="screen"
		href="shared/styles.chblue.css">
	<link rel="stylesheet" type="text/css" media="print"
		href="shared/template-default-print.css">
	<!--[if IE 6]>
			<style>
			/* dirty hack for IE6. */
			#quickbar {
				position: absolute;
				}
			</style>
	<![endif]-->
  <link rel="start" href="http://wiki.beyondunreal.com/">
  <link rel="glossary"  href="http://wiki.beyondunreal.com/wiki/Terminology">
  <link rel="help"  href="http://wiki.beyondunreal.com/wiki/Using_The_Wiki">
<script type="text/javascript" src="shared/dhtml.js"></script>
<script type="text/javascript" src="shared/dhtml-menu.js"></script>
<style type="text/css">#dhtml-menu    { background: #eee; padding: 5px 0px; margin-right: -20px; border: 1px solid #888; border-left: 1px solid #ccc; border-top: 1px solid #ccc;  border-right: 1px solid #888; border-bottom: 1px solid #888 }
#dhtml-menu td { color: #000; font-family: Arial,Helvetica,sans-serif; font-size: 9pt; line-height: 13pt; padding: 1px 10px; cursor: default }
#dhtml-menu a  { color: #000; font-family: Arial,Helvetica,sans-serif; font-size: 9pt; line-height: 13pt; text-decoration: none }
#dhtml-menu tt { font-family: monospace; font-size: 9pt }
#dhtml-menu-separator { height: 1px; background: red }
#dhtml-menu-anchor { cursor: default }
</style>
<script type="text/javascript" src="shared/expandable.js"></script>
</head>
<body onLoad="menuInit(); document.cookie='page=VampireShoppers; path=/'" class="default">
<div id="scrolling"><!-- contains all except the fixed sidebar -->
<div id="topbar"  class="bar">
	<div class="righthalf">
		<input type="text" name="search"  size="14" /> <input type="button" onclick="location.href='../search-error/index.html';" value="search" />
	</div>
	<div class="lefthalf">
		<script type="text/javascript"><!--
			menuAlignRight = false;
		//--></script>
		<span><script type="text/javascript"><!--
 menuWriteAnchor("Quick Navigation") //--></script></span> | <a href="../index.html">Home Page</a> | <a href="recent-changes.html">Recent Changes</a>
	</div>
</div>

<div id="content"><!-- contains the title and article -->
	<h1 class='pagetitle'><a href="http://wiki.beyondunreal.com/wiki?back=VampireShoppers">VampireShoppers</a></h1>
	<div class="wiki"><h3><a name="0.0.1"></a>Vampire Shoppers Tutorial:  (IN DEVELOPMENT)</h3>
<p>Vampire Shoppers is a mutator we're making as a class project for our Gaming class at <a href="http://www.bcc.ctc.edu">[Bellevue Community College]</a></p>
<p>The goal of the project is to combine two mutators that we've made. The two mutators are Super Vampire (A vampire that steals adrenaline too, and gets bonuses for headshots) with Buy Mode. (You can't just pick up weapons, you buy them with adrenaline. You've gotta work for it now! Adrenaline junkies be afraid.) This tutorial is meant to walk people through everything we did. Hopefully it can be helpful to others. If you have any comments for us on how we can do things better, please post them.</p>
<p>Our style for this tutorial is pretty much to show you what we did, and try and explain it as best we can. It's more of a reference manual than a "now press the left mouse button" walkthrough. We figure it's more useful that way.</p>
<p>Make sure to download the complete source code <a href="http://www.franich.com/MutVampireShoppers.zip">[here]</a>. It's extensively commented, and will serve as a sort of tutorial all of it's own. That should be your main source of information.</p>
<hr class="thin"><h3><a name="0.0.2"></a>Some terminology</h3>
<p>Throughout this tutorial we're going to be using some terms that might be unfamiliar. Here they are:</p>
<dl><dt>Bottom Feeder</dt><dd>The currently lowest ranked player. Yes, we stole the term from one of our favorite game modes, Mutant! We also stole some code from them too. We give full credit where it's due. We never would've been able to learn what we've learned without their fine example.</dd></dl>
<hr class="thin"><h3><a name="0.0.3"></a>Where we started, two lonely mutators</h3>
<p>This project was actually about working in a group to combine two separate mutators that we (as individuals) had already made. When we started we had two mutators:</p>
<dl><dt>Buy Mode</dt><dd>You start out with a shield gun and an assault rifle. In order to get new weapons you have to spend adrenaline. To choose which weapon you want you bring up a menu by pressing the 'b' key. </dd><dt>Super Vampire</dt><dd>Like normal vampire, except that if you hit the max health, you can still continue to gain health. (It forces your maximum to go up.) After all, what's the point of being a vampire if you can't just keep getting better and better. Just to make the code more 'interesting' it also ended up adding vampiric adrenaline gain/loss too, to parallel the health.</dd></dl>
<p>We were assigned to bring these two mutators together into one, and write this tutorial, but in the process we decided we wanted the following features:</p>
<ul><li>Buy Mode:<ul><li>You can now buy powerups too. (For great Double-Damage!)</li>
<li>You can sell weapons back when they're empty (or before) in exchange for a small amount of adrenaline</li>
<li>Improved (and now hierarchical) menu system. (Break things down into sub-menus, rather than have everything on one big menu.)</li>
<li>If you're the worst ranked player in the game, you get a special discount on weapons and powerups. (Hopefully you can use this to improve your standings, or just cause more chaos.)</li>
</ul>
</li>
<li>Super Vampire:<ul><li>You're a vampire. Headshots should mean something significant, right? So if you get a headshot, you get an additional little dose of vampirism.</li>
<li>If you were the worst ranked player in the game, you get a few bonus health and adrenaline points, hopefully allowing you to stay alive a bit longer, buy a better weapon, and improve your standings a bit. (makes for more chaos!)</li>
</ul>
</li>
</ul>
<hr class="thin"><h3><a name="0.0.4"></a>Now for some depth, a look at each file and it's methods:</h3>
<h4><a name="0.0.4.1"></a>MutVampShopper.uc:</h4>
<div class="classpath"><a href="info.html">Info</a> &gt;&gt; <a href="mutator.html">Mutator</a> &gt;&gt; MutVampShopper<br></div>
<p>Main Mutator file, Lots of different functions, that do lots of different things. Probably best to go through them 1 and a time.</p>
<dl><dt>Tick()</dt><dd>Loads our interaction(VampShopper_Inter) every tick. That's essentially all this does.</dd><dt>CheckReplacement()</dt><dd>Hides all pickup, and weapon bases. Moves all pickups to an unreachable location. Can't just destroy the pickups since they are required for Buying Powerups.</dd><dt>PostBeginPlay()</dt><dd>Loads out gamerules class(VampShopper_Rules) into the game.</dd><dt>IsRelevant()</dt><dd>Taken from the No Adrenaline MOD. Removes all Adrenaline pickups, not sure if that's all it does.</dd></dl>
<h4><a name="0.0.4.2"></a>VampShopper_Rules.uc:</h4>
<div class="classpath"><a href="info.html">Info</a> &gt;&gt; <a href="gamerules.html">GameRules</a> &gt;&gt; VampShopper_Rules<br></div>
<p>This file actually sets up the game rules. It controls what should happen when a player takes damaage, or is killed.<br>It also controls which player is the "bottom feeder".<br>This is where the meat of the vampire side of things comes in.</p>
<dl><dt>ScoreKill()</dt><dd>This method is called (I think) whenever someone is killed. Credit the code pretty much to the Mutant gametype. The one thing that had to be done is that we had to use ScoreKill() instead of what Mutant used, which was NotifyKilled(). Not really sure of the difference, other than that NotifyKilled is a part of the gametype, but ScoreKill is the game's ruleset. This means that we should be able to operate in any game type. I think.<br>All that happens in this method is that whenever someone dies, we trigger an update to see who the current "bottom feeder" is. (By calling UpdateBottomFeeder() strangely enough... <img alt=":-D" src="emoticons/biggrin.gif" align="middle">)</dd><dt>NetDamage()</dt><dd>Whenever someone takes damage, this function is called. This is where we compute how much health should be gained vampirically, and how much adrenaline should be both gained and lost. This includes adding the bonuses for either a headshot, or the bottom feeder.<br>I'm not too happy with the way we do all the checks for headshots and all that. It seems inelegant, but at least it's pretty straightforward.<br>The only thing this function does that might be hard to understand is the check to see if <em class="em1">DamageType==Headshot</em>. <em class="em1">HeadShot</em> is defined as a default property. It's just a <em class="em1">DamTypeSniperHeadShot</em> class. I'd have liked a way to check for head shots with any weapon, but it's not a built-in concept to the game, and I was too lazy to change everything that would've been required for any-weapon headshots. (I <em class="em2">think</em> it would've taken creating a new damage type for each weapon.)<br>Other than that, there's nothing at all complicated about what this function does, it just runs through a bunch of <em class="em1">if</em> statements. Looking at the (well commented) code is your best bet to see exactly what's going on.</dd><dt>ComparePRI()</dt><dd>This method takes two players (actually, their PlayerReplicationInfo) and compares them, to see which of the players is ranked lower. (This method also was stolen directly from the Mutant gametype.) It's also a pretty straightforward method. Just compare various player stats to see who is better.<br>The important thing to realize about this is that it gets called over and over again on all players... </dd><dt>UpdateBottomFeeder()</dt><dd>Decides which player is actually the worst by looping through them and calling ComparePRI() to compare them. Voodoo Magic!<br>Actually it's fairly simple, even though it's probably the single most complicated part of this file.<br><pre class="uscript">oldBF <span class="uscript-operator">=</span> CurrentBottomFeeder<span class="uscript-operator">;</span>
CurrentBottomFeeder <span class="uscript-operator">=</span> <span class="uscript-keyword">None</span><span class="uscript-operator">;</span></pre><br>We set the current bottom feeder into a temporary variable, and then clear the variable that keeps track of who the bottom feeder is.<br><pre class="uscript">Player <span class="uscript-operator">=</span> Level<span class="uscript-operator">.</span>getLocalPlayerController<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span></pre><br>This is something that was hard to figure out. This code was taken from the Mutant gametype, but in mutant it was part of a class that extended deathmatch. Apparently <em class="em1">GameReplicationInfo</em> is inherited somehow in that class. Apparently though, it's not inherited by a class that extends gamerules. So we had to go and get the GameReplicationInfo from somewhere. (I think that the way we're doing it here is actually about the worst way you could do it, but I couldn't find any clue on how to do it another way. -Josh)<br><pre class="uscript"><span class="uscript-keyword">for</span><span class="uscript-operator">(</span>i<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span> i<span class="uscript-operator">&lt;</span>Player<span class="uscript-operator">.</span>GameReplicationInfo<span class="uscript-operator">.</span>PRIArray<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">;</span> i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
    myPRI <span class="uscript-operator">=</span> Player<span class="uscript-operator">.</span>GameReplicationInfo<span class="uscript-operator">.</span>PRIArray<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">;</span>

    <span class="uscript-comment">// Spectators/mutant can't be BF</span>
    <span class="uscript-keyword">if</span><span class="uscript-operator">(</span> myPRI<span class="uscript-operator">.</span>bOnlySpectator <span class="uscript-operator">)</span> <span class="uscript-comment">//|| (CurrentMutant != None &amp;&amp; myPRI == CurrentMutant.PlayerReplicationInfo) )</span>
        <span class="uscript-keyword">continue</span><span class="uscript-operator">;</span>

    <span class="uscript-keyword">if</span><span class="uscript-operator">(</span>CurrentBottomFeeder <span class="uscript-operator">==</span> <span class="uscript-keyword">None</span><span class="uscript-operator">)</span>
        CurrentBottomFeeder <span class="uscript-operator">=</span> Controller<span class="uscript-operator">(</span>myPRI<span class="uscript-operator">.</span>Owner<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    <span class="uscript-keyword">else</span>
    <span class="uscript-operator">{</span>
        <span class="uscript-comment">// Compare current BF with this PRI. If its worse, make it the new BF.</span>
        <span class="uscript-keyword">if</span><span class="uscript-operator">(</span> ComparePRI<span class="uscript-operator">(</span>CurrentBottomFeeder<span class="uscript-operator">.</span>PlayerReplicationInfo<span class="uscript-operator">,</span> myPRI<span class="uscript-operator">)</span> <span class="uscript-operator">&gt;</span> <span class="uscript-number">0</span> <span class="uscript-operator">)</span>
            CurrentBottomFeeder <span class="uscript-operator">=</span> Controller<span class="uscript-operator">(</span>myPRI<span class="uscript-operator">.</span>Owner<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>
<span class="uscript-operator">}</span></pre><br>There's really nothing terribly complex about this either. It loops through all available players, makes sure that they're a valid potential Bottom Feeder, (IE, not a spectator. In Mutant, there were other ways of not being a valid candidate for Bottom Feeder, but all we care about is that they're not a spectator.) sets them to the bottom feeder automatically if there isn't currently a bottom feeder, or compares the current player represented by the iteration of the loop to the bottom feeder (if there is a bottom feeder.), and sets whichever is worse to be the new bottom feeder. (Although, if the player who WAS the bottom feeder, is still worse, the bottom feeder doesn't actually appear to change.)</dd></dl>
<h4><a name="0.0.4.3"></a>VampShopper_Inter.uc:</h4>
<div class="classpath"><a href="interactions.html">Interactions</a> &gt;&gt; <a href="interaction.html">Interaction</a> &gt;&gt; <a href="console.html">Console</a> &gt;&gt; VampShopper_Inter<br></div>
<p>This file gets and gives activity from the hud and key inputs. (When the player asks for a redeemer, give it to them!)<br>Spawns shopping hud, and 2ndary deathmatch hud.<br>"Bleh" is needed to override the gun that's spawned on the shopping hud. (Otherwise it ends up in the wrong place when the menu is open.)<br>If buymode is true, than each render cycle will know that it should be displaying a buy menu of some sort or the other.</p>
<p>Extends off console(Which in turn extends off interaction). Handles all key interactions from the player, and controlls the Shopping Menus. Consists of very few function. </p>
<dl><dt>Initialized()</dt><dd>This gets run when the file is first accessed. Instantiates the ShoppingHUD(this caused another gun to render over the weapons bar from the base HUD, I'm not sure why), and a 2nd DeathMatchHud(To override the Gun from the Shopping HUD).</dd><dt>PostRender()</dt><dd>This calls the render functions on each of the HUDs instantiated by the Initialized function. Also turns some elements that conflict off on the 2nd DM HUD.</dd><dt>BuyWeapon()</dt><dd>Custom Function, called whenver a player buys a weapon. Checks to see if the player has the weapon, and if they have enough adrenaline to buy it. If both check out, it awars the player the weapon, and deducts the cost of it from the player's adrenaline. If they do not, it throws an error out to the client.<br><pre class="uscript"><span class="uscript-keyword">function</span> BuyWeapon<span class="uscript-operator">(</span><span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>weapon<span class="uscript-operator">&gt;</span> Weapon<span class="uscript-operator">,</span><span class="uscript-type">int</span> cost<span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
    <span class="uscript-comment">//Checks to see if the player already has the weapon</span>
    <span class="uscript-keyword">if</span><span class="uscript-operator">(</span>ViewPortOwner<span class="uscript-operator">.</span>Actor<span class="uscript-operator">.</span>Pawn<span class="uscript-operator">.</span>findInventorytype<span class="uscript-operator">(</span>Weapon<span class="uscript-operator">)</span> <span class="uscript-operator">!=</span> <span class="uscript-keyword">none</span><span class="uscript-operator">)</span>
           <span class="uscript-operator">{</span>
           ViewportOwner<span class="uscript-operator">.</span>Actor<span class="uscript-operator">.</span>ClientMessage<span class="uscript-operator">(</span><span class="uscript-string">"You Already have this weapon."</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
           <span class="uscript-operator">}</span>
    <span class="uscript-comment">//Checks to see if the player has enough adrenaline to buy the weapon</span>
           <span class="uscript-keyword">else</span> <span class="uscript-keyword">if</span><span class="uscript-operator">(</span>ViewportOwner<span class="uscript-operator">.</span>Actor<span class="uscript-operator">.</span>Adrenaline <span class="uscript-operator">&gt;=</span> cost<span class="uscript-operator">)</span>
           <span class="uscript-operator">{</span>
           <span class="uscript-comment">//Spawn the weapon, and give it to the player.</span>
            W <span class="uscript-operator">=</span> ViewportOwner<span class="uscript-operator">.</span>Actor<span class="uscript-operator">.</span>Pawn<span class="uscript-operator">.</span>Spawn<span class="uscript-operator">(</span>Weapon<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
            W<span class="uscript-operator">.</span>GiveTo<span class="uscript-operator">(</span>ViewPortOwner<span class="uscript-operator">.</span>Actor<span class="uscript-operator">.</span>Pawn<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
            <span class="uscript-comment">//Turn buyMode off, and turn all menus off</span>
            BuyMode <span class="uscript-operator">=</span> <span class="uscript-keyword">false</span><span class="uscript-operator">;</span>
            BuyMenu <span class="uscript-operator">=</span> <span class="uscript-number">0</span><span class="uscript-operator">;</span>
            BuyHUD<span class="uscript-operator">.</span>BuyHUDOn3 <span class="uscript-operator">=</span> <span class="uscript-keyword">false</span><span class="uscript-operator">;</span>
            BuyHUD<span class="uscript-operator">.</span>BuyHUDOn2 <span class="uscript-operator">=</span> <span class="uscript-keyword">false</span><span class="uscript-operator">;</span>
            <span class="uscript-comment">//Deduct Adrenaline</span>
           ViewportOwner<span class="uscript-operator">.</span>Actor<span class="uscript-operator">.</span>Adrenaline <span class="uscript-operator">-=</span> cost<span class="uscript-operator">;</span>
           <span class="uscript-operator">}</span>
           <span class="uscript-keyword">else</span>
           <span class="uscript-operator">{</span>
           <span class="uscript-comment">//toss an error if you don't have enough adrenaline</span>
           ViewportOwner<span class="uscript-operator">.</span>Actor<span class="uscript-operator">.</span>ClientMessage<span class="uscript-operator">(</span><span class="uscript-string">"You do not have the Adrenaline Required"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
           <span class="uscript-operator">}</span>
<span class="uscript-operator">}</span></pre></dd><dt>SellWeapon()</dt><dd>Custom Function, called whenever a player wants to sell a weapon. Checks to see if the player actually has the weapon they are trying to sell. If they do, it destroys the weapon, and awards the appropriate amount of adrenaline.<br><pre class="uscript"><span class="uscript-keyword">function</span> SellWeapon<span class="uscript-operator">(</span><span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>weapon<span class="uscript-operator">&gt;</span> Weapon<span class="uscript-operator">,</span><span class="uscript-type">int</span> worth<span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
    <span class="uscript-comment">//Checks to make sure the player actually has the weapon they are trying to sell</span>
    <span class="uscript-keyword">if</span><span class="uscript-operator">(</span>ViewPortOwner<span class="uscript-operator">.</span>Actor<span class="uscript-operator">.</span>Pawn<span class="uscript-operator">.</span>findInventorytype<span class="uscript-operator">(</span>Weapon<span class="uscript-operator">)</span> <span class="uscript-operator">!=</span> <span class="uscript-keyword">none</span><span class="uscript-operator">)</span>
    <span class="uscript-operator">{</span>
           <span class="uscript-comment">//Assigns the weapon in the inventory to a variable, and destroy it</span>
           W <span class="uscript-operator">=</span> Weapon<span class="uscript-operator">(</span>ViewportOwner<span class="uscript-operator">.</span>Actor<span class="uscript-operator">.</span>Pawn<span class="uscript-operator">.</span>findInventorytype<span class="uscript-operator">(</span>Weapon<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
           W<span class="uscript-operator">.</span>Destroy<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
           <span class="uscript-comment">//Exit buy mode</span>
           ViewportOwner<span class="uscript-operator">.</span>Actor<span class="uscript-operator">.</span>PrevWeapon<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
           BuyMode <span class="uscript-operator">=</span> <span class="uscript-keyword">false</span><span class="uscript-operator">;</span>
           BuyMenu <span class="uscript-operator">=</span> <span class="uscript-number">0</span><span class="uscript-operator">;</span>
           BuyHUD<span class="uscript-operator">.</span>BuyHUDOn3 <span class="uscript-operator">=</span> <span class="uscript-keyword">false</span><span class="uscript-operator">;</span>
           BuyHUD<span class="uscript-operator">.</span>BuyHUDOn1 <span class="uscript-operator">=</span> <span class="uscript-keyword">false</span><span class="uscript-operator">;</span>
           <span class="uscript-comment">//Award Adrenaline</span>
           ViewportOwner<span class="uscript-operator">.</span>Actor<span class="uscript-operator">.</span>Adrenaline <span class="uscript-operator">+=</span> worth<span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>
    <span class="uscript-keyword">else</span>
    <span class="uscript-operator">{</span>
    <span class="uscript-comment">//Error message incase they don't have the weapon they are trying to sell.</span>
           ViewportOwner<span class="uscript-operator">.</span>Actor<span class="uscript-operator">.</span>ClientMessage<span class="uscript-operator">(</span><span class="uscript-string">"You do not have that weapon"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>
<span class="uscript-operator">}</span></pre> </dd><dt>BuyPowerup()</dt><dd>Custom Function, called whenever a player tries to purchase a powerup, does basiclly the same thing as BuyWeapon.<br><pre class="uscript"><span class="uscript-keyword">function</span> BuyPowerup<span class="uscript-operator">(</span><span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>Pickup<span class="uscript-operator">&gt;</span> PowerUp<span class="uscript-operator">,</span><span class="uscript-type">int</span> cost<span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
<span class="uscript-comment">//Checking to see if the player has enough adrenaline to buy this.</span>
    <span class="uscript-keyword">if</span><span class="uscript-operator">(</span>ViewportOwner<span class="uscript-operator">.</span>Actor<span class="uscript-operator">.</span>Adrenaline <span class="uscript-operator">&gt;=</span> cost<span class="uscript-operator">)</span>
    <span class="uscript-operator">{</span>
           <span class="uscript-comment">//Same as weapon, however this spawns in the same location as all other pickups on the map(see the main mutator file)</span>
           P <span class="uscript-operator">=</span> ViewportOwner<span class="uscript-operator">.</span>Actor<span class="uscript-operator">.</span>Pawn<span class="uscript-operator">.</span>Spawn<span class="uscript-operator">(</span>PowerUp<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
           <span class="uscript-comment">//So we have to set it's location to the player's location</span>
           P<span class="uscript-operator">.</span>SetLocation<span class="uscript-operator">(</span>ViewportOwner<span class="uscript-operator">.</span>Actor<span class="uscript-operator">.</span>Pawn<span class="uscript-operator">.</span>Location<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
           <span class="uscript-comment">//And run the touch function on the PickUP</span>
           P<span class="uscript-operator">.</span>Touch<span class="uscript-operator">(</span>ViewportOwner<span class="uscript-operator">.</span>Actor<span class="uscript-operator">.</span>Pawn<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
           <span class="uscript-comment">//Then Destroy the pickup to keep it from respawning</span>
           P<span class="uscript-operator">.</span>Destroy<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
           <span class="uscript-comment">//And Turn BuyMOde off</span>
           BuyMode <span class="uscript-operator">=</span> <span class="uscript-keyword">false</span><span class="uscript-operator">;</span>
           BuyMenu <span class="uscript-operator">=</span> <span class="uscript-number">0</span><span class="uscript-operator">;</span>
           BuyHUD<span class="uscript-operator">.</span>BuyHUDOn3 <span class="uscript-operator">=</span> <span class="uscript-keyword">false</span><span class="uscript-operator">;</span>
           BuyHUD<span class="uscript-operator">.</span>BuyHUDOn <span class="uscript-operator">=</span> <span class="uscript-keyword">false</span><span class="uscript-operator">;</span>
           <span class="uscript-comment">//And Deduct the adrenaline cost.</span>
           ViewportOwner<span class="uscript-operator">.</span>Actor<span class="uscript-operator">.</span>Adrenaline <span class="uscript-operator">-=</span> cost<span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>
    <span class="uscript-keyword">else</span>
    <span class="uscript-operator">{</span>
    ViewportOwner<span class="uscript-operator">.</span>Actor<span class="uscript-operator">.</span>ClientMessage<span class="uscript-operator">(</span><span class="uscript-string">"You do not have enough Adrenaline"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>
<span class="uscript-operator">}</span></pre></dd><dt>KeyEvent()</dt><dd>Built in function of the Interaction class. Handles all inputs from the keyboard. Toggles switches on the instaniated version of ShoppingHUD. This causes ShoppingHUD to make certain menus visible/invisible each time PostRender() is called. Calles bIgnoreKeys to check and see if any of the keys pressed are relevant to the menu system(Escape, and 1-8 num keys). If true, it continues down the function. If false, it throws back to the inbedded key rendering system. The rest of the function is only conserned with handling changes in the menu system. Changing menus, buying/selling weapons and powerups. All this is commented in the file for more detail.</dd></dl>
<h4><a name="0.0.4.4"></a>ShoppingHUD.uc:</h4>
<div class="classpath">Hud<a href="http://wiki.beyondunreal.com/wiki?action=edit&id=Hud&referrerid=VampireShoppers">?</a> &gt;&gt; <a href="hudbase.html">HudBase</a> &gt;&gt; HudBDeathMatch<a href="http://wiki.beyondunreal.com/wiki?action=edit&id=HudBDeathMatch&referrerid=VampireShoppers">?</a> &gt;&gt; ShoppingHUD<br></div>
<p>This file controls the HUD used for buying things.<br>There's a bool for each menu that could potentially be displayed. If it's true, render the menu it's related to.<br>Hud is "always on" just not visible until VampShopper_Inter.uc tells it to display something.</p>
<p>Controlls all the displaying of the Shopping Menus. Each menu has a bool applied to it, that controls if that menu should be Rendered or not. Also has 4 draw passes, DrawHudPassA, DrawHudPassB, DrawHudPassC, and DrawHudPassD. These draw the hud to the canvas, however I'm not entirely sure if/why all 4 of them are needed. This file also contains the pricing information that can be set by the user. Those variables are listed in the section below the booleans.</p>
<dl><dt>bool BuyHUD3</dt><dd>The base HUD, Allows client to select the Buy Weapon, Sell Weapon, or Buy Powerup menu.</dd><dt>bool BuyHUD3On</dt><dd>Tells the DrawHUD passes to make the base HUD menu visible, or invisible.</dd><dt>bool BuyHUD2</dt><dd>The BuyWeapon HUD, Allows client buy weapons.</dd><dt>bool BuyHUD2On</dt><dd>Tells the DrawHUD passes to make the BuyWeapon HUD menu visible, or invisible.</dd><dt>bool BuyHUD1</dt><dd>The SellWeapon HUD, Allows client sell weapons.</dd><dt>bool BuyHUD1On</dt><dd>Tells the DrawHUD passes to make the SellWeapon HUD menu visible, or invisible.</dd><dt>bool BuyHUD</dt><dd>The BuyPowerup HUD, Allows client buy powerups.</dd><dt>bool BuyHUDOn</dt><dd>Tells the DrawHUD passes to make the BuyPowerup HUD menu visible, or invisible.</dd></dl>
<h4><a name="0.0.4.5"></a>Weapon Price Variables</h4>
<dl><dt>int CostWeapon_Bio</dt><dd>Holds BioRifle price.</dd><dt>int CostWeapon_Link</dt><dd>Holds Linkgun price.</dd><dt>int CostWeapon_Shock</dt><dd>Holds ShockRifle price.</dd><dt>int CostWeapon_Mini</dt><dd>Holds Minigun price.</dd><dt>int CostWeapon_Flak</dt><dd>Holds FlakCannon price.</dd><dt>int CostWeapon_Sniper</dt><dd>Holds SniperRifle price.</dd><dt>int CostWeapon_Rocket</dt><dd>Holds RocketLauncher price.</dd><dt>int CostWeapon_Redeemer</dt><dd>Holds Redeemer price.</dd></dl>
<h4><a name="0.0.4.6"></a>PowerUp Price Variables</h4>
<dl><dt>int CostPowerUp_MiniHealth</dt><dd>Holds MiniHealthPack price.</dd><dt>int CostPowerUp_Health</dt><dd>Holds HealthPack price. </dd><dt>int CostPowerUp_SuperHealth</dt><dd>Holds SuperHealthPack price.</dd><dt>int CostPowerUp_Shield</dt><dd>Holds ShieldPack price.</dd><dt>int CostPowerUp_SuperShield</dt><dd>Holds SuperShieldPack price.</dd><dt>int CostPowerUp_DoubleDam</dt><dd>Holds DoubleDamage price.</dd></dl>
<hr class="thin"><h3><a name="0.0.5"></a>Concepts we learned, or that are worth noting.</h3>
<hr class="thin"><h3><a name="0.0.6"></a>Things we still are trying to do:</h3>
<ul><li>Make a mutator options menu. (Josh will work on.. But probably not in time for the project due date. It'd be a great feature, but.. Ah, to be using CVS. -Josh)</li>
<li>Ok all done,The last track with the bottom feeder, ended up working. Also I just had to drop a resolution calculation into my drawtext calls to adjust their position. </li>
<li>final version is up for download. Will post full source of each file(all heavily commented), and make revisions to the page tommarow. -Antone</li>
</ul>
<h2><a name="0.1"></a>Discussion</h2>
<p><em class="em2">SuperApe:</em> I have no idea how old this page is or if it is still in development.  Can we get an update (with a date)?</p>
<hr class="thin"><p><a href="category-custom-class.html">Category Custom Class</a></p>
<p><a href="category-tutorial.html">Category Tutorial</a></p>
<script type="text/javascript"><!--
 menuItemAdd("Vampire Shoppers Tutorial:  (IN DEVELOPMENT)", "#0.0.1");
menuItemAdd("Some terminology", "#0.0.2");
menuItemAdd("Where we started, two lonely mutators", "#0.0.3");
menuItemAdd("Now for some depth, a look at each file and it's methods:", "#0.0.4");
menuItemAdd("<tt>&nbsp;&nbsp;</tt>MutVampShopper.uc:", "#0.0.4.1");
menuItemAdd("<tt>&nbsp;&nbsp;</tt>VampShopper_Rules.uc:", "#0.0.4.2");
menuItemAdd("<tt>&nbsp;&nbsp;</tt>VampShopper_Inter.uc:", "#0.0.4.3");
menuItemAdd("<tt>&nbsp;&nbsp;</tt>ShoppingHUD.uc:", "#0.0.4.4");
menuItemAdd("<tt>&nbsp;&nbsp;</tt>Weapon Price Variables", "#0.0.4.5");
menuItemAdd("<tt>&nbsp;&nbsp;</tt>PowerUp Price Variables", "#0.0.4.6");
menuItemAdd("Concepts we learned, or that are worth noting.", "#0.0.5");
menuItemAdd("Things we still are trying to do:", "#0.0.6");
menuItemAdd("Discussion", "#0.1");
 menuWrite() //--></script></div>
</div>

<div id="footer" class="bar">
	<p>
<a href="../index.html">Home Page</a> | <a href="recent-changes.html">Recent Changes</a><br>
Last edited December 2, 2005 20:37 <a href="http://wiki.beyondunreal.com/wiki?action=browse&diff=1&id=VampireShoppers">(diff)</a><br>Search: <input type="text" name="search"  size="14" /><input type="button" onclick="location.href='../search-error/index.html';" value="search" /><br><br><small><a href="http://wiki.beyondunreal.com/wiki/VampireShoppers">Original page</a> &#150; copy created Sat, Jun 23, 2007</small><div></div>

	</p>
	<p>I don't need to test my programs. I have an error-correcting modem.
</p>
</div>
</div><!-- close of "scrolling" div -->

<div id="quickbar">
	<div id="logo"><a href="../index.html"><img src="shared/wikilogo.jpg" width="143" height="100" border="0"></a>
		</div>
	<div class="qbsitename">
		<p>The Unreal Engine Documentation Site</p>
	</div>
	<div class="qbsection">
<p><a href="metatopics.html">Wiki Community</a></p>
<p><a href="category-category.html">Topic Categories</a></p>


<p><a href="recent-changes.html">Recent Changes</a></p>
<p><a href="offline-wiki.html">Offline Wiki</a></p>
</div><div class="qbsection">
<p><a href="unreal-engine.html">Unreal Engine</a></p>
<p><a href="console-commands.html">Console Commands</a></p>
<p><a href="terminology.html">Terminology</a></p>
<p><a href="category-faq.html">FAQs</a></p>
<p><a href="help-desk.html">Help Desk</a></p>
</div><div class="qbsection">
<p><a href="topics-on-mapping.html">Mapping Topics</a></p>
<p><a href="mapping-lessons.html">Mapping Lessons</a></p>
<p><a href="unrealed-3.html">UnrealEd Interface</a></p>
</div><div class="qbsection">
<p><a href="unrealscript.html">UnrealScript Topics</a></p>
<p><a href="unrealscript-lessons.html">UnrealScript Lessons</a></p>
<p><a href="making-mods.html">Making Mods</a></p>
<p><a href="class-tree.html">Class Tree</a></p>
</div><div class="qbsection">
<p><a href="topics-on-modeling.html">Modeling Topics</a></p>
</div><div class="qbsection">
<p><a href="chongqing-page.html">Chongqing Page</a></p>
<p><a href="log-in.html">Log In</a></p></div>
</div>

</body></html>
