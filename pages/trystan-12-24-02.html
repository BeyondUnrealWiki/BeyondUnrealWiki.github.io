<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"  "http://www.w3.org/TR/html4/loose.dtd">

<html>
<head lang="en">
	<title>UnrealWiki: Trystan/12 24 02</title>
	<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
	<link rel="stylesheet" type="text/css" media="screen, print"
		href="shared/stylebase.structural.css">	
	<link rel="stylesheet" type="text/css" media="screen"
		href="shared/template-default.css">
	<link rel="stylesheet" type="text/css" media="screen"
		href="shared/styles.chblue.css">
	<link rel="stylesheet" type="text/css" media="print"
		href="shared/template-default-print.css">
	<!--[if IE 6]>
			<style>
			/* dirty hack for IE6. */
			#quickbar {
				position: absolute;
				}
			</style>
	<![endif]-->
  <link rel="start" href="http://wiki.beyondunreal.com/">
  <link rel="glossary"  href="http://wiki.beyondunreal.com/wiki/Terminology">
  <link rel="help"  href="http://wiki.beyondunreal.com/wiki/Using_The_Wiki">
<script type="text/javascript" src="shared/dhtml.js"></script>
<script type="text/javascript" src="shared/dhtml-menu.js"></script>
<style type="text/css">#dhtml-menu    { background: #eee; padding: 5px 0px; margin-right: -20px; border: 1px solid #888; border-left: 1px solid #ccc; border-top: 1px solid #ccc;  border-right: 1px solid #888; border-bottom: 1px solid #888 }
#dhtml-menu td { color: #000; font-family: Arial,Helvetica,sans-serif; font-size: 9pt; line-height: 13pt; padding: 1px 10px; cursor: default }
#dhtml-menu a  { color: #000; font-family: Arial,Helvetica,sans-serif; font-size: 9pt; line-height: 13pt; text-decoration: none }
#dhtml-menu tt { font-family: monospace; font-size: 9pt }
#dhtml-menu-separator { height: 1px; background: red }
#dhtml-menu-anchor { cursor: default }
</style>
<script type="text/javascript" src="shared/expandable.js"></script>
</head>
<body onLoad="menuInit(); document.cookie='page=Trystan/12_24_02; path=/'" class="default">
<div id="scrolling"><!-- contains all except the fixed sidebar -->
<div id="topbar"  class="bar">
	<div class="righthalf">
		<form class="inline" method="post" action="/wiki" enctype="application/x-www-form-urlencoded"><input type="text" name="search"  size="20" /> <input type="submit" name="search" value="search" /></form>
	</div>
	<div class="lefthalf">
		<script type="text/javascript"><!--
			menuAlignRight = false;
		//--></script>
		<span><script type="text/javascript"><!--
 menuWriteAnchor("Quick Navigation") //--></script></span> | <a href="../index.html">Home Page</a> | <a href="recent-changes.html">Recent Changes</a>
	</div>
</div>

<div id="content"><!-- contains the title and article -->
	<h1 class='pagetitle'><a href="trystan.html">Trystan</a>/<a href="http://wiki.beyondunreal.com/wiki?back=Trystan/12+24+02">12 24 02</a></h1>
	<div class="wiki"><h2><a name="0.1"></a>Custom Gametype</h2>
<p>Not satisfied with mutators and want to make your own game type eh?  Well, first off, a note.  This page will be under an unusual amount of construction for me - and will be updated over the course of a long time as I don't believe I currently have a complete grasp on what constitutes a full game type.  This will be my attempt at categorizing the fleeting thoughts in my head into one.</p>
<h3><a name="0.1.1"></a>Map List Class</h3>
<pre class="uscript"><span class="uscript-keyword">class</span> MapListModName <span class="uscript-keyword">extends</span> MapList
    <span class="uscript-keyword">config</span><span class="uscript-operator">;</span></pre><p>Mine's based off xInterface.MapListTeamDeathMatch.  This class primarily figures into the int file.  Speaking of that..</p>
<h3><a name="0.1.2"></a>ModName.int</h3>
<pre class="uscript"><span class="uscript-operator">[</span>Public<span class="uscript-operator">]</span>
Object<span class="uscript-operator">=</span><span class="uscript-operator">(</span><span class="uscript-keyword">Class</span><span class="uscript-operator">=</span><span class="uscript-keyword">Class</span><span class="uscript-operator">,</span>MetaClass<span class="uscript-operator">=</span>Engine<span class="uscript-operator">.</span>GameInfo<span class="uscript-operator">,</span><span class="uscript-type">Name</span><span class="uscript-operator">=</span>MyPackage<span class="uscript-operator">.</span>MyGame<span class="uscript-operator">,</span>Description<span class="uscript-operator">=</span><span class="uscript-string">"XxX|My Game Name|xinterface.Tab_IADeathMatch|MyPackage.MapListModName|false"</span><span class="uscript-operator">)</span>
Preferences<span class="uscript-operator">=</span><span class="uscript-operator">(</span>Caption<span class="uscript-operator">=</span><span class="uscript-string">"My Game Name"</span><span class="uscript-operator">,</span>Parent<span class="uscript-operator">=</span><span class="uscript-string">"Game Types"</span><span class="uscript-operator">,</span><span class="uscript-keyword">Class</span><span class="uscript-operator">=</span>MyPackage<span class="uscript-operator">.</span>MyGame<span class="uscript-operator">,</span>Immediate<span class="uscript-operator">=</span><span class="uscript-keyword">True</span><span class="uscript-operator">)</span>
GameName<span class="uscript-operator">=</span><span class="uscript-string">"World at War"</span></pre><h3><a name="0.1.3"></a>xInterface.Tab_IADeathMatch</h3>
<p>Yea, we'll need to replace that at some point as well.</p>
<h3><a name="0.1.4"></a>MyPackage.MyGame</h3>
<pre class="uscript"><span class="uscript-keyword">class</span> MyGame <span class="uscript-keyword">extends</span> TeamGame
    <span class="uscript-keyword">config</span><span class="uscript-operator">;</span>

<span class="uscript-comment">// Do stuff specific to your mod prior to play starting here.</span>
<span class="uscript-keyword">function</span> PostBeginPlay<span class="uscript-operator">(</span><span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
    <span class="uscript-keyword">Super</span><span class="uscript-operator">.</span>PostBeginPlay<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-operator">}</span>

<span class="uscript-comment">// Called before players log out.  Drop inventory, guns, etc.</span>
<span class="uscript-keyword">function</span> Logout<span class="uscript-operator">(</span> Controller Exiting <span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
    <span class="uscript-keyword">Super</span><span class="uscript-operator">.</span>Logout<span class="uscript-operator">(</span> Exiting <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-operator">}</span>

<span class="uscript-comment">// Check end of game situations here.</span>
<span class="uscript-keyword">function</span> <span class="uscript-type">bool</span> CheckEndGame<span class="uscript-operator">(</span> PlayerReplicationInfo Winner<span class="uscript-operator">,</span> <span class="uscript-type">string</span> Reason <span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
    <span class="uscript-keyword">return</span> <span class="uscript-keyword">Super</span><span class="uscript-operator">.</span>CheckEndGame<span class="uscript-operator">(</span> Winner<span class="uscript-operator">,</span> Reason <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-operator">}</span>

<span class="uscript-comment">// This function decides if we can change teams from what I can tell.</span>
<span class="uscript-comment">// It does -not- do the actual team change.  That seems to be processed</span>
<span class="uscript-comment">// in the player class.  Removal of this function results in an</span>
<span class="uscript-comment">// error on startup of the game type if the game type is team based --</span>
<span class="uscript-comment">// this function's existence in the parent class doesn't seem to matter?</span>
<span class="uscript-keyword">function</span> <span class="uscript-type">bool</span> ChangeTeam<span class="uscript-operator">(</span>Controller Other<span class="uscript-operator">,</span> <span class="uscript-type">int</span> N<span class="uscript-operator">,</span> <span class="uscript-type">bool</span> bNewTeam<span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
    <span class="uscript-keyword">return</span> <span class="uscript-keyword">true</span><span class="uscript-operator">;</span>
<span class="uscript-operator">}</span>

<span class="uscript-comment">// TODO:  Create our own AI routines and replace below.</span>
<span class="uscript-keyword">defaultproperties</span>
<span class="uscript-operator">{</span>
    bAllowTrans                 <span class="uscript-operator">=</span>   <span class="uscript-keyword">true</span>
    bSpawnInTeamArea            <span class="uscript-operator">=</span>   <span class="uscript-keyword">false</span>
    bScoreTeamKills             <span class="uscript-operator">=</span>   <span class="uscript-keyword">false</span>
    bWeaponStay                 <span class="uscript-operator">=</span>   <span class="uscript-keyword">true</span>

    GoalScore                   <span class="uscript-operator">=</span>   <span class="uscript-number">3</span>

    TeamAIType<span class="uscript-operator">(</span><span class="uscript-number">0</span><span class="uscript-operator">)</span>               <span class="uscript-operator">=</span>   <span class="uscript-keyword">class</span><span class="uscript-name">'MyPackage.MyTeamAI'</span>
    TeamAIType<span class="uscript-operator">(</span><span class="uscript-number">1</span><span class="uscript-operator">)</span>               <span class="uscript-operator">=</span>   <span class="uscript-keyword">class</span><span class="uscript-name">'MyPackage.MyTeamAI'</span>

    bScoreVictimsTarget         <span class="uscript-operator">=</span>   <span class="uscript-keyword">true</span>
    ADR_Kill                    <span class="uscript-operator">=</span>   <span class="uscript-number">2.0</span>

    BeaconName                  <span class="uscript-operator">=</span>   <span class="uscript-string">"XxX"</span>
    MapPrefix                   <span class="uscript-operator">=</span>   <span class="uscript-string">"XxX"</span>
    GameName                    <span class="uscript-operator">=</span>   <span class="uscript-string">"My Game Name"</span>
    HUDType                     <span class="uscript-operator">=</span>   <span class="uscript-string">"MyPackage.MyHud"</span>
    PlayerControllerClassName   <span class="uscript-operator">=</span>   <span class="uscript-string">"MyPackage.MyPlayer"</span>
<span class="uscript-operator">}</span></pre><h3><a name="0.1.5"></a>MyPackage.MyHud</h3>
<p>Heads up display.  This will determine what's drawn on the screen and is one of the most heavily modified classes out there.  Mine's simple and sleek because it doesn't do squat.  Yet.</p>
<pre class="uscript"><span class="uscript-keyword">class</span> MyHud <span class="uscript-keyword">extends</span> HudBTeamDeathMatch<span class="uscript-operator">;</span>

<span class="uscript-exec">#exec OBJ LOAD FILE=MyTextures.utx</span>

<span class="uscript-keyword">var</span> texture FireMode<span class="uscript-operator">;</span>

<span class="uscript-keyword">function</span> DrawHud<span class="uscript-operator">(</span>Canvas c<span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
    <span class="uscript-keyword">local</span> color preColor<span class="uscript-operator">;</span>
    <span class="uscript-keyword">local</span> <span class="uscript-type">byte</span> preStyle<span class="uscript-operator">;</span>

    <span class="uscript-comment">// Store the current color and style variables.</span>
    preColor <span class="uscript-operator">=</span> c<span class="uscript-operator">.</span>DrawColor<span class="uscript-operator">;</span>
    preStyle <span class="uscript-operator">=</span> c<span class="uscript-operator">.</span>Style<span class="uscript-operator">;</span>

    <span class="uscript-comment">// We want to (generally) draw in white.</span>
    c<span class="uscript-operator">.</span>DrawColor <span class="uscript-operator">=</span> WhiteColor<span class="uscript-operator">;</span>
    c<span class="uscript-operator">.</span>Style <span class="uscript-operator">=</span> ERenderStyle<span class="uscript-operator">.</span>STY_Translucent<span class="uscript-operator">;</span>

    <span class="uscript-comment">// Draw the texture.</span>
    c<span class="uscript-operator">.</span>SetPos<span class="uscript-operator">(</span><span class="uscript-number">0</span><span class="uscript-operator">,</span> <span class="uscript-number">0</span> <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    c<span class="uscript-operator">.</span>DrawIcon<span class="uscript-operator">(</span> FireMode<span class="uscript-operator">,</span> <span class="uscript-number">1</span> <span class="uscript-operator">)</span><span class="uscript-operator">;</span>

    <span class="uscript-comment">// Restore prior color and style.</span>
    <span class="uscript-comment">// A lot like Windows GDI programming here..</span>

    c<span class="uscript-operator">.</span>DrawColor <span class="uscript-operator">=</span> preColor<span class="uscript-operator">;</span>
    c<span class="uscript-operator">.</span>Style <span class="uscript-operator">=</span> preStyle<span class="uscript-operator">;</span>

    <span class="uscript-keyword">Super</span><span class="uscript-operator">.</span>DrawHud<span class="uscript-operator">(</span> c <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-operator">}</span>

<span class="uscript-keyword">DefaultProperties</span>
<span class="uscript-operator">{</span>
<span class="uscript-operator">}</span></pre><h3><a name="0.1.6"></a>MyPackage.TeamAI</h3>
<p>Determines how bots work together in a team.  Again, mine's sparse - the point of this entry is not to do it for you, but to show you the parts that are necessary.</p>
<pre class="uscript"><span class="uscript-keyword">class</span> MyTeamAI <span class="uscript-keyword">extends</span> TeamAI<span class="uscript-operator">;</span>

<span class="uscript-keyword">defaultproperties</span>
<span class="uscript-operator">{</span>
     SquadType  <span class="uscript-operator">=</span>   <span class="uscript-keyword">Class</span><span class="uscript-name">'MyPackage.MySquadAI'</span>
<span class="uscript-operator">}</span></pre><h3><a name="0.1.7"></a>MyPackage.SquadAI</h3>
<p>Each team gets broken into squads - "I've got your back!" in UT2K3 for instance.  This file determines how the squads work together.</p>
<pre class="uscript"><span class="uscript-keyword">class</span> MySquadAI <span class="uscript-keyword">extends</span> SquadAI<span class="uscript-operator">;</span>

<span class="uscript-keyword">defaultproperties</span>
<span class="uscript-operator">{</span>
<span class="uscript-operator">}</span></pre><h3><a name="0.1.8"></a>MyPackage.MyPlayerController</h3>
<p>This determines your own custom controller class.  The guy running around in the game is a pawn - the person controlling the pawn controls it through the controller class.  This is a very important class.</p>
<pre class="uscript"><span class="uscript-comment">// All new functions (exec) should go here.  All interaction with</span>
<span class="uscript-comment">// the player's controls occur here.  Important class.</span>

<span class="uscript-keyword">class</span> MyPlayer <span class="uscript-keyword">extends</span> xPlayer<span class="uscript-operator">;</span>

<span class="uscript-keyword">exec</span> <span class="uscript-keyword">function</span> MyTest<span class="uscript-operator">(</span><span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
    Log<span class="uscript-operator">(</span><span class="uscript-string">"Function successfully called."</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-operator">}</span>

<span class="uscript-keyword">defaultproperties</span>
<span class="uscript-operator">{</span>
    PawnClass   <span class="uscript-operator">=</span>   <span class="uscript-keyword">Class</span><span class="uscript-name">'MyPackage.MyPawn'</span>
    InputClass  <span class="uscript-operator">=</span>   <span class="uscript-keyword">Class</span><span class="uscript-name">'MyPackage.MyPlayerInput'</span>
    PlayerReplicationInfoClass <span class="uscript-operator">=</span> <span class="uscript-keyword">Class</span><span class="uscript-name">'MyPackage.MyPlayerReplicationInfo'</span>
<span class="uscript-operator">}</span></pre><p><em class="em2">Mychaeel:</em> I don't see why it's important to subclass it though.</p>
<p><em class="em2">Wormbo:</em> It might not sound like good OOP, but if you already have a HUD subclass and only use the PlayerController class to add new exec functions, then you could as well use the HUD class for those and leave the PlayerController alone.</p>
<p><em class="em2">Trystan:</em> Where would you turn on your pawn and/or input class if you didn't subclass this?  And I don't know, it would seem more logical to me to leave new functions in the controller class - that's what it's for.  (Logical == OOP?  Hm, not always. <img alt="=)" src="emoticons/smile.gif" align="middle">)  I think subclassing this has caused me some grief though as I have a few access nones I simply can't track down that really shouldn't be happening.  Perhaps I'll find out how to create my pawn another way and try to remove this class from my hierarchy.  We also do subclass PlayerInput to disable dodging.</p>
<h3><a name="0.1.9"></a>MyPackage.MyPawn</h3>
<p>The pawn class determines how the player actually works in game.  It is controlled by the controller.</p>
<pre class="uscript"><span class="uscript-keyword">class</span> MyPawn <span class="uscript-keyword">extends</span> xPawn<span class="uscript-operator">;</span>

<span class="uscript-keyword">DefaultProperties</span>
<span class="uscript-operator">{</span>
   GroundSpeed<span class="uscript-operator">=</span><span class="uscript-number">350.000000</span>
   WaterSpeed<span class="uscript-operator">=</span><span class="uscript-number">210.000000</span>
   AirSpeed<span class="uscript-operator">=</span><span class="uscript-number">320.000000</span>
   JumpZ<span class="uscript-operator">=</span><span class="uscript-number">210.000000</span>
   AccelRate<span class="uscript-operator">=</span><span class="uscript-number">1024</span>
   WalkingPct<span class="uscript-operator">=</span><span class="uscript-number">0.60000</span>
   CrouchedPct<span class="uscript-operator">=</span><span class="uscript-number">0.45000</span>
   MaxFallSpeed<span class="uscript-operator">=</span><span class="uscript-number">665</span>

   MultiJumpRemaining<span class="uscript-operator">=</span><span class="uscript-number">0</span>
   MaxMultiJump<span class="uscript-operator">=</span><span class="uscript-number">0</span>
   MultiJumpBoost<span class="uscript-operator">=</span><span class="uscript-number">0</span>
   bCanDoubleJump<span class="uscript-operator">=</span><span class="uscript-keyword">False</span>
<span class="uscript-operator">}</span></pre><h3><a name="0.1.10"></a>MyPackage.MyPlayerInput</h3>
<p>Honestly there's not a lot for my mod to do in this class.  We've subclassed it for one basic reason:  to turn off dodging in the defaultproperties.  There's probably a hugely better way to do that but I haven't looked into it yet.</p>
<pre class="uscript"><span class="uscript-keyword">class</span> MyPlayerInput <span class="uscript-keyword">extends</span> PlayerInput<span class="uscript-operator">;</span>

<span class="uscript-keyword">defaultproperties</span>
<span class="uscript-operator">{</span>
    bEnableDodging  <span class="uscript-operator">=</span>   <span class="uscript-keyword">False</span>
<span class="uscript-operator">}</span></pre><h3><a name="0.1.11"></a>MyPackage.MyPlayerReplicationInfo</h3>
<p>PlayerReplicationInfo holds information specific to the players of your game.  This information is replicated to the network clients as needed.</p>
<pre class="uscript"><span class="uscript-keyword">class</span> MyPlayerReplicationInfo <span class="uscript-keyword">extends</span> PlayerReplicationInfo<span class="uscript-operator">;</span></pre><p>More to come.  Specifically more information on bots and their proper configuration.</p>
<script type="text/javascript"><!--
 menuItemAdd("Custom Gametype", "#0.1");
menuItemAdd("<tt>&nbsp;&nbsp;</tt>Map List Class", "#0.1.1");
menuItemAdd("<tt>&nbsp;&nbsp;</tt>ModName.int", "#0.1.2");
menuItemAdd("<tt>&nbsp;&nbsp;</tt>xInterface.Tab_IADeathMatch", "#0.1.3");
menuItemAdd("<tt>&nbsp;&nbsp;</tt>MyPackage.MyGame", "#0.1.4");
menuItemAdd("<tt>&nbsp;&nbsp;</tt>MyPackage.MyHud", "#0.1.5");
menuItemAdd("<tt>&nbsp;&nbsp;</tt>MyPackage.TeamAI", "#0.1.6");
menuItemAdd("<tt>&nbsp;&nbsp;</tt>MyPackage.SquadAI", "#0.1.7");
menuItemAdd("<tt>&nbsp;&nbsp;</tt>MyPackage.MyPlayerController", "#0.1.8");
menuItemAdd("<tt>&nbsp;&nbsp;</tt>MyPackage.MyPawn", "#0.1.9");
menuItemAdd("<tt>&nbsp;&nbsp;</tt>MyPackage.MyPlayerInput", "#0.1.10");
menuItemAdd("<tt>&nbsp;&nbsp;</tt>MyPackage.MyPlayerReplicationInfo", "#0.1.11");
 menuWrite() //--></script></div>
</div>

<div id="footer" class="bar">
	<p><form method="post" action="http://wiki.beyondunreal.com/wiki" enctype="application/x-www-form-urlencoded">
<a href="../index.html">Home Page</a> | <a href="trystan.html">Trystan</a> | <a href="recent-changes.html">Recent Changes</a><br>
Last edited December 27, 2002 16:24 <a href="http://wiki.beyondunreal.com/wiki?action=browse&diff=1&id=Trystan/12_24_02">(diff)</a><br>Search: <input type="text" name="search"  size="20" /><input type="hidden" name="dosearch" value="1"  /><br><br><small><a href="http://wiki.beyondunreal.com/wiki/Trystan/12_24_02">Original page</a> &#150; copy created Sat, Jun 23, 2007</small><div></div>
</form>
	</p>
	<p>Gah - a solution with more questions. (EntropicLqd)
</p>
</div>
</div><!-- close of "scrolling" div -->

<div id="quickbar">
	<div id="logo"><a href="../index.html"><img src="shared/wikilogo.jpg" width="143" height="100" border="0"></a>
		</div>
	<div class="qbsitename">
		<p>The Unreal Engine Documentation Site</p>
	</div>
	<div class="qbsection">
<p><a href="metatopics.html">Wiki Community</a></p>
<p><a href="category-category.html">Topic Categories</a></p>


<p><a href="recent-changes.html">Recent Changes</a></p>
<p><a href="offline-wiki.html">Offline Wiki</a></p>
</div><div class="qbsection">
<p><a href="unreal-engine.html">Unreal Engine</a></p>
<p><a href="console-commands.html">Console Commands</a></p>
<p><a href="terminology.html">Terminology</a></p>
<p><a href="category-faq.html">FAQs</a></p>
<p><a href="help-desk.html">Help Desk</a></p>
</div><div class="qbsection">
<p><a href="topics-on-mapping.html">Mapping Topics</a></p>
<p><a href="mapping-lessons.html">Mapping Lessons</a></p>
<p><a href="unrealed-3.html">UnrealEd Interface</a></p>
</div><div class="qbsection">
<p><a href="unrealscript.html">UnrealScript Topics</a></p>
<p><a href="unrealscript-lessons.html">UnrealScript Lessons</a></p>
<p><a href="making-mods.html">Making Mods</a></p>
<p><a href="class-tree.html">Class Tree</a></p>
</div><div class="qbsection">
<p><a href="topics-on-modeling.html">Modeling Topics</a></p>
</div><div class="qbsection">
<p><a href="chongqing-page.html">Chongqing Page</a></p>
<p><a href="log-in.html">Log In</a></p></div>
</div>

</body></html>
