<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"  "http://www.w3.org/TR/html4/loose.dtd">

<html>
<head lang="en">
	<title>UnrealWiki: MD5Hash</title>
	<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
	<link rel="stylesheet" type="text/css" media="screen, print"
		href="shared/stylebase.structural.css">	
	<link rel="stylesheet" type="text/css" media="screen"
		href="shared/template-default.css">
	<link rel="stylesheet" type="text/css" media="screen"
		href="shared/styles.chblue.css">
	<link rel="stylesheet" type="text/css" media="print"
		href="shared/template-default-print.css">
	<!--[if IE 6]>
			<style>
			/* dirty hack for IE6. */
			#quickbar {
				position: absolute;
				}
			</style>
	<![endif]-->
  <link rel="start" href="http://wiki.beyondunreal.com/">
  <link rel="glossary"  href="http://wiki.beyondunreal.com/wiki/Terminology">
  <link rel="help"  href="http://wiki.beyondunreal.com/wiki/Using_The_Wiki">
<script type="text/javascript" src="shared/dhtml.js"></script>
<script type="text/javascript" src="shared/dhtml-menu.js"></script>
<style type="text/css">#dhtml-menu    { background: #eee; padding: 5px 0px; margin-right: -20px; border: 1px solid #888; border-left: 1px solid #ccc; border-top: 1px solid #ccc;  border-right: 1px solid #888; border-bottom: 1px solid #888 }
#dhtml-menu td { color: #000; font-family: Arial,Helvetica,sans-serif; font-size: 9pt; line-height: 13pt; padding: 1px 10px; cursor: default }
#dhtml-menu a  { color: #000; font-family: Arial,Helvetica,sans-serif; font-size: 9pt; line-height: 13pt; text-decoration: none }
#dhtml-menu tt { font-family: monospace; font-size: 9pt }
#dhtml-menu-separator { height: 1px; background: red }
#dhtml-menu-anchor { cursor: default }
</style>
<script type="text/javascript" src="shared/expandable.js"></script>
</head>
<body onLoad="menuInit(); document.cookie='page=MD5Hash; path=/'" class="default">
<div id="scrolling"><!-- contains all except the fixed sidebar -->
<div id="topbar"  class="bar">
	<div class="righthalf">
		<form class="inline" method="post" action="/wiki" enctype="application/x-www-form-urlencoded"><input type="text" name="search"  size="20" /> <input type="submit" name="search" value="search" /></form>
	</div>
	<div class="lefthalf">
		<script type="text/javascript"><!--
			menuAlignRight = false;
		//--></script>
		<span><script type="text/javascript"><!--
 menuWriteAnchor("Quick Navigation") //--></script></span> | <a href="(start).html">Home Page</a> | <a href="recent-changes.html">Recent Changes</a> | <a href="http://wiki.beyondunreal.com/wiki?action=editprefs">Preferences</a>
	</div>
</div>

<div id="content"><!-- contains the title and article -->
	<h1 class='pagetitle'><a href="http://wiki.beyondunreal.com/wiki?back=MD5Hash">MD5Hash</a></h1>
	<div class="wiki"><div class="classpath"><a href="object.html">Object</a> &gt;&gt; MD5Hash (custom class)<br></div>
<p>A custom utility class for calculating <span class="interwiki"><img 
      alt="Wikipedia logo"
      title="Wikipedia"
      src="shared//InterWiki-Wikipedia.png">&nbsp;<a href="http://www.wikipedia.com/wiki/MD5">MD5</a></span> hashes of strings and dynamic byte arrays. It cannot be used in UnrealEngine1 games due to their lack of dynamic arrays.</p>
<p>This implementation is specially optimized for <a href="unrealscript.html">UnrealScript</a> and probably won't perform well when ported to Java, C/C++ or other languages. Important performance optimizations include the use of class-global variables and the lack of <tt>out</tt> parameters, because those are <em class="em1">not</em> "by reference" in UnrealScript!</p>
<p>Note that the bottle neck of this implementation &ndash; string to byte conversion &ndash; still is there and there's no real workaround for that yet. Passing large strings around takes some time, and they always need to be passed at least to the <tt>Mid()</tt> function.</p>
<h2><a name="0.1"></a>Usage</h2>
<p>For now the class can only be used statically:</p>
<pre class="uscript"><span class="uscript-keyword">local</span> <span class="uscript-keyword">array</span><span class="uscript-operator">&lt;</span><span class="uscript-type">byte</span><span class="uscript-operator">&gt;</span> SomeData<span class="uscript-operator">;</span>
<span class="uscript-keyword">local</span> <span class="uscript-type">string</span> Result<span class="uscript-operator">;</span>

<span class="uscript-comment">// fill SomeData with byte values</span>

Result <span class="uscript-operator">=</span> <span class="uscript-keyword">class</span><span class="uscript-name">'MD5Hash'</span><span class="uscript-operator">.</span><span class="uscript-keyword">static</span><span class="uscript-operator">.</span>GetArrayHashString<span class="uscript-operator">(</span>SomeData<span class="uscript-operator">)</span><span class="uscript-operator">;</span></pre><pre class="uscript"><span class="uscript-keyword">local</span> <span class="uscript-type">string</span> SomeData<span class="uscript-operator">;</span>
<span class="uscript-keyword">local</span> <span class="uscript-type">string</span> Result<span class="uscript-operator">;</span>

<span class="uscript-comment">// fill SomeData with a string</span>

Result <span class="uscript-operator">=</span> <span class="uscript-keyword">class</span><span class="uscript-name">'MD5Hash'</span><span class="uscript-operator">.</span><span class="uscript-keyword">static</span><span class="uscript-operator">.</span>GetStringHashString<span class="uscript-operator">(</span>SomeData<span class="uscript-operator">)</span><span class="uscript-operator">;</span></pre><p>A new version is being worked on that allows the programmer to create an instance of the class as "MD5 context" for more performance-friendly handling of more complex values.</p>
<h2><a name="0.2"></a>Methods</h2>
<h3><a name="0.2.1"></a>Static Methods</h3>
<dl><dt>GUID GetArrayHash(array&lt;byte&gt; InData)</dt><dd>Returns the MD5 hash of the specified byte array as a GUID.</dd><dt>string GetArrayHashString(array&lt;byte&gt; InData)</dt><dd>Returns the MD5 hash of the specified byte array as a string.</dd><dt>GUID GetStringHash(string InData)</dt><dd>Returns the MD5 hash of the specified string as a GUID.</dd><dt>string GetStringHashString(string InData)</dt><dd>Returns the MD5 hash of the specified string as a string.</dd><dt>string GetHashString(GUID Hash)</dt><dd>Returns the string representation of the MD5 hash.</dd><dt>string LittleEndianToHex(int i)</dt><dd>Returns the little endian string representation of the integer value.</dd></dl>
<h2><a name="0.3"></a>Code</h2>
<pre class="uscript"><span class="uscript-comment">/******************************************************************************
MD5 hash implementation for UnrealScript by Wormbo.
Feel free to modify and optimize for your needs.
******************************************************************************/</span>


<span class="uscript-keyword">class</span> MD5Hash <span class="uscript-keyword">extends</span> Object<span class="uscript-operator">;</span>


<span class="uscript-comment">/** @ignore */</span>
<span class="uscript-keyword">var</span> <span class="uscript-keyword">private</span> <span class="uscript-keyword">GUID</span> StaticHashValue<span class="uscript-operator">;</span>
<span class="uscript-comment">/** @ignore */</span>
<span class="uscript-keyword">var</span> <span class="uscript-keyword">private</span> <span class="uscript-keyword">array</span><span class="uscript-operator">&lt;</span><span class="uscript-type">byte</span><span class="uscript-operator">&gt;</span> StaticData<span class="uscript-operator">;</span>


<span class="uscript-comment">//=============================================================================</span>
<span class="uscript-comment">// Instant hash functions - probably not suitable for long input data</span>
<span class="uscript-comment">//=============================================================================</span>

<span class="uscript-keyword">static</span> <span class="uscript-keyword">final</span> <span class="uscript-keyword">function</span> <span class="uscript-keyword">GUID</span> GetStringHash<span class="uscript-operator">(</span><span class="uscript-type">string</span> In<span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
  <span class="uscript-keyword">local</span> <span class="uscript-type">int</span> StrLen<span class="uscript-operator">,</span> i<span class="uscript-operator">;</span>
  
  StrLen <span class="uscript-operator">=</span> Len<span class="uscript-operator">(</span>In<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
  <span class="uscript-keyword">default</span><span class="uscript-operator">.</span>StaticData<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span> <span class="uscript-operator">=</span> StrLen<span class="uscript-operator">;</span>
  <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i <span class="uscript-operator">=</span> <span class="uscript-number">0</span><span class="uscript-operator">;</span> i <span class="uscript-operator">&lt;</span> StrLen<span class="uscript-operator">;</span> i<span class="uscript-operator">++</span><span class="uscript-operator">)</span> <span class="uscript-operator">{</span>
    <span class="uscript-keyword">default</span><span class="uscript-operator">.</span>StaticData<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span> <span class="uscript-operator">=</span> Asc<span class="uscript-operator">(</span>Mid<span class="uscript-operator">(</span>In<span class="uscript-operator">,</span> i<span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
  <span class="uscript-operator">}</span>
  StaticProcessChunks<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
  <span class="uscript-keyword">return</span> <span class="uscript-keyword">default</span><span class="uscript-operator">.</span>StaticHashValue<span class="uscript-operator">;</span>
<span class="uscript-operator">}</span>

<span class="uscript-keyword">static</span> <span class="uscript-keyword">final</span> <span class="uscript-keyword">function</span> <span class="uscript-type">string</span> GetStringHashString<span class="uscript-operator">(</span><span class="uscript-type">string</span> In<span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
  <span class="uscript-keyword">local</span> <span class="uscript-type">int</span> StrLen<span class="uscript-operator">,</span> i<span class="uscript-operator">;</span>
  
  StrLen <span class="uscript-operator">=</span> Len<span class="uscript-operator">(</span>In<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
  <span class="uscript-keyword">default</span><span class="uscript-operator">.</span>StaticData<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span> <span class="uscript-operator">=</span> StrLen<span class="uscript-operator">;</span>
  <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i <span class="uscript-operator">=</span> <span class="uscript-number">0</span><span class="uscript-operator">;</span> i <span class="uscript-operator">&lt;</span> StrLen<span class="uscript-operator">;</span> i<span class="uscript-operator">++</span><span class="uscript-operator">)</span> <span class="uscript-operator">{</span>
    <span class="uscript-keyword">default</span><span class="uscript-operator">.</span>StaticData<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span> <span class="uscript-operator">=</span> Asc<span class="uscript-operator">(</span>Mid<span class="uscript-operator">(</span>In<span class="uscript-operator">,</span> i<span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
  <span class="uscript-operator">}</span>
  StaticProcessChunks<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
  <span class="uscript-keyword">return</span> LittleEndianToHex<span class="uscript-operator">(</span><span class="uscript-keyword">default</span><span class="uscript-operator">.</span>StaticHashValue<span class="uscript-operator">.</span>A<span class="uscript-operator">)</span>
      <span class="uscript-operator">$</span> LittleEndianToHex<span class="uscript-operator">(</span><span class="uscript-keyword">default</span><span class="uscript-operator">.</span>StaticHashValue<span class="uscript-operator">.</span>B<span class="uscript-operator">)</span>
      <span class="uscript-operator">$</span> LittleEndianToHex<span class="uscript-operator">(</span><span class="uscript-keyword">default</span><span class="uscript-operator">.</span>StaticHashValue<span class="uscript-operator">.</span>C<span class="uscript-operator">)</span>
      <span class="uscript-operator">$</span> LittleEndianToHex<span class="uscript-operator">(</span><span class="uscript-keyword">default</span><span class="uscript-operator">.</span>StaticHashValue<span class="uscript-operator">.</span>D<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-operator">}</span>

<span class="uscript-keyword">static</span> <span class="uscript-keyword">final</span> <span class="uscript-keyword">function</span> <span class="uscript-keyword">GUID</span> GetArrayHash<span class="uscript-operator">(</span><span class="uscript-keyword">array</span><span class="uscript-operator">&lt;</span><span class="uscript-type">byte</span><span class="uscript-operator">&gt;</span> In<span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
  <span class="uscript-keyword">default</span><span class="uscript-operator">.</span>StaticData <span class="uscript-operator">=</span> In<span class="uscript-operator">;</span>
  StaticProcessChunks<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
  <span class="uscript-keyword">return</span> <span class="uscript-keyword">default</span><span class="uscript-operator">.</span>StaticHashValue<span class="uscript-operator">;</span>
<span class="uscript-operator">}</span>

<span class="uscript-keyword">static</span> <span class="uscript-keyword">final</span> <span class="uscript-keyword">function</span> <span class="uscript-type">string</span> GetArrayHashString<span class="uscript-operator">(</span><span class="uscript-keyword">array</span><span class="uscript-operator">&lt;</span><span class="uscript-type">byte</span><span class="uscript-operator">&gt;</span> In<span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
  <span class="uscript-keyword">default</span><span class="uscript-operator">.</span>StaticData <span class="uscript-operator">=</span> In<span class="uscript-operator">;</span>
  StaticProcessChunks<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
  <span class="uscript-keyword">return</span> LittleEndianToHex<span class="uscript-operator">(</span><span class="uscript-keyword">default</span><span class="uscript-operator">.</span>StaticHashValue<span class="uscript-operator">.</span>A<span class="uscript-operator">)</span>
      <span class="uscript-operator">$</span> LittleEndianToHex<span class="uscript-operator">(</span><span class="uscript-keyword">default</span><span class="uscript-operator">.</span>StaticHashValue<span class="uscript-operator">.</span>B<span class="uscript-operator">)</span>
      <span class="uscript-operator">$</span> LittleEndianToHex<span class="uscript-operator">(</span><span class="uscript-keyword">default</span><span class="uscript-operator">.</span>StaticHashValue<span class="uscript-operator">.</span>C<span class="uscript-operator">)</span>
      <span class="uscript-operator">$</span> LittleEndianToHex<span class="uscript-operator">(</span><span class="uscript-keyword">default</span><span class="uscript-operator">.</span>StaticHashValue<span class="uscript-operator">.</span>D<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-operator">}</span>

<span class="uscript-keyword">static</span> <span class="uscript-keyword">final</span> <span class="uscript-keyword">function</span> <span class="uscript-type">string</span> GetHashString<span class="uscript-operator">(</span><span class="uscript-keyword">GUID</span> Hash<span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
  <span class="uscript-keyword">return</span> LittleEndianToHex<span class="uscript-operator">(</span>Hash<span class="uscript-operator">.</span>A<span class="uscript-operator">)</span> <span class="uscript-operator">$</span> LittleEndianToHex<span class="uscript-operator">(</span>Hash<span class="uscript-operator">.</span>B<span class="uscript-operator">)</span>
      <span class="uscript-operator">$</span> LittleEndianToHex<span class="uscript-operator">(</span>Hash<span class="uscript-operator">.</span>C<span class="uscript-operator">)</span> <span class="uscript-operator">$</span> LittleEndianToHex<span class="uscript-operator">(</span>Hash<span class="uscript-operator">.</span>D<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-operator">}</span>


<span class="uscript-comment">//=============================================================================</span>
<span class="uscript-comment">// Internal stuff for static instant hashing functions</span>
<span class="uscript-comment">//=============================================================================</span>

<span class="uscript-keyword">static</span> <span class="uscript-keyword">final</span> <span class="uscript-keyword">function</span> <span class="uscript-type">string</span> LittleEndianToHex<span class="uscript-operator">(</span><span class="uscript-type">int</span> i<span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
  <span class="uscript-keyword">const</span> hex <span class="uscript-operator">=</span> <span class="uscript-string">"0123456789abcdef"</span><span class="uscript-operator">;</span>
  
  <span class="uscript-keyword">return</span> Mid<span class="uscript-operator">(</span>hex<span class="uscript-operator">,</span> i <span class="uscript-operator">&gt;&gt;</span> <span class="uscript-number">4</span> <span class="uscript-operator">&amp;</span> <span class="uscript-number">0xf</span><span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span> <span class="uscript-operator">$</span> Mid<span class="uscript-operator">(</span>hex<span class="uscript-operator">,</span> i <span class="uscript-operator">&amp;</span> <span class="uscript-number">0xf</span><span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span>
      <span class="uscript-operator">$</span> Mid<span class="uscript-operator">(</span>hex<span class="uscript-operator">,</span> i <span class="uscript-operator">&gt;&gt;</span> <span class="uscript-number">12</span> <span class="uscript-operator">&amp;</span> <span class="uscript-number">0xf</span><span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span> <span class="uscript-operator">$</span> Mid<span class="uscript-operator">(</span>hex<span class="uscript-operator">,</span> i <span class="uscript-operator">&gt;&gt;</span> <span class="uscript-number">8</span> <span class="uscript-operator">&amp;</span> <span class="uscript-number">0xf</span><span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span>
      <span class="uscript-operator">$</span> Mid<span class="uscript-operator">(</span>hex<span class="uscript-operator">,</span> i <span class="uscript-operator">&gt;&gt;</span> <span class="uscript-number">20</span> <span class="uscript-operator">&amp;</span> <span class="uscript-number">0xf</span><span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span> <span class="uscript-operator">$</span> Mid<span class="uscript-operator">(</span>hex<span class="uscript-operator">,</span> i <span class="uscript-operator">&gt;&gt;</span> <span class="uscript-number">16</span> <span class="uscript-operator">&amp;</span> <span class="uscript-number">0xf</span><span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span>
      <span class="uscript-operator">$</span> Mid<span class="uscript-operator">(</span>hex<span class="uscript-operator">,</span> i <span class="uscript-operator">&gt;&gt;</span> <span class="uscript-number">28</span> <span class="uscript-operator">&amp;</span> <span class="uscript-number">0xf</span><span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span> <span class="uscript-operator">$</span> Mid<span class="uscript-operator">(</span>hex<span class="uscript-operator">,</span> i <span class="uscript-operator">&gt;&gt;</span> <span class="uscript-number">24</span> <span class="uscript-operator">&amp;</span> <span class="uscript-number">0xf</span><span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-operator">}</span>

<span class="uscript-keyword">static</span> <span class="uscript-keyword">final</span> <span class="uscript-keyword">function</span> StaticProcessChunks<span class="uscript-operator">(</span><span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
  <span class="uscript-keyword">local</span> <span class="uscript-type">int</span> i<span class="uscript-operator">;</span>
  <span class="uscript-keyword">local</span> <span class="uscript-type">int</span> A<span class="uscript-operator">,</span> B<span class="uscript-operator">,</span> C<span class="uscript-operator">,</span> D<span class="uscript-operator">;</span>
  <span class="uscript-keyword">local</span> <span class="uscript-type">int</span> W<span class="uscript-operator">[</span><span class="uscript-number">16</span><span class="uscript-operator">]</span><span class="uscript-operator">;</span>
  
  i <span class="uscript-operator">=</span> <span class="uscript-keyword">default</span><span class="uscript-operator">.</span>StaticData<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">;</span>
  <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>i <span class="uscript-operator">%</span> <span class="uscript-number">64</span> <span class="uscript-operator">&lt;</span> <span class="uscript-number">56</span><span class="uscript-operator">)</span>
    <span class="uscript-keyword">default</span><span class="uscript-operator">.</span>StaticData<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span> <span class="uscript-operator">=</span> <span class="uscript-keyword">default</span><span class="uscript-operator">.</span>StaticData<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span> <span class="uscript-operator">+</span> <span class="uscript-number">64</span> <span class="uscript-operator">-</span> i <span class="uscript-operator">%</span> <span class="uscript-number">64</span><span class="uscript-operator">;</span>
  <span class="uscript-keyword">else</span>
    <span class="uscript-keyword">default</span><span class="uscript-operator">.</span>StaticData<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span> <span class="uscript-operator">=</span> <span class="uscript-keyword">default</span><span class="uscript-operator">.</span>StaticData<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span> <span class="uscript-operator">+</span> <span class="uscript-number">128</span> <span class="uscript-operator">-</span> i <span class="uscript-operator">%</span> <span class="uscript-number">64</span><span class="uscript-operator">;</span>
  <span class="uscript-keyword">default</span><span class="uscript-operator">.</span>StaticData<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span> <span class="uscript-operator">=</span> <span class="uscript-number">0x80</span><span class="uscript-operator">;</span>
  <span class="uscript-keyword">default</span><span class="uscript-operator">.</span>StaticData<span class="uscript-operator">[</span><span class="uscript-keyword">default</span><span class="uscript-operator">.</span>StaticData<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span> <span class="uscript-operator">-</span> <span class="uscript-number">4</span><span class="uscript-operator">]</span> <span class="uscript-operator">=</span> <span class="uscript-operator">(</span>i <span class="uscript-operator">&gt;&gt;&gt;</span> <span class="uscript-number">29</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
  <span class="uscript-keyword">default</span><span class="uscript-operator">.</span>StaticData<span class="uscript-operator">[</span><span class="uscript-keyword">default</span><span class="uscript-operator">.</span>StaticData<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span> <span class="uscript-operator">-</span> <span class="uscript-number">5</span><span class="uscript-operator">]</span> <span class="uscript-operator">=</span> <span class="uscript-operator">(</span>i <span class="uscript-operator">&gt;&gt;&gt;</span> <span class="uscript-number">21</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
  <span class="uscript-keyword">default</span><span class="uscript-operator">.</span>StaticData<span class="uscript-operator">[</span><span class="uscript-keyword">default</span><span class="uscript-operator">.</span>StaticData<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span> <span class="uscript-operator">-</span> <span class="uscript-number">6</span><span class="uscript-operator">]</span> <span class="uscript-operator">=</span> <span class="uscript-operator">(</span>i <span class="uscript-operator">&gt;&gt;&gt;</span> <span class="uscript-number">13</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
  <span class="uscript-keyword">default</span><span class="uscript-operator">.</span>StaticData<span class="uscript-operator">[</span><span class="uscript-keyword">default</span><span class="uscript-operator">.</span>StaticData<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span> <span class="uscript-operator">-</span> <span class="uscript-number">7</span><span class="uscript-operator">]</span> <span class="uscript-operator">=</span> <span class="uscript-operator">(</span>i <span class="uscript-operator">&gt;&gt;&gt;</span>  <span class="uscript-number">5</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
  <span class="uscript-keyword">default</span><span class="uscript-operator">.</span>StaticData<span class="uscript-operator">[</span><span class="uscript-keyword">default</span><span class="uscript-operator">.</span>StaticData<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span> <span class="uscript-operator">-</span> <span class="uscript-number">8</span><span class="uscript-operator">]</span> <span class="uscript-operator">=</span> <span class="uscript-operator">(</span>i <span class="uscript-operator">&lt;&lt;</span>   <span class="uscript-number">3</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
  
  <span class="uscript-keyword">default</span><span class="uscript-operator">.</span>StaticHashValue<span class="uscript-operator">.</span>A <span class="uscript-operator">=</span> <span class="uscript-number">0x67452301</span><span class="uscript-operator">;</span>
  <span class="uscript-keyword">default</span><span class="uscript-operator">.</span>StaticHashValue<span class="uscript-operator">.</span>B <span class="uscript-operator">=</span> <span class="uscript-number">0xEFCDAB89</span><span class="uscript-operator">;</span>
  <span class="uscript-keyword">default</span><span class="uscript-operator">.</span>StaticHashValue<span class="uscript-operator">.</span>C <span class="uscript-operator">=</span> <span class="uscript-number">0x98BADCFE</span><span class="uscript-operator">;</span>
  <span class="uscript-keyword">default</span><span class="uscript-operator">.</span>StaticHashValue<span class="uscript-operator">.</span>D <span class="uscript-operator">=</span> <span class="uscript-number">0x10325476</span><span class="uscript-operator">;</span>
  
  <span class="uscript-keyword">while</span> <span class="uscript-operator">(</span><span class="uscript-keyword">default</span><span class="uscript-operator">.</span>StaticData<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span> <span class="uscript-operator">&gt;</span> <span class="uscript-number">0</span><span class="uscript-operator">)</span> <span class="uscript-operator">{</span>
    <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i <span class="uscript-operator">=</span> <span class="uscript-number">0</span><span class="uscript-operator">;</span> i <span class="uscript-operator">&lt;</span> <span class="uscript-number">16</span><span class="uscript-operator">;</span> i<span class="uscript-operator">++</span><span class="uscript-operator">)</span> <span class="uscript-operator">{</span>
      W<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span> <span class="uscript-operator">=</span> <span class="uscript-operator">(</span><span class="uscript-keyword">default</span><span class="uscript-operator">.</span>StaticData<span class="uscript-operator">[</span>i <span class="uscript-operator">*</span> <span class="uscript-number">4</span> <span class="uscript-operator">+</span> <span class="uscript-number">3</span><span class="uscript-operator">]</span> <span class="uscript-operator">&lt;&lt;</span> <span class="uscript-number">24</span><span class="uscript-operator">)</span>
          <span class="uscript-operator">|</span> <span class="uscript-operator">(</span><span class="uscript-keyword">default</span><span class="uscript-operator">.</span>StaticData<span class="uscript-operator">[</span>i <span class="uscript-operator">*</span> <span class="uscript-number">4</span> <span class="uscript-operator">+</span> <span class="uscript-number">2</span><span class="uscript-operator">]</span> <span class="uscript-operator">&lt;&lt;</span> <span class="uscript-number">16</span><span class="uscript-operator">)</span>
          <span class="uscript-operator">|</span> <span class="uscript-operator">(</span><span class="uscript-keyword">default</span><span class="uscript-operator">.</span>StaticData<span class="uscript-operator">[</span>i <span class="uscript-operator">*</span> <span class="uscript-number">4</span> <span class="uscript-operator">+</span> <span class="uscript-number">1</span><span class="uscript-operator">]</span> <span class="uscript-operator">&lt;&lt;</span> <span class="uscript-number">8</span><span class="uscript-operator">)</span>
          <span class="uscript-operator">|</span> <span class="uscript-keyword">default</span><span class="uscript-operator">.</span>StaticData<span class="uscript-operator">[</span>i <span class="uscript-operator">*</span> <span class="uscript-number">4</span><span class="uscript-operator">]</span><span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>
    
    <span class="uscript-comment">// initialize hash value for this chunk</span>
    A <span class="uscript-operator">=</span> <span class="uscript-keyword">default</span><span class="uscript-operator">.</span>StaticHashValue<span class="uscript-operator">.</span>A<span class="uscript-operator">;</span>
    B <span class="uscript-operator">=</span> <span class="uscript-keyword">default</span><span class="uscript-operator">.</span>StaticHashValue<span class="uscript-operator">.</span>B<span class="uscript-operator">;</span>
    C <span class="uscript-operator">=</span> <span class="uscript-keyword">default</span><span class="uscript-operator">.</span>StaticHashValue<span class="uscript-operator">.</span>C<span class="uscript-operator">;</span>
    D <span class="uscript-operator">=</span> <span class="uscript-keyword">default</span><span class="uscript-operator">.</span>StaticHashValue<span class="uscript-operator">.</span>D<span class="uscript-operator">;</span>
    
    <span class="uscript-comment">// round 1</span>
    A <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span>D <span class="uscript-operator">^</span> <span class="uscript-operator">(</span>B <span class="uscript-operator">&amp;</span> <span class="uscript-operator">(</span>C <span class="uscript-operator">^</span> D<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">+</span> W<span class="uscript-operator">[</span> <span class="uscript-number">0</span><span class="uscript-operator">]</span> <span class="uscript-operator">+</span> <span class="uscript-number">0xD76AA478</span><span class="uscript-operator">;</span>   A <span class="uscript-operator">=</span> B <span class="uscript-operator">+</span> <span class="uscript-operator">(</span>A <span class="uscript-operator">&lt;&lt;</span>  <span class="uscript-number">7</span> <span class="uscript-operator">|</span> A <span class="uscript-operator">&gt;&gt;&gt;</span>  <span class="uscript-operator">-</span><span class="uscript-number">7</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    D <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span>C <span class="uscript-operator">^</span> <span class="uscript-operator">(</span>A <span class="uscript-operator">&amp;</span> <span class="uscript-operator">(</span>B <span class="uscript-operator">^</span> C<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">+</span> W<span class="uscript-operator">[</span> <span class="uscript-number">1</span><span class="uscript-operator">]</span> <span class="uscript-operator">+</span> <span class="uscript-number">0xE8C7B756</span><span class="uscript-operator">;</span>   D <span class="uscript-operator">=</span> A <span class="uscript-operator">+</span> <span class="uscript-operator">(</span>D <span class="uscript-operator">&lt;&lt;</span> <span class="uscript-number">12</span> <span class="uscript-operator">|</span> D <span class="uscript-operator">&gt;&gt;&gt;</span> <span class="uscript-operator">-</span><span class="uscript-number">12</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    C <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span>B <span class="uscript-operator">^</span> <span class="uscript-operator">(</span>D <span class="uscript-operator">&amp;</span> <span class="uscript-operator">(</span>A <span class="uscript-operator">^</span> B<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">+</span> W<span class="uscript-operator">[</span> <span class="uscript-number">2</span><span class="uscript-operator">]</span> <span class="uscript-operator">+</span> <span class="uscript-number">0x242070DB</span><span class="uscript-operator">;</span>   C <span class="uscript-operator">=</span> D <span class="uscript-operator">+</span> <span class="uscript-operator">(</span>C <span class="uscript-operator">&lt;&lt;</span> <span class="uscript-number">17</span> <span class="uscript-operator">|</span> C <span class="uscript-operator">&gt;&gt;&gt;</span> <span class="uscript-operator">-</span><span class="uscript-number">17</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    B <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span>A <span class="uscript-operator">^</span> <span class="uscript-operator">(</span>C <span class="uscript-operator">&amp;</span> <span class="uscript-operator">(</span>D <span class="uscript-operator">^</span> A<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">+</span> W<span class="uscript-operator">[</span> <span class="uscript-number">3</span><span class="uscript-operator">]</span> <span class="uscript-operator">+</span> <span class="uscript-number">0xC1BDCEEE</span><span class="uscript-operator">;</span>   B <span class="uscript-operator">=</span> C <span class="uscript-operator">+</span> <span class="uscript-operator">(</span>B <span class="uscript-operator">&lt;&lt;</span> <span class="uscript-number">22</span> <span class="uscript-operator">|</span> B <span class="uscript-operator">&gt;&gt;&gt;</span> <span class="uscript-operator">-</span><span class="uscript-number">22</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    
    A <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span>D <span class="uscript-operator">^</span> <span class="uscript-operator">(</span>B <span class="uscript-operator">&amp;</span> <span class="uscript-operator">(</span>C <span class="uscript-operator">^</span> D<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">+</span> W<span class="uscript-operator">[</span> <span class="uscript-number">4</span><span class="uscript-operator">]</span> <span class="uscript-operator">+</span> <span class="uscript-number">0xF57C0FAF</span><span class="uscript-operator">;</span>   A <span class="uscript-operator">=</span> B <span class="uscript-operator">+</span> <span class="uscript-operator">(</span>A <span class="uscript-operator">&lt;&lt;</span>  <span class="uscript-number">7</span> <span class="uscript-operator">|</span> A <span class="uscript-operator">&gt;&gt;&gt;</span>  <span class="uscript-operator">-</span><span class="uscript-number">7</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    D <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span>C <span class="uscript-operator">^</span> <span class="uscript-operator">(</span>A <span class="uscript-operator">&amp;</span> <span class="uscript-operator">(</span>B <span class="uscript-operator">^</span> C<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">+</span> W<span class="uscript-operator">[</span> <span class="uscript-number">5</span><span class="uscript-operator">]</span> <span class="uscript-operator">+</span> <span class="uscript-number">0x4787C62A</span><span class="uscript-operator">;</span>   D <span class="uscript-operator">=</span> A <span class="uscript-operator">+</span> <span class="uscript-operator">(</span>D <span class="uscript-operator">&lt;&lt;</span> <span class="uscript-number">12</span> <span class="uscript-operator">|</span> D <span class="uscript-operator">&gt;&gt;&gt;</span> <span class="uscript-operator">-</span><span class="uscript-number">12</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    C <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span>B <span class="uscript-operator">^</span> <span class="uscript-operator">(</span>D <span class="uscript-operator">&amp;</span> <span class="uscript-operator">(</span>A <span class="uscript-operator">^</span> B<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">+</span> W<span class="uscript-operator">[</span> <span class="uscript-number">6</span><span class="uscript-operator">]</span> <span class="uscript-operator">+</span> <span class="uscript-number">0xA8304613</span><span class="uscript-operator">;</span>   C <span class="uscript-operator">=</span> D <span class="uscript-operator">+</span> <span class="uscript-operator">(</span>C <span class="uscript-operator">&lt;&lt;</span> <span class="uscript-number">17</span> <span class="uscript-operator">|</span> C <span class="uscript-operator">&gt;&gt;&gt;</span> <span class="uscript-operator">-</span><span class="uscript-number">17</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    B <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span>A <span class="uscript-operator">^</span> <span class="uscript-operator">(</span>C <span class="uscript-operator">&amp;</span> <span class="uscript-operator">(</span>D <span class="uscript-operator">^</span> A<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">+</span> W<span class="uscript-operator">[</span> <span class="uscript-number">7</span><span class="uscript-operator">]</span> <span class="uscript-operator">+</span> <span class="uscript-number">0xFD469501</span><span class="uscript-operator">;</span>   B <span class="uscript-operator">=</span> C <span class="uscript-operator">+</span> <span class="uscript-operator">(</span>B <span class="uscript-operator">&lt;&lt;</span> <span class="uscript-number">22</span> <span class="uscript-operator">|</span> B <span class="uscript-operator">&gt;&gt;&gt;</span> <span class="uscript-operator">-</span><span class="uscript-number">22</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    
    A <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span>D <span class="uscript-operator">^</span> <span class="uscript-operator">(</span>B <span class="uscript-operator">&amp;</span> <span class="uscript-operator">(</span>C <span class="uscript-operator">^</span> D<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">+</span> W<span class="uscript-operator">[</span> <span class="uscript-number">8</span><span class="uscript-operator">]</span> <span class="uscript-operator">+</span> <span class="uscript-number">0x698098D8</span><span class="uscript-operator">;</span>   A <span class="uscript-operator">=</span> B <span class="uscript-operator">+</span> <span class="uscript-operator">(</span>A <span class="uscript-operator">&lt;&lt;</span>  <span class="uscript-number">7</span> <span class="uscript-operator">|</span> A <span class="uscript-operator">&gt;&gt;&gt;</span>  <span class="uscript-operator">-</span><span class="uscript-number">7</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    D <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span>C <span class="uscript-operator">^</span> <span class="uscript-operator">(</span>A <span class="uscript-operator">&amp;</span> <span class="uscript-operator">(</span>B <span class="uscript-operator">^</span> C<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">+</span> W<span class="uscript-operator">[</span> <span class="uscript-number">9</span><span class="uscript-operator">]</span> <span class="uscript-operator">+</span> <span class="uscript-number">0x8B44F7AF</span><span class="uscript-operator">;</span>   D <span class="uscript-operator">=</span> A <span class="uscript-operator">+</span> <span class="uscript-operator">(</span>D <span class="uscript-operator">&lt;&lt;</span> <span class="uscript-number">12</span> <span class="uscript-operator">|</span> D <span class="uscript-operator">&gt;&gt;&gt;</span> <span class="uscript-operator">-</span><span class="uscript-number">12</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    C <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span>B <span class="uscript-operator">^</span> <span class="uscript-operator">(</span>D <span class="uscript-operator">&amp;</span> <span class="uscript-operator">(</span>A <span class="uscript-operator">^</span> B<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">+</span> W<span class="uscript-operator">[</span><span class="uscript-number">10</span><span class="uscript-operator">]</span> <span class="uscript-operator">+</span> <span class="uscript-number">0xFFFF5BB1</span><span class="uscript-operator">;</span>   C <span class="uscript-operator">=</span> D <span class="uscript-operator">+</span> <span class="uscript-operator">(</span>C <span class="uscript-operator">&lt;&lt;</span> <span class="uscript-number">17</span> <span class="uscript-operator">|</span> C <span class="uscript-operator">&gt;&gt;&gt;</span> <span class="uscript-operator">-</span><span class="uscript-number">17</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    B <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span>A <span class="uscript-operator">^</span> <span class="uscript-operator">(</span>C <span class="uscript-operator">&amp;</span> <span class="uscript-operator">(</span>D <span class="uscript-operator">^</span> A<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">+</span> W<span class="uscript-operator">[</span><span class="uscript-number">11</span><span class="uscript-operator">]</span> <span class="uscript-operator">+</span> <span class="uscript-number">0x895CD7BE</span><span class="uscript-operator">;</span>   B <span class="uscript-operator">=</span> C <span class="uscript-operator">+</span> <span class="uscript-operator">(</span>B <span class="uscript-operator">&lt;&lt;</span> <span class="uscript-number">22</span> <span class="uscript-operator">|</span> B <span class="uscript-operator">&gt;&gt;&gt;</span> <span class="uscript-operator">-</span><span class="uscript-number">22</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    
    A <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span>D <span class="uscript-operator">^</span> <span class="uscript-operator">(</span>B <span class="uscript-operator">&amp;</span> <span class="uscript-operator">(</span>C <span class="uscript-operator">^</span> D<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">+</span> W<span class="uscript-operator">[</span><span class="uscript-number">12</span><span class="uscript-operator">]</span> <span class="uscript-operator">+</span> <span class="uscript-number">0x6B901122</span><span class="uscript-operator">;</span>   A <span class="uscript-operator">=</span> B <span class="uscript-operator">+</span> <span class="uscript-operator">(</span>A <span class="uscript-operator">&lt;&lt;</span>  <span class="uscript-number">7</span> <span class="uscript-operator">|</span> A <span class="uscript-operator">&gt;&gt;&gt;</span>  <span class="uscript-operator">-</span><span class="uscript-number">7</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    D <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span>C <span class="uscript-operator">^</span> <span class="uscript-operator">(</span>A <span class="uscript-operator">&amp;</span> <span class="uscript-operator">(</span>B <span class="uscript-operator">^</span> C<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">+</span> W<span class="uscript-operator">[</span><span class="uscript-number">13</span><span class="uscript-operator">]</span> <span class="uscript-operator">+</span> <span class="uscript-number">0xFD987193</span><span class="uscript-operator">;</span>   D <span class="uscript-operator">=</span> A <span class="uscript-operator">+</span> <span class="uscript-operator">(</span>D <span class="uscript-operator">&lt;&lt;</span> <span class="uscript-number">12</span> <span class="uscript-operator">|</span> D <span class="uscript-operator">&gt;&gt;&gt;</span> <span class="uscript-operator">-</span><span class="uscript-number">12</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    C <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span>B <span class="uscript-operator">^</span> <span class="uscript-operator">(</span>D <span class="uscript-operator">&amp;</span> <span class="uscript-operator">(</span>A <span class="uscript-operator">^</span> B<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">+</span> W<span class="uscript-operator">[</span><span class="uscript-number">14</span><span class="uscript-operator">]</span> <span class="uscript-operator">+</span> <span class="uscript-number">0xA679438E</span><span class="uscript-operator">;</span>   C <span class="uscript-operator">=</span> D <span class="uscript-operator">+</span> <span class="uscript-operator">(</span>C <span class="uscript-operator">&lt;&lt;</span> <span class="uscript-number">17</span> <span class="uscript-operator">|</span> C <span class="uscript-operator">&gt;&gt;&gt;</span> <span class="uscript-operator">-</span><span class="uscript-number">17</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    B <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span>A <span class="uscript-operator">^</span> <span class="uscript-operator">(</span>C <span class="uscript-operator">&amp;</span> <span class="uscript-operator">(</span>D <span class="uscript-operator">^</span> A<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">+</span> W<span class="uscript-operator">[</span><span class="uscript-number">15</span><span class="uscript-operator">]</span> <span class="uscript-operator">+</span> <span class="uscript-number">0x49B40821</span><span class="uscript-operator">;</span>   B <span class="uscript-operator">=</span> C <span class="uscript-operator">+</span> <span class="uscript-operator">(</span>B <span class="uscript-operator">&lt;&lt;</span> <span class="uscript-number">22</span> <span class="uscript-operator">|</span> B <span class="uscript-operator">&gt;&gt;&gt;</span> <span class="uscript-operator">-</span><span class="uscript-number">22</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    
    <span class="uscript-comment">// round 2</span>
    A <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span>C <span class="uscript-operator">^</span> <span class="uscript-operator">(</span>D <span class="uscript-operator">&amp;</span> <span class="uscript-operator">(</span>B <span class="uscript-operator">^</span> C<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">+</span> W<span class="uscript-operator">[</span> <span class="uscript-number">1</span><span class="uscript-operator">]</span> <span class="uscript-operator">+</span> <span class="uscript-number">0xF61E2562</span><span class="uscript-operator">;</span>   A <span class="uscript-operator">=</span> B <span class="uscript-operator">+</span> <span class="uscript-operator">(</span>A <span class="uscript-operator">&lt;&lt;</span>  <span class="uscript-number">5</span> <span class="uscript-operator">|</span> A <span class="uscript-operator">&gt;&gt;&gt;</span>  <span class="uscript-operator">-</span><span class="uscript-number">5</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    D <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span>B <span class="uscript-operator">^</span> <span class="uscript-operator">(</span>C <span class="uscript-operator">&amp;</span> <span class="uscript-operator">(</span>A <span class="uscript-operator">^</span> B<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">+</span> W<span class="uscript-operator">[</span> <span class="uscript-number">6</span><span class="uscript-operator">]</span> <span class="uscript-operator">+</span> <span class="uscript-number">0xC040B340</span><span class="uscript-operator">;</span>   D <span class="uscript-operator">=</span> A <span class="uscript-operator">+</span> <span class="uscript-operator">(</span>D <span class="uscript-operator">&lt;&lt;</span>  <span class="uscript-number">9</span> <span class="uscript-operator">|</span> D <span class="uscript-operator">&gt;&gt;&gt;</span>  <span class="uscript-operator">-</span><span class="uscript-number">9</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    C <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span>A <span class="uscript-operator">^</span> <span class="uscript-operator">(</span>B <span class="uscript-operator">&amp;</span> <span class="uscript-operator">(</span>D <span class="uscript-operator">^</span> A<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">+</span> W<span class="uscript-operator">[</span><span class="uscript-number">11</span><span class="uscript-operator">]</span> <span class="uscript-operator">+</span> <span class="uscript-number">0x265E5A51</span><span class="uscript-operator">;</span>   C <span class="uscript-operator">=</span> D <span class="uscript-operator">+</span> <span class="uscript-operator">(</span>C <span class="uscript-operator">&lt;&lt;</span> <span class="uscript-number">14</span> <span class="uscript-operator">|</span> C <span class="uscript-operator">&gt;&gt;&gt;</span> <span class="uscript-operator">-</span><span class="uscript-number">14</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    B <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span>D <span class="uscript-operator">^</span> <span class="uscript-operator">(</span>A <span class="uscript-operator">&amp;</span> <span class="uscript-operator">(</span>C <span class="uscript-operator">^</span> D<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">+</span> W<span class="uscript-operator">[</span> <span class="uscript-number">0</span><span class="uscript-operator">]</span> <span class="uscript-operator">+</span> <span class="uscript-number">0xE9B6C7AA</span><span class="uscript-operator">;</span>   B <span class="uscript-operator">=</span> C <span class="uscript-operator">+</span> <span class="uscript-operator">(</span>B <span class="uscript-operator">&lt;&lt;</span> <span class="uscript-number">20</span> <span class="uscript-operator">|</span> B <span class="uscript-operator">&gt;&gt;&gt;</span> <span class="uscript-operator">-</span><span class="uscript-number">20</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    
    A <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span>C <span class="uscript-operator">^</span> <span class="uscript-operator">(</span>D <span class="uscript-operator">&amp;</span> <span class="uscript-operator">(</span>B <span class="uscript-operator">^</span> C<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">+</span> W<span class="uscript-operator">[</span> <span class="uscript-number">5</span><span class="uscript-operator">]</span> <span class="uscript-operator">+</span> <span class="uscript-number">0xD62F105D</span><span class="uscript-operator">;</span>   A <span class="uscript-operator">=</span> B <span class="uscript-operator">+</span> <span class="uscript-operator">(</span>A <span class="uscript-operator">&lt;&lt;</span>  <span class="uscript-number">5</span> <span class="uscript-operator">|</span> A <span class="uscript-operator">&gt;&gt;&gt;</span>  <span class="uscript-operator">-</span><span class="uscript-number">5</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    D <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span>B <span class="uscript-operator">^</span> <span class="uscript-operator">(</span>C <span class="uscript-operator">&amp;</span> <span class="uscript-operator">(</span>A <span class="uscript-operator">^</span> B<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">+</span> W<span class="uscript-operator">[</span><span class="uscript-number">10</span><span class="uscript-operator">]</span> <span class="uscript-operator">+</span> <span class="uscript-number">0x02441453</span><span class="uscript-operator">;</span>   D <span class="uscript-operator">=</span> A <span class="uscript-operator">+</span> <span class="uscript-operator">(</span>D <span class="uscript-operator">&lt;&lt;</span>  <span class="uscript-number">9</span> <span class="uscript-operator">|</span> D <span class="uscript-operator">&gt;&gt;&gt;</span>  <span class="uscript-operator">-</span><span class="uscript-number">9</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    C <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span>A <span class="uscript-operator">^</span> <span class="uscript-operator">(</span>B <span class="uscript-operator">&amp;</span> <span class="uscript-operator">(</span>D <span class="uscript-operator">^</span> A<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">+</span> W<span class="uscript-operator">[</span><span class="uscript-number">15</span><span class="uscript-operator">]</span> <span class="uscript-operator">+</span> <span class="uscript-number">0xD8A1E681</span><span class="uscript-operator">;</span>   C <span class="uscript-operator">=</span> D <span class="uscript-operator">+</span> <span class="uscript-operator">(</span>C <span class="uscript-operator">&lt;&lt;</span> <span class="uscript-number">14</span> <span class="uscript-operator">|</span> C <span class="uscript-operator">&gt;&gt;&gt;</span> <span class="uscript-operator">-</span><span class="uscript-number">14</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    B <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span>D <span class="uscript-operator">^</span> <span class="uscript-operator">(</span>A <span class="uscript-operator">&amp;</span> <span class="uscript-operator">(</span>C <span class="uscript-operator">^</span> D<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">+</span> W<span class="uscript-operator">[</span> <span class="uscript-number">4</span><span class="uscript-operator">]</span> <span class="uscript-operator">+</span> <span class="uscript-number">0xE7D3FBC8</span><span class="uscript-operator">;</span>   B <span class="uscript-operator">=</span> C <span class="uscript-operator">+</span> <span class="uscript-operator">(</span>B <span class="uscript-operator">&lt;&lt;</span> <span class="uscript-number">20</span> <span class="uscript-operator">|</span> B <span class="uscript-operator">&gt;&gt;&gt;</span> <span class="uscript-operator">-</span><span class="uscript-number">20</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    
    A <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span>C <span class="uscript-operator">^</span> <span class="uscript-operator">(</span>D <span class="uscript-operator">&amp;</span> <span class="uscript-operator">(</span>B <span class="uscript-operator">^</span> C<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">+</span> W<span class="uscript-operator">[</span> <span class="uscript-number">9</span><span class="uscript-operator">]</span> <span class="uscript-operator">+</span> <span class="uscript-number">0x21E1CDE6</span><span class="uscript-operator">;</span>   A <span class="uscript-operator">=</span> B <span class="uscript-operator">+</span> <span class="uscript-operator">(</span>A <span class="uscript-operator">&lt;&lt;</span>  <span class="uscript-number">5</span> <span class="uscript-operator">|</span> A <span class="uscript-operator">&gt;&gt;&gt;</span>  <span class="uscript-operator">-</span><span class="uscript-number">5</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    D <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span>B <span class="uscript-operator">^</span> <span class="uscript-operator">(</span>C <span class="uscript-operator">&amp;</span> <span class="uscript-operator">(</span>A <span class="uscript-operator">^</span> B<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">+</span> W<span class="uscript-operator">[</span><span class="uscript-number">14</span><span class="uscript-operator">]</span> <span class="uscript-operator">+</span> <span class="uscript-number">0xC33707D6</span><span class="uscript-operator">;</span>   D <span class="uscript-operator">=</span> A <span class="uscript-operator">+</span> <span class="uscript-operator">(</span>D <span class="uscript-operator">&lt;&lt;</span>  <span class="uscript-number">9</span> <span class="uscript-operator">|</span> D <span class="uscript-operator">&gt;&gt;&gt;</span>  <span class="uscript-operator">-</span><span class="uscript-number">9</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    C <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span>A <span class="uscript-operator">^</span> <span class="uscript-operator">(</span>B <span class="uscript-operator">&amp;</span> <span class="uscript-operator">(</span>D <span class="uscript-operator">^</span> A<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">+</span> W<span class="uscript-operator">[</span> <span class="uscript-number">3</span><span class="uscript-operator">]</span> <span class="uscript-operator">+</span> <span class="uscript-number">0xF4D50D87</span><span class="uscript-operator">;</span>   C <span class="uscript-operator">=</span> D <span class="uscript-operator">+</span> <span class="uscript-operator">(</span>C <span class="uscript-operator">&lt;&lt;</span> <span class="uscript-number">14</span> <span class="uscript-operator">|</span> C <span class="uscript-operator">&gt;&gt;&gt;</span> <span class="uscript-operator">-</span><span class="uscript-number">14</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    B <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span>D <span class="uscript-operator">^</span> <span class="uscript-operator">(</span>A <span class="uscript-operator">&amp;</span> <span class="uscript-operator">(</span>C <span class="uscript-operator">^</span> D<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">+</span> W<span class="uscript-operator">[</span> <span class="uscript-number">8</span><span class="uscript-operator">]</span> <span class="uscript-operator">+</span> <span class="uscript-number">0x455A14ED</span><span class="uscript-operator">;</span>   B <span class="uscript-operator">=</span> C <span class="uscript-operator">+</span> <span class="uscript-operator">(</span>B <span class="uscript-operator">&lt;&lt;</span> <span class="uscript-number">20</span> <span class="uscript-operator">|</span> B <span class="uscript-operator">&gt;&gt;&gt;</span> <span class="uscript-operator">-</span><span class="uscript-number">20</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    
    A <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span>C <span class="uscript-operator">^</span> <span class="uscript-operator">(</span>D <span class="uscript-operator">&amp;</span> <span class="uscript-operator">(</span>B <span class="uscript-operator">^</span> C<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">+</span> W<span class="uscript-operator">[</span><span class="uscript-number">13</span><span class="uscript-operator">]</span> <span class="uscript-operator">+</span> <span class="uscript-number">0xA9E3E905</span><span class="uscript-operator">;</span>   A <span class="uscript-operator">=</span> B <span class="uscript-operator">+</span> <span class="uscript-operator">(</span>A <span class="uscript-operator">&lt;&lt;</span>  <span class="uscript-number">5</span> <span class="uscript-operator">|</span> A <span class="uscript-operator">&gt;&gt;&gt;</span>  <span class="uscript-operator">-</span><span class="uscript-number">5</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    D <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span>B <span class="uscript-operator">^</span> <span class="uscript-operator">(</span>C <span class="uscript-operator">&amp;</span> <span class="uscript-operator">(</span>A <span class="uscript-operator">^</span> B<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">+</span> W<span class="uscript-operator">[</span> <span class="uscript-number">2</span><span class="uscript-operator">]</span> <span class="uscript-operator">+</span> <span class="uscript-number">0xFCEFA3F8</span><span class="uscript-operator">;</span>   D <span class="uscript-operator">=</span> A <span class="uscript-operator">+</span> <span class="uscript-operator">(</span>D <span class="uscript-operator">&lt;&lt;</span>  <span class="uscript-number">9</span> <span class="uscript-operator">|</span> D <span class="uscript-operator">&gt;&gt;&gt;</span>  <span class="uscript-operator">-</span><span class="uscript-number">9</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    C <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span>A <span class="uscript-operator">^</span> <span class="uscript-operator">(</span>B <span class="uscript-operator">&amp;</span> <span class="uscript-operator">(</span>D <span class="uscript-operator">^</span> A<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">+</span> W<span class="uscript-operator">[</span> <span class="uscript-number">7</span><span class="uscript-operator">]</span> <span class="uscript-operator">+</span> <span class="uscript-number">0x676F02D9</span><span class="uscript-operator">;</span>   C <span class="uscript-operator">=</span> D <span class="uscript-operator">+</span> <span class="uscript-operator">(</span>C <span class="uscript-operator">&lt;&lt;</span> <span class="uscript-number">14</span> <span class="uscript-operator">|</span> C <span class="uscript-operator">&gt;&gt;&gt;</span> <span class="uscript-operator">-</span><span class="uscript-number">14</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    B <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span>D <span class="uscript-operator">^</span> <span class="uscript-operator">(</span>A <span class="uscript-operator">&amp;</span> <span class="uscript-operator">(</span>C <span class="uscript-operator">^</span> D<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">+</span> W<span class="uscript-operator">[</span><span class="uscript-number">12</span><span class="uscript-operator">]</span> <span class="uscript-operator">+</span> <span class="uscript-number">0x8D2A4C8A</span><span class="uscript-operator">;</span>   B <span class="uscript-operator">=</span> C <span class="uscript-operator">+</span> <span class="uscript-operator">(</span>B <span class="uscript-operator">&lt;&lt;</span> <span class="uscript-number">20</span> <span class="uscript-operator">|</span> B <span class="uscript-operator">&gt;&gt;&gt;</span> <span class="uscript-operator">-</span><span class="uscript-number">20</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    
    <span class="uscript-comment">// round 3</span>
    A <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span>B <span class="uscript-operator">^</span> C <span class="uscript-operator">^</span> D<span class="uscript-operator">)</span> <span class="uscript-operator">+</span> W<span class="uscript-operator">[</span> <span class="uscript-number">5</span><span class="uscript-operator">]</span> <span class="uscript-operator">+</span> <span class="uscript-number">0xFFFA3942</span><span class="uscript-operator">;</span>    A <span class="uscript-operator">=</span> B <span class="uscript-operator">+</span> <span class="uscript-operator">(</span>A <span class="uscript-operator">&lt;&lt;</span>  <span class="uscript-number">4</span> <span class="uscript-operator">|</span> A <span class="uscript-operator">&gt;&gt;&gt;</span>  <span class="uscript-operator">-</span><span class="uscript-number">4</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    D <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span>A <span class="uscript-operator">^</span> B <span class="uscript-operator">^</span> C<span class="uscript-operator">)</span> <span class="uscript-operator">+</span> W<span class="uscript-operator">[</span> <span class="uscript-number">8</span><span class="uscript-operator">]</span> <span class="uscript-operator">+</span> <span class="uscript-number">0x8771F681</span><span class="uscript-operator">;</span>    D <span class="uscript-operator">=</span> A <span class="uscript-operator">+</span> <span class="uscript-operator">(</span>D <span class="uscript-operator">&lt;&lt;</span> <span class="uscript-number">11</span> <span class="uscript-operator">|</span> D <span class="uscript-operator">&gt;&gt;&gt;</span> <span class="uscript-operator">-</span><span class="uscript-number">11</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    C <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span>D <span class="uscript-operator">^</span> A <span class="uscript-operator">^</span> B<span class="uscript-operator">)</span> <span class="uscript-operator">+</span> W<span class="uscript-operator">[</span><span class="uscript-number">11</span><span class="uscript-operator">]</span> <span class="uscript-operator">+</span> <span class="uscript-number">0x6D9D6122</span><span class="uscript-operator">;</span>    C <span class="uscript-operator">=</span> D <span class="uscript-operator">+</span> <span class="uscript-operator">(</span>C <span class="uscript-operator">&lt;&lt;</span> <span class="uscript-number">16</span> <span class="uscript-operator">|</span> C <span class="uscript-operator">&gt;&gt;&gt;</span> <span class="uscript-operator">-</span><span class="uscript-number">16</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    B <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span>C <span class="uscript-operator">^</span> D <span class="uscript-operator">^</span> A<span class="uscript-operator">)</span> <span class="uscript-operator">+</span> W<span class="uscript-operator">[</span><span class="uscript-number">14</span><span class="uscript-operator">]</span> <span class="uscript-operator">+</span> <span class="uscript-number">0xFDE5380C</span><span class="uscript-operator">;</span>    B <span class="uscript-operator">=</span> C <span class="uscript-operator">+</span> <span class="uscript-operator">(</span>B <span class="uscript-operator">&lt;&lt;</span> <span class="uscript-number">23</span> <span class="uscript-operator">|</span> B <span class="uscript-operator">&gt;&gt;&gt;</span> <span class="uscript-operator">-</span><span class="uscript-number">23</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    
    A <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span>B <span class="uscript-operator">^</span> C <span class="uscript-operator">^</span> D<span class="uscript-operator">)</span> <span class="uscript-operator">+</span> W<span class="uscript-operator">[</span> <span class="uscript-number">1</span><span class="uscript-operator">]</span> <span class="uscript-operator">+</span> <span class="uscript-number">0xA4BEEA44</span><span class="uscript-operator">;</span>    A <span class="uscript-operator">=</span> B <span class="uscript-operator">+</span> <span class="uscript-operator">(</span>A <span class="uscript-operator">&lt;&lt;</span>  <span class="uscript-number">4</span> <span class="uscript-operator">|</span> A <span class="uscript-operator">&gt;&gt;&gt;</span>  <span class="uscript-operator">-</span><span class="uscript-number">4</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    D <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span>A <span class="uscript-operator">^</span> B <span class="uscript-operator">^</span> C<span class="uscript-operator">)</span> <span class="uscript-operator">+</span> W<span class="uscript-operator">[</span> <span class="uscript-number">4</span><span class="uscript-operator">]</span> <span class="uscript-operator">+</span> <span class="uscript-number">0x4BDECFA9</span><span class="uscript-operator">;</span>    D <span class="uscript-operator">=</span> A <span class="uscript-operator">+</span> <span class="uscript-operator">(</span>D <span class="uscript-operator">&lt;&lt;</span> <span class="uscript-number">11</span> <span class="uscript-operator">|</span> D <span class="uscript-operator">&gt;&gt;&gt;</span> <span class="uscript-operator">-</span><span class="uscript-number">11</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    C <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span>D <span class="uscript-operator">^</span> A <span class="uscript-operator">^</span> B<span class="uscript-operator">)</span> <span class="uscript-operator">+</span> W<span class="uscript-operator">[</span> <span class="uscript-number">7</span><span class="uscript-operator">]</span> <span class="uscript-operator">+</span> <span class="uscript-number">0xF6BB4B60</span><span class="uscript-operator">;</span>    C <span class="uscript-operator">=</span> D <span class="uscript-operator">+</span> <span class="uscript-operator">(</span>C <span class="uscript-operator">&lt;&lt;</span> <span class="uscript-number">16</span> <span class="uscript-operator">|</span> C <span class="uscript-operator">&gt;&gt;&gt;</span> <span class="uscript-operator">-</span><span class="uscript-number">16</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    B <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span>C <span class="uscript-operator">^</span> D <span class="uscript-operator">^</span> A<span class="uscript-operator">)</span> <span class="uscript-operator">+</span> W<span class="uscript-operator">[</span><span class="uscript-number">10</span><span class="uscript-operator">]</span> <span class="uscript-operator">+</span> <span class="uscript-number">0xBEBFBC70</span><span class="uscript-operator">;</span>    B <span class="uscript-operator">=</span> C <span class="uscript-operator">+</span> <span class="uscript-operator">(</span>B <span class="uscript-operator">&lt;&lt;</span> <span class="uscript-number">23</span> <span class="uscript-operator">|</span> B <span class="uscript-operator">&gt;&gt;&gt;</span> <span class="uscript-operator">-</span><span class="uscript-number">23</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    
    A <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span>B <span class="uscript-operator">^</span> C <span class="uscript-operator">^</span> D<span class="uscript-operator">)</span> <span class="uscript-operator">+</span> W<span class="uscript-operator">[</span><span class="uscript-number">13</span><span class="uscript-operator">]</span> <span class="uscript-operator">+</span> <span class="uscript-number">0x289B7EC6</span><span class="uscript-operator">;</span>    A <span class="uscript-operator">=</span> B <span class="uscript-operator">+</span> <span class="uscript-operator">(</span>A <span class="uscript-operator">&lt;&lt;</span>  <span class="uscript-number">4</span> <span class="uscript-operator">|</span> A <span class="uscript-operator">&gt;&gt;&gt;</span>  <span class="uscript-operator">-</span><span class="uscript-number">4</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    D <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span>A <span class="uscript-operator">^</span> B <span class="uscript-operator">^</span> C<span class="uscript-operator">)</span> <span class="uscript-operator">+</span> W<span class="uscript-operator">[</span> <span class="uscript-number">0</span><span class="uscript-operator">]</span> <span class="uscript-operator">+</span> <span class="uscript-number">0xEAA127FA</span><span class="uscript-operator">;</span>    D <span class="uscript-operator">=</span> A <span class="uscript-operator">+</span> <span class="uscript-operator">(</span>D <span class="uscript-operator">&lt;&lt;</span> <span class="uscript-number">11</span> <span class="uscript-operator">|</span> D <span class="uscript-operator">&gt;&gt;&gt;</span> <span class="uscript-operator">-</span><span class="uscript-number">11</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    C <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span>D <span class="uscript-operator">^</span> A <span class="uscript-operator">^</span> B<span class="uscript-operator">)</span> <span class="uscript-operator">+</span> W<span class="uscript-operator">[</span> <span class="uscript-number">3</span><span class="uscript-operator">]</span> <span class="uscript-operator">+</span> <span class="uscript-number">0xD4EF3085</span><span class="uscript-operator">;</span>    C <span class="uscript-operator">=</span> D <span class="uscript-operator">+</span> <span class="uscript-operator">(</span>C <span class="uscript-operator">&lt;&lt;</span> <span class="uscript-number">16</span> <span class="uscript-operator">|</span> C <span class="uscript-operator">&gt;&gt;&gt;</span> <span class="uscript-operator">-</span><span class="uscript-number">16</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    B <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span>C <span class="uscript-operator">^</span> D <span class="uscript-operator">^</span> A<span class="uscript-operator">)</span> <span class="uscript-operator">+</span> W<span class="uscript-operator">[</span> <span class="uscript-number">6</span><span class="uscript-operator">]</span> <span class="uscript-operator">+</span> <span class="uscript-number">0x04881D05</span><span class="uscript-operator">;</span>    B <span class="uscript-operator">=</span> C <span class="uscript-operator">+</span> <span class="uscript-operator">(</span>B <span class="uscript-operator">&lt;&lt;</span> <span class="uscript-number">23</span> <span class="uscript-operator">|</span> B <span class="uscript-operator">&gt;&gt;&gt;</span> <span class="uscript-operator">-</span><span class="uscript-number">23</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    
    A <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span>B <span class="uscript-operator">^</span> C <span class="uscript-operator">^</span> D<span class="uscript-operator">)</span> <span class="uscript-operator">+</span> W<span class="uscript-operator">[</span> <span class="uscript-number">9</span><span class="uscript-operator">]</span> <span class="uscript-operator">+</span> <span class="uscript-number">0xD9D4D039</span><span class="uscript-operator">;</span>    A <span class="uscript-operator">=</span> B <span class="uscript-operator">+</span> <span class="uscript-operator">(</span>A <span class="uscript-operator">&lt;&lt;</span>  <span class="uscript-number">4</span> <span class="uscript-operator">|</span> A <span class="uscript-operator">&gt;&gt;&gt;</span>  <span class="uscript-operator">-</span><span class="uscript-number">4</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    D <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span>A <span class="uscript-operator">^</span> B <span class="uscript-operator">^</span> C<span class="uscript-operator">)</span> <span class="uscript-operator">+</span> W<span class="uscript-operator">[</span><span class="uscript-number">12</span><span class="uscript-operator">]</span> <span class="uscript-operator">+</span> <span class="uscript-number">0xE6DB99E5</span><span class="uscript-operator">;</span>    D <span class="uscript-operator">=</span> A <span class="uscript-operator">+</span> <span class="uscript-operator">(</span>D <span class="uscript-operator">&lt;&lt;</span> <span class="uscript-number">11</span> <span class="uscript-operator">|</span> D <span class="uscript-operator">&gt;&gt;&gt;</span> <span class="uscript-operator">-</span><span class="uscript-number">11</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    C <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span>D <span class="uscript-operator">^</span> A <span class="uscript-operator">^</span> B<span class="uscript-operator">)</span> <span class="uscript-operator">+</span> W<span class="uscript-operator">[</span><span class="uscript-number">15</span><span class="uscript-operator">]</span> <span class="uscript-operator">+</span> <span class="uscript-number">0x1FA27CF8</span><span class="uscript-operator">;</span>    C <span class="uscript-operator">=</span> D <span class="uscript-operator">+</span> <span class="uscript-operator">(</span>C <span class="uscript-operator">&lt;&lt;</span> <span class="uscript-number">16</span> <span class="uscript-operator">|</span> C <span class="uscript-operator">&gt;&gt;&gt;</span> <span class="uscript-operator">-</span><span class="uscript-number">16</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    B <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span>C <span class="uscript-operator">^</span> D <span class="uscript-operator">^</span> A<span class="uscript-operator">)</span> <span class="uscript-operator">+</span> W<span class="uscript-operator">[</span> <span class="uscript-number">2</span><span class="uscript-operator">]</span> <span class="uscript-operator">+</span> <span class="uscript-number">0xC4AC5665</span><span class="uscript-operator">;</span>    B <span class="uscript-operator">=</span> C <span class="uscript-operator">+</span> <span class="uscript-operator">(</span>B <span class="uscript-operator">&lt;&lt;</span> <span class="uscript-number">23</span> <span class="uscript-operator">|</span> B <span class="uscript-operator">&gt;&gt;&gt;</span> <span class="uscript-operator">-</span><span class="uscript-number">23</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    
    <span class="uscript-comment">// round 4</span>
    A <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span>C <span class="uscript-operator">^</span> <span class="uscript-operator">(</span>B <span class="uscript-operator">|</span> <span class="uscript-operator">~</span>D<span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">+</span> W<span class="uscript-operator">[</span> <span class="uscript-number">0</span><span class="uscript-operator">]</span> <span class="uscript-operator">+</span> <span class="uscript-number">0xF4292244</span><span class="uscript-operator">;</span>     A <span class="uscript-operator">=</span> B <span class="uscript-operator">+</span> <span class="uscript-operator">(</span>A <span class="uscript-operator">&lt;&lt;</span>  <span class="uscript-number">6</span> <span class="uscript-operator">|</span> A <span class="uscript-operator">&gt;&gt;&gt;</span>  <span class="uscript-operator">-</span><span class="uscript-number">6</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    D <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span>B <span class="uscript-operator">^</span> <span class="uscript-operator">(</span>A <span class="uscript-operator">|</span> <span class="uscript-operator">~</span>C<span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">+</span> W<span class="uscript-operator">[</span> <span class="uscript-number">7</span><span class="uscript-operator">]</span> <span class="uscript-operator">+</span> <span class="uscript-number">0x432AFF97</span><span class="uscript-operator">;</span>     D <span class="uscript-operator">=</span> A <span class="uscript-operator">+</span> <span class="uscript-operator">(</span>D <span class="uscript-operator">&lt;&lt;</span> <span class="uscript-number">10</span> <span class="uscript-operator">|</span> D <span class="uscript-operator">&gt;&gt;&gt;</span> <span class="uscript-operator">-</span><span class="uscript-number">10</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    C <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span>A <span class="uscript-operator">^</span> <span class="uscript-operator">(</span>D <span class="uscript-operator">|</span> <span class="uscript-operator">~</span>B<span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">+</span> W<span class="uscript-operator">[</span><span class="uscript-number">14</span><span class="uscript-operator">]</span> <span class="uscript-operator">+</span> <span class="uscript-number">0xAB9423A7</span><span class="uscript-operator">;</span>     C <span class="uscript-operator">=</span> D <span class="uscript-operator">+</span> <span class="uscript-operator">(</span>C <span class="uscript-operator">&lt;&lt;</span> <span class="uscript-number">15</span> <span class="uscript-operator">|</span> C <span class="uscript-operator">&gt;&gt;&gt;</span> <span class="uscript-operator">-</span><span class="uscript-number">15</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    B <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span>D <span class="uscript-operator">^</span> <span class="uscript-operator">(</span>C <span class="uscript-operator">|</span> <span class="uscript-operator">~</span>A<span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">+</span> W<span class="uscript-operator">[</span> <span class="uscript-number">5</span><span class="uscript-operator">]</span> <span class="uscript-operator">+</span> <span class="uscript-number">0xFC93A039</span><span class="uscript-operator">;</span>     B <span class="uscript-operator">=</span> C <span class="uscript-operator">+</span> <span class="uscript-operator">(</span>B <span class="uscript-operator">&lt;&lt;</span> <span class="uscript-number">21</span> <span class="uscript-operator">|</span> B <span class="uscript-operator">&gt;&gt;&gt;</span> <span class="uscript-operator">-</span><span class="uscript-number">21</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    
    A <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span>C <span class="uscript-operator">^</span> <span class="uscript-operator">(</span>B <span class="uscript-operator">|</span> <span class="uscript-operator">~</span>D<span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">+</span> W<span class="uscript-operator">[</span><span class="uscript-number">12</span><span class="uscript-operator">]</span> <span class="uscript-operator">+</span> <span class="uscript-number">0x655B59C3</span><span class="uscript-operator">;</span>     A <span class="uscript-operator">=</span> B <span class="uscript-operator">+</span> <span class="uscript-operator">(</span>A <span class="uscript-operator">&lt;&lt;</span>  <span class="uscript-number">6</span> <span class="uscript-operator">|</span> A <span class="uscript-operator">&gt;&gt;&gt;</span>  <span class="uscript-operator">-</span><span class="uscript-number">6</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    D <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span>B <span class="uscript-operator">^</span> <span class="uscript-operator">(</span>A <span class="uscript-operator">|</span> <span class="uscript-operator">~</span>C<span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">+</span> W<span class="uscript-operator">[</span> <span class="uscript-number">3</span><span class="uscript-operator">]</span> <span class="uscript-operator">+</span> <span class="uscript-number">0x8F0CCC92</span><span class="uscript-operator">;</span>     D <span class="uscript-operator">=</span> A <span class="uscript-operator">+</span> <span class="uscript-operator">(</span>D <span class="uscript-operator">&lt;&lt;</span> <span class="uscript-number">10</span> <span class="uscript-operator">|</span> D <span class="uscript-operator">&gt;&gt;&gt;</span> <span class="uscript-operator">-</span><span class="uscript-number">10</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    C <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span>A <span class="uscript-operator">^</span> <span class="uscript-operator">(</span>D <span class="uscript-operator">|</span> <span class="uscript-operator">~</span>B<span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">+</span> W<span class="uscript-operator">[</span><span class="uscript-number">10</span><span class="uscript-operator">]</span> <span class="uscript-operator">+</span> <span class="uscript-number">0xFFEFF47D</span><span class="uscript-operator">;</span>     C <span class="uscript-operator">=</span> D <span class="uscript-operator">+</span> <span class="uscript-operator">(</span>C <span class="uscript-operator">&lt;&lt;</span> <span class="uscript-number">15</span> <span class="uscript-operator">|</span> C <span class="uscript-operator">&gt;&gt;&gt;</span> <span class="uscript-operator">-</span><span class="uscript-number">15</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    B <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span>D <span class="uscript-operator">^</span> <span class="uscript-operator">(</span>C <span class="uscript-operator">|</span> <span class="uscript-operator">~</span>A<span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">+</span> W<span class="uscript-operator">[</span> <span class="uscript-number">1</span><span class="uscript-operator">]</span> <span class="uscript-operator">+</span> <span class="uscript-number">0x85845dd1</span><span class="uscript-operator">;</span>     B <span class="uscript-operator">=</span> C <span class="uscript-operator">+</span> <span class="uscript-operator">(</span>B <span class="uscript-operator">&lt;&lt;</span> <span class="uscript-number">21</span> <span class="uscript-operator">|</span> B <span class="uscript-operator">&gt;&gt;&gt;</span> <span class="uscript-operator">-</span><span class="uscript-number">21</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    
    A <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span>C <span class="uscript-operator">^</span> <span class="uscript-operator">(</span>B <span class="uscript-operator">|</span> <span class="uscript-operator">~</span>D<span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">+</span> W<span class="uscript-operator">[</span> <span class="uscript-number">8</span><span class="uscript-operator">]</span> <span class="uscript-operator">+</span> <span class="uscript-number">0x6FA87E4F</span><span class="uscript-operator">;</span>     A <span class="uscript-operator">=</span> B <span class="uscript-operator">+</span> <span class="uscript-operator">(</span>A <span class="uscript-operator">&lt;&lt;</span>  <span class="uscript-number">6</span> <span class="uscript-operator">|</span> A <span class="uscript-operator">&gt;&gt;&gt;</span>  <span class="uscript-operator">-</span><span class="uscript-number">6</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    D <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span>B <span class="uscript-operator">^</span> <span class="uscript-operator">(</span>A <span class="uscript-operator">|</span> <span class="uscript-operator">~</span>C<span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">+</span> W<span class="uscript-operator">[</span><span class="uscript-number">15</span><span class="uscript-operator">]</span> <span class="uscript-operator">+</span> <span class="uscript-number">0xFE2CE6E0</span><span class="uscript-operator">;</span>     D <span class="uscript-operator">=</span> A <span class="uscript-operator">+</span> <span class="uscript-operator">(</span>D <span class="uscript-operator">&lt;&lt;</span> <span class="uscript-number">10</span> <span class="uscript-operator">|</span> D <span class="uscript-operator">&gt;&gt;&gt;</span> <span class="uscript-operator">-</span><span class="uscript-number">10</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    C <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span>A <span class="uscript-operator">^</span> <span class="uscript-operator">(</span>D <span class="uscript-operator">|</span> <span class="uscript-operator">~</span>B<span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">+</span> W<span class="uscript-operator">[</span> <span class="uscript-number">6</span><span class="uscript-operator">]</span> <span class="uscript-operator">+</span> <span class="uscript-number">0xA3014314</span><span class="uscript-operator">;</span>     C <span class="uscript-operator">=</span> D <span class="uscript-operator">+</span> <span class="uscript-operator">(</span>C <span class="uscript-operator">&lt;&lt;</span> <span class="uscript-number">15</span> <span class="uscript-operator">|</span> C <span class="uscript-operator">&gt;&gt;&gt;</span> <span class="uscript-operator">-</span><span class="uscript-number">15</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    B <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span>D <span class="uscript-operator">^</span> <span class="uscript-operator">(</span>C <span class="uscript-operator">|</span> <span class="uscript-operator">~</span>A<span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">+</span> W<span class="uscript-operator">[</span><span class="uscript-number">13</span><span class="uscript-operator">]</span> <span class="uscript-operator">+</span> <span class="uscript-number">0x4E0811A1</span><span class="uscript-operator">;</span>     B <span class="uscript-operator">=</span> C <span class="uscript-operator">+</span> <span class="uscript-operator">(</span>B <span class="uscript-operator">&lt;&lt;</span> <span class="uscript-number">21</span> <span class="uscript-operator">|</span> B <span class="uscript-operator">&gt;&gt;&gt;</span> <span class="uscript-operator">-</span><span class="uscript-number">21</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    
    A <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span>C <span class="uscript-operator">^</span> <span class="uscript-operator">(</span>B <span class="uscript-operator">|</span> <span class="uscript-operator">~</span>D<span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">+</span> W<span class="uscript-operator">[</span> <span class="uscript-number">4</span><span class="uscript-operator">]</span> <span class="uscript-operator">+</span> <span class="uscript-number">0xF7537E82</span><span class="uscript-operator">;</span>     A <span class="uscript-operator">=</span> B <span class="uscript-operator">+</span> <span class="uscript-operator">(</span>A <span class="uscript-operator">&lt;&lt;</span>  <span class="uscript-number">6</span> <span class="uscript-operator">|</span> A <span class="uscript-operator">&gt;&gt;&gt;</span>  <span class="uscript-operator">-</span><span class="uscript-number">6</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    D <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span>B <span class="uscript-operator">^</span> <span class="uscript-operator">(</span>A <span class="uscript-operator">|</span> <span class="uscript-operator">~</span>C<span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">+</span> W<span class="uscript-operator">[</span><span class="uscript-number">11</span><span class="uscript-operator">]</span> <span class="uscript-operator">+</span> <span class="uscript-number">0xBD3AF235</span><span class="uscript-operator">;</span>     D <span class="uscript-operator">=</span> A <span class="uscript-operator">+</span> <span class="uscript-operator">(</span>D <span class="uscript-operator">&lt;&lt;</span> <span class="uscript-number">10</span> <span class="uscript-operator">|</span> D <span class="uscript-operator">&gt;&gt;&gt;</span> <span class="uscript-operator">-</span><span class="uscript-number">10</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    C <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span>A <span class="uscript-operator">^</span> <span class="uscript-operator">(</span>D <span class="uscript-operator">|</span> <span class="uscript-operator">~</span>B<span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">+</span> W<span class="uscript-operator">[</span> <span class="uscript-number">2</span><span class="uscript-operator">]</span> <span class="uscript-operator">+</span> <span class="uscript-number">0x2AD7D2BB</span><span class="uscript-operator">;</span>     C <span class="uscript-operator">=</span> D <span class="uscript-operator">+</span> <span class="uscript-operator">(</span>C <span class="uscript-operator">&lt;&lt;</span> <span class="uscript-number">15</span> <span class="uscript-operator">|</span> C <span class="uscript-operator">&gt;&gt;&gt;</span> <span class="uscript-operator">-</span><span class="uscript-number">15</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    B <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span>D <span class="uscript-operator">^</span> <span class="uscript-operator">(</span>C <span class="uscript-operator">|</span> <span class="uscript-operator">~</span>A<span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">+</span> W<span class="uscript-operator">[</span> <span class="uscript-number">9</span><span class="uscript-operator">]</span> <span class="uscript-operator">+</span> <span class="uscript-number">0xEB86D391</span><span class="uscript-operator">;</span>     B <span class="uscript-operator">=</span> C <span class="uscript-operator">+</span> <span class="uscript-operator">(</span>B <span class="uscript-operator">&lt;&lt;</span> <span class="uscript-number">21</span> <span class="uscript-operator">|</span> B <span class="uscript-operator">&gt;&gt;&gt;</span> <span class="uscript-operator">-</span><span class="uscript-number">21</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    
    <span class="uscript-comment">// add this chunk's hash to result so far</span>
    <span class="uscript-keyword">default</span><span class="uscript-operator">.</span>StaticHashValue<span class="uscript-operator">.</span>A <span class="uscript-operator">+=</span> A<span class="uscript-operator">;</span>
    <span class="uscript-keyword">default</span><span class="uscript-operator">.</span>StaticHashValue<span class="uscript-operator">.</span>B <span class="uscript-operator">+=</span> B<span class="uscript-operator">;</span>
    <span class="uscript-keyword">default</span><span class="uscript-operator">.</span>StaticHashValue<span class="uscript-operator">.</span>C <span class="uscript-operator">+=</span> C<span class="uscript-operator">;</span>
    <span class="uscript-keyword">default</span><span class="uscript-operator">.</span>StaticHashValue<span class="uscript-operator">.</span>D <span class="uscript-operator">+=</span> D<span class="uscript-operator">;</span>
    
    <span class="uscript-keyword">default</span><span class="uscript-operator">.</span>StaticData<span class="uscript-operator">.</span><span class="uscript-keyword">Remove</span><span class="uscript-operator">(</span><span class="uscript-number">0</span><span class="uscript-operator">,</span> <span class="uscript-number">64</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
  <span class="uscript-operator">}</span>
<span class="uscript-operator">}</span></pre><h2><a name="0.4"></a>Implementation Notes</h2>
<p>Only the 5 least significant bits of the second operand of <a href="unrealscript.html">UnrealScript</a>'s bitshift operators are used. That means, for example <code>(C &gt;&gt;&gt; -30)</code> is the same as <code>(C &gt;&gt;&gt; 2)</code>.</p>
<p>The implementation avoids the unneccessary circular variable assignments and additional function calls the original MD5 implementation in RFC 1321 and on Wikipedia suggest. While Wikipedia's very efficient notation of the main loop (see below) is very small, the high number of assignments make it quite slow in UnrealScript.</p>
<pre class="paraverbatim">    <em class="em2">for</em> i <em class="em2">from</em> 0 to 63
        <em class="em2">if</em> 0 &#8804; i &#8804; 15 <em class="em2">then</em>
            f := (b <em class="em2">and</em> c) <em class="em2">or</em> ((<em class="em2">not</em> b) <em class="em2">and</em> d)
            g := i
        <em class="em2">else if</em> 16 &#8804; i &#8804; 31
            f := (d <em class="em2">and</em> b) <em class="em2">or</em> ((<em class="em2">not</em> d) <em class="em2">and</em> c)
            g := (5*i + 1) <em class="em2">mod</em> 16
        <em class="em2">else if</em> 32 &#8804; i &#8804; 47
            f := b <em class="em2">xor</em> c <em class="em2">xor</em> d
            g := (3*i + 5) <em class="em2">mod</em> 16
        <em class="em2">else if</em> 48 &#8804; i &#8804; 63
            f := c <em class="em2">xor</em> (b <em class="em2">or</em> (<em class="em2">not</em> d))
            g := (7*i) <em class="em2">mod</em> 16
 
        temp := d
        d := c
        c := b
        b := ((a + f + k(i) + w(g)) <em class="em2">leftrotate</em> r(i)) + b
        a := temp</pre><p>Another difference from the original implementation suggestions are the calculations on the first and second round. This algorithm implements the optimizations suggested by Wikipedia: <code>d xor (b and (c xor d))</code> instead of <code>(b and c) or ((not b) and d)</code> for the first round and <code>c xor (d and (b xor c))</code> instead of <code>(d and b) or ((not d) and c)</code> for the second round. This results in a lower number of operations without changing the result.</p>
<h2><a name="0.5"></a>Related Topics</h2>
<ul><li><a href="sha1hash.html">SHA1Hash</a> &ndash; a similar class for calculating SHA1 hashes</li>
<li><span class="interwiki"><img 
      alt="Wikipedia logo"
      title="Wikipedia"
      src="shared//InterWiki-Wikipedia.png">&nbsp;<a href="http://www.wikipedia.com/wiki/MD5">MD5</a></span> &ndash; Wikipedia article about the MD5 hash function</li>
</ul>
<hr class="thin"><p><a href="category-custom-class.html">Category Custom Class</a><br><a href="category-algorithm.html">Category Algorithm</a></p>
<script type="text/javascript"><!--
 menuItemAdd("Usage", "#0.1");
menuItemAdd("Methods", "#0.2");
menuItemAdd("<tt>&nbsp;&nbsp;</tt>Static Methods", "#0.2.1");
menuItemAdd("Code", "#0.3");
menuItemAdd("Implementation Notes", "#0.4");
menuItemAdd("Related Topics", "#0.5");
 menuWrite() //--></script></div>
</div>

<div id="footer" class="bar">
	<p><form method="post" action="http://wiki.beyondunreal.com/wiki" enctype="application/x-www-form-urlencoded">
<a href="(start).html">Home Page</a> | <a href="recent-changes.html">Recent Changes</a> | <a href="http://wiki.beyondunreal.com/wiki?action=editprefs">Preferences</a><br>
<a href="http://wiki.beyondunreal.com/wiki?action=edit&id=MD5Hash">Edit text of this page</a> | <a href="http://wiki.beyondunreal.com/wiki?action=history&id=MD5Hash">View other revisions</a><br>Last edited February 13, 2006 4:55 <a href="http://wiki.beyondunreal.com/wiki?action=browse&diff=1&id=MD5Hash">(diff)</a><br>Search: <input type="text" name="search"  size="20" /><input type="hidden" name="dosearch" value="1"  /><br><br><small><a href="http://wiki.beyondunreal.com/wiki/MD5Hash">Original page</a> &#150; copy created Sat, Jun 23, 2007</small><div></div>
</form>
	</p>
	<p>Mostly Harmless
</p>
</div>
</div><!-- close of "scrolling" div -->

<div id="quickbar">
	<div id="logo"><a href="http://wiki.beyondunreal.com/"><img src="shared/wikilogo.jpg" width="143" height="100" border="0"></a>
		</div>
	<div class="qbsitename">
		<p>The Unreal Engine Documentation Site</p>
	</div>
	<div class="qbsection">
<p><a href="metatopics.html">Wiki Community</a></p>
<p><a href="category-category.html">Topic Categories</a></p>
<p><a href="/cgi-bin/imageupload.cgi/wiki-ext/imageupload.htt" target="_blank ">Image Uploads</a></p>
<p><a href="http://wiki.beyondunreal.com/wiki?action=random">Random Page</a></p>
<p><a href="recent-changes.html">Recent Changes</a></p>
<p><a href="offline-wiki.html">Offline Wiki</a></p>
</div><div class="qbsection">
<p><a href="unreal-engine.html">Unreal Engine</a></p>
<p><a href="console-commands.html">Console Commands</a></p>
<p><a href="terminology.html">Terminology</a></p>
<p><a href="category-faq.html">FAQs</a></p>
<p><a href="help-desk.html">Help Desk</a></p>
</div><div class="qbsection">
<p><a href="topics-on-mapping.html">Mapping Topics</a></p>
<p><a href="mapping-lessons.html">Mapping Lessons</a></p>
<p><a href="unrealed-3.html">UnrealEd Interface</a></p>
</div><div class="qbsection">
<p><a href="unrealscript.html">UnrealScript Topics</a></p>
<p><a href="unrealscript-lessons.html">UnrealScript Lessons</a></p>
<p><a href="making-mods.html">Making Mods</a></p>
<p><a href="class-tree.html">Class Tree</a></p>
</div><div class="qbsection">
<p><a href="topics-on-modeling.html">Modeling Topics</a></p>
</div><div class="qbsection">
<p><a href="chongqing-page.html">Chongqing Page</a></p>
<p><a href="log-in.html">Log In</a></p></div>
</div>

</body></html>
