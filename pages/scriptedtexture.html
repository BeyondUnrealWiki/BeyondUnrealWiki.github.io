<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"  "http://www.w3.org/TR/html4/loose.dtd">

<html>
<head lang="en">
	<title>UnrealWiki: ScriptedTexture</title>
	<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
	<link rel="stylesheet" type="text/css" media="screen, print"
		href="shared/stylebase.structural.css">	
	<link rel="stylesheet" type="text/css" media="screen"
		href="shared/template-default.css">
	<link rel="stylesheet" type="text/css" media="screen"
		href="shared/styles.chblue.css">
	<link rel="stylesheet" type="text/css" media="print"
		href="shared/template-default-print.css">
	<!--[if IE 6]>
			<style>
			/* dirty hack for IE6. */
			#quickbar {
				position: absolute;
				}
			</style>
	<![endif]-->
  <link rel="start" href="http://wiki.beyondunreal.com/">
  <link rel="glossary"  href="http://wiki.beyondunreal.com/wiki/Terminology">
  <link rel="help"  href="http://wiki.beyondunreal.com/wiki/Using_The_Wiki">
<script type="text/javascript" src="shared/dhtml.js"></script>
<script type="text/javascript" src="shared/dhtml-menu.js"></script>
<style type="text/css">#dhtml-menu    { background: #eee; padding: 5px 0px; margin-right: -20px; border: 1px solid #888; border-left: 1px solid #ccc; border-top: 1px solid #ccc;  border-right: 1px solid #888; border-bottom: 1px solid #888 }
#dhtml-menu td { color: #000; font-family: Arial,Helvetica,sans-serif; font-size: 9pt; line-height: 13pt; padding: 1px 10px; cursor: default }
#dhtml-menu a  { color: #000; font-family: Arial,Helvetica,sans-serif; font-size: 9pt; line-height: 13pt; text-decoration: none }
#dhtml-menu tt { font-family: monospace; font-size: 9pt }
#dhtml-menu-separator { height: 1px; background: red }
#dhtml-menu-anchor { cursor: default }
</style>
<script type="text/javascript" src="shared/expandable.js"></script>
</head>
<body onLoad="menuInit(); document.cookie='page=ScriptedTexture; path=/'" class="default">
<div id="scrolling"><!-- contains all except the fixed sidebar -->
<div id="topbar"  class="bar">
	<div class="righthalf">
		<form class="inline" method="post" action="/wiki" enctype="application/x-www-form-urlencoded"><input type="text" name="search"  size="20" /> <input type="submit" name="search" value="search" /></form>
	</div>
	<div class="lefthalf">
		<script type="text/javascript"><!--
			menuAlignRight = false;
		//--></script>
		<span><script type="text/javascript"><!--
 menuWriteAnchor("Quick Navigation") //--></script></span> | <a href="../index.html">Home Page</a> | <a href="recent-changes.html">Recent Changes</a>
	</div>
</div>

<div id="content"><!-- contains the title and article -->
	<h1 class='pagetitle'><a href="http://wiki.beyondunreal.com/wiki?back=ScriptedTexture">ScriptedTexture</a></h1>
	<div class="wiki"><div class="classpath"><img src="shared//gameicons/icon-ut2003.png"> <a href="unreal-tournament-2003.html">UT2003</a> :: <a href="object.html">Object</a> &gt;&gt; <a href="material.html">Material</a> &gt;&gt; <a href="renderedmaterial.html">RenderedMaterial</a> &gt;&gt; <a href="bitmapmaterial.html">BitmapMaterial</a> &gt;&gt; ScriptedTexture (Package: Engine)<br></div>
<p>A ScriptedTexture is a <a href="dynamic-texture.html">dynamic texture</a> that can be drawn on in real-time with UnrealScript, used (for instance) for the monitors in DM-Insidious.</p>
<p><em class="em2">NOTE:</em> ScriptedTextures do not work in the software or OpenGL renderers.  If you use ScriptedTextures people on Mac or Linux and people using the software renderer will just see white.  Epic has stated that this issue will not be resolved.</p>
<p><em class="em2">Solid Snake:</em> I think this is now no longer true. I recall reading somewhere that scripted textures now work in OpenGL. Not sure about either Linux/Mac, but I assume since the Linux version of UT2004 is primarily OpenGL (I think...) it should also work there. Here is a indirect reference, <a href="http://www.unrealadmin.org/forums/printthread.php?threadid=12874">http://www.unrealadmin.org/forums/printthread.php?threadid=12874</a>. It states that OpenGL no longer renders ScriptedTextures upside down...</p>
<p><em class="em2">Bob_The_Beheader:</em> I use OpenGL in the Windows version, and the scripted textures do not appear. It's slightly annoying. I like seeing my nick on the hellbender licence plate.</p>
<p>See <a href="scriptedtexture-ut.html">ScriptedTexture (UT)</a> for the UT version of this class.</p>
<h2><a name="0.1"></a>Properties</h2>
<dl><dt><a href="actor.html">Actor</a> Client</dt><dd>The actor which is responsible for drawing the dynamic content on this ScriptedTexture.<br>Each frame when <tt>Revision &gt; OldRevision</tt>, this actor's RenderTexture event is called. <a href="cameratextureclient.html">CameraTextureClient</a>s point their assigned ScriptedTexture's Client property to themselves on game start.</dd><dt>int OldRevision (transient, const)</dt><dd>The last drawn revision.</dd><dt>int RenderTarget (transient, const)</dt><dd></dd><dt><a href="viewport.html">Viewport</a> RenderViewport (transient, const)</dt><dd></dd><dt>int Revision (transient)</dt><dd>Current revision. Increment this property to redraw the ScriptedTexture the next frame it is used.</dd></dl>
<h2><a name="0.2"></a>Methods</h2>
<p>All these methods are native and final.</p>
<dl><dt>DrawPortal (int X, int Y, int Width, int Height, <a href="actor.html">Actor</a> CamActor, vector CamLocation, rotator CamRotation, optional int FOV, optional bool ClearZ)</dt><dd>In the rectangle set by X, Y, Width, and Height, draws what the viewport would render from a camera at CamActor's position, offset by CamLocation, rotated by CamRotation. Absolutely impossible to do in UT, this is the Right Way to set up for a bank of CCTV monitors if you don't use <a href="cameratextureclient.html">CameraTextureClient</a>s.</dd><dt>DrawText (int StartX, int StartY, coerce string Text, Font Font, Color Color)</dt><dd>Draws text in the given font and color at the given position.</dd><dt>DrawTile (float X, float Y, float XL, float YL, float U, float V, float UL, float VL, <a href="material.html">Material</a> Material, Color Color)</dt><dd>Draws a material tile on the ScriptedTexture at the given X/Y position, stretched to XL/YL pixels, and taken from the area specified by U/V (horizontal/vertical texel offset) and UL/VL (width/height) from the given material.</dd><dt>SetSize (int Width,int Height)</dt><dd>Sets the size of the ScriptedTexture.</dd><dt>TextSize (coerce string Text, Font Font, out int Width, out int Height)</dt><dd>Returns the size of the given text in the given font in the out parameters Width and Height.</dd></dl>
<h2><a name="0.3"></a>Creation in Code</h2>
<p>A simple example of creating a new scripted texture for an actor dynamically at runtime.</p>
<pre class="uscript"><span class="uscript-keyword">var</span> <span class="uscript-keyword">protected</span> ScriptedTexture MyScriptedTexture<span class="uscript-operator">;</span>
<span class="uscript-keyword">var</span> <span class="uscript-keyword">protected</span> <span class="uscript-type">string</span> MyMessage<span class="uscript-operator">;</span>
<span class="uscript-keyword">var</span> <span class="uscript-keyword">protected</span> <span class="uscript-keyword">const</span> Font MyFont<span class="uscript-operator">;</span>
<span class="uscript-keyword">var</span> <span class="uscript-keyword">protected</span> <span class="uscript-keyword">const</span> color MyFontColor<span class="uscript-operator">;</span>

<span class="uscript-keyword">event</span> PostBeginPlay<span class="uscript-operator">(</span><span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
  <span class="uscript-keyword">Super</span><span class="uscript-operator">.</span>PostBeginPlay<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>

  <span class="uscript-comment">// Allocate a new scripted texture from the pool</span>
  <span class="uscript-comment">// and have it call us for updates.</span>
  MyScriptedTexture <span class="uscript-operator">=</span> ScriptedTexture<span class="uscript-operator">(</span>
    Level<span class="uscript-operator">.</span>ObjectPool<span class="uscript-operator">.</span>AllocateObject<span class="uscript-operator">(</span> <span class="uscript-keyword">class</span><span class="uscript-name">'ScriptedTexture'</span> <span class="uscript-operator">)</span> <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
  MyScriptedTexture<span class="uscript-operator">.</span>SetSize<span class="uscript-operator">(</span> <span class="uscript-number">256</span><span class="uscript-operator">,</span> <span class="uscript-number">256</span> <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
  MyScriptedTexture<span class="uscript-operator">.</span>Client <span class="uscript-operator">=</span> <span class="uscript-keyword">Self</span><span class="uscript-operator">;</span>

  <span class="uscript-comment">// Attach the texture to one of the actors</span>
  <span class="uscript-comment">// skin materials.</span>
  Skins<span class="uscript-operator">[</span><span class="uscript-number">0</span><span class="uscript-operator">]</span> <span class="uscript-operator">=</span> MyScriptedTexture<span class="uscript-operator">;</span>

  SetMessage<span class="uscript-operator">(</span> <span class="uscript-string">"Hello Texture!"</span> <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-operator">}</span>

<span class="uscript-keyword">event</span> Destroyed<span class="uscript-operator">(</span><span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
  <span class="uscript-comment">// You should disconnect the object </span>
  <span class="uscript-comment">// pool texture from everything you've</span>
  <span class="uscript-comment">// assigned it to.</span>
  Skins<span class="uscript-operator">[</span><span class="uscript-number">0</span><span class="uscript-operator">]</span> <span class="uscript-operator">=</span> <span class="uscript-keyword">None</span><span class="uscript-operator">;</span>

  <span class="uscript-comment">// Clean up else you will leak resources.</span>
  <span class="uscript-keyword">assert</span><span class="uscript-operator">(</span> MyScriptedTexture <span class="uscript-operator">!=</span> <span class="uscript-keyword">None</span> <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
  Level<span class="uscript-operator">.</span>ObjectPool<span class="uscript-operator">.</span>FreeObject<span class="uscript-operator">(</span> MyScriptedTexture <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
  MyScriptedTexture <span class="uscript-operator">=</span> <span class="uscript-keyword">None</span><span class="uscript-operator">;</span>

  <span class="uscript-keyword">Super</span><span class="uscript-operator">.</span>Destroyed<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-operator">}</span>

<span class="uscript-keyword">function</span> SetMessage<span class="uscript-operator">(</span> <span class="uscript-type">string</span> NewMessage <span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
  <span class="uscript-comment">// Change the message and force an update</span>
  <span class="uscript-comment">// of the scripted texture on the next </span>
  <span class="uscript-comment">// frame it's visible.</span>
  MyMessage <span class="uscript-operator">=</span> NewMessage<span class="uscript-operator">;</span>
  <span class="uscript-keyword">assert</span><span class="uscript-operator">(</span> MyScriptedTexture <span class="uscript-operator">!=</span> <span class="uscript-keyword">None</span> <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
  <span class="uscript-operator">++</span>MyScriptedTexture<span class="uscript-operator">.</span>Revision<span class="uscript-operator">;</span>
<span class="uscript-operator">}</span>

<span class="uscript-keyword">event</span> RenderTexture<span class="uscript-operator">(</span> ScriptedTexture Tex <span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
  <span class="uscript-keyword">local</span> <span class="uscript-type">int</span> w<span class="uscript-operator">,</span> h<span class="uscript-operator">;</span>

  <span class="uscript-keyword">assert</span><span class="uscript-operator">(</span> Tex <span class="uscript-operator">==</span> MyScriptedTexture <span class="uscript-operator">)</span><span class="uscript-operator">;</span>

  <span class="uscript-comment">// Draw the text centered.</span>
  Tex<span class="uscript-operator">.</span>TextSize<span class="uscript-operator">(</span> MyMessage<span class="uscript-operator">,</span> MyFont<span class="uscript-operator">,</span> w<span class="uscript-operator">,</span> h <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
  Tex<span class="uscript-operator">.</span>DrawText<span class="uscript-operator">(</span> <span class="uscript-operator">(</span> Tex<span class="uscript-operator">.</span>USize <span class="uscript-operator">/</span> <span class="uscript-number">2</span> <span class="uscript-operator">)</span> <span class="uscript-operator">-</span> <span class="uscript-operator">(</span> w <span class="uscript-operator">/</span> <span class="uscript-number">2</span> <span class="uscript-operator">)</span><span class="uscript-operator">,</span>
    <span class="uscript-operator">(</span> Tex<span class="uscript-operator">.</span>VSize <span class="uscript-operator">/</span> <span class="uscript-number">2</span> <span class="uscript-operator">)</span> <span class="uscript-operator">-</span> <span class="uscript-operator">(</span> h <span class="uscript-operator">/</span> <span class="uscript-number">2</span> <span class="uscript-operator">)</span><span class="uscript-operator">,</span>
    MyMessage<span class="uscript-operator">,</span> MyFont<span class="uscript-operator">,</span> MyFontColor <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-operator">}</span>

<span class="uscript-keyword">defaultproperties</span>
<span class="uscript-operator">{</span>
  MyFont<span class="uscript-operator">=</span>Font<span class="uscript-name">'UT2003Fonts.FontNeuzeit17'</span>
  MyFontColor<span class="uscript-operator">=</span><span class="uscript-operator">(</span>R<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">,</span>G<span class="uscript-operator">=</span><span class="uscript-number">255</span><span class="uscript-operator">,</span>B<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">,</span>A<span class="uscript-operator">=</span><span class="uscript-number">255</span><span class="uscript-operator">)</span>
<span class="uscript-operator">}</span></pre><p><em class="em2">Shambler:</em> Scripted textures have a problem with rendering maps containing skyboxes when UseStencil is set to True in UT2004.ini but when UseStencil is False warp zones and some other things stop working, here is a little hack I coded which gets them to work together <img alt=":)" src="emoticons/smile.gif" align="middle"></p>
<pre class="uscript"><span class="uscript-keyword">simulated</span> <span class="uscript-keyword">event</span> RenderTexture<span class="uscript-operator">(</span>ScriptedTexture Tex<span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
    <span class="uscript-keyword">local</span> RenderDevice rDev<span class="uscript-operator">;</span>
    <span class="uscript-keyword">local</span> <span class="uscript-type">string</span> sInitVal<span class="uscript-operator">;</span>

    <span class="uscript-comment">// Lovely hack for scripted textures :)</span>
    rDev <span class="uscript-operator">=</span> GameEngine<span class="uscript-operator">(</span>FindObject<span class="uscript-operator">(</span><span class="uscript-string">"Package.GameEngine"</span><span class="uscript-operator">,</span> <span class="uscript-keyword">Class</span><span class="uscript-name">'GameEngine'</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">.</span>GRenDev<span class="uscript-operator">;</span>

    sInitVal <span class="uscript-operator">=</span> rDev<span class="uscript-operator">.</span>GetPropertyText<span class="uscript-operator">(</span><span class="uscript-string">"UseStencil"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    rDev<span class="uscript-operator">.</span>SetPropertyText<span class="uscript-operator">(</span><span class="uscript-string">"UseStencil"</span><span class="uscript-operator">,</span> <span class="uscript-string">"False"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>

    <span class="uscript-comment">// Draw stuff</span>

    rDev<span class="uscript-operator">.</span>SetPropertyText<span class="uscript-operator">(</span><span class="uscript-string">"UseStencil"</span><span class="uscript-operator">,</span> sInitVal<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-operator">}</span></pre><h2><a name="0.4"></a>Creation in UnrealEd</h2>
<p>This page describes how to make a ScriptedTexture in UnrealEd and draw some text on it with script: <a href="writing-on-scriptedtextures.html">Writing On ScriptedTextures</a>.</p>
<hr class="thin"><p><a href="category-to-do.html">Category To Do</a></p>
<p><a href="category-class-ut2003.html">Category Class (UT2003)</a></p>
<script type="text/javascript"><!--
 menuItemAdd("Properties", "#0.1");
menuItemAdd("Methods", "#0.2");
menuItemAdd("Creation in Code", "#0.3");
menuItemAdd("Creation in UnrealEd", "#0.4");
 menuWrite() //--></script></div>
</div>

<div id="footer" class="bar">
	<p><form method="post" action="http://wiki.beyondunreal.com/wiki" enctype="application/x-www-form-urlencoded">
<a href="../index.html">Home Page</a> | <a href="recent-changes.html">Recent Changes</a><br>
Last edited September 26, 2006 15:09 <a href="http://wiki.beyondunreal.com/wiki?action=browse&diff=1&id=ScriptedTexture">(diff)</a><br>Search: <input type="text" name="search"  size="20" /><input type="hidden" name="dosearch" value="1"  /><br><br><small><a href="http://wiki.beyondunreal.com/wiki/ScriptedTexture">Original page</a> &#150; copy created Sat, Jun 23, 2007</small><div></div>
</form>
	</p>
	<p>Worst-case scenario: the UEd Goblin wipes the map and burns down your house.
</p>
</div>
</div><!-- close of "scrolling" div -->

<div id="quickbar">
	<div id="logo"><a href="../index.html"><img src="shared/wikilogo.jpg" width="143" height="100" border="0"></a>
		</div>
	<div class="qbsitename">
		<p>The Unreal Engine Documentation Site</p>
	</div>
	<div class="qbsection">
<p><a href="metatopics.html">Wiki Community</a></p>
<p><a href="category-category.html">Topic Categories</a></p>


<p><a href="recent-changes.html">Recent Changes</a></p>
<p><a href="offline-wiki.html">Offline Wiki</a></p>
</div><div class="qbsection">
<p><a href="unreal-engine.html">Unreal Engine</a></p>
<p><a href="console-commands.html">Console Commands</a></p>
<p><a href="terminology.html">Terminology</a></p>
<p><a href="category-faq.html">FAQs</a></p>
<p><a href="help-desk.html">Help Desk</a></p>
</div><div class="qbsection">
<p><a href="topics-on-mapping.html">Mapping Topics</a></p>
<p><a href="mapping-lessons.html">Mapping Lessons</a></p>
<p><a href="unrealed-3.html">UnrealEd Interface</a></p>
</div><div class="qbsection">
<p><a href="unrealscript.html">UnrealScript Topics</a></p>
<p><a href="unrealscript-lessons.html">UnrealScript Lessons</a></p>
<p><a href="making-mods.html">Making Mods</a></p>
<p><a href="class-tree.html">Class Tree</a></p>
</div><div class="qbsection">
<p><a href="topics-on-modeling.html">Modeling Topics</a></p>
</div><div class="qbsection">
<p><a href="chongqing-page.html">Chongqing Page</a></p>
<p><a href="log-in.html">Log In</a></p></div>
</div>

</body></html>
