<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"  "http://www.w3.org/TR/html4/loose.dtd">

<html>
<head lang="en">
	<title>UnrealWiki: LadderQuery</title>
	<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
	<link rel="stylesheet" type="text/css" media="screen, print"
		href="shared/stylebase.structural.css">	
	<link rel="stylesheet" type="text/css" media="screen"
		href="shared/template-default.css">
	<link rel="stylesheet" type="text/css" media="screen"
		href="shared/styles.chblue.css">
	<link rel="stylesheet" type="text/css" media="print"
		href="shared/template-default-print.css">
	<!--[if IE 6]>
			<style>
			/* dirty hack for IE6. */
			#quickbar {
				position: absolute;
				}
			</style>
	<![endif]-->
  <link rel="start" href="http://wiki.beyondunreal.com/">
  <link rel="glossary"  href="http://wiki.beyondunreal.com/wiki/Terminology">
  <link rel="help"  href="http://wiki.beyondunreal.com/wiki/Using_The_Wiki">
<script type="text/javascript" src="shared/dhtml.js"></script>
<script type="text/javascript" src="shared/dhtml-menu.js"></script>
<style type="text/css">#dhtml-menu    { background: #eee; padding: 5px 0px; margin-right: -20px; border: 1px solid #888; border-left: 1px solid #ccc; border-top: 1px solid #ccc;  border-right: 1px solid #888; border-bottom: 1px solid #888 }
#dhtml-menu td { color: #000; font-family: Arial,Helvetica,sans-serif; font-size: 9pt; line-height: 13pt; padding: 1px 10px; cursor: default }
#dhtml-menu a  { color: #000; font-family: Arial,Helvetica,sans-serif; font-size: 9pt; line-height: 13pt; text-decoration: none }
#dhtml-menu tt { font-family: monospace; font-size: 9pt }
#dhtml-menu-separator { height: 1px; background: red }
#dhtml-menu-anchor { cursor: default }
</style>
<script type="text/javascript" src="shared/expandable.js"></script>
</head>
<body onLoad="menuInit(); document.cookie='page=LadderQuery; path=/'" class="default">
<div id="scrolling"><!-- contains all except the fixed sidebar -->
<div id="topbar"  class="bar">
	<div class="righthalf">
		<form class="inline" method="post" action="/wiki" enctype="application/x-www-form-urlencoded"><input type="text" name="search"  size="20" /> <input type="submit" name="search" value="search" /></form>
	</div>
	<div class="lefthalf">
		<script type="text/javascript"><!--
			menuAlignRight = false;
		//--></script>
		<span><script type="text/javascript"><!--
 menuWriteAnchor("Quick Navigation") //--></script></span> | <a href="(start).html">Home Page</a> | <a href="recent-changes.html">Recent Changes</a> | <a href="http://wiki.beyondunreal.com/wiki?action=editprefs">Preferences</a>
	</div>
</div>

<div id="content"><!-- contains the title and article -->
	<h1 class='pagetitle'><a href="http://wiki.beyondunreal.com/wiki?back=LadderQuery">LadderQuery</a></h1>
	<div class="wiki"><div class="classpath"><img src="shared//gameicons/icon-ut2003.png"> <a href="unreal-tournament-2003.html">UT2003</a> :: <a href="object.html">Object</a> &gt;&gt; XAdminBase<a href="http://wiki.beyondunreal.com/wiki?action=edit&id=XAdminBase&referrerid=LadderQuery">?</a> &gt;&gt; xWebQueryHandler<a href="http://wiki.beyondunreal.com/wiki?action=edit&id=XWebQueryHandler&referrerid=LadderQuery">?</a> &gt;&gt; LadderQuery (<a href="ladder1-46.html">Ladder1.46</a>)<br></div>
<pre class="uscript"><span class="uscript-line">00001</span>  <span class="uscript-comment">//-----------------------------------------------------------</span>
<span class="uscript-line">00002</span>  <span class="uscript-comment">//  Ladder.LadderQuery</span>
<span class="uscript-line">00003</span>  <span class="uscript-comment">//  QueryHandler for webadmin interface</span>
<span class="uscript-line">00004</span>  <span class="uscript-comment">//-----------------------------------------------------------</span>
<span class="uscript-line">00005</span>  <span class="uscript-keyword">class</span> LadderQuery <span class="uscript-keyword">extends</span> xWebQueryHandler
<span class="uscript-line">00006</span>      <span class="uscript-keyword">DependsOn</span><span class="uscript-operator">(</span>ProfileConfigSet<span class="uscript-operator">)</span>
<span class="uscript-line">00007</span>      <span class="uscript-keyword">config</span><span class="uscript-operator">(</span>System<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00008</span>  
<span class="uscript-line">00009</span>  <span class="uscript-keyword">const</span> LOGNAME       <span class="uscript-operator">=</span> <span class="uscript-name">'LadderQuery'</span><span class="uscript-operator">;</span>
<span class="uscript-line">00010</span>  <span class="uscript-keyword">const</span> EPICNUMBER    <span class="uscript-operator">=</span> <span class="uscript-number">85</span><span class="uscript-operator">;</span>
<span class="uscript-line">00011</span>  
<span class="uscript-line">00012</span>  <span class="uscript-keyword">var</span> LadderGameRules LadderRules<span class="uscript-operator">;</span>
<span class="uscript-line">00013</span>  
<span class="uscript-line">00014</span>  <span class="uscript-comment">// Profile Tracking Variables</span>
<span class="uscript-line">00015</span>  <span class="uscript-keyword">var</span> SessionMaster           SMaster<span class="uscript-operator">;</span>
<span class="uscript-line">00016</span>  <span class="uscript-keyword">var</span> ConfigMaster            ConfigM<span class="uscript-operator">;</span>
<span class="uscript-line">00017</span>  <span class="uscript-keyword">var</span> <span class="uscript-type">string</span>                  EpicPackages<span class="uscript-operator">[</span>EPICNUMBER<span class="uscript-operator">]</span><span class="uscript-operator">;</span>
<span class="uscript-line">00018</span>  
<span class="uscript-line">00019</span>  <span class="uscript-comment">// Active Profile Variables</span>
<span class="uscript-line">00020</span>  <span class="uscript-keyword">var</span> StringArray         ProfileMaps<span class="uscript-operator">;</span>
<span class="uscript-line">00021</span>  <span class="uscript-keyword">var</span> ProfileExporter     ExportMaster<span class="uscript-operator">;</span>
<span class="uscript-line">00022</span>  <span class="uscript-keyword">var</span> ProfileConfigSet    CurrentProfile<span class="uscript-operator">;</span>
<span class="uscript-line">00023</span>  <span class="uscript-keyword">var</span> StringArray         ProfileMutators<span class="uscript-operator">;</span>
<span class="uscript-line">00024</span>  
<span class="uscript-line">00025</span>  <span class="uscript-keyword">var</span> <span class="uscript-type">string</span>              DefaultProfileName<span class="uscript-operator">;</span>
<span class="uscript-line">00026</span>  
<span class="uscript-line">00027</span>  <span class="uscript-comment">// Physical page that will be served</span>
<span class="uscript-line">00028</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">config</span> <span class="uscript-type">string</span>       MasterPage<span class="uscript-operator">;</span> <span class="uscript-comment">// This is main html page for Ladder</span>
<span class="uscript-line">00029</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">config</span> <span class="uscript-type">string</span>       SubFrame<span class="uscript-operator">;</span>   <span class="uscript-comment">// Manage sub-frame</span>
<span class="uscript-line">00030</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">config</span> <span class="uscript-type">string</span>       SubFrameMenu<span class="uscript-operator">;</span>   <span class="uscript-comment">// Sub-menu (GameType, Mutators, Maps, PlayInfo, Review)</span>
<span class="uscript-line">00031</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">config</span> <span class="uscript-type">string</span>       SubFrameContent<span class="uscript-operator">;</span>
<span class="uscript-line">00032</span>  
<span class="uscript-line">00033</span>  
<span class="uscript-line">00034</span>  <span class="uscript-comment">// Include Files</span>
<span class="uscript-line">00035</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">config</span> <span class="uscript-type">string</span>       IncludeTable<span class="uscript-operator">;</span>
<span class="uscript-line">00036</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">config</span> <span class="uscript-type">string</span>       IncludeSection<span class="uscript-operator">;</span>
<span class="uscript-line">00037</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">config</span> <span class="uscript-type">string</span>       IncludeRows<span class="uscript-operator">;</span>
<span class="uscript-line">00038</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">config</span> <span class="uscript-type">string</span>       IncludeCaptionButton<span class="uscript-operator">;</span>
<span class="uscript-line">00039</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">config</span> <span class="uscript-type">string</span>       IncludeMapSelect<span class="uscript-operator">;</span>
<span class="uscript-line">00040</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">config</span> <span class="uscript-type">string</span>       IncludeProfileName<span class="uscript-operator">;</span>
<span class="uscript-line">00041</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">config</span> <span class="uscript-type">string</span>       IncludeGameType<span class="uscript-operator">;</span>
<span class="uscript-line">00042</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">config</span> <span class="uscript-type">string</span>       IncludeCheckBox<span class="uscript-operator">;</span>
<span class="uscript-line">00043</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">config</span> <span class="uscript-type">string</span>       IncludeSwitch<span class="uscript-operator">;</span>
<span class="uscript-line">00044</span>  
<span class="uscript-line">00045</span>  <span class="uscript-comment">// Virtual paths that will be requested from clients</span>
<span class="uscript-line">00046</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">config</span> <span class="uscript-type">string</span>       ProfileViewURI<span class="uscript-operator">;</span>
<span class="uscript-line">00047</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">config</span> <span class="uscript-type">string</span>       ProfileEditURI<span class="uscript-operator">;</span>
<span class="uscript-line">00048</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">config</span> <span class="uscript-type">string</span>       ProfileMenuURI<span class="uscript-operator">;</span>
<span class="uscript-line">00049</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">config</span> <span class="uscript-type">string</span>       ProfileSwitchURI<span class="uscript-operator">;</span>
<span class="uscript-line">00050</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">config</span> <span class="uscript-type">string</span>       ProfileManageURI<span class="uscript-operator">;</span>
<span class="uscript-line">00051</span>  
<span class="uscript-line">00052</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">config</span> <span class="uscript-type">string</span>       SubFrameURI<span class="uscript-operator">;</span>    <span class="uscript-comment">// accessed through manage link - linked to SubFrame page</span>
<span class="uscript-line">00053</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">config</span> <span class="uscript-type">string</span>       SubFrameMenuURI<span class="uscript-operator">;</span>
<span class="uscript-line">00054</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">config</span> <span class="uscript-type">string</span>       SubMapsURI<span class="uscript-operator">;</span>
<span class="uscript-line">00055</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">config</span> <span class="uscript-type">string</span>       SubSavedURI<span class="uscript-operator">;</span>
<span class="uscript-line">00056</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">config</span> <span class="uscript-type">string</span>       SubRulesURI<span class="uscript-operator">;</span>
<span class="uscript-line">00057</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">config</span> <span class="uscript-type">string</span>       SubReviewURI<span class="uscript-operator">;</span>
<span class="uscript-line">00058</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">config</span> <span class="uscript-type">string</span>       SubGametypeURI<span class="uscript-operator">;</span>
<span class="uscript-line">00059</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">config</span> <span class="uscript-type">string</span>       SubMutatorsURI<span class="uscript-operator">;</span>
<span class="uscript-line">00060</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">config</span> <span class="uscript-type">string</span>       SubImportURI<span class="uscript-operator">;</span>
<span class="uscript-line">00061</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">config</span> <span class="uscript-type">string</span>       SubExportURI<span class="uscript-operator">;</span>
<span class="uscript-line">00062</span>  
<span class="uscript-line">00063</span>  <span class="uscript-comment">// Localized Page Help texts</span>
<span class="uscript-line">00064</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    HelpViewProfile<span class="uscript-operator">;</span>
<span class="uscript-line">00065</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    HelpEditProfile<span class="uscript-operator">;</span>
<span class="uscript-line">00066</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    HelpSwitchProfile<span class="uscript-operator">;</span>
<span class="uscript-line">00067</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    HelpManageProfile<span class="uscript-operator">;</span>
<span class="uscript-line">00068</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    HelpImportProfile<span class="uscript-operator">;</span>
<span class="uscript-line">00069</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    HelpExportProfile<span class="uscript-operator">;</span>
<span class="uscript-line">00070</span>  <span class="uscript-comment">// Subpage help text</span>
<span class="uscript-line">00071</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    HelpGameType<span class="uscript-operator">;</span>
<span class="uscript-line">00072</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    HelpMutators<span class="uscript-operator">;</span>
<span class="uscript-line">00073</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    HelpMaps<span class="uscript-operator">;</span>
<span class="uscript-line">00074</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    HelpPlayInfo<span class="uscript-operator">;</span>
<span class="uscript-line">00075</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    HelpReview<span class="uscript-operator">;</span>
<span class="uscript-line">00076</span>  
<span class="uscript-line">00077</span>  <span class="uscript-comment">// Localized Menu Link Text</span>
<span class="uscript-line">00078</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    LinkEditProfile<span class="uscript-operator">;</span>
<span class="uscript-line">00079</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    LinkViewProfile<span class="uscript-operator">;</span>
<span class="uscript-line">00080</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    LinkSwitchProfile<span class="uscript-operator">;</span>
<span class="uscript-line">00081</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    LinkManageProfile<span class="uscript-operator">;</span>
<span class="uscript-line">00082</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    LinkImportProfile<span class="uscript-operator">;</span>
<span class="uscript-line">00083</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    LinkExportProfile<span class="uscript-operator">;</span>
<span class="uscript-line">00084</span>  
<span class="uscript-line">00085</span>  <span class="uscript-comment">// for AddProfilePage/ManageProfilePage</span>
<span class="uscript-line">00086</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    TableTitle<span class="uscript-operator">[</span><span class="uscript-number">9</span><span class="uscript-operator">]</span><span class="uscript-operator">;</span>
<span class="uscript-line">00087</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    PageCaption<span class="uscript-operator">[</span><span class="uscript-number">9</span><span class="uscript-operator">]</span><span class="uscript-operator">;</span>
<span class="uscript-line">00088</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    ProfileButtonName<span class="uscript-operator">[</span><span class="uscript-number">9</span><span class="uscript-operator">]</span><span class="uscript-operator">;</span>
<span class="uscript-line">00089</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    ProfileButtonValue<span class="uscript-operator">[</span><span class="uscript-number">9</span><span class="uscript-operator">]</span><span class="uscript-operator">;</span>
<span class="uscript-line">00090</span>  
<span class="uscript-line">00091</span>  <span class="uscript-comment">// Section Headers &amp; Text</span>
<span class="uscript-line">00092</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    MapText<span class="uscript-operator">;</span>
<span class="uscript-line">00093</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    ErrorText<span class="uscript-operator">;</span>
<span class="uscript-line">00094</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    MutatorText<span class="uscript-operator">;</span>
<span class="uscript-line">00095</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    RequiredText<span class="uscript-operator">;</span>
<span class="uscript-line">00096</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    AvailableText<span class="uscript-operator">;</span>
<span class="uscript-line">00097</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    UnlimitedText<span class="uscript-operator">;</span>
<span class="uscript-line">00098</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    FollowingMaps<span class="uscript-operator">;</span>
<span class="uscript-line">00099</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    AreAssignedText<span class="uscript-operator">;</span>
<span class="uscript-line">00100</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    AreAvailableText<span class="uscript-operator">;</span>
<span class="uscript-line">00101</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    FollowingMutators<span class="uscript-operator">;</span>
<span class="uscript-line">00102</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    CommandLineOptionsTitle<span class="uscript-operator">;</span>
<span class="uscript-line">00103</span>  
<span class="uscript-line">00104</span>  <span class="uscript-comment">// Button Values</span>
<span class="uscript-line">00105</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    ButtonLoadProfile<span class="uscript-operator">;</span>          <span class="uscript-comment">// Label for "switch immediately" button</span>
<span class="uscript-line">00106</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    ButtonDeleteProfile<span class="uscript-operator">;</span>
<span class="uscript-line">00107</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    ButtonPreviewProfile<span class="uscript-operator">;</span>       <span class="uscript-comment">// Label for previewing remote profile button</span>
<span class="uscript-line">00108</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    ButtonApplyImportProfile<span class="uscript-operator">;</span>
<span class="uscript-line">00109</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    ButtonApplyExportProfile<span class="uscript-operator">;</span>
<span class="uscript-line">00110</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    ButtonApplyProfileChanges<span class="uscript-operator">;</span>
<span class="uscript-line">00111</span>  
<span class="uscript-line">00112</span>  <span class="uscript-comment">// Input form labels</span>
<span class="uscript-line">00113</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    LabelCopyProfile<span class="uscript-operator">;</span>
<span class="uscript-line">00114</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    LabelDeleteProfile<span class="uscript-operator">;</span>
<span class="uscript-line">00115</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    LabelImportProfile<span class="uscript-operator">;</span>
<span class="uscript-line">00116</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    LabelExportProfile<span class="uscript-operator">;</span>
<span class="uscript-line">00117</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    LabelAddProfile<span class="uscript-operator">;</span>
<span class="uscript-line">00118</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    LabelSelectActions<span class="uscript-operator">;</span>
<span class="uscript-line">00119</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    LabelTextboxActions<span class="uscript-operator">;</span>
<span class="uscript-line">00120</span>  
<span class="uscript-line">00121</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    LabelPlayInfo<span class="uscript-operator">;</span>
<span class="uscript-line">00122</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    LabelGeneralProfile<span class="uscript-operator">;</span>
<span class="uscript-line">00123</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    LabelGameType<span class="uscript-operator">;</span>
<span class="uscript-line">00124</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    LabelProfileName<span class="uscript-operator">;</span>
<span class="uscript-line">00125</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    LabelAccessControl<span class="uscript-operator">;</span>
<span class="uscript-line">00126</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    LabelChooseAction<span class="uscript-operator">;</span>
<span class="uscript-line">00127</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    LabelManagement<span class="uscript-operator">;</span>
<span class="uscript-line">00128</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    LabelInputDescription<span class="uscript-operator">;</span>
<span class="uscript-line">00129</span>  
<span class="uscript-line">00130</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    LabelMaxMaps<span class="uscript-operator">;</span>
<span class="uscript-line">00131</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    LabelNumberGames<span class="uscript-operator">;</span>
<span class="uscript-line">00132</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    LabelCheckAllMap<span class="uscript-operator">;</span>
<span class="uscript-line">00133</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    LabelRequiredMaps<span class="uscript-operator">;</span>
<span class="uscript-line">00134</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    LabelUncheckAllMap<span class="uscript-operator">;</span>
<span class="uscript-line">00135</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    LabelChangeMaplist<span class="uscript-operator">;</span>
<span class="uscript-line">00136</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    LabelCheckAllMutator<span class="uscript-operator">;</span>
<span class="uscript-line">00137</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    LabelRequiredMutators<span class="uscript-operator">;</span>
<span class="uscript-line">00138</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    LabelNumberMatchesLeft<span class="uscript-operator">;</span>
<span class="uscript-line">00139</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    LabelUncheckAllMutator<span class="uscript-operator">;</span>
<span class="uscript-line">00140</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    LabelDelayProfileChange<span class="uscript-operator">;</span>
<span class="uscript-line">00141</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    LabelApplyImportProfile<span class="uscript-operator">;</span>
<span class="uscript-line">00142</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    LabelApplyExportProfile<span class="uscript-operator">;</span>
<span class="uscript-line">00143</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    LabelModifyProfile<span class="uscript-operator">;</span>
<span class="uscript-line">00144</span>  
<span class="uscript-line">00145</span>  <span class="uscript-comment">// Success Messages</span>
<span class="uscript-line">00146</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    SuccessText<span class="uscript-operator">;</span>
<span class="uscript-line">00147</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    SuccessDeleteProfile<span class="uscript-operator">;</span>
<span class="uscript-line">00148</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    SuccessExportProfile<span class="uscript-operator">;</span>
<span class="uscript-line">00149</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    SuccessImportProfile<span class="uscript-operator">;</span>
<span class="uscript-line">00150</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    SuccessImportProfileTitle<span class="uscript-operator">;</span>
<span class="uscript-line">00151</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    SuccessCopyProfile<span class="uscript-operator">;</span>
<span class="uscript-line">00152</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    SuccessSwitchProfile<span class="uscript-operator">;</span>
<span class="uscript-line">00153</span>  
<span class="uscript-line">00154</span>  <span class="uscript-comment">// Profile Errors</span>
<span class="uscript-line">00155</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    ErrorLoadingPlayInfoText<span class="uscript-operator">[</span><span class="uscript-number">5</span><span class="uscript-operator">]</span><span class="uscript-operator">;</span>
<span class="uscript-line">00156</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    ErrorGameRulesNotFound<span class="uscript-operator">;</span>
<span class="uscript-line">00157</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    ErrorGameClassText<span class="uscript-operator">;</span>
<span class="uscript-line">00158</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    ErrorGameClassTitle<span class="uscript-operator">;</span>
<span class="uscript-line">00159</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    ErrorAccessControlText<span class="uscript-operator">;</span>
<span class="uscript-line">00160</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    ErrorAccessControlTitle<span class="uscript-operator">;</span>
<span class="uscript-line">00161</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    ErrorSameProfileName<span class="uscript-operator">;</span>
<span class="uscript-line">00162</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    ErrorRemoteMutator<span class="uscript-operator">;</span>
<span class="uscript-line">00163</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    ErrorRemoteServerActor<span class="uscript-operator">;</span>
<span class="uscript-line">00164</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    ErrorSavingProfile<span class="uscript-operator">;</span>
<span class="uscript-line">00165</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    ErrorDeletingProfile<span class="uscript-operator">;</span>
<span class="uscript-line">00166</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    ErrorExportingProfile<span class="uscript-operator">;</span>
<span class="uscript-line">00167</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    ErrorNoProfilesExist<span class="uscript-operator">;</span>
<span class="uscript-line">00168</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    ErrorCopyFrom<span class="uscript-operator">;</span>
<span class="uscript-line">00169</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    ErrorCopyNoName<span class="uscript-operator">;</span>
<span class="uscript-line">00170</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    ErrorExcludeMapNotFound<span class="uscript-operator">;</span>
<span class="uscript-line">00171</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    ErrorIncludeMapNotFound<span class="uscript-operator">;</span>
<span class="uscript-line">00172</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    ErrorReplacingWebConnection<span class="uscript-operator">;</span>
<span class="uscript-line">00173</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    ImportClassSpawnError<span class="uscript-operator">;</span>
<span class="uscript-line">00174</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    ImportProfileFailText<span class="uscript-operator">;</span>
<span class="uscript-line">00175</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    ImportProfileFailTitle<span class="uscript-operator">;</span>
<span class="uscript-line">00176</span>  
<span class="uscript-line">00177</span>  <span class="uscript-comment">// Import errors</span>
<span class="uscript-line">00178</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    ErrorBind<span class="uscript-operator">;</span>
<span class="uscript-line">00179</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    ErrorBadURL<span class="uscript-operator">;</span>
<span class="uscript-line">00180</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    ErrorServer<span class="uscript-operator">;</span>
<span class="uscript-line">00181</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    ErrorResolve<span class="uscript-operator">;</span>
<span class="uscript-line">00182</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    ErrorProfile<span class="uscript-operator">;</span>
<span class="uscript-line">00183</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    ErrorTimeout<span class="uscript-operator">;</span>
<span class="uscript-line">00184</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    ErrorNotFound<span class="uscript-operator">;</span>
<span class="uscript-line">00185</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    ErrorForbidden<span class="uscript-operator">;</span>
<span class="uscript-line">00186</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    ErrorBadRequest<span class="uscript-operator">;</span>
<span class="uscript-line">00187</span>  <span class="uscript-keyword">var</span> <span class="uscript-keyword">localized</span> <span class="uscript-type">string</span>    ErrorUnauthorized<span class="uscript-operator">;</span>
<span class="uscript-line">00188</span>  
<span class="uscript-line">00189</span>  <span class="uscript-keyword">function</span> <span class="uscript-type">bool</span> Init<span class="uscript-operator">(</span><span class="uscript-operator">)</span>
<span class="uscript-line">00190</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">00191</span>      <span class="uscript-keyword">local</span> GameRules GR<span class="uscript-operator">;</span>
<span class="uscript-line">00192</span>  
<span class="uscript-line">00193</span>      <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>GR<span class="uscript-operator">=</span>Level<span class="uscript-operator">.</span>Game<span class="uscript-operator">.</span>GameRulesModifiers<span class="uscript-operator">;</span>GR<span class="uscript-operator">!=</span><span class="uscript-keyword">None</span><span class="uscript-operator">;</span>GR<span class="uscript-operator">=</span>GR<span class="uscript-operator">.</span>NextGameRules<span class="uscript-operator">)</span>
<span class="uscript-line">00194</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>LadderGameRules<span class="uscript-operator">(</span>GR<span class="uscript-operator">)</span> <span class="uscript-operator">!=</span> <span class="uscript-keyword">None</span><span class="uscript-operator">)</span>
<span class="uscript-line">00195</span>              LadderRules <span class="uscript-operator">=</span> LadderGameRules<span class="uscript-operator">(</span>GR<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00196</span>  
<span class="uscript-line">00197</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>LadderRules <span class="uscript-operator">==</span> <span class="uscript-keyword">None</span><span class="uscript-operator">)</span>
<span class="uscript-line">00198</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">00199</span>          Cleanup<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00200</span>          <span class="uscript-keyword">return</span> <span class="uscript-keyword">false</span><span class="uscript-operator">;</span>
<span class="uscript-line">00201</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">00202</span>  
<span class="uscript-line">00203</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>ConfigM <span class="uscript-operator">==</span> <span class="uscript-keyword">None</span> <span class="uscript-operator">&amp;&amp;</span> ConfigMaster<span class="uscript-operator">(</span>Level<span class="uscript-operator">.</span>Game<span class="uscript-operator">.</span>BaseMutator<span class="uscript-operator">.</span>NextMutator<span class="uscript-operator">)</span> <span class="uscript-operator">!=</span> <span class="uscript-keyword">None</span><span class="uscript-operator">)</span>
<span class="uscript-line">00204</span>          ConfigM <span class="uscript-operator">=</span> ConfigMaster<span class="uscript-operator">(</span>Level<span class="uscript-operator">.</span>Game<span class="uscript-operator">.</span>BaseMutator<span class="uscript-operator">.</span>NextMutator<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00205</span>  
<span class="uscript-line">00206</span>      GetCurrentConfigSet<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00207</span>      ExportMaster            <span class="uscript-operator">=</span> <span class="uscript-keyword">new</span> <span class="uscript-keyword">class</span><span class="uscript-name">'ProfileExporter'</span><span class="uscript-operator">;</span>
<span class="uscript-line">00208</span>      DefaultProfileName      <span class="uscript-operator">=</span> LadderRules<span class="uscript-operator">.</span>DefaultProfileName<span class="uscript-operator">;</span>
<span class="uscript-line">00209</span>  
<span class="uscript-line">00210</span>      SMaster                 <span class="uscript-operator">=</span> <span class="uscript-keyword">new</span><span class="uscript-operator">(</span><span class="uscript-keyword">None</span><span class="uscript-operator">)</span> <span class="uscript-keyword">class</span><span class="uscript-name">'SessionMaster'</span><span class="uscript-operator">;</span>
<span class="uscript-line">00211</span>      ProfileMaps             <span class="uscript-operator">=</span> <span class="uscript-keyword">new</span><span class="uscript-operator">(</span><span class="uscript-keyword">None</span><span class="uscript-operator">)</span> <span class="uscript-keyword">class</span><span class="uscript-name">'SortedStringArray'</span><span class="uscript-operator">;</span>
<span class="uscript-line">00212</span>      ProfileMutators         <span class="uscript-operator">=</span> <span class="uscript-keyword">new</span><span class="uscript-operator">(</span><span class="uscript-keyword">None</span><span class="uscript-operator">)</span> <span class="uscript-keyword">class</span><span class="uscript-name">'SortedStringArray'</span><span class="uscript-operator">;</span>
<span class="uscript-line">00213</span>  
<span class="uscript-line">00214</span>      <span class="uscript-keyword">Assert</span><span class="uscript-operator">(</span>Level<span class="uscript-operator">.</span>Game<span class="uscript-operator">.</span>AccessControl <span class="uscript-operator">!=</span> <span class="uscript-keyword">None</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00215</span>      <span class="uscript-keyword">return</span> <span class="uscript-keyword">true</span><span class="uscript-operator">;</span>
<span class="uscript-line">00216</span>  <span class="uscript-operator">}</span>
<span class="uscript-line">00217</span>  
<span class="uscript-line">00218</span>  <span class="uscript-comment">//////////////////////////////////////////////////////////////</span>
<span class="uscript-line">00219</span>  <span class="uscript-comment">//////////////////////////////////////////////////////////////</span>
<span class="uscript-line">00220</span>  <span class="uscript-comment">// Session Manipulation Functions</span>
<span class="uscript-line">00221</span>  <span class="uscript-comment">//</span>
<span class="uscript-line">00222</span>  
<span class="uscript-line">00223</span>  <span class="uscript-comment">// Load profile information into session object</span>
<span class="uscript-line">00224</span>  <span class="uscript-keyword">function</span> CreateSessionInfo<span class="uscript-operator">(</span><span class="uscript-keyword">coerce</span> <span class="uscript-type">int</span> ProfileIndex<span class="uscript-operator">,</span> <span class="uscript-type">string</span> SID<span class="uscript-operator">,</span> <span class="uscript-keyword">optional</span> <span class="uscript-type">bool</span> bIncludeNonActive<span class="uscript-operator">,</span> <span class="uscript-keyword">optional</span> <span class="uscript-type">bool</span> bSave<span class="uscript-operator">,</span> <span class="uscript-keyword">optional</span> <span class="uscript-type">bool</span> bQuiet<span class="uscript-operator">)</span>
<span class="uscript-line">00225</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">00226</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">int</span>                                       i<span class="uscript-operator">;</span>
<span class="uscript-line">00227</span>      <span class="uscript-keyword">local</span> Session                                   CurS<span class="uscript-operator">;</span>
<span class="uscript-line">00228</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">string</span>                                    TempStr<span class="uscript-operator">;</span>
<span class="uscript-line">00229</span>      <span class="uscript-keyword">local</span> <span class="uscript-keyword">array</span><span class="uscript-operator">&lt;</span><span class="uscript-type">string</span><span class="uscript-operator">&gt;</span>                             TempArr<span class="uscript-operator">;</span>
<span class="uscript-line">00230</span>      <span class="uscript-keyword">local</span> ProfileConfigSet                          TempPCS<span class="uscript-operator">;</span>
<span class="uscript-line">00231</span>      <span class="uscript-keyword">local</span> <span class="uscript-keyword">array</span><span class="uscript-operator">&lt;</span>ProfileConfigSet<span class="uscript-operator">.</span>ProfileMutator<span class="uscript-operator">&gt;</span>    AllPCSMutators<span class="uscript-operator">;</span>
<span class="uscript-line">00232</span>      <span class="uscript-keyword">local</span> <span class="uscript-keyword">array</span><span class="uscript-operator">&lt;</span>ProfileConfigSet<span class="uscript-operator">.</span>ProfileMap<span class="uscript-operator">&gt;</span>        AllPCSMaps<span class="uscript-operator">;</span>
<span class="uscript-line">00233</span>      <span class="uscript-keyword">local</span> <span class="uscript-keyword">array</span><span class="uscript-operator">&lt;</span>ProfileConfigSet<span class="uscript-operator">.</span>ProfileSA<span class="uscript-operator">&gt;</span> AllPCSServerActors<span class="uscript-operator">;</span>
<span class="uscript-line">00234</span>  
<span class="uscript-line">00235</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>SID <span class="uscript-operator">==</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">00236</span>          <span class="uscript-keyword">return</span><span class="uscript-operator">;</span>
<span class="uscript-line">00237</span>  
<span class="uscript-line">00238</span>      CurS <span class="uscript-operator">=</span> SMaster<span class="uscript-operator">.</span>getSession<span class="uscript-operator">(</span>SID<span class="uscript-operator">,</span><span class="uscript-keyword">true</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00239</span>      TempPCS <span class="uscript-operator">=</span> LadderRules<span class="uscript-operator">.</span>LadderProfiles<span class="uscript-operator">[</span>ProfileIndex<span class="uscript-operator">]</span><span class="uscript-operator">;</span>
<span class="uscript-line">00240</span>      TempPCS<span class="uscript-operator">.</span>StartEdit<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00241</span>  
<span class="uscript-line">00242</span>  <span class="uscript-comment">// General profile information</span>
<span class="uscript-line">00243</span>      CurS<span class="uscript-operator">.</span>setValue<span class="uscript-operator">(</span><span class="uscript-string">"ProfileIndex"</span><span class="uscript-operator">,</span> <span class="uscript-type">string</span><span class="uscript-operator">(</span>ProfileIndex<span class="uscript-operator">)</span><span class="uscript-operator">,</span> <span class="uscript-keyword">true</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00244</span>      CurS<span class="uscript-operator">.</span>setValue<span class="uscript-operator">(</span><span class="uscript-string">"ProfileName"</span><span class="uscript-operator">,</span>LadderRules<span class="uscript-operator">.</span>Profiles<span class="uscript-operator">[</span>ProfileIndex<span class="uscript-operator">]</span><span class="uscript-operator">.</span>ProfileName<span class="uscript-operator">,</span><span class="uscript-keyword">true</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00245</span>      CurS<span class="uscript-operator">.</span>setValue<span class="uscript-operator">(</span><span class="uscript-string">"GameType"</span><span class="uscript-operator">,</span> <span class="uscript-type">string</span><span class="uscript-operator">(</span>TempPCS<span class="uscript-operator">.</span>GetGameClass<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">,</span> <span class="uscript-keyword">True</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00246</span>      CurS<span class="uscript-operator">.</span>setValue<span class="uscript-operator">(</span><span class="uscript-string">"ACClass"</span><span class="uscript-operator">,</span> TempPCS<span class="uscript-operator">.</span>GetAccessControl<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">,</span> <span class="uscript-keyword">True</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00247</span>      CurS<span class="uscript-operator">.</span>setValue<span class="uscript-operator">(</span><span class="uscript-string">"MaxMaps"</span><span class="uscript-operator">,</span> <span class="uscript-type">string</span><span class="uscript-operator">(</span>TempPCS<span class="uscript-operator">.</span>GetMaxMaps<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">,</span> <span class="uscript-keyword">True</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00248</span>  
<span class="uscript-line">00249</span>      AllPCSMutators <span class="uscript-operator">=</span> TempPCS<span class="uscript-operator">.</span>GetProfileMutators<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00250</span>      AllPCSMaps <span class="uscript-operator">=</span> TempPCS<span class="uscript-operator">.</span>GetProfileMaps<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00251</span>      AllPCSServerActors <span class="uscript-operator">=</span> TempPCS<span class="uscript-operator">.</span>GetProfileServerActors<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00252</span>  
<span class="uscript-line">00253</span>      TempArr <span class="uscript-operator">=</span> LadderRules<span class="uscript-operator">.</span>GetProfileMutators<span class="uscript-operator">(</span><span class="uscript-type">string</span><span class="uscript-operator">(</span>ProfileIndex<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00254</span>      TempStr <span class="uscript-operator">=</span> <span class="uscript-keyword">class</span><span class="uscript-name">'wUtils103.wArray'</span><span class="uscript-operator">.</span><span class="uscript-keyword">static</span><span class="uscript-operator">.</span>Join<span class="uscript-operator">(</span>TempArr<span class="uscript-operator">,</span><span class="uscript-string">","</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00255</span>  
<span class="uscript-line">00256</span>  <span class="uscript-comment">// Load profile mutator information</span>
<span class="uscript-line">00257</span>      CurS<span class="uscript-operator">.</span>ClearMutators<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00258</span>      <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>i<span class="uscript-operator">&lt;</span>AllPCSMutators<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">;</span>i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">00259</span>         <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>AllPCSMutators<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>bRequired <span class="uscript-operator">||</span> <span class="uscript-operator">(</span>InStr<span class="uscript-operator">(</span>TempStr<span class="uscript-operator">,</span>AllPCSMutators<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>MutatorName<span class="uscript-operator">)</span><span class="uscript-operator">!=</span><span class="uscript-operator">-</span><span class="uscript-number">1</span><span class="uscript-operator">)</span> <span class="uscript-operator">||</span> bIncludeNonActive<span class="uscript-operator">)</span>
<span class="uscript-line">00260</span>             CurS<span class="uscript-operator">.</span>setMutator<span class="uscript-operator">(</span>AllPCSMutators<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>MutatorName<span class="uscript-operator">,</span><span class="uscript-keyword">True</span><span class="uscript-operator">,</span>AllPCSMutators<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>bRequired<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00261</span>  
<span class="uscript-line">00262</span>      TempArr <span class="uscript-operator">=</span> LadderRules<span class="uscript-operator">.</span>GetProfileMaps<span class="uscript-operator">(</span><span class="uscript-type">string</span><span class="uscript-operator">(</span>ProfileIndex<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00263</span>      TempStr <span class="uscript-operator">=</span> <span class="uscript-keyword">class</span><span class="uscript-name">'wUtils103.wArray'</span><span class="uscript-operator">.</span><span class="uscript-keyword">static</span><span class="uscript-operator">.</span>Join<span class="uscript-operator">(</span>TempArr<span class="uscript-operator">,</span><span class="uscript-string">","</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00264</span>  
<span class="uscript-line">00265</span>  <span class="uscript-comment">// Load profile map information</span>
<span class="uscript-line">00266</span>      CurS<span class="uscript-operator">.</span>ClearMaps<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00267</span>      <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>i<span class="uscript-operator">&lt;</span>AllPCSMaps<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">;</span>i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">00268</span>         <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>AllPCSMaps<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>bRequired <span class="uscript-operator">||</span> <span class="uscript-operator">(</span>InStr<span class="uscript-operator">(</span>TempStr<span class="uscript-operator">,</span>AllPCSMaps<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>MapName<span class="uscript-operator">)</span><span class="uscript-operator">!=</span><span class="uscript-operator">-</span><span class="uscript-number">1</span><span class="uscript-operator">)</span> <span class="uscript-operator">||</span> bIncludeNonActive<span class="uscript-operator">)</span>
<span class="uscript-line">00269</span>             CurS<span class="uscript-operator">.</span>setMap<span class="uscript-operator">(</span>AllPCSMaps<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>MapName<span class="uscript-operator">,</span>AllPCSMaps<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>MapListOrder<span class="uscript-operator">,</span><span class="uscript-keyword">True</span><span class="uscript-operator">,</span>AllPCSMaps<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>bRequired<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00270</span>  
<span class="uscript-line">00271</span>      TempArr <span class="uscript-operator">=</span> LadderRules<span class="uscript-operator">.</span>GetProfileServerActors<span class="uscript-operator">(</span><span class="uscript-type">string</span><span class="uscript-operator">(</span>ProfileIndex<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00272</span>      TempStr <span class="uscript-operator">=</span> <span class="uscript-keyword">class</span><span class="uscript-name">'wUtils103.wArray'</span><span class="uscript-operator">.</span><span class="uscript-keyword">static</span><span class="uscript-operator">.</span>Join<span class="uscript-operator">(</span>TempArr<span class="uscript-operator">,</span><span class="uscript-string">","</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00273</span>  
<span class="uscript-line">00274</span>  <span class="uscript-comment">// Load ServerActor info</span>
<span class="uscript-line">00275</span>      CurS<span class="uscript-operator">.</span>ClearServerActors<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00276</span>      <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>i<span class="uscript-operator">&lt;</span>AllPCSServerActors<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">;</span>i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">00277</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>AllPCSServerActors<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>bRequired <span class="uscript-operator">||</span> InStr<span class="uscript-operator">(</span>TempStr<span class="uscript-operator">,</span>AllPCSServerActors<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>ActorClass<span class="uscript-operator">)</span><span class="uscript-operator">!=</span><span class="uscript-operator">-</span><span class="uscript-number">1</span> <span class="uscript-operator">||</span> bIncludeNonActive<span class="uscript-operator">)</span>
<span class="uscript-line">00278</span>              CurS<span class="uscript-operator">.</span>setServerActor<span class="uscript-operator">(</span>AllPCSServerActors<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>ActorClass<span class="uscript-operator">,</span> <span class="uscript-keyword">True</span><span class="uscript-operator">,</span> AllPCSServerActors<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>bRequired<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00279</span>  
<span class="uscript-line">00280</span>  <span class="uscript-comment">// Load profile PlayInfo data</span>
<span class="uscript-line">00281</span>      <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>i<span class="uscript-operator">&lt;</span>TempPCS<span class="uscript-operator">.</span>Count<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">00282</span>          CurS<span class="uscript-operator">.</span>setValue<span class="uscript-operator">(</span>TempPCS<span class="uscript-operator">.</span>GetProfileParamName<span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">,</span>TempPCS<span class="uscript-operator">.</span>GetProfileParam<span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">,</span><span class="uscript-keyword">True</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00283</span>  
<span class="uscript-line">00284</span>      TempPCS<span class="uscript-operator">.</span>EndEdit<span class="uscript-operator">(</span>bSave<span class="uscript-operator">,</span>bQuiet<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00285</span>  <span class="uscript-operator">}</span>
<span class="uscript-line">00286</span>  
<span class="uscript-line">00287</span>  <span class="uscript-comment">// Initialize session data for recently imported profile</span>
<span class="uscript-line">00288</span>  <span class="uscript-keyword">function</span> ProfileConfigSet CreateImportSessionInfo<span class="uscript-operator">(</span>Session CurS<span class="uscript-operator">)</span>
<span class="uscript-line">00289</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">00290</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">int</span>                       i<span class="uscript-operator">;</span>
<span class="uscript-line">00291</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">string</span>                    TempStr<span class="uscript-operator">,</span> Tmp<span class="uscript-operator">;</span>
<span class="uscript-line">00292</span>      <span class="uscript-keyword">local</span> PlayInfo                  TempPI<span class="uscript-operator">;</span>
<span class="uscript-line">00293</span>      <span class="uscript-keyword">local</span> ProfileConfigSet          TempPCS<span class="uscript-operator">;</span>
<span class="uscript-line">00294</span>  
<span class="uscript-line">00295</span>      <span class="uscript-keyword">local</span> <span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>Mutator<span class="uscript-operator">&gt;</span>            MutClass<span class="uscript-operator">;</span>
<span class="uscript-line">00296</span>      <span class="uscript-keyword">local</span> <span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>GameInfo<span class="uscript-operator">&gt;</span>           GIClass<span class="uscript-operator">;</span>
<span class="uscript-line">00297</span>      <span class="uscript-keyword">local</span> <span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>AccessControl<span class="uscript-operator">&gt;</span>      ACClass<span class="uscript-operator">;</span>
<span class="uscript-line">00298</span>      <span class="uscript-keyword">local</span> <span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>Info<span class="uscript-operator">&gt;</span>               ServerActorClass<span class="uscript-operator">;</span>
<span class="uscript-line">00299</span>      <span class="uscript-keyword">local</span> <span class="uscript-keyword">array</span><span class="uscript-operator">&lt;</span><span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>Info<span class="uscript-operator">&gt;</span> <span class="uscript-operator">&gt;</span>       SAClass<span class="uscript-operator">;</span>
<span class="uscript-line">00300</span>      <span class="uscript-keyword">local</span> <span class="uscript-keyword">array</span><span class="uscript-operator">&lt;</span><span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>Mutator<span class="uscript-operator">&gt;</span> <span class="uscript-operator">&gt;</span>    MClass<span class="uscript-operator">;</span>
<span class="uscript-line">00301</span>  
<span class="uscript-line">00302</span>      TempPCS <span class="uscript-operator">=</span> LadderRules<span class="uscript-operator">.</span>AddProfile<span class="uscript-operator">(</span>CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"ProfileName"</span><span class="uscript-operator">)</span><span class="uscript-operator">,</span>CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"GameType"</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00303</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>TempPCS<span class="uscript-operator">.</span>StartEdit<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">00304</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">00305</span>          TempStr <span class="uscript-operator">=</span> CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"GameType"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00306</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>TempStr <span class="uscript-operator">!=</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">00307</span>              GIClass <span class="uscript-operator">=</span> <span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>GameInfo<span class="uscript-operator">&gt;</span><span class="uscript-operator">(</span>DynamicLoadObject<span class="uscript-operator">(</span>TempStr<span class="uscript-operator">,</span><span class="uscript-keyword">class</span><span class="uscript-name">'Class'</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00308</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>GIClass <span class="uscript-operator">==</span> <span class="uscript-keyword">None</span><span class="uscript-operator">)</span> <span class="uscript-keyword">return</span> <span class="uscript-keyword">None</span><span class="uscript-operator">;</span>
<span class="uscript-line">00309</span>  
<span class="uscript-line">00310</span>          TempStr <span class="uscript-operator">=</span> CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"ACClass"</span><span class="uscript-operator">,</span>Level<span class="uscript-operator">.</span>Game<span class="uscript-operator">.</span>AccessControlClass<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00311</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>TempStr <span class="uscript-operator">!=</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">00312</span>              ACClass <span class="uscript-operator">=</span> <span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>AccessControl<span class="uscript-operator">&gt;</span><span class="uscript-operator">(</span>DynamicLoadObject<span class="uscript-operator">(</span>TempStr<span class="uscript-operator">,</span><span class="uscript-keyword">class</span><span class="uscript-name">'Class'</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00313</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>ACClass <span class="uscript-operator">==</span> <span class="uscript-keyword">None</span><span class="uscript-operator">)</span> <span class="uscript-keyword">return</span> <span class="uscript-keyword">None</span><span class="uscript-operator">;</span>
<span class="uscript-line">00314</span>  
<span class="uscript-line">00315</span>          TempPI <span class="uscript-operator">=</span> <span class="uscript-keyword">new</span><span class="uscript-operator">(</span><span class="uscript-keyword">None</span><span class="uscript-operator">)</span> <span class="uscript-keyword">class</span><span class="uscript-name">'PlayInfo'</span><span class="uscript-operator">;</span>
<span class="uscript-line">00316</span>  
<span class="uscript-line">00317</span>  <span class="uscript-comment">// Mutators</span>
<span class="uscript-line">00318</span>          <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>i<span class="uscript-operator">&lt;</span>CurS<span class="uscript-operator">.</span>getMutatorLength<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">00319</span>          <span class="uscript-operator">{</span>
<span class="uscript-line">00320</span>              TempStr <span class="uscript-operator">=</span> CurS<span class="uscript-operator">.</span>getMutator<span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00321</span>              MutClass <span class="uscript-operator">=</span> <span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>Mutator<span class="uscript-operator">&gt;</span><span class="uscript-operator">(</span>DynamicLoadObject<span class="uscript-operator">(</span>TempStr<span class="uscript-operator">,</span> <span class="uscript-keyword">class</span><span class="uscript-name">'Class'</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00322</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>MutClass <span class="uscript-operator">!=</span> <span class="uscript-keyword">None</span><span class="uscript-operator">)</span>
<span class="uscript-line">00323</span>              <span class="uscript-operator">{</span>
<span class="uscript-line">00324</span>                  MClass<span class="uscript-operator">[</span>MClass<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">]</span> <span class="uscript-operator">=</span> MutClass<span class="uscript-operator">;</span>
<span class="uscript-line">00325</span>                  TempPCS<span class="uscript-operator">.</span>AddProfileMutator<span class="uscript-operator">(</span>TempStr<span class="uscript-operator">,</span>CurS<span class="uscript-operator">.</span>MutRequired<span class="uscript-operator">(</span>TempStr<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00326</span>              <span class="uscript-operator">}</span>
<span class="uscript-line">00327</span>  
<span class="uscript-line">00328</span>              <span class="uscript-keyword">else</span> log<span class="uscript-operator">(</span>ErrorRemoteMutator<span class="uscript-operator">@</span>TempStr<span class="uscript-operator">,</span>LOGNAME<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00329</span>          <span class="uscript-operator">}</span>
<span class="uscript-line">00330</span>  
<span class="uscript-line">00331</span>          <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>i<span class="uscript-operator">&lt;</span>CurS<span class="uscript-operator">.</span>getSALength<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">00332</span>          <span class="uscript-operator">{</span>
<span class="uscript-line">00333</span>              TempStr <span class="uscript-operator">=</span> CurS<span class="uscript-operator">.</span>getServerActor<span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00334</span>              ServerActorClass <span class="uscript-operator">=</span> <span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>Info<span class="uscript-operator">&gt;</span><span class="uscript-operator">(</span>DynamicLoadObject<span class="uscript-operator">(</span>TempStr<span class="uscript-operator">,</span><span class="uscript-keyword">class</span><span class="uscript-name">'Class'</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00335</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>ServerActorClass <span class="uscript-operator">!=</span> <span class="uscript-keyword">None</span><span class="uscript-operator">)</span>
<span class="uscript-line">00336</span>              <span class="uscript-operator">{</span>
<span class="uscript-line">00337</span>                  SAClass<span class="uscript-operator">[</span>SAClass<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">]</span> <span class="uscript-operator">=</span> ServerActorClass<span class="uscript-operator">;</span>
<span class="uscript-line">00338</span>                  TempPCS<span class="uscript-operator">.</span>AddProfileServerActor<span class="uscript-operator">(</span>TempStr<span class="uscript-operator">,</span>CurS<span class="uscript-operator">.</span>SARequired<span class="uscript-operator">(</span>TempStr<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00339</span>              <span class="uscript-operator">}</span>
<span class="uscript-line">00340</span>              <span class="uscript-keyword">else</span> log<span class="uscript-operator">(</span>ErrorRemoteServerActor<span class="uscript-operator">@</span>TempStr<span class="uscript-operator">,</span>LOGNAME<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00341</span>          <span class="uscript-operator">}</span>
<span class="uscript-line">00342</span>  
<span class="uscript-line">00343</span>          LoadThisPlayInfo<span class="uscript-operator">(</span>TempPI<span class="uscript-operator">,</span> GIClass<span class="uscript-operator">,</span> ACClass<span class="uscript-operator">,</span> MClass<span class="uscript-operator">,</span> SAClass<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00344</span>  
<span class="uscript-line">00345</span>  <span class="uscript-comment">// Maps</span>
<span class="uscript-line">00346</span>          <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>i<span class="uscript-operator">&lt;</span>CurS<span class="uscript-operator">.</span>getMapLength<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">00347</span>          <span class="uscript-operator">{</span>
<span class="uscript-line">00348</span>              TempStr <span class="uscript-operator">=</span> CurS<span class="uscript-operator">.</span>getMap<span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00349</span>              TempPCS<span class="uscript-operator">.</span>AddProfileMap<span class="uscript-operator">(</span>TempStr<span class="uscript-operator">,</span>CurS<span class="uscript-operator">.</span>MapRequired<span class="uscript-operator">(</span>TempStr<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00350</span>          <span class="uscript-operator">}</span>
<span class="uscript-line">00351</span>  
<span class="uscript-line">00352</span>  <span class="uscript-comment">// PlayInfo</span>
<span class="uscript-line">00353</span>          <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>i<span class="uscript-operator">&lt;</span>TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">;</span>i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">00354</span>          <span class="uscript-operator">{</span>
<span class="uscript-line">00355</span>              TempStr <span class="uscript-operator">=</span> <span class="uscript-string">""</span><span class="uscript-operator">;</span> Tmp<span class="uscript-operator">=</span><span class="uscript-string">""</span><span class="uscript-operator">;</span>
<span class="uscript-line">00356</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>CurS<span class="uscript-operator">.</span>getIdValue<span class="uscript-operator">(</span>i<span class="uscript-operator">,</span>TempStr<span class="uscript-operator">,</span>Tmp<span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-operator">-</span><span class="uscript-number">1</span><span class="uscript-operator">)</span>
<span class="uscript-line">00357</span>                  <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>
<span class="uscript-line">00358</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span> <span class="uscript-operator">!</span>SettingIsAllowed<span class="uscript-operator">(</span>TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>SecLevel<span class="uscript-operator">)</span> <span class="uscript-operator">)</span> <span class="uscript-keyword">continue</span><span class="uscript-operator">;</span>
<span class="uscript-line">00359</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">!</span>TempPCS<span class="uscript-operator">.</span>SetProfileNamedParam<span class="uscript-operator">(</span>TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>SettingName<span class="uscript-operator">,</span> CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span>TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>SettingName<span class="uscript-operator">,</span>TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>Value<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">00360</span>                  TempPCS<span class="uscript-operator">.</span>SetProfileParam<span class="uscript-operator">(</span>TempPCS<span class="uscript-operator">.</span>Count<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">,</span>TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>SettingName<span class="uscript-operator">,</span>CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span>TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>SettingName<span class="uscript-operator">,</span>TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>Value<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00361</span>          <span class="uscript-operator">}</span>
<span class="uscript-line">00362</span>  
<span class="uscript-line">00363</span>          TempPCS<span class="uscript-operator">.</span>EndEdit<span class="uscript-operator">(</span><span class="uscript-keyword">True</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00364</span>          <span class="uscript-keyword">return</span> TempPCS<span class="uscript-operator">;</span>
<span class="uscript-line">00365</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">00366</span>  
<span class="uscript-line">00367</span>      <span class="uscript-keyword">else</span> log<span class="uscript-operator">(</span>ErrorServer<span class="uscript-operator">,</span>LOGNAME<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00368</span>  
<span class="uscript-line">00369</span>      <span class="uscript-keyword">return</span> <span class="uscript-keyword">None</span><span class="uscript-operator">;</span>
<span class="uscript-line">00370</span>  <span class="uscript-operator">}</span>
<span class="uscript-line">00371</span>  
<span class="uscript-line">00372</span>  <span class="uscript-comment">// Clear session data and optionally create new session object</span>
<span class="uscript-line">00373</span>  <span class="uscript-keyword">function</span> <span class="uscript-type">string</span> ResetSessionID<span class="uscript-operator">(</span>Session CurS<span class="uscript-operator">,</span> <span class="uscript-keyword">optional</span> <span class="uscript-type">bool</span> bDestroySession<span class="uscript-operator">)</span>
<span class="uscript-line">00374</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">00375</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">string</span> OldSID<span class="uscript-operator">;</span>
<span class="uscript-line">00376</span>  
<span class="uscript-line">00377</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>bDestroySession<span class="uscript-operator">)</span> SMaster<span class="uscript-operator">.</span>destroySession<span class="uscript-operator">(</span>CurS<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00378</span>      <span class="uscript-keyword">else</span> CurS<span class="uscript-operator">.</span>ResetSession<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00379</span>  
<span class="uscript-line">00380</span>      CurS <span class="uscript-operator">=</span> SMaster<span class="uscript-operator">.</span>getSession<span class="uscript-operator">(</span>OldSID<span class="uscript-operator">,</span><span class="uscript-keyword">true</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00381</span>      <span class="uscript-keyword">return</span> CurS<span class="uscript-operator">.</span>GetHash<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00382</span>  <span class="uscript-operator">}</span>
<span class="uscript-line">00383</span>  
<span class="uscript-line">00384</span>  
<span class="uscript-line">00385</span>  <span class="uscript-comment">////////////////////////////////////////////////////////////</span>
<span class="uscript-line">00386</span>  <span class="uscript-comment">////////////////////////////////////////////////////////////</span>
<span class="uscript-line">00387</span>  <span class="uscript-comment">// Profile manipulation methods</span>
<span class="uscript-line">00388</span>  <span class="uscript-comment">//</span>
<span class="uscript-line">00389</span>  
<span class="uscript-line">00390</span>  <span class="uscript-keyword">function</span> <span class="uscript-type">int</span> LoadThisPlayInfo<span class="uscript-operator">(</span>PlayInfo PI<span class="uscript-operator">,</span> <span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>GameInfo<span class="uscript-operator">&gt;</span> ThisGameInfo<span class="uscript-operator">,</span> <span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>AccessControl<span class="uscript-operator">&gt;</span> ThisAccessControl<span class="uscript-operator">,</span> <span class="uscript-keyword">array</span><span class="uscript-operator">&lt;</span><span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>Mutator<span class="uscript-operator">&gt;</span> <span class="uscript-operator">&gt;</span> ThisMutator<span class="uscript-operator">,</span> <span class="uscript-keyword">array</span><span class="uscript-operator">&lt;</span><span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>Info<span class="uscript-operator">&gt;</span> <span class="uscript-operator">&gt;</span> ThisServerActor<span class="uscript-operator">)</span>
<span class="uscript-line">00391</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">00392</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">int</span> i<span class="uscript-operator">;</span>
<span class="uscript-line">00393</span>      <span class="uscript-keyword">local</span> <span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>Mutator<span class="uscript-operator">&gt;</span> M<span class="uscript-operator">;</span>
<span class="uscript-line">00394</span>  
<span class="uscript-line">00395</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>PI <span class="uscript-operator">==</span> <span class="uscript-keyword">None</span><span class="uscript-operator">)</span>
<span class="uscript-line">00396</span>          <span class="uscript-keyword">return</span> <span class="uscript-number">0</span><span class="uscript-operator">;</span>
<span class="uscript-line">00397</span>      PI<span class="uscript-operator">.</span>Clear<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00398</span>  
<span class="uscript-line">00399</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>ThisGameInfo <span class="uscript-operator">==</span> <span class="uscript-keyword">None</span><span class="uscript-operator">)</span>
<span class="uscript-line">00400</span>          <span class="uscript-keyword">return</span> <span class="uscript-number">1</span><span class="uscript-operator">;</span>
<span class="uscript-line">00401</span>  
<span class="uscript-line">00402</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>ThisAccessControl <span class="uscript-operator">==</span> <span class="uscript-keyword">None</span><span class="uscript-operator">)</span>
<span class="uscript-line">00403</span>          <span class="uscript-keyword">return</span> <span class="uscript-number">2</span><span class="uscript-operator">;</span>
<span class="uscript-line">00404</span>  
<span class="uscript-line">00405</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>ThisMutator<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span> <span class="uscript-operator">&gt;</span> <span class="uscript-number">0</span><span class="uscript-operator">)</span>
<span class="uscript-line">00406</span>          <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>i<span class="uscript-operator">&lt;</span>ThisMutator<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">;</span>i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">00407</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>ThisMutator<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span> <span class="uscript-operator">==</span> <span class="uscript-keyword">None</span><span class="uscript-operator">)</span>
<span class="uscript-line">00408</span>                  <span class="uscript-keyword">return</span> <span class="uscript-number">3</span><span class="uscript-operator">;</span>
<span class="uscript-line">00409</span>  
<span class="uscript-line">00410</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>ThisServerActor<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span> <span class="uscript-operator">&gt;</span> <span class="uscript-number">0</span><span class="uscript-operator">)</span>
<span class="uscript-line">00411</span>          <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>i<span class="uscript-operator">&lt;</span>ThisServerActor<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">;</span>i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">00412</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>ThisServerActor<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span> <span class="uscript-operator">==</span> <span class="uscript-keyword">None</span><span class="uscript-operator">)</span>
<span class="uscript-line">00413</span>                  <span class="uscript-keyword">return</span> <span class="uscript-number">4</span><span class="uscript-operator">;</span>
<span class="uscript-line">00414</span>  
<span class="uscript-line">00415</span>      ThisGameInfo<span class="uscript-operator">.</span><span class="uscript-keyword">static</span><span class="uscript-operator">.</span>FillPlayInfo<span class="uscript-operator">(</span>PI<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00416</span>      PI<span class="uscript-operator">.</span>PopClass<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00417</span>  
<span class="uscript-line">00418</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>ThisGameInfo<span class="uscript-operator">.</span><span class="uscript-keyword">default</span><span class="uscript-operator">.</span>MutatorClass <span class="uscript-operator">!=</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">00419</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">00420</span>          M <span class="uscript-operator">=</span> <span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>Mutator<span class="uscript-operator">&gt;</span><span class="uscript-operator">(</span>DynamicLoadObject<span class="uscript-operator">(</span>ThisGameInfo<span class="uscript-operator">.</span><span class="uscript-keyword">default</span><span class="uscript-operator">.</span>MutatorClass<span class="uscript-operator">,</span><span class="uscript-keyword">class</span><span class="uscript-name">'Class'</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00421</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>M <span class="uscript-operator">!=</span> <span class="uscript-keyword">None</span><span class="uscript-operator">)</span>
<span class="uscript-line">00422</span>              M<span class="uscript-operator">.</span><span class="uscript-keyword">static</span><span class="uscript-operator">.</span>FillPlayInfo<span class="uscript-operator">(</span>PI<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00423</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">00424</span>  
<span class="uscript-line">00425</span>      ThisAccessControl<span class="uscript-operator">.</span><span class="uscript-keyword">static</span><span class="uscript-operator">.</span>FillPlayInfo<span class="uscript-operator">(</span>PI<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00426</span>      PI<span class="uscript-operator">.</span>PopClass<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00427</span>  
<span class="uscript-line">00428</span>      <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i <span class="uscript-operator">=</span> <span class="uscript-number">0</span><span class="uscript-operator">;</span> i <span class="uscript-operator">&lt;</span> ThisMutator<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">;</span> i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">00429</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">00430</span>          ThisMutator<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span><span class="uscript-keyword">static</span><span class="uscript-operator">.</span>FillPlayInfo<span class="uscript-operator">(</span>PI<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00431</span>          PI<span class="uscript-operator">.</span>PopClass<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00432</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">00433</span>  
<span class="uscript-line">00434</span>      <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i <span class="uscript-operator">=</span> <span class="uscript-number">0</span><span class="uscript-operator">;</span> i <span class="uscript-operator">&lt;</span> ThisServerActor<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">;</span> i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">00435</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">00436</span>          ThisServerActor<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span><span class="uscript-keyword">static</span><span class="uscript-operator">.</span>FillPlayInfo<span class="uscript-operator">(</span>PI<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00437</span>          PI<span class="uscript-operator">.</span>PopClass<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00438</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">00439</span>  
<span class="uscript-line">00440</span>      <span class="uscript-keyword">class</span><span class="uscript-name">'CommandLineParams'</span><span class="uscript-operator">.</span><span class="uscript-keyword">static</span><span class="uscript-operator">.</span>FillPlayInfo<span class="uscript-operator">(</span>PI<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00441</span>      PI<span class="uscript-operator">.</span>PopClass<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00442</span>  
<span class="uscript-line">00443</span>      <span class="uscript-keyword">return</span> <span class="uscript-operator">-</span><span class="uscript-number">1</span><span class="uscript-operator">;</span>
<span class="uscript-line">00444</span>  <span class="uscript-operator">}</span>
<span class="uscript-line">00445</span>  
<span class="uscript-line">00446</span>  <span class="uscript-keyword">function</span> ProfileConfigSet GetCurrentConfigSet<span class="uscript-operator">(</span><span class="uscript-operator">)</span>
<span class="uscript-line">00447</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">00448</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">int</span> i<span class="uscript-operator">;</span>
<span class="uscript-line">00449</span>  
<span class="uscript-line">00450</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>CurrentProfile <span class="uscript-operator">==</span> <span class="uscript-keyword">None</span><span class="uscript-operator">)</span>
<span class="uscript-line">00451</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">00452</span>          i <span class="uscript-operator">=</span> LadderRules<span class="uscript-operator">.</span>FindActiveProfile<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00453</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>i <span class="uscript-operator">&gt;=</span> <span class="uscript-number">0</span><span class="uscript-operator">)</span> CurrentProfile <span class="uscript-operator">=</span> LadderRules<span class="uscript-operator">.</span>LadderProfiles<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">;</span>
<span class="uscript-line">00454</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">00455</span>  
<span class="uscript-line">00456</span>      <span class="uscript-keyword">return</span> CurrentProfile<span class="uscript-operator">;</span>
<span class="uscript-line">00457</span>  <span class="uscript-operator">}</span>
<span class="uscript-line">00458</span>  
<span class="uscript-line">00459</span>  <span class="uscript-keyword">function</span> <span class="uscript-type">int</span> GetCurrentConfigIndex<span class="uscript-operator">(</span><span class="uscript-operator">)</span>
<span class="uscript-line">00460</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">00461</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">int</span> i<span class="uscript-operator">;</span>
<span class="uscript-line">00462</span>  
<span class="uscript-line">00463</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>CurrentProfile <span class="uscript-operator">!=</span> <span class="uscript-keyword">None</span><span class="uscript-operator">)</span>
<span class="uscript-line">00464</span>          <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i <span class="uscript-operator">=</span> <span class="uscript-number">0</span><span class="uscript-operator">;</span>i <span class="uscript-operator">&lt;</span> LadderRules<span class="uscript-operator">.</span>LadderProfiles<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">;</span>i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">00465</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>LadderRules<span class="uscript-operator">.</span>LadderProfiles<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span> <span class="uscript-operator">==</span> CurrentProfile<span class="uscript-operator">)</span>
<span class="uscript-line">00466</span>                  <span class="uscript-keyword">return</span> i<span class="uscript-operator">;</span>
<span class="uscript-line">00467</span>  
<span class="uscript-line">00468</span>      <span class="uscript-keyword">return</span> LadderRules<span class="uscript-operator">.</span>FindActiveProfile<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00469</span>  <span class="uscript-operator">}</span>
<span class="uscript-line">00470</span>  
<span class="uscript-line">00471</span>  <span class="uscript-comment">// Returns an array of class names for mutators that this profile will use in the game</span>
<span class="uscript-line">00472</span>  <span class="uscript-keyword">function</span> <span class="uscript-keyword">array</span><span class="uscript-operator">&lt;</span><span class="uscript-type">string</span><span class="uscript-operator">&gt;</span> LoadActiveProfileMutators<span class="uscript-operator">(</span><span class="uscript-keyword">optional</span> <span class="uscript-type">string</span> CurrentProfileItem<span class="uscript-operator">)</span>
<span class="uscript-line">00473</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">00474</span>      <span class="uscript-keyword">return</span> LadderRules<span class="uscript-operator">.</span>GetProfileMutators<span class="uscript-operator">(</span>CurrentProfileItem<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00475</span>  <span class="uscript-operator">}</span>
<span class="uscript-line">00476</span>  
<span class="uscript-line">00477</span>  <span class="uscript-keyword">function</span> <span class="uscript-keyword">array</span><span class="uscript-operator">&lt;</span><span class="uscript-type">string</span><span class="uscript-operator">&gt;</span> LoadActiveProfileServerActors<span class="uscript-operator">(</span><span class="uscript-keyword">optional</span> <span class="uscript-type">string</span> CurrentProfileItem<span class="uscript-operator">)</span>
<span class="uscript-line">00478</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">00479</span>      <span class="uscript-keyword">return</span> LadderRules<span class="uscript-operator">.</span>GetProfileServerActors<span class="uscript-operator">(</span>CurrentProfileItem<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00480</span>  <span class="uscript-operator">}</span>
<span class="uscript-line">00481</span>  
<span class="uscript-line">00482</span>  <span class="uscript-comment">// Returns an array of map names that in the maplist for this profile</span>
<span class="uscript-line">00483</span>  <span class="uscript-keyword">function</span> <span class="uscript-keyword">array</span><span class="uscript-operator">&lt;</span><span class="uscript-type">string</span><span class="uscript-operator">&gt;</span> LoadActiveProfileMaps<span class="uscript-operator">(</span><span class="uscript-keyword">optional</span> <span class="uscript-type">string</span> CurrentProfileItem<span class="uscript-operator">)</span>
<span class="uscript-line">00484</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">00485</span>      <span class="uscript-keyword">return</span> LadderRules<span class="uscript-operator">.</span>GetProfileServerActors<span class="uscript-operator">(</span>CurrentProfileItem<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00486</span>  <span class="uscript-operator">}</span>
<span class="uscript-line">00487</span>  <span class="uscript-comment">/*
<span class="uscript-line">00488</span>  function CreateFullMutatorList(out StringArray Mutators, out StringArray GroupsOnly)
<span class="uscript-line">00489</span>  {
<span class="uscript-line">00490</span>      local StringArray Grouped;
<span class="uscript-line">00491</span>      local int i,j,z;
<span class="uscript-line">00492</span>      local string GrpName;
<span class="uscript-line">00493</span>      local string thisgroup, nextgroup;
<span class="uscript-line">00494</span>  
<span class="uscript-line">00495</span>  // This class provides a specialized sorting function
<span class="uscript-line">00496</span>  // since mutators may be grouped - mutators in the same groups
<span class="uscript-line">00497</span>  // are not allowed to be selected togther
<span class="uscript-line">00498</span>  
<span class="uscript-line">00499</span>      Grouped = new(None) class'SortedStringArray';
<span class="uscript-line">00500</span>  
<span class="uscript-line">00501</span>  // Create array sorted on GroupName...this allows to flag
<span class="uscript-line">00502</span>  // the mutator for a different .inc file
<span class="uscript-line">00503</span>      for (i = 0; i &lt; Mutators.Count(); i++)
<span class="uscript-line">00504</span>      {
<span class="uscript-line">00505</span>          j = int(Mutators.GetItem(i));
<span class="uscript-line">00506</span>  
<span class="uscript-line">00507</span>  // If the mutator author forgot to configure a group name for the mutator
<span class="uscript-line">00508</span>          if (AllMutators[j].GroupName == "")
<span class="uscript-line">00509</span>              GrpName = "Z" $ string (z++);
<span class="uscript-line">00510</span>          else GrpName = AllMutators[j].GroupName;
<span class="uscript-line">00511</span>  
<span class="uscript-line">00512</span>          Grouped.Add(string(j),GrpName $ "." $ AllMutators[j].FriendlyName);
<span class="uscript-line">00513</span>      }
<span class="uscript-line">00514</span>  
<span class="uscript-line">00515</span>  // Move all grouped mutators to GroupsOnly StringArray for sorting by friendly name
<span class="uscript-line">00516</span>      for (i=0;i&lt;Grouped.Count();i++)
<span class="uscript-line">00517</span>      {
<span class="uscript-line">00518</span>          thisgroup = AllMutators[int(Grouped.GetItem(i))].GroupName;
<span class="uscript-line">00519</span>          nextgroup = "";
<span class="uscript-line">00520</span>  
<span class="uscript-line">00521</span>          if (thisgroup=="")
<span class="uscript-line">00522</span>              continue;
<span class="uscript-line">00523</span>          if (i+1&lt;Grouped.Count())
<span class="uscript-line">00524</span>              nextgroup = AllMutators[int(Grouped.GetItem(i+1))].GroupName;
<span class="uscript-line">00525</span>  
<span class="uscript-line">00526</span>          if (thisgroup ~= nextgroup)
<span class="uscript-line">00527</span>          {
<span class="uscript-line">00528</span>              j=i;
<span class="uscript-line">00529</span>              while(nextgroup~=thisgroup &amp;&amp; j&lt;Grouped.Count())
<span class="uscript-line">00530</span>              {
<span class="uscript-line">00531</span>                  GroupsOnly.MoveFromId(Grouped, Grouped.FindItemId(Grouped.GetItem(j)));
<span class="uscript-line">00532</span>                  thisgroup = nextgroup;
<span class="uscript-line">00533</span>                  if (j+1==Grouped.Count())
<span class="uscript-line">00534</span>                      nextgroup="";
<span class="uscript-line">00535</span>                  else nextgroup = AllMutators[int(Grouped.GetItem(j+1))].GroupName;
<span class="uscript-line">00536</span>              }
<span class="uscript-line">00537</span>              if (j&lt;Grouped.Count())
<span class="uscript-line">00538</span>                  GroupsOnly.MoveFromId(Grouped,Grouped.FindItemId(Grouped.GetItem(j)));
<span class="uscript-line">00539</span>              i=-1;
<span class="uscript-line">00540</span>          }
<span class="uscript-line">00541</span>      }
<span class="uscript-line">00542</span>  
<span class="uscript-line">00543</span>  // Move all non-grouped mutators back to Mutators array
<span class="uscript-line">00544</span>  // for re-sorting by Friendly Name
<span class="uscript-line">00545</span>      Mutators.Reset();
<span class="uscript-line">00546</span>      for (i=0;i&lt;Grouped.Count();i++)
<span class="uscript-line">00547</span>      {
<span class="uscript-line">00548</span>          j=int(Grouped.GetItem(i));
<span class="uscript-line">00549</span>          Mutators.Add(string(j),AllMutators[j].FriendlyName);
<span class="uscript-line">00550</span>      }
<span class="uscript-line">00551</span>      Grouped.Reset();
<span class="uscript-line">00552</span>  }
<span class="uscript-line">00553</span>  */</span>
<span class="uscript-line">00554</span>  <span class="uscript-comment">//****************************************************************</span>
<span class="uscript-line">00555</span>  <span class="uscript-comment">//****************************************************************</span>
<span class="uscript-line">00556</span>  <span class="uscript-comment">// Helper functions</span>
<span class="uscript-line">00557</span>  <span class="uscript-comment">//</span>
<span class="uscript-line">00558</span>  <span class="uscript-comment">//****************************************************************</span>
<span class="uscript-line">00559</span>  <span class="uscript-comment">//**************************</span>
<span class="uscript-line">00560</span>  <span class="uscript-comment">// HTML Generation</span>
<span class="uscript-line">00561</span>  <span class="uscript-comment">//*************************</span>
<span class="uscript-line">00562</span>  
<span class="uscript-line">00563</span>  <span class="uscript-comment">// Creates a listing of PlayInfo data</span>
<span class="uscript-line">00564</span>  <span class="uscript-comment">// Pass "defaults_row" in the 'IncludeFile' param to add the</span>
<span class="uscript-line">00565</span>  <span class="uscript-comment">// input form objects to the output</span>
<span class="uscript-line">00566</span>  
<span class="uscript-line">00567</span>  <span class="uscript-keyword">function</span> <span class="uscript-type">string</span> GeneratePlayInfoRows<span class="uscript-operator">(</span>WebRequest Req<span class="uscript-operator">,</span> WebResponse Res<span class="uscript-operator">,</span> <span class="uscript-type">string</span> IncludeFile<span class="uscript-operator">)</span>
<span class="uscript-line">00568</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">00569</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">int</span> i<span class="uscript-operator">,</span>j<span class="uscript-operator">,</span>k<span class="uscript-operator">,</span>z<span class="uscript-operator">;</span>
<span class="uscript-line">00570</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">string</span>    TempStr<span class="uscript-operator">,</span> Data<span class="uscript-operator">,</span> Op<span class="uscript-operator">,</span> SID<span class="uscript-operator">,</span>
<span class="uscript-line">00571</span>                      TempRow<span class="uscript-operator">,</span> HeadingRow<span class="uscript-operator">,</span> PlayInfoRows<span class="uscript-operator">;</span>
<span class="uscript-line">00572</span>  
<span class="uscript-line">00573</span>      <span class="uscript-keyword">local</span> Session       CurS<span class="uscript-operator">;</span>
<span class="uscript-line">00574</span>      <span class="uscript-keyword">local</span> PlayInfo      TempPI<span class="uscript-operator">;</span>
<span class="uscript-line">00575</span>      <span class="uscript-keyword">local</span> StringArray   Info<span class="uscript-operator">,</span> InfoC<span class="uscript-operator">,</span> InfoS<span class="uscript-operator">,</span> InfoT<span class="uscript-operator">;</span>
<span class="uscript-line">00576</span>  
<span class="uscript-line">00577</span>      <span class="uscript-keyword">local</span> <span class="uscript-keyword">array</span><span class="uscript-operator">&lt;</span><span class="uscript-type">string</span><span class="uscript-operator">&gt;</span>         Options<span class="uscript-operator">;</span>
<span class="uscript-line">00578</span>      <span class="uscript-keyword">local</span> <span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>Mutator<span class="uscript-operator">&gt;</span>        TempMut<span class="uscript-operator">;</span>
<span class="uscript-line">00579</span>      <span class="uscript-keyword">local</span> <span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>Info<span class="uscript-operator">&gt;</span>           TempSA<span class="uscript-operator">;</span>
<span class="uscript-line">00580</span>      <span class="uscript-keyword">local</span> <span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>GameInfo<span class="uscript-operator">&gt;</span>       GIClass<span class="uscript-operator">;</span>
<span class="uscript-line">00581</span>      <span class="uscript-keyword">local</span> <span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>AccessControl<span class="uscript-operator">&gt;</span>  ACClass<span class="uscript-operator">;</span>
<span class="uscript-line">00582</span>      <span class="uscript-keyword">local</span> <span class="uscript-keyword">array</span><span class="uscript-operator">&lt;</span><span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>Mutator<span class="uscript-operator">&gt;</span> <span class="uscript-operator">&gt;</span> MClass<span class="uscript-operator">;</span>
<span class="uscript-line">00583</span>      <span class="uscript-keyword">local</span> <span class="uscript-keyword">array</span><span class="uscript-operator">&lt;</span><span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>Info<span class="uscript-operator">&gt;</span> <span class="uscript-operator">&gt;</span>   SAClass<span class="uscript-operator">;</span>
<span class="uscript-line">00584</span>  
<span class="uscript-line">00585</span>      SID <span class="uscript-operator">=</span> Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span><span class="uscript-string">"SessionID"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00586</span>      CurS <span class="uscript-operator">=</span> SMaster<span class="uscript-operator">.</span>GetSession<span class="uscript-operator">(</span>SID<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00587</span>  
<span class="uscript-line">00588</span>      TempStr <span class="uscript-operator">=</span> CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"GameType"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00589</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>TempStr <span class="uscript-operator">!=</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">00590</span>          GIClass <span class="uscript-operator">=</span> <span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>GameInfo<span class="uscript-operator">&gt;</span><span class="uscript-operator">(</span>DynamicLoadObject<span class="uscript-operator">(</span>TempStr<span class="uscript-operator">,</span><span class="uscript-keyword">class</span><span class="uscript-name">'Class'</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00591</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>GIClass <span class="uscript-operator">==</span> <span class="uscript-keyword">None</span><span class="uscript-operator">)</span>
<span class="uscript-line">00592</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">00593</span>          ShowMessage<span class="uscript-operator">(</span>Res<span class="uscript-operator">,</span>ErrorGameClassTitle<span class="uscript-operator">,</span>ErrorGameClassText<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00594</span>          <span class="uscript-keyword">return</span> <span class="uscript-string">""</span><span class="uscript-operator">;</span>
<span class="uscript-line">00595</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">00596</span>  
<span class="uscript-line">00597</span>      TempStr <span class="uscript-operator">=</span> CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"ACClass"</span><span class="uscript-operator">,</span>Level<span class="uscript-operator">.</span>Game<span class="uscript-operator">.</span>AccessControlClass<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00598</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>TempStr <span class="uscript-operator">!=</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">00599</span>          ACClass <span class="uscript-operator">=</span> <span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>AccessControl<span class="uscript-operator">&gt;</span><span class="uscript-operator">(</span>DynamicLoadObject<span class="uscript-operator">(</span>TempStr<span class="uscript-operator">,</span><span class="uscript-keyword">class</span><span class="uscript-name">'Class'</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00600</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>ACClass <span class="uscript-operator">==</span> <span class="uscript-keyword">None</span><span class="uscript-operator">)</span>
<span class="uscript-line">00601</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">00602</span>          ShowMessage<span class="uscript-operator">(</span>Res<span class="uscript-operator">,</span>ErrorAccessControlTitle<span class="uscript-operator">,</span>ErrorAccessControlText<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00603</span>          <span class="uscript-keyword">return</span> <span class="uscript-string">""</span><span class="uscript-operator">;</span>
<span class="uscript-line">00604</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">00605</span>  
<span class="uscript-line">00606</span>      <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>i<span class="uscript-operator">&lt;</span>CurS<span class="uscript-operator">.</span>GetMutatorLength<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">00607</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">00608</span>          TempStr <span class="uscript-operator">=</span> CurS<span class="uscript-operator">.</span>getMutator<span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00609</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>TempStr <span class="uscript-operator">!=</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">00610</span>          <span class="uscript-operator">{</span>
<span class="uscript-line">00611</span>              TempMut <span class="uscript-operator">=</span> <span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>Mutator<span class="uscript-operator">&gt;</span><span class="uscript-operator">(</span>DynamicLoadObject<span class="uscript-operator">(</span>TempStr<span class="uscript-operator">,</span><span class="uscript-keyword">class</span><span class="uscript-name">'Class'</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00612</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>TempMut <span class="uscript-operator">!=</span> <span class="uscript-keyword">None</span><span class="uscript-operator">)</span>
<span class="uscript-line">00613</span>                  MClass<span class="uscript-operator">[</span>MClass<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">]</span> <span class="uscript-operator">=</span> TempMut<span class="uscript-operator">;</span>
<span class="uscript-line">00614</span>          <span class="uscript-operator">}</span>
<span class="uscript-line">00615</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">00616</span>  
<span class="uscript-line">00617</span>      <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>i<span class="uscript-operator">&lt;</span>CurS<span class="uscript-operator">.</span>getSALength<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">00618</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">00619</span>          TempStr <span class="uscript-operator">=</span> CurS<span class="uscript-operator">.</span>getServerActor<span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00620</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>TempStr <span class="uscript-operator">!=</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">00621</span>          <span class="uscript-operator">{</span>
<span class="uscript-line">00622</span>              TempSA <span class="uscript-operator">=</span> <span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>Info<span class="uscript-operator">&gt;</span><span class="uscript-operator">(</span>DynamicLoadObject<span class="uscript-operator">(</span>TempStr<span class="uscript-operator">,</span><span class="uscript-keyword">class</span><span class="uscript-name">'Class'</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00623</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>TempSA <span class="uscript-operator">!=</span> <span class="uscript-keyword">None</span><span class="uscript-operator">)</span>
<span class="uscript-line">00624</span>                  SAClass<span class="uscript-operator">[</span>SAClass<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">]</span> <span class="uscript-operator">=</span> TempSA<span class="uscript-operator">;</span>
<span class="uscript-line">00625</span>          <span class="uscript-operator">}</span>
<span class="uscript-line">00626</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">00627</span>  
<span class="uscript-line">00628</span>      <span class="uscript-comment">// Initialize and fill PlayInfo</span>
<span class="uscript-line">00629</span>      TempPI <span class="uscript-operator">=</span> <span class="uscript-keyword">new</span><span class="uscript-operator">(</span><span class="uscript-keyword">None</span><span class="uscript-operator">)</span> <span class="uscript-keyword">class</span><span class="uscript-name">'PlayInfo'</span><span class="uscript-operator">;</span>
<span class="uscript-line">00630</span>      LoadThisPlayInfo<span class="uscript-operator">(</span>TempPI<span class="uscript-operator">,</span> GIClass<span class="uscript-operator">,</span> ACClass<span class="uscript-operator">,</span> MClass<span class="uscript-operator">,</span> SAClass<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00631</span>  
<span class="uscript-line">00632</span>      <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>i<span class="uscript-operator">&lt;</span>TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">;</span>i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">00633</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>CurS<span class="uscript-operator">.</span>HasData<span class="uscript-operator">(</span>TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>SettingName<span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">00634</span>              TempPI<span class="uscript-operator">.</span>StoreSetting<span class="uscript-operator">(</span>i<span class="uscript-operator">,</span> CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span>TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>SettingName<span class="uscript-operator">,</span>TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>Value<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00635</span>  
<span class="uscript-line">00636</span>      InfoC <span class="uscript-operator">=</span> <span class="uscript-keyword">new</span><span class="uscript-operator">(</span><span class="uscript-keyword">None</span><span class="uscript-operator">)</span> <span class="uscript-keyword">class</span><span class="uscript-name">'SortedStringArray'</span><span class="uscript-operator">;</span> <span class="uscript-comment">// Checkboxes</span>
<span class="uscript-line">00637</span>      InfoS <span class="uscript-operator">=</span> <span class="uscript-keyword">new</span><span class="uscript-operator">(</span><span class="uscript-keyword">None</span><span class="uscript-operator">)</span> <span class="uscript-keyword">class</span><span class="uscript-name">'SortedStringArray'</span><span class="uscript-operator">;</span> <span class="uscript-comment">// Selects</span>
<span class="uscript-line">00638</span>      InfoT <span class="uscript-operator">=</span> <span class="uscript-keyword">new</span><span class="uscript-operator">(</span><span class="uscript-keyword">None</span><span class="uscript-operator">)</span> <span class="uscript-keyword">class</span><span class="uscript-name">'SortedStringArray'</span><span class="uscript-operator">;</span> <span class="uscript-comment">// Textboxes</span>
<span class="uscript-line">00639</span>      Info  <span class="uscript-operator">=</span> <span class="uscript-keyword">new</span><span class="uscript-operator">(</span><span class="uscript-keyword">None</span><span class="uscript-operator">)</span> <span class="uscript-keyword">class</span><span class="uscript-name">'SortedStringArray'</span><span class="uscript-operator">;</span> <span class="uscript-comment">// Contains each unique ClassFrom value</span>
<span class="uscript-line">00640</span>  
<span class="uscript-line">00641</span>      <span class="uscript-comment">// Want to allow admin to input values for each setting</span>
<span class="uscript-line">00642</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>IncludeFile <span class="uscript-operator">~=</span> <span class="uscript-string">"defaults_row"</span><span class="uscript-operator">)</span>
<span class="uscript-line">00643</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">00644</span>          <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>i<span class="uscript-operator">&lt;</span>TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">;</span>i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">00645</span>          <span class="uscript-operator">{</span>
<span class="uscript-line">00646</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>RenderType<span class="uscript-operator">~=</span><span class="uscript-string">"Text"</span><span class="uscript-operator">)</span>
<span class="uscript-line">00647</span>              <span class="uscript-operator">{</span>
<span class="uscript-line">00648</span>                  <span class="uscript-comment">// Hack for MOTD sorting</span>
<span class="uscript-line">00649</span>                  <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>Left<span class="uscript-operator">(</span>TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>SettingName<span class="uscript-operator">,</span>Len<span class="uscript-operator">(</span>TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>SettingName<span class="uscript-operator">)</span> <span class="uscript-operator">-</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span> <span class="uscript-operator">~=</span> <span class="uscript-string">"GameReplicationInfo.MOTDLine"</span><span class="uscript-operator">)</span>
<span class="uscript-line">00650</span>                      InfoT<span class="uscript-operator">.</span>Add<span class="uscript-operator">(</span><span class="uscript-type">string</span><span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">,</span> TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>SettingName<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00651</span>                  <span class="uscript-keyword">else</span> InfoT<span class="uscript-operator">.</span>Add<span class="uscript-operator">(</span><span class="uscript-type">string</span><span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">,</span>TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>DisplayName<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00652</span>              <span class="uscript-operator">}</span>
<span class="uscript-line">00653</span>  
<span class="uscript-line">00654</span>              <span class="uscript-keyword">else</span> <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>RenderType<span class="uscript-operator">~=</span><span class="uscript-string">"Check"</span><span class="uscript-operator">)</span>
<span class="uscript-line">00655</span>                  InfoC<span class="uscript-operator">.</span>Add<span class="uscript-operator">(</span><span class="uscript-type">string</span><span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">,</span>TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>DisplayName<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00656</span>  
<span class="uscript-line">00657</span>              <span class="uscript-keyword">else</span> <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>RenderType<span class="uscript-operator">~=</span><span class="uscript-string">"Select"</span><span class="uscript-operator">)</span>
<span class="uscript-line">00658</span>                  InfoS<span class="uscript-operator">.</span>Add<span class="uscript-operator">(</span><span class="uscript-type">string</span><span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">,</span>TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>DisplayName<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00659</span>  
<span class="uscript-line">00660</span>              <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>j<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>j<span class="uscript-operator">&lt;</span>Info<span class="uscript-operator">.</span>Count<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>j<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">00661</span>                  <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>Info<span class="uscript-operator">.</span>GetTag<span class="uscript-operator">(</span>j<span class="uscript-operator">)</span> <span class="uscript-operator">~=</span> <span class="uscript-type">string</span><span class="uscript-operator">(</span>TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>ClassFrom<span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">00662</span>                      <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>
<span class="uscript-line">00663</span>  
<span class="uscript-line">00664</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>j <span class="uscript-operator">==</span> Info<span class="uscript-operator">.</span>Count<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">00665</span>                  Info<span class="uscript-operator">.</span>Add<span class="uscript-operator">(</span><span class="uscript-type">string</span><span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">,</span> <span class="uscript-type">string</span><span class="uscript-operator">(</span>TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>ClassFrom<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00666</span>          <span class="uscript-operator">}</span>
<span class="uscript-line">00667</span>  
<span class="uscript-line">00668</span>          <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>k<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>k<span class="uscript-operator">&lt;</span>Info<span class="uscript-operator">.</span>Count<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>k<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">00669</span>          <span class="uscript-operator">{</span>
<span class="uscript-line">00670</span>              TempRow <span class="uscript-operator">=</span> <span class="uscript-string">""</span><span class="uscript-operator">;</span> HeadingRow <span class="uscript-operator">=</span> <span class="uscript-string">""</span><span class="uscript-operator">;</span>
<span class="uscript-line">00671</span>              Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"RowContent"</span><span class="uscript-operator">,</span> <span class="uscript-string">"&lt;td class=ttext colspan=\"3\"&gt;"</span><span class="uscript-operator">$</span>Info<span class="uscript-operator">.</span>GetTag<span class="uscript-operator">(</span>k<span class="uscript-operator">)</span><span class="uscript-operator">$</span><span class="uscript-string">"&lt;/td&gt;"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00672</span>              HeadingRow <span class="uscript-operator">=</span> WebInclude<span class="uscript-operator">(</span>RowLeft<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00673</span>  
<span class="uscript-line">00674</span>              <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>i<span class="uscript-operator">&lt;</span>InfoC<span class="uscript-operator">.</span>Count<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">00675</span>              <span class="uscript-operator">{</span>
<span class="uscript-line">00676</span>                  TempStr <span class="uscript-operator">=</span> <span class="uscript-string">""</span><span class="uscript-operator">;</span>
<span class="uscript-line">00677</span>                  j<span class="uscript-operator">=</span><span class="uscript-type">int</span><span class="uscript-operator">(</span>InfoC<span class="uscript-operator">.</span>GetItem<span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00678</span>                  <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">!</span>SettingIsAllowed<span class="uscript-operator">(</span>TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>SecLevel<span class="uscript-operator">)</span> <span class="uscript-operator">||</span> <span class="uscript-operator">(</span><span class="uscript-type">string</span><span class="uscript-operator">(</span>TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>ClassFrom<span class="uscript-operator">)</span><span class="uscript-operator">!=</span>Info<span class="uscript-operator">.</span>GetTag<span class="uscript-operator">(</span>k<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">00679</span>                      <span class="uscript-keyword">continue</span><span class="uscript-operator">;</span>
<span class="uscript-line">00680</span>  
<span class="uscript-line">00681</span>                  Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"Content"</span><span class="uscript-operator">,</span> Checkbox<span class="uscript-operator">(</span>TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>SettingName<span class="uscript-operator">,</span> TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>Value <span class="uscript-operator">~=</span> <span class="uscript-string">"True"</span><span class="uscript-operator">,</span> TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>Data <span class="uscript-operator">!=</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00682</span>                  TempStr <span class="uscript-operator">=</span> WebInclude<span class="uscript-operator">(</span>CellLeft<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00683</span>  
<span class="uscript-line">00684</span>                  Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"Content"</span><span class="uscript-operator">,</span> <span class="uscript-string">"&lt;span class=location title=\"Required Security Level\"&gt;"</span><span class="uscript-operator">$</span>TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>SecLevel<span class="uscript-operator">$</span><span class="uscript-string">"&lt;/span&gt;"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00685</span>                  TempStr <span class="uscript-operator">+=</span> WebInclude<span class="uscript-operator">(</span>CellLeft<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00686</span>  
<span class="uscript-line">00687</span>                  Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"Content"</span><span class="uscript-operator">,</span> <span class="uscript-string">"&lt;span class='location'&gt;"</span><span class="uscript-operator">$</span>HtmlEncode<span class="uscript-operator">(</span>TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>DisplayName<span class="uscript-operator">)</span><span class="uscript-operator">$</span><span class="uscript-string">"&lt;/span&gt;"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00688</span>                  Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"RowContent"</span><span class="uscript-operator">,</span> WebInclude<span class="uscript-operator">(</span>CellLeft<span class="uscript-operator">)</span> <span class="uscript-operator">$</span> TempStr<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00689</span>                  TempRow <span class="uscript-operator">+=</span> WebInclude<span class="uscript-operator">(</span>RowLeft<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00690</span>              <span class="uscript-operator">}</span>
<span class="uscript-line">00691</span>  
<span class="uscript-line">00692</span>              <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>i<span class="uscript-operator">&lt;</span>InfoT<span class="uscript-operator">.</span>Count<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">00693</span>              <span class="uscript-operator">{</span>
<span class="uscript-line">00694</span>                  TempStr <span class="uscript-operator">=</span> <span class="uscript-string">""</span><span class="uscript-operator">;</span>
<span class="uscript-line">00695</span>                  j <span class="uscript-operator">=</span> <span class="uscript-type">int</span><span class="uscript-operator">(</span>InfoT<span class="uscript-operator">.</span>GetItem<span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00696</span>                  <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">!</span>SettingIsAllowed<span class="uscript-operator">(</span>TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>SecLevel<span class="uscript-operator">)</span> <span class="uscript-operator">||</span> <span class="uscript-operator">(</span><span class="uscript-type">string</span><span class="uscript-operator">(</span>TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>ClassFrom<span class="uscript-operator">)</span><span class="uscript-operator">!=</span>Info<span class="uscript-operator">.</span>GetTag<span class="uscript-operator">(</span>k<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">00697</span>                      <span class="uscript-keyword">continue</span><span class="uscript-operator">;</span>
<span class="uscript-line">00698</span>  
<span class="uscript-line">00699</span>                  Data <span class="uscript-operator">=</span> <span class="uscript-string">"8"</span><span class="uscript-operator">;</span>
<span class="uscript-line">00700</span>                  <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>Data <span class="uscript-operator">!=</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">00701</span>                  <span class="uscript-operator">{</span>
<span class="uscript-line">00702</span>                      Data <span class="uscript-operator">=</span> TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>Data<span class="uscript-operator">;</span>
<span class="uscript-line">00703</span>                      Divide<span class="uscript-operator">(</span>TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>Data<span class="uscript-operator">,</span> <span class="uscript-string">";"</span><span class="uscript-operator">,</span> Data<span class="uscript-operator">,</span> Op<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00704</span>                      TempPI<span class="uscript-operator">.</span>SplitStringToArray<span class="uscript-operator">(</span>Options<span class="uscript-operator">,</span> Op<span class="uscript-operator">,</span> <span class="uscript-string">":"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00705</span>                  <span class="uscript-operator">}</span>
<span class="uscript-line">00706</span>  
<span class="uscript-line">00707</span>                  Op <span class="uscript-operator">=</span> <span class="uscript-string">""</span><span class="uscript-operator">;</span>
<span class="uscript-line">00708</span>                  <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>Options<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span> <span class="uscript-operator">&gt;</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span>
<span class="uscript-line">00709</span>                      Op <span class="uscript-operator">=</span> <span class="uscript-string">" ("</span><span class="uscript-operator">$</span>Options<span class="uscript-operator">[</span><span class="uscript-number">0</span><span class="uscript-operator">]</span><span class="uscript-operator">$</span><span class="uscript-string">" - "</span><span class="uscript-operator">$</span>Options<span class="uscript-operator">[</span><span class="uscript-number">1</span><span class="uscript-operator">]</span><span class="uscript-operator">$</span><span class="uscript-string">")"</span><span class="uscript-operator">;</span>
<span class="uscript-line">00710</span>  
<span class="uscript-line">00711</span>                  Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"Content"</span><span class="uscript-operator">,</span> Textbox<span class="uscript-operator">(</span>TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>SettingName<span class="uscript-operator">,</span> Data<span class="uscript-operator">,</span> <span class="uscript-number">3</span> <span class="uscript-operator">*</span> <span class="uscript-type">int</span><span class="uscript-operator">(</span>Data<span class="uscript-operator">)</span><span class="uscript-operator">,</span> TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>Value<span class="uscript-operator">)</span> <span class="uscript-operator">$</span> Op<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00712</span>                  TempStr <span class="uscript-operator">=</span> WebInclude<span class="uscript-operator">(</span>CellLeft<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00713</span>  
<span class="uscript-line">00714</span>                  Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"Content"</span><span class="uscript-operator">,</span> <span class="uscript-string">"&lt;span class=location title=\"Required Security Level\"&gt;"</span><span class="uscript-operator">$</span>TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>SecLevel<span class="uscript-operator">$</span><span class="uscript-string">"&lt;/span&gt;"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00715</span>                  TempStr <span class="uscript-operator">+=</span> WebInclude<span class="uscript-operator">(</span>CellLeft<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00716</span>  
<span class="uscript-line">00717</span>                  Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"Content"</span><span class="uscript-operator">,</span> <span class="uscript-string">"&lt;span class='location'&gt;"</span><span class="uscript-operator">$</span>HtmlEncode<span class="uscript-operator">(</span>TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>DisplayName<span class="uscript-operator">)</span><span class="uscript-operator">$</span><span class="uscript-string">"&lt;/span&gt;"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00718</span>                  Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"RowContent"</span><span class="uscript-operator">,</span> WebInclude<span class="uscript-operator">(</span>CellLeft<span class="uscript-operator">)</span> <span class="uscript-operator">$</span> TempStr<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00719</span>                  TempRow <span class="uscript-operator">+=</span> WebInclude<span class="uscript-operator">(</span>RowLeft<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00720</span>              <span class="uscript-operator">}</span>
<span class="uscript-line">00721</span>  
<span class="uscript-line">00722</span>              <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>i<span class="uscript-operator">&lt;</span>InfoS<span class="uscript-operator">.</span>Count<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">00723</span>              <span class="uscript-operator">{</span>
<span class="uscript-line">00724</span>                  Data <span class="uscript-operator">=</span> <span class="uscript-string">""</span><span class="uscript-operator">;</span> TempStr <span class="uscript-operator">=</span> <span class="uscript-string">""</span><span class="uscript-operator">;</span>
<span class="uscript-line">00725</span>                  j<span class="uscript-operator">=</span><span class="uscript-type">int</span><span class="uscript-operator">(</span>InfoS<span class="uscript-operator">.</span>GetItem<span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00726</span>                  <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">!</span>SettingIsAllowed<span class="uscript-operator">(</span>TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>SecLevel<span class="uscript-operator">)</span> <span class="uscript-operator">||</span> <span class="uscript-operator">(</span><span class="uscript-type">string</span><span class="uscript-operator">(</span>TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>ClassFrom<span class="uscript-operator">)</span><span class="uscript-operator">!=</span>Info<span class="uscript-operator">.</span>GetTag<span class="uscript-operator">(</span>k<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">00727</span>                      <span class="uscript-keyword">continue</span><span class="uscript-operator">;</span>
<span class="uscript-line">00728</span>                  <span class="uscript-comment">// Build a set of options from PID.Data</span>
<span class="uscript-line">00729</span>                  TempPI<span class="uscript-operator">.</span>SplitStringToArray<span class="uscript-operator">(</span>Options<span class="uscript-operator">,</span> TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>Data<span class="uscript-operator">,</span> <span class="uscript-string">";"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00730</span>                  <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>z <span class="uscript-operator">=</span> <span class="uscript-number">0</span><span class="uscript-operator">;</span> <span class="uscript-operator">(</span>z<span class="uscript-number">+1</span><span class="uscript-operator">)</span><span class="uscript-operator">&lt;</span>Options<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">;</span> z <span class="uscript-operator">+=</span> <span class="uscript-number">2</span><span class="uscript-operator">)</span>
<span class="uscript-line">00731</span>                  <span class="uscript-operator">{</span>
<span class="uscript-line">00732</span>                      Data <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span><span class="uscript-string">"&lt;option value='"</span><span class="uscript-operator">$</span>Options<span class="uscript-operator">[</span>z<span class="uscript-operator">]</span><span class="uscript-operator">$</span><span class="uscript-string">"'"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00733</span>                      <span class="uscript-keyword">If</span> <span class="uscript-operator">(</span>TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>Value <span class="uscript-operator">==</span> Options<span class="uscript-operator">[</span>z<span class="uscript-operator">]</span><span class="uscript-operator">)</span>
<span class="uscript-line">00734</span>                          Data <span class="uscript-operator">@</span><span class="uscript-operator">=</span> <span class="uscript-string">"selected"</span><span class="uscript-operator">;</span>
<span class="uscript-line">00735</span>                      Data <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span><span class="uscript-string">"&gt;"</span><span class="uscript-operator">$</span>HtmlEncode<span class="uscript-operator">(</span>Options<span class="uscript-operator">[</span>z<span class="uscript-number">+1</span><span class="uscript-operator">]</span><span class="uscript-operator">)</span><span class="uscript-operator">$</span><span class="uscript-string">"&lt;/option&gt;"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00736</span>                  <span class="uscript-operator">}</span>
<span class="uscript-line">00737</span>  
<span class="uscript-line">00738</span>                  Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"Content"</span><span class="uscript-operator">,</span> Select<span class="uscript-operator">(</span>TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>SettingName<span class="uscript-operator">,</span> Data<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00739</span>                  TempStr <span class="uscript-operator">=</span> WebInclude<span class="uscript-operator">(</span>CellLeft<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00740</span>  
<span class="uscript-line">00741</span>                  Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"Content"</span><span class="uscript-operator">,</span> <span class="uscript-string">"&lt;span class=location title=\"Required Security Level\"&gt;"</span><span class="uscript-operator">$</span>TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>SecLevel<span class="uscript-operator">$</span><span class="uscript-string">"&lt;/span&gt;"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00742</span>                  TempStr <span class="uscript-operator">+=</span> WebInclude<span class="uscript-operator">(</span>CellLeft<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00743</span>  
<span class="uscript-line">00744</span>                  Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"Content"</span><span class="uscript-operator">,</span> <span class="uscript-string">"&lt;span class='location'&gt;"</span><span class="uscript-operator">$</span>HtmlEncode<span class="uscript-operator">(</span>TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>DisplayName<span class="uscript-operator">)</span><span class="uscript-operator">$</span><span class="uscript-string">"&lt;/span&gt;"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00745</span>                  Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"RowContent"</span><span class="uscript-operator">,</span> WebInclude<span class="uscript-operator">(</span>CellLeft<span class="uscript-operator">)</span> <span class="uscript-operator">$</span> TempStr<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00746</span>                  TempRow <span class="uscript-operator">+=</span> WebInclude<span class="uscript-operator">(</span>RowLeft<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00747</span>              <span class="uscript-operator">}</span>
<span class="uscript-line">00748</span>  
<span class="uscript-line">00749</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>TempRow<span class="uscript-operator">!=</span><span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">00750</span>                  PlayInfoRows <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span>HeadingRow<span class="uscript-operator">$</span>TempRow<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00751</span>          <span class="uscript-operator">}</span>
<span class="uscript-line">00752</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">00753</span>      <span class="uscript-keyword">else</span>    <span class="uscript-comment">// Displaying values only</span>
<span class="uscript-line">00754</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">00755</span>          <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>i<span class="uscript-operator">&lt;</span>TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">;</span>i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">00756</span>          <span class="uscript-operator">{</span>
<span class="uscript-line">00757</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>Left<span class="uscript-operator">(</span>TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>SettingName<span class="uscript-operator">,</span>Len<span class="uscript-operator">(</span>TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>SettingName<span class="uscript-operator">)</span> <span class="uscript-operator">-</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span> <span class="uscript-operator">~=</span> <span class="uscript-string">"GameReplicationInfo.MOTDLine"</span><span class="uscript-operator">)</span>
<span class="uscript-line">00758</span>                  InfoS<span class="uscript-operator">.</span>Add<span class="uscript-operator">(</span><span class="uscript-type">string</span><span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">,</span> TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>SettingName<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00759</span>              <span class="uscript-keyword">else</span> InfoS<span class="uscript-operator">.</span>Add<span class="uscript-operator">(</span><span class="uscript-type">string</span><span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">,</span>TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>DisplayName<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00760</span>  
<span class="uscript-line">00761</span>              <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>j<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>j<span class="uscript-operator">&lt;</span>Info<span class="uscript-operator">.</span>Count<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>j<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">00762</span>                  <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>Info<span class="uscript-operator">.</span>GetTag<span class="uscript-operator">(</span>j<span class="uscript-operator">)</span> <span class="uscript-operator">~=</span> <span class="uscript-type">string</span><span class="uscript-operator">(</span>TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>ClassFrom<span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">00763</span>                      <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>
<span class="uscript-line">00764</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>j <span class="uscript-operator">==</span> Info<span class="uscript-operator">.</span>Count<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">00765</span>                  Info<span class="uscript-operator">.</span>Add<span class="uscript-operator">(</span><span class="uscript-type">string</span><span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">,</span> <span class="uscript-type">string</span><span class="uscript-operator">(</span>TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>ClassFrom<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00766</span>          <span class="uscript-operator">}</span>
<span class="uscript-line">00767</span>  
<span class="uscript-line">00768</span>          <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>k<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>k<span class="uscript-operator">&lt;</span>Info<span class="uscript-operator">.</span>Count<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>k<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">00769</span>          <span class="uscript-operator">{</span>
<span class="uscript-line">00770</span>              TempRow <span class="uscript-operator">=</span> <span class="uscript-string">""</span><span class="uscript-operator">;</span>
<span class="uscript-line">00771</span>              HeadingRow <span class="uscript-operator">=</span> <span class="uscript-string">"&lt;tr&gt;&lt;td class=ttext colspan=\"2\"&gt;"</span><span class="uscript-operator">$</span>Info<span class="uscript-operator">.</span>GetTag<span class="uscript-operator">(</span>k<span class="uscript-operator">)</span><span class="uscript-operator">$</span><span class="uscript-string">"&lt;/td&gt;&lt;/tr&gt;"</span><span class="uscript-operator">;</span>
<span class="uscript-line">00772</span>              <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>i<span class="uscript-operator">&lt;</span>InfoS<span class="uscript-operator">.</span>Count<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">00773</span>              <span class="uscript-operator">{</span>
<span class="uscript-line">00774</span>                  j<span class="uscript-operator">=</span><span class="uscript-type">int</span><span class="uscript-operator">(</span>InfoS<span class="uscript-operator">.</span>GetItem<span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00775</span>                  Data <span class="uscript-operator">=</span> <span class="uscript-string">""</span><span class="uscript-operator">;</span>
<span class="uscript-line">00776</span>  
<span class="uscript-line">00777</span>                  <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">!</span>SettingIsAllowed<span class="uscript-operator">(</span>TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>SecLevel<span class="uscript-operator">)</span> <span class="uscript-operator">||</span> <span class="uscript-operator">(</span><span class="uscript-type">string</span><span class="uscript-operator">(</span>TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>ClassFrom<span class="uscript-operator">)</span><span class="uscript-operator">!=</span>Info<span class="uscript-operator">.</span>GetTag<span class="uscript-operator">(</span>k<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">00778</span>                      <span class="uscript-keyword">continue</span><span class="uscript-operator">;</span>
<span class="uscript-line">00779</span>  
<span class="uscript-line">00780</span>                  Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SettingName"</span><span class="uscript-operator">,</span> HtmlEncode<span class="uscript-operator">(</span>TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>DisplayName<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00781</span>  
<span class="uscript-line">00782</span>                  <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>Value <span class="uscript-operator">~=</span> <span class="uscript-string">"true"</span><span class="uscript-operator">)</span>
<span class="uscript-line">00783</span>                      Data <span class="uscript-operator">=</span> <span class="uscript-string">"True"</span><span class="uscript-operator">;</span>
<span class="uscript-line">00784</span>  
<span class="uscript-line">00785</span>                  <span class="uscript-keyword">else</span> <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>Value <span class="uscript-operator">~=</span> <span class="uscript-string">"false"</span><span class="uscript-operator">)</span>
<span class="uscript-line">00786</span>                      Data <span class="uscript-operator">=</span> <span class="uscript-string">"False"</span><span class="uscript-operator">;</span>
<span class="uscript-line">00787</span>  
<span class="uscript-line">00788</span>                  <span class="uscript-keyword">else</span>
<span class="uscript-line">00789</span>                  <span class="uscript-operator">{</span>
<span class="uscript-line">00790</span>                      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>RenderType <span class="uscript-operator">~=</span> <span class="uscript-string">"Select"</span><span class="uscript-operator">)</span>
<span class="uscript-line">00791</span>                      <span class="uscript-operator">{</span>
<span class="uscript-line">00792</span>                          <span class="uscript-keyword">class</span><span class="uscript-name">'wUtils103.wString'</span><span class="uscript-operator">.</span><span class="uscript-keyword">static</span><span class="uscript-operator">.</span>Split2<span class="uscript-operator">(</span>TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>Data<span class="uscript-operator">,</span> <span class="uscript-string">";"</span><span class="uscript-operator">,</span> Options<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00793</span>                          <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>z<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span><span class="uscript-operator">(</span>z<span class="uscript-number">+1</span><span class="uscript-operator">)</span><span class="uscript-operator">&lt;</span>Options<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">;</span>z<span class="uscript-operator">+=</span><span class="uscript-number">2</span><span class="uscript-operator">)</span>
<span class="uscript-line">00794</span>                          <span class="uscript-operator">{</span>
<span class="uscript-line">00795</span>                              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>Value <span class="uscript-operator">==</span> Options<span class="uscript-operator">[</span>z<span class="uscript-operator">]</span><span class="uscript-operator">)</span>
<span class="uscript-line">00796</span>                              <span class="uscript-operator">{</span>
<span class="uscript-line">00797</span>                                  Data <span class="uscript-operator">=</span> Options<span class="uscript-operator">[</span>z<span class="uscript-number">+1</span><span class="uscript-operator">]</span><span class="uscript-operator">;</span>
<span class="uscript-line">00798</span>                                  <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>
<span class="uscript-line">00799</span>                              <span class="uscript-operator">}</span>
<span class="uscript-line">00800</span>                          <span class="uscript-operator">}</span>
<span class="uscript-line">00801</span>                      <span class="uscript-operator">}</span>
<span class="uscript-line">00802</span>                      <span class="uscript-keyword">else</span> Data <span class="uscript-operator">=</span> TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>Value<span class="uscript-operator">;</span>
<span class="uscript-line">00803</span>                  <span class="uscript-operator">}</span>
<span class="uscript-line">00804</span>  
<span class="uscript-line">00805</span>                  Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SettingData"</span><span class="uscript-operator">,</span> HtmlEncode<span class="uscript-operator">(</span>Data<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00806</span>                  Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"Extra"</span><span class="uscript-operator">,</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00807</span>                  TempRow <span class="uscript-operator">+=</span> WebInclude<span class="uscript-operator">(</span>IncludeFile<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00808</span>              <span class="uscript-operator">}</span>
<span class="uscript-line">00809</span>  
<span class="uscript-line">00810</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>TempRow<span class="uscript-operator">!=</span><span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">00811</span>                  PlayInfoRows <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span>HeadingRow<span class="uscript-operator">$</span>TempRow<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00812</span>          <span class="uscript-operator">}</span>
<span class="uscript-line">00813</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">00814</span>      <span class="uscript-keyword">return</span> PlayInfoRows<span class="uscript-operator">;</span>
<span class="uscript-line">00815</span>  <span class="uscript-operator">}</span>
<span class="uscript-line">00816</span>  
<span class="uscript-line">00817</span>  <span class="uscript-comment">// Creates the drop-down box containing profiles names</span>
<span class="uscript-line">00818</span>  <span class="uscript-keyword">function</span> <span class="uscript-type">String</span> GenerateSwitchProfileOptions<span class="uscript-operator">(</span><span class="uscript-keyword">optional</span> <span class="uscript-type">string</span> CurrentProfileItem<span class="uscript-operator">)</span>
<span class="uscript-line">00819</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">00820</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">int</span> i<span class="uscript-operator">;</span>
<span class="uscript-line">00821</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">string</span> SelectedStr<span class="uscript-operator">,</span> OptionStr<span class="uscript-operator">;</span>
<span class="uscript-line">00822</span>  
<span class="uscript-line">00823</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>LadderRules<span class="uscript-operator">.</span>AllLadderProfiles<span class="uscript-operator">.</span>Count<span class="uscript-operator">(</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-number">0</span><span class="uscript-operator">)</span>
<span class="uscript-line">00824</span>          <span class="uscript-keyword">return</span> <span class="uscript-string">"&lt;option value=\"\"&gt;***"</span><span class="uscript-operator">@</span>NoneText<span class="uscript-operator">@</span><span class="uscript-string">"***&lt;/option&gt;"</span><span class="uscript-operator">;</span>
<span class="uscript-line">00825</span>  
<span class="uscript-line">00826</span>      <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span> i <span class="uscript-operator">&lt;</span> LadderRules<span class="uscript-operator">.</span>AllLadderProfiles<span class="uscript-operator">.</span>Count<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">00827</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">00828</span>      <span class="uscript-comment">// This item was the item passed in by CurrentProfileItem, so make it active</span>
<span class="uscript-line">00829</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>CurrentProfileItem <span class="uscript-operator">~=</span> LadderRules<span class="uscript-operator">.</span>AllLadderProfiles<span class="uscript-operator">.</span>GetItem<span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">00830</span>              SelectedStr <span class="uscript-operator">=</span> <span class="uscript-string">" selected"</span><span class="uscript-operator">;</span>
<span class="uscript-line">00831</span>          <span class="uscript-keyword">else</span> SelectedStr <span class="uscript-operator">=</span> <span class="uscript-string">""</span><span class="uscript-operator">;</span>
<span class="uscript-line">00832</span>  
<span class="uscript-line">00833</span>          OptionStr <span class="uscript-operator">=</span> OptionStr<span class="uscript-operator">$</span><span class="uscript-string">"&lt;option value=\""</span><span class="uscript-operator">$</span>LadderRules<span class="uscript-operator">.</span>AllLadderProfiles<span class="uscript-operator">.</span>GetItem<span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">$</span><span class="uscript-string">"\""</span><span class="uscript-operator">$</span>SelectedStr<span class="uscript-operator">$</span><span class="uscript-string">"&gt;"</span><span class="uscript-operator">$</span>LadderRules<span class="uscript-operator">.</span>AllLadderProfiles<span class="uscript-operator">.</span>GetTag<span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">@</span><span class="uscript-string">"&lt;/option&gt;"</span><span class="uscript-operator">;</span>
<span class="uscript-line">00834</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">00835</span>      <span class="uscript-keyword">return</span> OptionStr<span class="uscript-operator">;</span>
<span class="uscript-line">00836</span>  <span class="uscript-operator">}</span>
<span class="uscript-line">00837</span>  
<span class="uscript-line">00838</span>  <span class="uscript-keyword">function</span> <span class="uscript-type">bool</span> SettingIsAllowed<span class="uscript-operator">(</span><span class="uscript-type">byte</span> SettingSecLevel<span class="uscript-operator">)</span>
<span class="uscript-line">00839</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">00840</span>      <span class="uscript-keyword">return</span> SettingSecLevel <span class="uscript-operator">&lt;=</span> CurAdmin<span class="uscript-operator">.</span>MaxSecLevel<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00841</span>  <span class="uscript-operator">}</span>
<span class="uscript-line">00842</span>  
<span class="uscript-line">00843</span>  <span class="uscript-comment">// Handles generation of the double map select boxes (Exclude &amp; Include)</span>
<span class="uscript-line">00844</span>  <span class="uscript-keyword">function</span> <span class="uscript-type">String</span> CreateMapListSelect<span class="uscript-operator">(</span><span class="uscript-keyword">array</span><span class="uscript-operator">&lt;</span>ProfileConfigSet<span class="uscript-operator">.</span>ProfileMap<span class="uscript-operator">&gt;</span> AllPCSMaps<span class="uscript-operator">,</span> StringArray MapList<span class="uscript-operator">,</span> StringArray MovedMaps<span class="uscript-operator">)</span>
<span class="uscript-line">00845</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">00846</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">int</span> i<span class="uscript-operator">,</span>j<span class="uscript-operator">;</span>
<span class="uscript-line">00847</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">String</span> ResponseStr<span class="uscript-operator">,</span> SelectedStr<span class="uscript-operator">,</span> Tmp<span class="uscript-operator">;</span>
<span class="uscript-line">00848</span>  
<span class="uscript-line">00849</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>MapList<span class="uscript-operator">.</span>Count<span class="uscript-operator">(</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-number">0</span><span class="uscript-operator">)</span>
<span class="uscript-line">00850</span>          <span class="uscript-keyword">return</span> <span class="uscript-string">"&lt;option value=\"\"&gt;***"</span><span class="uscript-operator">@</span>NoneText<span class="uscript-operator">@</span><span class="uscript-string">"***&lt;/option&gt;"</span><span class="uscript-operator">;</span>
<span class="uscript-line">00851</span>  
<span class="uscript-line">00852</span>      <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i <span class="uscript-operator">=</span> <span class="uscript-number">0</span><span class="uscript-operator">;</span> i<span class="uscript-operator">&lt;</span>MapList<span class="uscript-operator">.</span>Count<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">00853</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">00854</span>      <span class="uscript-comment">// Index for map within AllPCSMaps</span>
<span class="uscript-line">00855</span>          j <span class="uscript-operator">=</span> <span class="uscript-type">int</span><span class="uscript-operator">(</span>MapList<span class="uscript-operator">.</span>GetItem<span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00856</span>  
<span class="uscript-line">00857</span>          Tmp <span class="uscript-operator">=</span> AllPCSMaps<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>MapName<span class="uscript-operator">;</span>
<span class="uscript-line">00858</span>          SelectedStr <span class="uscript-operator">=</span> <span class="uscript-string">""</span><span class="uscript-operator">;</span>
<span class="uscript-line">00859</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>MovedMaps <span class="uscript-operator">!=</span> <span class="uscript-keyword">None</span> <span class="uscript-operator">&amp;&amp;</span> MovedMaps<span class="uscript-operator">.</span>FindItemId<span class="uscript-operator">(</span><span class="uscript-type">string</span><span class="uscript-operator">(</span>j<span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">&gt;=</span> <span class="uscript-number">0</span><span class="uscript-operator">)</span>
<span class="uscript-line">00860</span>              SelectedStr <span class="uscript-operator">=</span> <span class="uscript-string">" selected"</span><span class="uscript-operator">;</span>
<span class="uscript-line">00861</span>          ResponseStr <span class="uscript-operator">=</span> ResponseStr<span class="uscript-operator">$</span><span class="uscript-string">"&lt;option value=\""</span><span class="uscript-operator">$</span>Tmp<span class="uscript-operator">$</span><span class="uscript-string">"\""</span><span class="uscript-operator">$</span>SelectedStr<span class="uscript-operator">$</span><span class="uscript-string">"&gt;"</span><span class="uscript-operator">$</span>Tmp<span class="uscript-operator">$</span><span class="uscript-string">"&lt;/option&gt;"</span><span class="uscript-operator">;</span>
<span class="uscript-line">00862</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">00863</span>  
<span class="uscript-line">00864</span>      <span class="uscript-keyword">return</span> ResponseStr<span class="uscript-operator">;</span>
<span class="uscript-line">00865</span>  <span class="uscript-operator">}</span>
<span class="uscript-line">00866</span>  
<span class="uscript-line">00867</span>  <span class="uscript-comment">//**********************</span>
<span class="uscript-line">00868</span>  <span class="uscript-comment">// Import / Export</span>
<span class="uscript-line">00869</span>  <span class="uscript-comment">//**********************</span>
<span class="uscript-line">00870</span>  
<span class="uscript-line">00871</span>  <span class="uscript-comment">// Handles spacing for textboxes on export page</span>
<span class="uscript-line">00872</span>  <span class="uscript-keyword">function</span> <span class="uscript-type">int</span> GetLongestURL<span class="uscript-operator">(</span><span class="uscript-operator">)</span>
<span class="uscript-line">00873</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">00874</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">int</span> i<span class="uscript-operator">,</span> Current<span class="uscript-operator">,</span> Largest<span class="uscript-operator">;</span>
<span class="uscript-line">00875</span>  
<span class="uscript-line">00876</span>      <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i <span class="uscript-operator">=</span> <span class="uscript-number">0</span><span class="uscript-operator">;</span> i <span class="uscript-operator">&lt;</span> ExportMaster<span class="uscript-operator">.</span>Zips<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">;</span> i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">00877</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">00878</span>          Current <span class="uscript-operator">=</span> Len<span class="uscript-operator">(</span>ExportMaster<span class="uscript-operator">.</span>Zips<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>ZipURL<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00879</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>Current <span class="uscript-operator">&gt;</span> Largest<span class="uscript-operator">)</span>
<span class="uscript-line">00880</span>              Largest <span class="uscript-operator">=</span> Current<span class="uscript-operator">;</span>
<span class="uscript-line">00881</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">00882</span>  
<span class="uscript-line">00883</span>      <span class="uscript-keyword">return</span> Largest <span class="uscript-operator">+</span> <span class="uscript-number">1</span><span class="uscript-operator">;</span>
<span class="uscript-line">00884</span>  <span class="uscript-operator">}</span>
<span class="uscript-line">00885</span>  
<span class="uscript-line">00886</span>  <span class="uscript-comment">// Handles filling in zip-location textboxes on export page</span>
<span class="uscript-line">00887</span>  <span class="uscript-keyword">function</span> <span class="uscript-type">string</span> GetLocation<span class="uscript-operator">(</span><span class="uscript-type">string</span> Package<span class="uscript-operator">)</span>
<span class="uscript-line">00888</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">00889</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">int</span> i<span class="uscript-operator">;</span>
<span class="uscript-line">00890</span>  
<span class="uscript-line">00891</span>      <span class="uscript-comment">// Check if we're dealing with a map or a mutator</span>
<span class="uscript-line">00892</span>      i <span class="uscript-operator">=</span> InStr<span class="uscript-operator">(</span>Package<span class="uscript-operator">,</span> <span class="uscript-string">"."</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00893</span>  
<span class="uscript-line">00894</span>      <span class="uscript-comment">// Dealing with a mutator - remove class name</span>
<span class="uscript-line">00895</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>i <span class="uscript-operator">!=</span> <span class="uscript-operator">-</span><span class="uscript-number">1</span><span class="uscript-operator">)</span>
<span class="uscript-line">00896</span>          Package <span class="uscript-operator">=</span> Left<span class="uscript-operator">(</span>Package<span class="uscript-operator">,</span> i<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00897</span>  
<span class="uscript-line">00898</span>      <span class="uscript-keyword">return</span> ExportMaster<span class="uscript-operator">.</span>FindZipLocation<span class="uscript-operator">(</span>Package<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00899</span>  <span class="uscript-operator">}</span>
<span class="uscript-line">00900</span>  
<span class="uscript-line">00901</span>  <span class="uscript-comment">// Handles saving zip file locations from export page</span>
<span class="uscript-line">00902</span>  <span class="uscript-keyword">function</span> SetLocation<span class="uscript-operator">(</span><span class="uscript-type">string</span> Package<span class="uscript-operator">,</span> <span class="uscript-type">string</span> NewLocation<span class="uscript-operator">)</span>
<span class="uscript-line">00903</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">00904</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">int</span> i<span class="uscript-operator">;</span>
<span class="uscript-line">00905</span>  
<span class="uscript-line">00906</span>      <span class="uscript-comment">// Check if we're dealing with a map or a mutator</span>
<span class="uscript-line">00907</span>      i <span class="uscript-operator">=</span> InStr<span class="uscript-operator">(</span>Package<span class="uscript-operator">,</span> <span class="uscript-string">"."</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00908</span>  
<span class="uscript-line">00909</span>      <span class="uscript-comment">// Dealing with a mutator - remove class name</span>
<span class="uscript-line">00910</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>i <span class="uscript-operator">!=</span> <span class="uscript-operator">-</span><span class="uscript-number">1</span><span class="uscript-operator">)</span>
<span class="uscript-line">00911</span>          Package <span class="uscript-operator">=</span> Left<span class="uscript-operator">(</span>Package<span class="uscript-operator">,</span> i<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00912</span>  
<span class="uscript-line">00913</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>NewLocation <span class="uscript-operator">==</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">00914</span>          ExportMaster<span class="uscript-operator">.</span>DeleteZipLocation<span class="uscript-operator">(</span>Package<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00915</span>      <span class="uscript-keyword">else</span> ExportMaster<span class="uscript-operator">.</span>AddZipLocation<span class="uscript-operator">(</span>Package<span class="uscript-operator">,</span> NewLocation<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00916</span>  <span class="uscript-operator">}</span>
<span class="uscript-line">00917</span>  
<span class="uscript-line">00918</span>  <span class="uscript-comment">// Utility function to remove strings from profile names before</span>
<span class="uscript-line">00919</span>  <span class="uscript-comment">// creating .txt for exported profile</span>
<span class="uscript-line">00920</span>  <span class="uscript-keyword">function</span> <span class="uscript-type">string</span> RemoveStr<span class="uscript-operator">(</span><span class="uscript-type">string</span> Source<span class="uscript-operator">,</span><span class="uscript-type">string</span> mask<span class="uscript-operator">)</span>
<span class="uscript-line">00921</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">00922</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">int</span> i<span class="uscript-operator">;</span>
<span class="uscript-line">00923</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">string</span> left<span class="uscript-operator">,</span>right<span class="uscript-operator">;</span>
<span class="uscript-line">00924</span>  
<span class="uscript-line">00925</span>      i <span class="uscript-operator">=</span> InStr<span class="uscript-operator">(</span>Source<span class="uscript-operator">,</span>mask<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00926</span>      <span class="uscript-keyword">while</span> <span class="uscript-operator">(</span>i <span class="uscript-operator">!=</span> <span class="uscript-operator">-</span><span class="uscript-number">1</span><span class="uscript-operator">)</span>
<span class="uscript-line">00927</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">00928</span>          Divide<span class="uscript-operator">(</span>Source<span class="uscript-operator">,</span>mask<span class="uscript-operator">,</span>left<span class="uscript-operator">,</span>right<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00929</span>          Source <span class="uscript-operator">=</span> Left<span class="uscript-operator">$</span>Right<span class="uscript-operator">;</span>
<span class="uscript-line">00930</span>          i <span class="uscript-operator">=</span> InStr<span class="uscript-operator">(</span>Source<span class="uscript-operator">,</span>Mask<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00931</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">00932</span>  
<span class="uscript-line">00933</span>      <span class="uscript-keyword">return</span> Source<span class="uscript-operator">;</span>
<span class="uscript-line">00934</span>  <span class="uscript-operator">}</span>
<span class="uscript-line">00935</span>  
<span class="uscript-line">00936</span>  <span class="uscript-comment">// Prevents entering a zip file location for any package</span>
<span class="uscript-line">00937</span>  <span class="uscript-comment">// that is already included with the game</span>
<span class="uscript-line">00938</span>  <span class="uscript-keyword">function</span> <span class="uscript-type">bool</span> EpicPackage<span class="uscript-operator">(</span><span class="uscript-type">string</span> Package<span class="uscript-operator">)</span>
<span class="uscript-line">00939</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">00940</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">int</span> i<span class="uscript-operator">;</span>
<span class="uscript-line">00941</span>  
<span class="uscript-line">00942</span>      <span class="uscript-comment">// Check if we're dealing with a map or a mutator</span>
<span class="uscript-line">00943</span>      i <span class="uscript-operator">=</span> InStr<span class="uscript-operator">(</span>Package<span class="uscript-operator">,</span> <span class="uscript-string">"."</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00944</span>  
<span class="uscript-line">00945</span>      <span class="uscript-comment">// Dealing with a mutator - remove class name</span>
<span class="uscript-line">00946</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>i <span class="uscript-operator">!=</span> <span class="uscript-operator">-</span><span class="uscript-number">1</span><span class="uscript-operator">)</span>
<span class="uscript-line">00947</span>          Package <span class="uscript-operator">=</span> Left<span class="uscript-operator">(</span>Package<span class="uscript-operator">,</span> i<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00948</span>  
<span class="uscript-line">00949</span>      <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i <span class="uscript-operator">=</span> <span class="uscript-number">0</span><span class="uscript-operator">;</span>i <span class="uscript-operator">&lt;</span> EPICNUMBER<span class="uscript-operator">;</span> i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">00950</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>Package <span class="uscript-operator">~=</span> EpicPackages<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">)</span>
<span class="uscript-line">00951</span>              <span class="uscript-keyword">return</span> <span class="uscript-keyword">true</span><span class="uscript-operator">;</span>
<span class="uscript-line">00952</span>      <span class="uscript-keyword">return</span> <span class="uscript-keyword">false</span><span class="uscript-operator">;</span>
<span class="uscript-line">00953</span>  <span class="uscript-operator">}</span>
<span class="uscript-line">00954</span>  
<span class="uscript-line">00955</span>  <span class="uscript-keyword">function</span> CheckSettingValue<span class="uscript-operator">(</span><span class="uscript-type">string</span> SettingData<span class="uscript-operator">,</span> <span class="uscript-keyword">out</span> <span class="uscript-type">string</span> NewValue<span class="uscript-operator">)</span>
<span class="uscript-line">00956</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">00957</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">string</span> sMaxLength<span class="uscript-operator">,</span> sMinMax<span class="uscript-operator">,</span> sMin<span class="uscript-operator">,</span> sMax<span class="uscript-operator">;</span>
<span class="uscript-line">00958</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">int</span> iMaxLength<span class="uscript-operator">,</span> iMin<span class="uscript-operator">,</span> iMax<span class="uscript-operator">,</span> iValue<span class="uscript-operator">;</span>
<span class="uscript-line">00959</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">float</span> fMin<span class="uscript-operator">,</span> fMax<span class="uscript-operator">,</span> fValue<span class="uscript-operator">;</span>
<span class="uscript-line">00960</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">bool</span> bFloat<span class="uscript-operator">;</span>
<span class="uscript-line">00961</span>  
<span class="uscript-line">00962</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>SettingData <span class="uscript-operator">==</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">00963</span>          <span class="uscript-keyword">return</span><span class="uscript-operator">;</span>
<span class="uscript-line">00964</span>  
<span class="uscript-line">00965</span>  <span class="uscript-comment">// This setting has no valid min/max (it is a password setting or something)</span>
<span class="uscript-line">00966</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>InStr<span class="uscript-operator">(</span>SettingData<span class="uscript-operator">,</span><span class="uscript-string">";"</span><span class="uscript-operator">)</span> <span class="uscript-operator">&lt;</span> <span class="uscript-number">0</span> <span class="uscript-operator">)</span>
<span class="uscript-line">00967</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">00968</span>          <span class="uscript-comment">// Allow only up to three times the configured max length</span>
<span class="uscript-line">00969</span>          iMaxLength <span class="uscript-operator">=</span> <span class="uscript-number">3</span> <span class="uscript-operator">*</span> <span class="uscript-type">int</span><span class="uscript-operator">(</span>SettingData<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00970</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>Len<span class="uscript-operator">(</span>NewValue<span class="uscript-operator">)</span> <span class="uscript-operator">&gt;</span> iMaxLength<span class="uscript-operator">)</span>
<span class="uscript-line">00971</span>              NewValue <span class="uscript-operator">=</span> Left<span class="uscript-operator">(</span>NewValue<span class="uscript-operator">,</span>iMaxLength<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00972</span>          <span class="uscript-keyword">return</span><span class="uscript-operator">;</span>
<span class="uscript-line">00973</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">00974</span>  
<span class="uscript-line">00975</span>      Divide<span class="uscript-operator">(</span>SettingData<span class="uscript-operator">,</span><span class="uscript-string">";"</span><span class="uscript-operator">,</span>sMaxLength<span class="uscript-operator">,</span>sMinMax<span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-comment">// Split the Max Length &amp; MinMax Info</span>
<span class="uscript-line">00976</span>      Divide<span class="uscript-operator">(</span>sMinMax<span class="uscript-operator">,</span><span class="uscript-string">":"</span><span class="uscript-operator">,</span>sMin<span class="uscript-operator">,</span>sMax<span class="uscript-operator">)</span><span class="uscript-operator">;</span>              <span class="uscript-comment">// Split the Min &amp; Max info for casting</span>
<span class="uscript-line">00977</span>      iMaxLength <span class="uscript-operator">=</span> <span class="uscript-type">int</span><span class="uscript-operator">(</span>sMaxLength<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00978</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span> InStr<span class="uscript-operator">(</span>sMin<span class="uscript-operator">,</span><span class="uscript-string">"."</span><span class="uscript-operator">)</span> <span class="uscript-operator">&gt;=</span> <span class="uscript-number">0</span> <span class="uscript-operator">||</span> InStr<span class="uscript-operator">(</span>sMax<span class="uscript-operator">,</span><span class="uscript-string">"."</span><span class="uscript-operator">)</span> <span class="uscript-operator">&gt;=</span> <span class="uscript-number">0</span><span class="uscript-operator">)</span>  <span class="uscript-comment">// Are we dealing with floating point numbers?</span>
<span class="uscript-line">00979</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">00980</span>          bFloat <span class="uscript-operator">=</span> <span class="uscript-keyword">True</span><span class="uscript-operator">;</span>
<span class="uscript-line">00981</span>          fMin <span class="uscript-operator">=</span> <span class="uscript-type">float</span><span class="uscript-operator">(</span>sMin<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00982</span>          fMax <span class="uscript-operator">=</span> <span class="uscript-type">float</span><span class="uscript-operator">(</span>sMax<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00983</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">00984</span>  
<span class="uscript-line">00985</span>      <span class="uscript-keyword">else</span>
<span class="uscript-line">00986</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">00987</span>          iMin <span class="uscript-operator">=</span> <span class="uscript-type">int</span><span class="uscript-operator">(</span>sMin<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00988</span>          iMax <span class="uscript-operator">=</span> <span class="uscript-type">int</span><span class="uscript-operator">(</span>sMax<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00989</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">00990</span>  
<span class="uscript-line">00991</span>      <span class="uscript-comment">// First check for length</span>
<span class="uscript-line">00992</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>Len<span class="uscript-operator">(</span>NewValue<span class="uscript-operator">)</span> <span class="uscript-operator">&gt;</span> iMaxLength<span class="uscript-operator">)</span>
<span class="uscript-line">00993</span>          NewValue <span class="uscript-operator">=</span> Left<span class="uscript-operator">(</span>NewValue<span class="uscript-operator">,</span>iMaxLength<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00994</span>  
<span class="uscript-line">00995</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>bFloat<span class="uscript-operator">)</span>
<span class="uscript-line">00996</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">00997</span>          fValue <span class="uscript-operator">=</span> <span class="uscript-type">float</span><span class="uscript-operator">(</span>NewValue<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00998</span>          fValue <span class="uscript-operator">=</span> FClamp<span class="uscript-operator">(</span>fValue<span class="uscript-operator">,</span>fMin<span class="uscript-operator">,</span>fMax<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">00999</span>          NewValue <span class="uscript-operator">=</span> <span class="uscript-type">string</span><span class="uscript-operator">(</span>fValue<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01000</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">01001</span>      <span class="uscript-keyword">else</span>
<span class="uscript-line">01002</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">01003</span>          iValue <span class="uscript-operator">=</span> <span class="uscript-type">int</span><span class="uscript-operator">(</span>NewValue<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01004</span>          iValue <span class="uscript-operator">=</span> Clamp<span class="uscript-operator">(</span>iValue<span class="uscript-operator">,</span>iMin<span class="uscript-operator">,</span>iMax<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01005</span>          NewValue <span class="uscript-operator">=</span> <span class="uscript-type">string</span><span class="uscript-operator">(</span>iValue<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01006</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">01007</span>  <span class="uscript-operator">}</span>
<span class="uscript-line">01008</span>  <span class="uscript-comment">//*****************************************************************************</span>
<span class="uscript-line">01009</span>  <span class="uscript-comment">//*****************************************************************************</span>
<span class="uscript-line">01010</span>  <span class="uscript-comment">// Query Methods</span>
<span class="uscript-line">01011</span>  <span class="uscript-comment">//</span>
<span class="uscript-line">01012</span>  <span class="uscript-comment">//</span>
<span class="uscript-line">01013</span>  
<span class="uscript-line">01014</span>  <span class="uscript-comment">// Passes the SessionID variable to all pages in this query action</span>
<span class="uscript-line">01015</span>  <span class="uscript-comment">// if SessionID is not present in WebRequest, generates one</span>
<span class="uscript-line">01016</span>  <span class="uscript-comment">// (Helpful when dealing with frames)</span>
<span class="uscript-line">01017</span>  <span class="uscript-keyword">function</span> <span class="uscript-type">bool</span> PreQuery<span class="uscript-operator">(</span>WebRequest Req<span class="uscript-operator">,</span> WebResponse Res<span class="uscript-operator">)</span>
<span class="uscript-line">01018</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">01019</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">string</span> SID<span class="uscript-operator">;</span>
<span class="uscript-line">01020</span>  
<span class="uscript-line">01021</span>      SID <span class="uscript-operator">=</span> Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span><span class="uscript-string">"SessionID"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01022</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>SID <span class="uscript-operator">==</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">01023</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">01024</span>          SID <span class="uscript-operator">=</span> SMaster<span class="uscript-operator">.</span>getSession<span class="uscript-operator">(</span><span class="uscript-string">"xxxxx"</span><span class="uscript-operator">,</span><span class="uscript-keyword">true</span><span class="uscript-operator">)</span><span class="uscript-operator">.</span>GetHash<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01025</span>          Req<span class="uscript-operator">.</span>AddVariable<span class="uscript-operator">(</span><span class="uscript-string">"SessionID"</span><span class="uscript-operator">,</span> SID<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01026</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">01027</span>      Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SessionID"</span><span class="uscript-operator">,</span> SID<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01028</span>      <span class="uscript-keyword">return</span> <span class="uscript-keyword">true</span><span class="uscript-operator">;</span>
<span class="uscript-line">01029</span>  <span class="uscript-operator">}</span>
<span class="uscript-line">01030</span>  
<span class="uscript-line">01031</span>  <span class="uscript-keyword">function</span> <span class="uscript-type">bool</span> Query<span class="uscript-operator">(</span>WebRequest Request<span class="uscript-operator">,</span> WebResponse Response<span class="uscript-operator">)</span>
<span class="uscript-line">01032</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">01033</span>      <span class="uscript-keyword">switch</span> <span class="uscript-operator">(</span>Mid<span class="uscript-operator">(</span>Request<span class="uscript-operator">.</span>URI<span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">01034</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">01035</span>      <span class="uscript-keyword">case</span> DefaultPage:       <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">!</span>MapIsChanging<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> QueryLadderFrame<span class="uscript-operator">(</span>Request<span class="uscript-operator">,</span> Response<span class="uscript-operator">)</span><span class="uscript-operator">;</span>      <span class="uscript-keyword">return</span> <span class="uscript-keyword">true</span><span class="uscript-operator">;</span>
<span class="uscript-line">01036</span>      <span class="uscript-keyword">case</span> ProfileMenuURI:    <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">!</span>MapIsChanging<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> QueryLadderMenu<span class="uscript-operator">(</span>Request<span class="uscript-operator">,</span> Response<span class="uscript-operator">)</span><span class="uscript-operator">;</span>       <span class="uscript-keyword">return</span> <span class="uscript-keyword">true</span><span class="uscript-operator">;</span>
<span class="uscript-line">01037</span>      <span class="uscript-keyword">case</span> ProfileViewURI:    <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">!</span>MapIsChanging<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> QueryLadderView<span class="uscript-operator">(</span>Request<span class="uscript-operator">,</span> Response<span class="uscript-operator">)</span><span class="uscript-operator">;</span>       <span class="uscript-keyword">return</span> <span class="uscript-keyword">true</span><span class="uscript-operator">;</span>
<span class="uscript-line">01038</span>      <span class="uscript-keyword">case</span> ProfileEditURI:    <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">!</span>MapIsChanging<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> QueryLadderEdit<span class="uscript-operator">(</span>Request<span class="uscript-operator">,</span> Response<span class="uscript-operator">)</span><span class="uscript-operator">;</span>       <span class="uscript-keyword">return</span> <span class="uscript-keyword">true</span><span class="uscript-operator">;</span>
<span class="uscript-line">01039</span>      <span class="uscript-keyword">case</span> ProfileSwitchURI:  <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">!</span>MapIsChanging<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> QueryLadderSwitch<span class="uscript-operator">(</span>Request<span class="uscript-operator">,</span> Response<span class="uscript-operator">)</span><span class="uscript-operator">;</span>     <span class="uscript-keyword">return</span> <span class="uscript-keyword">true</span><span class="uscript-operator">;</span>
<span class="uscript-line">01040</span>      <span class="uscript-keyword">case</span> ProfileManageURI:  <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">!</span>MapIsChanging<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> QueryLadderManage<span class="uscript-operator">(</span>Request<span class="uscript-operator">,</span> Response<span class="uscript-operator">)</span><span class="uscript-operator">;</span>     <span class="uscript-keyword">return</span> <span class="uscript-keyword">true</span><span class="uscript-operator">;</span>
<span class="uscript-line">01041</span>  
<span class="uscript-line">01042</span>  <span class="uscript-comment">// Management subframes</span>
<span class="uscript-line">01043</span>      <span class="uscript-keyword">case</span> SubFrameURI:       <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">!</span>MapIsChanging<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> QuerySubFrame<span class="uscript-operator">(</span>Request<span class="uscript-operator">,</span> Response<span class="uscript-operator">)</span><span class="uscript-operator">;</span>         <span class="uscript-keyword">return</span> <span class="uscript-keyword">true</span><span class="uscript-operator">;</span>
<span class="uscript-line">01044</span>      <span class="uscript-keyword">case</span> SubFrameMenuURI:   <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">!</span>MapIsChanging<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> QuerySubMenu<span class="uscript-operator">(</span>Request<span class="uscript-operator">,</span> Response<span class="uscript-operator">)</span><span class="uscript-operator">;</span>          <span class="uscript-keyword">return</span> <span class="uscript-keyword">true</span><span class="uscript-operator">;</span>
<span class="uscript-line">01045</span>      <span class="uscript-keyword">case</span> SubGametypeURI:    <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">!</span>MapIsChanging<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> QuerySubGameType<span class="uscript-operator">(</span>Request<span class="uscript-operator">,</span> Response<span class="uscript-operator">)</span><span class="uscript-operator">;</span>      <span class="uscript-keyword">return</span> <span class="uscript-keyword">true</span><span class="uscript-operator">;</span>
<span class="uscript-line">01046</span>      <span class="uscript-keyword">case</span> SubMapsURI:        <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">!</span>MapIsChanging<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> QuerySubMaps<span class="uscript-operator">(</span>Request<span class="uscript-operator">,</span> Response<span class="uscript-operator">)</span><span class="uscript-operator">;</span>          <span class="uscript-keyword">return</span> <span class="uscript-keyword">true</span><span class="uscript-operator">;</span>
<span class="uscript-line">01047</span>      <span class="uscript-keyword">case</span> SubMutatorsURI:    <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">!</span>MapIsChanging<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> QuerySubMutators<span class="uscript-operator">(</span>Request<span class="uscript-operator">,</span> Response<span class="uscript-operator">)</span><span class="uscript-operator">;</span>      <span class="uscript-keyword">return</span> <span class="uscript-keyword">true</span><span class="uscript-operator">;</span>
<span class="uscript-line">01048</span>      <span class="uscript-keyword">case</span> SubRulesURI:       <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">!</span>MapIsChanging<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> QuerySubRules<span class="uscript-operator">(</span>Request<span class="uscript-operator">,</span> Response<span class="uscript-operator">)</span><span class="uscript-operator">;</span>         <span class="uscript-keyword">return</span> <span class="uscript-keyword">true</span><span class="uscript-operator">;</span>
<span class="uscript-line">01049</span>      <span class="uscript-keyword">case</span> SubReviewURI:      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">!</span>MapIsChanging<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> QuerySubReview<span class="uscript-operator">(</span>Request<span class="uscript-operator">,</span> Response<span class="uscript-operator">)</span><span class="uscript-operator">;</span>        <span class="uscript-keyword">return</span> <span class="uscript-keyword">true</span><span class="uscript-operator">;</span>
<span class="uscript-line">01050</span>      <span class="uscript-keyword">case</span> SubSavedURI:       <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">!</span>MapIsChanging<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> QuerySubSaved<span class="uscript-operator">(</span>Request<span class="uscript-operator">,</span> Response<span class="uscript-operator">)</span><span class="uscript-operator">;</span>         <span class="uscript-keyword">return</span> <span class="uscript-keyword">true</span><span class="uscript-operator">;</span>
<span class="uscript-line">01051</span>      <span class="uscript-keyword">case</span> SubImportURI:      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">!</span>MapIsChanging<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> QuerySubImport<span class="uscript-operator">(</span>Request<span class="uscript-operator">,</span> Response<span class="uscript-operator">)</span><span class="uscript-operator">;</span>        <span class="uscript-keyword">return</span> <span class="uscript-keyword">true</span><span class="uscript-operator">;</span>
<span class="uscript-line">01052</span>      <span class="uscript-keyword">case</span> SubExportURI:      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">!</span>MapIsChanging<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> QuerySubExport<span class="uscript-operator">(</span>Request<span class="uscript-operator">,</span> Response<span class="uscript-operator">)</span><span class="uscript-operator">;</span>        <span class="uscript-keyword">return</span> <span class="uscript-keyword">true</span><span class="uscript-operator">;</span>
<span class="uscript-line">01053</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">01054</span>  <span class="uscript-comment">// This query is looking for a page from another query handler</span>
<span class="uscript-line">01055</span>  <span class="uscript-comment">// or the map is changing</span>
<span class="uscript-line">01056</span>      <span class="uscript-keyword">return</span> <span class="uscript-keyword">false</span><span class="uscript-operator">;</span>
<span class="uscript-line">01057</span>  <span class="uscript-operator">}</span>
<span class="uscript-line">01058</span>  
<span class="uscript-line">01059</span>  <span class="uscript-keyword">function</span> QueryLadderFrame<span class="uscript-operator">(</span>WebRequest Req<span class="uscript-operator">,</span> WebResponse Res<span class="uscript-operator">)</span>
<span class="uscript-line">01060</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">01061</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">String</span> Page<span class="uscript-operator">;</span>
<span class="uscript-line">01062</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">string</span> SID<span class="uscript-operator">;</span>
<span class="uscript-line">01063</span>  
<span class="uscript-line">01064</span>  <span class="uscript-comment">// if no page specified, use the default</span>
<span class="uscript-line">01065</span>      Page <span class="uscript-operator">=</span> Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span><span class="uscript-string">"Page"</span><span class="uscript-operator">,</span> ProfileViewURI<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01066</span>      SID <span class="uscript-operator">=</span> Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span><span class="uscript-string">"SessionID"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01067</span>  
<span class="uscript-line">01068</span>  <span class="uscript-comment">// Tell the menu page which page we're viewing (with the ?Page=),</span>
<span class="uscript-line">01069</span>  <span class="uscript-comment">// so that it can highlight the appropriate link</span>
<span class="uscript-line">01070</span>      Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"IndexURI"</span><span class="uscript-operator">,</span>ProfileMenuURI<span class="uscript-operator">$</span><span class="uscript-string">"?Page="</span><span class="uscript-operator">$</span>Page<span class="uscript-operator">$</span><span class="uscript-string">"?SessionID="</span><span class="uscript-operator">$</span>SID<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01071</span>  
<span class="uscript-line">01072</span>  <span class="uscript-comment">// Load the main page into the frameset</span>
<span class="uscript-line">01073</span>      Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"MainURI"</span><span class="uscript-operator">,</span> Page<span class="uscript-operator">$</span><span class="uscript-string">"?SessionID="</span><span class="uscript-operator">$</span>SID<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01074</span>  
<span class="uscript-line">01075</span>      ShowFrame<span class="uscript-operator">(</span>Res<span class="uscript-operator">,</span> DefaultPage<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01076</span>  <span class="uscript-operator">}</span>
<span class="uscript-line">01077</span>  
<span class="uscript-line">01078</span>  <span class="uscript-keyword">function</span> QuerySubFrame<span class="uscript-operator">(</span>WebRequest Req<span class="uscript-operator">,</span> WebResponse Res<span class="uscript-operator">)</span>
<span class="uscript-line">01079</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">01080</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">string</span> Page<span class="uscript-operator">,</span> SID<span class="uscript-operator">,</span> TempStr<span class="uscript-operator">,</span> Action<span class="uscript-operator">;</span>
<span class="uscript-line">01081</span>      <span class="uscript-keyword">local</span> Session CurS<span class="uscript-operator">;</span>
<span class="uscript-line">01082</span>  
<span class="uscript-line">01083</span>      SID <span class="uscript-operator">=</span> Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span><span class="uscript-string">"SessionID"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01084</span>      CurS <span class="uscript-operator">=</span> SMaster<span class="uscript-operator">.</span>getSession<span class="uscript-operator">(</span>SID<span class="uscript-operator">,</span> <span class="uscript-keyword">true</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01085</span>  
<span class="uscript-line">01086</span>      Action <span class="uscript-operator">=</span> Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span><span class="uscript-string">"Actions"</span><span class="uscript-operator">,</span><span class="uscript-string">"Add"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01087</span>  
<span class="uscript-line">01088</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>Action <span class="uscript-operator">~=</span> <span class="uscript-string">"Modify"</span><span class="uscript-operator">)</span>
<span class="uscript-line">01089</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">01090</span>          TempStr <span class="uscript-operator">=</span> Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span><span class="uscript-string">"ProfileNameSelect"</span><span class="uscript-operator">,</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01091</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>TempStr <span class="uscript-operator">!=</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span> CreateSessionInfo<span class="uscript-operator">(</span>TempStr<span class="uscript-operator">,</span>SID<span class="uscript-operator">,</span><span class="uscript-keyword">True</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01092</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">01093</span>  
<span class="uscript-line">01094</span>      <span class="uscript-keyword">else</span> <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>Action <span class="uscript-operator">~=</span> <span class="uscript-string">"Add"</span><span class="uscript-operator">)</span>
<span class="uscript-line">01095</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">01096</span>          TempStr <span class="uscript-operator">=</span> Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span><span class="uscript-string">"TextInput"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01097</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>TempStr <span class="uscript-operator">!=</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span> CurS<span class="uscript-operator">.</span>setValue<span class="uscript-operator">(</span><span class="uscript-string">"ProfileName"</span><span class="uscript-operator">,</span>TempStr<span class="uscript-operator">,</span><span class="uscript-keyword">True</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01098</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">01099</span>  
<span class="uscript-line">01100</span>  <span class="uscript-comment">// if no page specified, use the default</span>
<span class="uscript-line">01101</span>      Page <span class="uscript-operator">=</span> Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span><span class="uscript-string">"Page"</span><span class="uscript-operator">,</span> SubGameTypeURI<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01102</span>      CurS<span class="uscript-operator">.</span>setValue<span class="uscript-operator">(</span><span class="uscript-string">"CurrentPage"</span><span class="uscript-operator">,</span> Page<span class="uscript-operator">,</span> <span class="uscript-keyword">True</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01103</span>  
<span class="uscript-line">01104</span>  <span class="uscript-comment">// Tell the SubMenu page which page we're viewing, so that it can highlight</span>
<span class="uscript-line">01105</span>  <span class="uscript-comment">// the appropriate link</span>
<span class="uscript-line">01106</span>      Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SubMenuURI"</span><span class="uscript-operator">,</span> SubFrameMenuURI<span class="uscript-operator">$</span><span class="uscript-string">"?SessionID="</span><span class="uscript-operator">$</span>SID<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01107</span>  
<span class="uscript-line">01108</span>  <span class="uscript-comment">// Load the main page into the frameset</span>
<span class="uscript-line">01109</span>      Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SubMainURI"</span><span class="uscript-operator">,</span> Page<span class="uscript-operator">$</span><span class="uscript-string">"?SessionID="</span><span class="uscript-operator">$</span>SID<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01110</span>      ShowFrame<span class="uscript-operator">(</span>Res<span class="uscript-operator">,</span> SubFrame<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01111</span>  <span class="uscript-operator">}</span>
<span class="uscript-line">01112</span>  
<span class="uscript-line">01113</span>  <span class="uscript-keyword">function</span> QueryLadderMenu<span class="uscript-operator">(</span>WebRequest Req<span class="uscript-operator">,</span> WebResponse Res<span class="uscript-operator">)</span>
<span class="uscript-line">01114</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">01115</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">string</span> SID<span class="uscript-operator">;</span>
<span class="uscript-line">01116</span>  
<span class="uscript-line">01117</span>      SID <span class="uscript-operator">=</span> Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span><span class="uscript-string">"SessionID"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01118</span>  <span class="uscript-comment">/*
<span class="uscript-line">01119</span>  If ?SessionID= is appended to the link, PreQuery() will not generate
<span class="uscript-line">01120</span>  a new Session when this link is queried
<span class="uscript-line">01121</span>  */</span>
<span class="uscript-line">01122</span>      <span class="uscript-comment">// Set URIs</span>
<span class="uscript-line">01123</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>CanPerform<span class="uscript-operator">(</span><span class="uscript-string">"Lv"</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">01124</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"ViewProfiles"</span><span class="uscript-operator">,</span> <span class="uscript-string">"&lt;a href=\""</span><span class="uscript-operator">$</span>ProfileViewURI<span class="uscript-operator">$</span><span class="uscript-string">"\" target=\"main\"&gt;"</span><span class="uscript-operator">$</span>LinkViewProfile<span class="uscript-operator">$</span><span class="uscript-string">"&lt;/a&gt;&lt;br&gt;"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01125</span>  
<span class="uscript-line">01126</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>CanPerform<span class="uscript-operator">(</span><span class="uscript-string">"Le"</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">01127</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"EditProfiles"</span><span class="uscript-operator">,</span> <span class="uscript-string">"&lt;a href=\""</span><span class="uscript-operator">$</span>ProfileEditURI<span class="uscript-operator">$</span><span class="uscript-string">"\" target=\"main\"&gt;"</span><span class="uscript-operator">$</span>LinkEditProfile<span class="uscript-operator">$</span><span class="uscript-string">"&lt;/a&gt;&lt;br&gt;"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01128</span>  
<span class="uscript-line">01129</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>CanPerform<span class="uscript-operator">(</span><span class="uscript-string">"Ls"</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">01130</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SwitchProfiles"</span><span class="uscript-operator">,</span> <span class="uscript-string">"&lt;a href=\""</span><span class="uscript-operator">$</span>ProfileSwitchURI<span class="uscript-operator">$</span><span class="uscript-string">"\" target=\"main\"&gt;"</span><span class="uscript-operator">$</span>LinkSwitchProfile<span class="uscript-operator">$</span><span class="uscript-string">"&lt;/a&gt;&lt;br&gt;"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01131</span>  
<span class="uscript-line">01132</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>CanPerform<span class="uscript-operator">(</span><span class="uscript-string">"Lm"</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">01133</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"ManageProfiles"</span><span class="uscript-operator">,</span> <span class="uscript-string">"&lt;a href=\""</span><span class="uscript-operator">$</span>ProfileManageURI<span class="uscript-operator">$</span><span class="uscript-string">"\" target=\"main\"&gt;"</span><span class="uscript-operator">$</span>LinkManageProfile<span class="uscript-operator">$</span><span class="uscript-string">"&lt;/a&gt;&lt;br&gt;"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01134</span>  
<span class="uscript-line">01135</span>      ShowPage<span class="uscript-operator">(</span>Res<span class="uscript-operator">,</span> ProfileMenuURI<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01136</span>  <span class="uscript-operator">}</span>
<span class="uscript-line">01137</span>  
<span class="uscript-line">01138</span>  <span class="uscript-keyword">function</span> QuerySubMenu<span class="uscript-operator">(</span>WebRequest Req<span class="uscript-operator">,</span> WebResponse Res<span class="uscript-operator">)</span>
<span class="uscript-line">01139</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">01140</span>  <span class="uscript-comment">// Highlight the current page</span>
<span class="uscript-line">01141</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">string</span> Highlighted<span class="uscript-operator">,</span> Background<span class="uscript-operator">,</span> SID<span class="uscript-operator">;</span>
<span class="uscript-line">01142</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">string</span> GameLink<span class="uscript-operator">,</span> MutatorLink<span class="uscript-operator">,</span> MapLink<span class="uscript-operator">,</span> RuleLink<span class="uscript-operator">,</span> ReviewLink<span class="uscript-operator">;</span>
<span class="uscript-line">01143</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">string</span> GameSpan<span class="uscript-operator">,</span> MutatorSpan<span class="uscript-operator">,</span> MapSpan<span class="uscript-operator">,</span> RuleSpan<span class="uscript-operator">,</span> ReviewSpan<span class="uscript-operator">;</span>
<span class="uscript-line">01144</span>  
<span class="uscript-line">01145</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">string</span> Page<span class="uscript-operator">;</span>
<span class="uscript-line">01146</span>      <span class="uscript-keyword">local</span> Session CurS<span class="uscript-operator">;</span>
<span class="uscript-line">01147</span>  
<span class="uscript-line">01148</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>CanPerform<span class="uscript-operator">(</span><span class="uscript-string">"Lm"</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">01149</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">01150</span>          Highlighted <span class="uscript-operator">=</span> <span class="uscript-string">"&lt;span class=\"blue\"&gt;"</span><span class="uscript-operator">;</span>
<span class="uscript-line">01151</span>          Background <span class="uscript-operator">=</span> <span class="uscript-string">"&lt;span class=\"red\"&gt;"</span><span class="uscript-operator">;</span>
<span class="uscript-line">01152</span>          SID <span class="uscript-operator">=</span> Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span><span class="uscript-string">"SessionID"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01153</span>          CurS <span class="uscript-operator">=</span> SMaster<span class="uscript-operator">.</span>getSession<span class="uscript-operator">(</span>SID<span class="uscript-operator">,</span> <span class="uscript-keyword">true</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01154</span>  
<span class="uscript-line">01155</span>          <span class="uscript-comment">// We are managing an existing profile</span>
<span class="uscript-line">01156</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>CurS<span class="uscript-operator">.</span>HasData<span class="uscript-operator">(</span><span class="uscript-string">"ProfileIndex"</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">01157</span>              Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"Section"</span><span class="uscript-operator">,</span> LabelModifyProfile<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01158</span>  
<span class="uscript-line">01159</span>          <span class="uscript-keyword">else</span> Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"Section"</span><span class="uscript-operator">,</span> LabelAddProfile<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01160</span>  
<span class="uscript-line">01161</span>          Page <span class="uscript-operator">=</span> CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"CurrentPage"</span><span class="uscript-operator">,</span>SubGametypeURI<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01162</span>  
<span class="uscript-line">01163</span>      <span class="uscript-comment">// Including ?SessionID= in link prevents PreQuery() from generating a new Session</span>
<span class="uscript-line">01164</span>          GameLink <span class="uscript-operator">=</span>      <span class="uscript-string">"&lt;a href=\""</span><span class="uscript-operator">$</span>SubFrameURI<span class="uscript-operator">$</span><span class="uscript-string">"?SessionID="</span><span class="uscript-operator">$</span>SID<span class="uscript-operator">$</span><span class="uscript-string">"?Page="</span><span class="uscript-operator">$</span>SubGametypeURI<span class="uscript-operator">$</span> <span class="uscript-string">"\" target=\"_parent\"&gt;"</span><span class="uscript-operator">;</span>
<span class="uscript-line">01165</span>          MutatorLink <span class="uscript-operator">=</span>   <span class="uscript-string">"&lt;a href=\""</span><span class="uscript-operator">$</span>SubFrameURI<span class="uscript-operator">$</span><span class="uscript-string">"?SessionID="</span><span class="uscript-operator">$</span>SID<span class="uscript-operator">$</span><span class="uscript-string">"?Page="</span><span class="uscript-operator">$</span>SubMutatorsURI<span class="uscript-operator">$</span> <span class="uscript-string">"\" target=\"_parent\"&gt;"</span><span class="uscript-operator">;</span>
<span class="uscript-line">01166</span>          MapLink <span class="uscript-operator">=</span>       <span class="uscript-string">"&lt;a href=\""</span><span class="uscript-operator">$</span>SubFrameURI<span class="uscript-operator">$</span><span class="uscript-string">"?SessionID="</span><span class="uscript-operator">$</span>SID<span class="uscript-operator">$</span><span class="uscript-string">"?Page="</span><span class="uscript-operator">$</span>SubMapsURI<span class="uscript-operator">$</span>     <span class="uscript-string">"\" target=\"_parent\"&gt;"</span><span class="uscript-operator">;</span>
<span class="uscript-line">01167</span>          RuleLink <span class="uscript-operator">=</span>      <span class="uscript-string">"&lt;a href=\""</span><span class="uscript-operator">$</span>SubFrameURI<span class="uscript-operator">$</span><span class="uscript-string">"?SessionID="</span><span class="uscript-operator">$</span>SID<span class="uscript-operator">$</span><span class="uscript-string">"?Page="</span><span class="uscript-operator">$</span>SubRulesURI<span class="uscript-operator">$</span>    <span class="uscript-string">"\" target=\"_parent\"&gt;"</span><span class="uscript-operator">;</span>
<span class="uscript-line">01168</span>          ReviewLink <span class="uscript-operator">=</span>    <span class="uscript-string">"&lt;a href=\""</span><span class="uscript-operator">$</span>SubFrameURI<span class="uscript-operator">$</span><span class="uscript-string">"?SessionID="</span><span class="uscript-operator">$</span>SID<span class="uscript-operator">$</span><span class="uscript-string">"?Page="</span><span class="uscript-operator">$</span>SubReviewURI<span class="uscript-operator">$</span>   <span class="uscript-string">"\" target=\"_parent\"&gt;"</span><span class="uscript-operator">;</span>
<span class="uscript-line">01169</span>  
<span class="uscript-line">01170</span>      <span class="uscript-comment">// Initially set all spans to the background color</span>
<span class="uscript-line">01171</span>          GameSpan    <span class="uscript-operator">=</span> Background<span class="uscript-operator">;</span>
<span class="uscript-line">01172</span>          MutatorSpan <span class="uscript-operator">=</span> Background<span class="uscript-operator">;</span>
<span class="uscript-line">01173</span>          MapSpan     <span class="uscript-operator">=</span> Background<span class="uscript-operator">;</span>
<span class="uscript-line">01174</span>          RuleSpan    <span class="uscript-operator">=</span> Background<span class="uscript-operator">;</span>
<span class="uscript-line">01175</span>          ReviewSpan  <span class="uscript-operator">=</span> Background<span class="uscript-operator">;</span>
<span class="uscript-line">01176</span>  
<span class="uscript-line">01177</span>          <span class="uscript-comment">// Then set the appropriate span to the highlighted color</span>
<span class="uscript-line">01178</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SubTitle"</span><span class="uscript-operator">,</span> CurS<span class="uscript-operator">.</span>GetValue<span class="uscript-operator">(</span><span class="uscript-string">"ProfileName"</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01179</span>          <span class="uscript-keyword">switch</span> <span class="uscript-operator">(</span>Page<span class="uscript-operator">)</span>
<span class="uscript-line">01180</span>          <span class="uscript-operator">{</span>
<span class="uscript-line">01181</span>              <span class="uscript-keyword">case</span> SubGametypeURI:
<span class="uscript-line">01182</span>                  Curs<span class="uscript-operator">.</span>SetValue<span class="uscript-operator">(</span><span class="uscript-string">"ButtonName"</span><span class="uscript-operator">,</span>     ProfileButtonName<span class="uscript-operator">[</span><span class="uscript-number">1</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span><span class="uscript-keyword">true</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01183</span>                  Curs<span class="uscript-operator">.</span>SetValue<span class="uscript-operator">(</span><span class="uscript-string">"ButtonValue"</span><span class="uscript-operator">,</span>    ProfileButtonValue<span class="uscript-operator">[</span><span class="uscript-number">1</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span><span class="uscript-keyword">true</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01184</span>  
<span class="uscript-line">01185</span>                  Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"PageHelp"</span><span class="uscript-operator">,</span> HelpGameType<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01186</span>                  GameSpan <span class="uscript-operator">=</span> Highlighted<span class="uscript-operator">;</span> <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>
<span class="uscript-line">01187</span>  
<span class="uscript-line">01188</span>              <span class="uscript-keyword">case</span> SubMutatorsURI:
<span class="uscript-line">01189</span>                  Curs<span class="uscript-operator">.</span>SetValue<span class="uscript-operator">(</span><span class="uscript-string">"ButtonName"</span><span class="uscript-operator">,</span>     ProfileButtonName<span class="uscript-operator">[</span><span class="uscript-number">2</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span><span class="uscript-keyword">true</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01190</span>                  Curs<span class="uscript-operator">.</span>SetValue<span class="uscript-operator">(</span><span class="uscript-string">"ButtonValue"</span><span class="uscript-operator">,</span>    ProfileButtonValue<span class="uscript-operator">[</span><span class="uscript-number">2</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span><span class="uscript-keyword">true</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01191</span>  
<span class="uscript-line">01192</span>                  Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"PageHelp"</span><span class="uscript-operator">,</span> HelpMutators<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01193</span>                  MutatorSpan <span class="uscript-operator">=</span> Highlighted<span class="uscript-operator">;</span> <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>
<span class="uscript-line">01194</span>  
<span class="uscript-line">01195</span>              <span class="uscript-keyword">case</span> SubMapsURI:
<span class="uscript-line">01196</span>                  Curs<span class="uscript-operator">.</span>SetValue<span class="uscript-operator">(</span><span class="uscript-string">"ButtonName"</span><span class="uscript-operator">,</span>     ProfileButtonName<span class="uscript-operator">[</span><span class="uscript-number">3</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span><span class="uscript-keyword">true</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01197</span>                  Curs<span class="uscript-operator">.</span>SetValue<span class="uscript-operator">(</span><span class="uscript-string">"ButtonValue"</span><span class="uscript-operator">,</span>    ProfileButtonValue<span class="uscript-operator">[</span><span class="uscript-number">3</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span><span class="uscript-keyword">true</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01198</span>  
<span class="uscript-line">01199</span>                  Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"PageHelp"</span><span class="uscript-operator">,</span> HelpMaps<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01200</span>                  Mapspan <span class="uscript-operator">=</span> Highlighted<span class="uscript-operator">;</span> <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>
<span class="uscript-line">01201</span>  
<span class="uscript-line">01202</span>              <span class="uscript-keyword">case</span> SubRulesURI:
<span class="uscript-line">01203</span>                  Curs<span class="uscript-operator">.</span>SetValue<span class="uscript-operator">(</span><span class="uscript-string">"ButtonName"</span><span class="uscript-operator">,</span>     ProfileButtonName<span class="uscript-operator">[</span><span class="uscript-number">4</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span><span class="uscript-keyword">true</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01204</span>                  Curs<span class="uscript-operator">.</span>SetValue<span class="uscript-operator">(</span><span class="uscript-string">"ButtonValue"</span><span class="uscript-operator">,</span>    ProfileButtonValue<span class="uscript-operator">[</span><span class="uscript-number">4</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span><span class="uscript-keyword">true</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01205</span>  
<span class="uscript-line">01206</span>                  Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"PageHelp"</span><span class="uscript-operator">,</span> HelpPlayInfo<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01207</span>                  RuleSpan <span class="uscript-operator">=</span> Highlighted<span class="uscript-operator">;</span> <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>
<span class="uscript-line">01208</span>  
<span class="uscript-line">01209</span>              <span class="uscript-keyword">case</span> SubReviewURI:
<span class="uscript-line">01210</span>                  Curs<span class="uscript-operator">.</span>SetValue<span class="uscript-operator">(</span><span class="uscript-string">"ButtonName"</span><span class="uscript-operator">,</span>     ProfileButtonName<span class="uscript-operator">[</span><span class="uscript-number">5</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span><span class="uscript-keyword">true</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01211</span>                  Curs<span class="uscript-operator">.</span>SetValue<span class="uscript-operator">(</span><span class="uscript-string">"ButtonValue"</span><span class="uscript-operator">,</span>    ProfileButtonValue<span class="uscript-operator">[</span><span class="uscript-number">5</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span><span class="uscript-keyword">true</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01212</span>  
<span class="uscript-line">01213</span>                  Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"PageHelp"</span><span class="uscript-operator">,</span> HelpReview<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01214</span>                  ReviewSpan <span class="uscript-operator">=</span> Highlighted<span class="uscript-operator">;</span> <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>
<span class="uscript-line">01215</span>          <span class="uscript-operator">}</span>
<span class="uscript-line">01216</span>  
<span class="uscript-line">01217</span>          GameLink    <span class="uscript-operator">=</span> GameLink      <span class="uscript-operator">$</span> GameSpan      <span class="uscript-operator">$</span> TableTitle<span class="uscript-operator">[</span><span class="uscript-number">1</span><span class="uscript-operator">]</span><span class="uscript-operator">$</span><span class="uscript-string">"&lt;/span&gt;&lt;/a&gt;"</span><span class="uscript-operator">;</span>
<span class="uscript-line">01218</span>          MutatorLink <span class="uscript-operator">=</span> MutatorLink   <span class="uscript-operator">$</span> MutatorSpan   <span class="uscript-operator">$</span> TableTitle<span class="uscript-operator">[</span><span class="uscript-number">2</span><span class="uscript-operator">]</span><span class="uscript-operator">$</span><span class="uscript-string">"&lt;/span&gt;&lt;/a&gt;"</span><span class="uscript-operator">;</span>
<span class="uscript-line">01219</span>          MapLink     <span class="uscript-operator">=</span> MapLink       <span class="uscript-operator">$</span> MapSpan       <span class="uscript-operator">$</span> TableTitle<span class="uscript-operator">[</span><span class="uscript-number">3</span><span class="uscript-operator">]</span><span class="uscript-operator">$</span><span class="uscript-string">"&lt;/span&gt;&lt;/a&gt;"</span><span class="uscript-operator">;</span>
<span class="uscript-line">01220</span>          RuleLink    <span class="uscript-operator">=</span> RuleLink      <span class="uscript-operator">$</span> RuleSpan      <span class="uscript-operator">$</span> TableTitle<span class="uscript-operator">[</span><span class="uscript-number">4</span><span class="uscript-operator">]</span><span class="uscript-operator">$</span><span class="uscript-string">"&lt;/span&gt;&lt;/a&gt;"</span><span class="uscript-operator">;</span>
<span class="uscript-line">01221</span>          ReviewLink  <span class="uscript-operator">=</span> ReviewLink    <span class="uscript-operator">$</span> ReviewSpan    <span class="uscript-operator">$</span> TableTitle<span class="uscript-operator">[</span><span class="uscript-number">5</span><span class="uscript-operator">]</span><span class="uscript-operator">$</span><span class="uscript-string">"&lt;/span&gt;&lt;/a&gt;"</span><span class="uscript-operator">;</span>
<span class="uscript-line">01222</span>  
<span class="uscript-line">01223</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"GameTypeLink"</span><span class="uscript-operator">,</span>   GameLink<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01224</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"MutatorsLink"</span><span class="uscript-operator">,</span>   MutatorLink<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01225</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"MapsLink"</span><span class="uscript-operator">,</span>       MapLink<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01226</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"RulesLink"</span><span class="uscript-operator">,</span>      RuleLink<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01227</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"ReviewLink"</span><span class="uscript-operator">,</span>     ReviewLink<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01228</span>  
<span class="uscript-line">01229</span>          ShowPage<span class="uscript-operator">(</span>Res<span class="uscript-operator">,</span> SubFrameMenu<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01230</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">01231</span>  
<span class="uscript-line">01232</span>      <span class="uscript-keyword">else</span> AccessDenied<span class="uscript-operator">(</span>Res<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01233</span>  <span class="uscript-operator">}</span>
<span class="uscript-line">01234</span>  
<span class="uscript-line">01235</span>  <span class="uscript-keyword">function</span> QueryLadderView<span class="uscript-operator">(</span>WebRequest Req<span class="uscript-operator">,</span> WebResponse Res<span class="uscript-operator">)</span>
<span class="uscript-line">01236</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">01237</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">int</span> i<span class="uscript-operator">,</span>j<span class="uscript-operator">;</span>
<span class="uscript-line">01238</span>      <span class="uscript-keyword">local</span> Session   CurS<span class="uscript-operator">;</span>
<span class="uscript-line">01239</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">string</span>    SID<span class="uscript-operator">,</span>
<span class="uscript-line">01240</span>                      TempStr<span class="uscript-operator">,</span>
<span class="uscript-line">01241</span>                      ViewRows<span class="uscript-operator">,</span>
<span class="uscript-line">01242</span>                      NewProfile<span class="uscript-operator">,</span>
<span class="uscript-line">01243</span>                      NewGameType<span class="uscript-operator">;</span>
<span class="uscript-line">01244</span>  
<span class="uscript-line">01245</span>      <span class="uscript-keyword">local</span> StringArray           Mutators<span class="uscript-operator">,</span> GroupsOnly<span class="uscript-operator">,</span> ServerActors<span class="uscript-operator">;</span>
<span class="uscript-line">01246</span>      <span class="uscript-keyword">local</span> <span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>GameInfo<span class="uscript-operator">&gt;</span>       GIClass<span class="uscript-operator">;</span>
<span class="uscript-line">01247</span>      <span class="uscript-keyword">local</span> <span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>AccessControl<span class="uscript-operator">&gt;</span>  ACClass<span class="uscript-operator">;</span>
<span class="uscript-line">01248</span>      <span class="uscript-keyword">local</span> <span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>Mutator<span class="uscript-operator">&gt;</span>        TempMut<span class="uscript-operator">;</span>
<span class="uscript-line">01249</span>      <span class="uscript-keyword">local</span> <span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>Info<span class="uscript-operator">&gt;</span>           TempSA<span class="uscript-operator">;</span>
<span class="uscript-line">01250</span>  
<span class="uscript-line">01251</span>  
<span class="uscript-line">01252</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>CanPerform<span class="uscript-operator">(</span><span class="uscript-string">"Lv"</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">01253</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">01254</span>          SID <span class="uscript-operator">=</span> Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span><span class="uscript-string">"SessionID"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01255</span>          CurS <span class="uscript-operator">=</span> SMaster<span class="uscript-operator">.</span>getSession<span class="uscript-operator">(</span>SID<span class="uscript-operator">,</span><span class="uscript-keyword">true</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01256</span>  
<span class="uscript-line">01257</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>CanPerform<span class="uscript-operator">(</span><span class="uscript-string">"Ls"</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">01258</span>          <span class="uscript-operator">{</span>
<span class="uscript-line">01259</span>  
<span class="uscript-line">01260</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span><span class="uscript-string">"SetProfileName"</span><span class="uscript-operator">,</span><span class="uscript-string">""</span><span class="uscript-operator">)</span><span class="uscript-operator">!=</span><span class="uscript-string">""</span><span class="uscript-operator">)</span> <span class="uscript-comment">// We would like to view a different profile</span>
<span class="uscript-line">01261</span>                  TempStr <span class="uscript-operator">=</span> Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span><span class="uscript-string">"ProfileNameSelect"</span><span class="uscript-operator">,</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01262</span>  
<span class="uscript-line">01263</span>              <span class="uscript-keyword">If</span> <span class="uscript-operator">(</span>TempStr <span class="uscript-operator">==</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span>  <span class="uscript-comment">// Not selecting a new profile to view</span>
<span class="uscript-line">01264</span>              <span class="uscript-operator">{</span>
<span class="uscript-line">01265</span>              <span class="uscript-comment">// First, see if the current session is holding a profile</span>
<span class="uscript-line">01266</span>                  NewProfile <span class="uscript-operator">=</span> CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"ProfileIndex"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01267</span>                  <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>NewProfile <span class="uscript-operator">==</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">01268</span>                  <span class="uscript-operator">{</span>
<span class="uscript-line">01269</span>                  <span class="uscript-comment">// See if a profile is currently loaded</span>
<span class="uscript-line">01270</span>                      j <span class="uscript-operator">=</span> GetCurrentConfigIndex<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01271</span>                      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>j<span class="uscript-operator">!=</span><span class="uscript-operator">-</span><span class="uscript-number">1</span><span class="uscript-operator">)</span>      <span class="uscript-comment">// Found an active profile - this profile should be selected</span>
<span class="uscript-line">01272</span>                          NewProfile <span class="uscript-operator">=</span> <span class="uscript-type">string</span><span class="uscript-operator">(</span>j<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01273</span>                  <span class="uscript-operator">}</span>
<span class="uscript-line">01274</span>              <span class="uscript-operator">}</span>
<span class="uscript-line">01275</span>  
<span class="uscript-line">01276</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>TempStr<span class="uscript-operator">!=</span><span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">01277</span>                  NewProfile <span class="uscript-operator">=</span> TempStr<span class="uscript-operator">;</span>
<span class="uscript-line">01278</span>  
<span class="uscript-line">01279</span>              Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"ButtonName"</span><span class="uscript-operator">,</span> <span class="uscript-string">"SetProfileName"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01280</span>              Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"ButtonValue"</span><span class="uscript-operator">,</span> ButtonLoadProfile<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01281</span>              Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"PageCaption"</span><span class="uscript-operator">,</span> <span class="uscript-string">"&lt;select class=mini name='ProfileNameSelect'&gt;"</span><span class="uscript-operator">$</span>GenerateSwitchProfileOptions<span class="uscript-operator">(</span>NewProfile<span class="uscript-operator">)</span><span class="uscript-operator">$</span><span class="uscript-string">"&lt;/select&gt;"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01282</span>          <span class="uscript-operator">}</span>
<span class="uscript-line">01283</span>  
<span class="uscript-line">01284</span>      <span class="uscript-comment">// If admin doesn't have switch privileges, check for current profile</span>
<span class="uscript-line">01285</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>NewProfile <span class="uscript-operator">==</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">01286</span>          <span class="uscript-operator">{</span>
<span class="uscript-line">01287</span>              NewProfile <span class="uscript-operator">=</span> CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"ProfileIndex"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01288</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>NewProfile <span class="uscript-operator">==</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">01289</span>              <span class="uscript-operator">{</span>
<span class="uscript-line">01290</span>                  j <span class="uscript-operator">=</span> GetCurrentConfigIndex<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01291</span>                  <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>j <span class="uscript-operator">!=</span> <span class="uscript-operator">-</span><span class="uscript-number">1</span><span class="uscript-operator">)</span>
<span class="uscript-line">01292</span>                      NewProfile <span class="uscript-operator">=</span> <span class="uscript-type">string</span><span class="uscript-operator">(</span>j<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01293</span>              <span class="uscript-operator">}</span>
<span class="uscript-line">01294</span>          <span class="uscript-operator">}</span>
<span class="uscript-line">01295</span>  
<span class="uscript-line">01296</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>NewProfile <span class="uscript-operator">!=</span> <span class="uscript-string">""</span> <span class="uscript-operator">&amp;&amp;</span> LadderRules<span class="uscript-operator">.</span>AllLadderProfiles<span class="uscript-operator">.</span>Count<span class="uscript-operator">(</span><span class="uscript-operator">)</span> <span class="uscript-operator">&gt;</span> <span class="uscript-number">0</span><span class="uscript-operator">)</span>
<span class="uscript-line">01297</span>          <span class="uscript-operator">{</span>
<span class="uscript-line">01298</span>              CurS<span class="uscript-operator">.</span>setValue<span class="uscript-operator">(</span><span class="uscript-string">"ProfileIndex"</span><span class="uscript-operator">,</span> NewProfile<span class="uscript-operator">,</span> <span class="uscript-keyword">True</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01299</span>              CreateSessionInfo<span class="uscript-operator">(</span>NewProfile<span class="uscript-operator">,</span>SID<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01300</span>              NewGameType <span class="uscript-operator">=</span> CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"GameType"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01301</span>  
<span class="uscript-line">01302</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>NewGameType <span class="uscript-operator">!=</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">01303</span>                  GIClass <span class="uscript-operator">=</span> <span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>GameInfo<span class="uscript-operator">&gt;</span><span class="uscript-operator">(</span>DynamicLoadObject<span class="uscript-operator">(</span>NewGameType<span class="uscript-operator">,</span><span class="uscript-keyword">class</span><span class="uscript-name">'Class'</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01304</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>GIClass<span class="uscript-operator">==</span><span class="uscript-keyword">None</span><span class="uscript-operator">)</span>
<span class="uscript-line">01305</span>              <span class="uscript-operator">{</span>
<span class="uscript-line">01306</span>                  ShowMessage<span class="uscript-operator">(</span>Res<span class="uscript-operator">,</span>ErrorGameClassTitle<span class="uscript-operator">,</span>ErrorGameClassText<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01307</span>                  <span class="uscript-keyword">return</span><span class="uscript-operator">;</span>
<span class="uscript-line">01308</span>              <span class="uscript-operator">}</span>
<span class="uscript-line">01309</span>  
<span class="uscript-line">01310</span>              TempStr <span class="uscript-operator">=</span> CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"ACClass"</span><span class="uscript-operator">,</span>Level<span class="uscript-operator">.</span>Game<span class="uscript-operator">.</span>AccessControlClass<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01311</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>TempStr <span class="uscript-operator">!=</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">01312</span>                  ACClass <span class="uscript-operator">=</span> <span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>AccessControl<span class="uscript-operator">&gt;</span><span class="uscript-operator">(</span>DynamicLoadObject<span class="uscript-operator">(</span>TempStr<span class="uscript-operator">,</span><span class="uscript-keyword">class</span><span class="uscript-name">'Class'</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01313</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>ACClass <span class="uscript-operator">==</span> <span class="uscript-keyword">None</span><span class="uscript-operator">)</span>
<span class="uscript-line">01314</span>              <span class="uscript-operator">{</span>
<span class="uscript-line">01315</span>                  ShowMessage<span class="uscript-operator">(</span>Res<span class="uscript-operator">,</span>ErrorAccessControlTitle<span class="uscript-operator">,</span>ErrorAccessControlText<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01316</span>                  <span class="uscript-keyword">return</span><span class="uscript-operator">;</span>
<span class="uscript-line">01317</span>              <span class="uscript-operator">}</span>
<span class="uscript-line">01318</span>  
<span class="uscript-line">01319</span>              Mutators <span class="uscript-operator">=</span> <span class="uscript-keyword">new</span><span class="uscript-operator">(</span><span class="uscript-keyword">None</span><span class="uscript-operator">)</span> <span class="uscript-keyword">class</span><span class="uscript-name">'SortedStringArray'</span><span class="uscript-operator">;</span>
<span class="uscript-line">01320</span>              GroupsOnly <span class="uscript-operator">=</span> <span class="uscript-keyword">new</span><span class="uscript-operator">(</span><span class="uscript-keyword">None</span><span class="uscript-operator">)</span> <span class="uscript-keyword">class</span><span class="uscript-name">'SortedStringArray'</span><span class="uscript-operator">;</span>
<span class="uscript-line">01321</span>              ServerActors <span class="uscript-operator">=</span> <span class="uscript-keyword">new</span><span class="uscript-operator">(</span><span class="uscript-keyword">None</span><span class="uscript-operator">)</span> <span class="uscript-keyword">class</span><span class="uscript-name">'SortedStringArray'</span><span class="uscript-operator">;</span>
<span class="uscript-line">01322</span>          <span class="uscript-comment">// Mutator Section</span>
<span class="uscript-line">01323</span>              <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>i<span class="uscript-operator">&lt;</span>CurS<span class="uscript-operator">.</span>getMutatorLength<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">01324</span>              <span class="uscript-operator">{</span>
<span class="uscript-line">01325</span>                  TempStr <span class="uscript-operator">=</span> CurS<span class="uscript-operator">.</span>getMutator<span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01326</span>                  <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>j<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>j<span class="uscript-operator">&lt;</span>AllMutators<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">;</span>j<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">01327</span>                  <span class="uscript-operator">{</span>
<span class="uscript-line">01328</span>                      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>TempStr <span class="uscript-operator">~=</span> AllMutators<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>ClassName<span class="uscript-operator">)</span>
<span class="uscript-line">01329</span>                      <span class="uscript-operator">{</span>
<span class="uscript-line">01330</span>                          TempMut <span class="uscript-operator">=</span> <span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>Mutator<span class="uscript-operator">&gt;</span><span class="uscript-operator">(</span>DynamicLoadObject<span class="uscript-operator">(</span>TempStr<span class="uscript-operator">,</span><span class="uscript-keyword">class</span><span class="uscript-name">'Class'</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01331</span>                          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>TempMut <span class="uscript-operator">!=</span> <span class="uscript-keyword">None</span><span class="uscript-operator">)</span>
<span class="uscript-line">01332</span>                              Mutators<span class="uscript-operator">.</span>Add<span class="uscript-operator">(</span><span class="uscript-type">string</span><span class="uscript-operator">(</span>j<span class="uscript-operator">)</span><span class="uscript-operator">,</span> AllMutators<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>FriendlyName<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01333</span>                      <span class="uscript-operator">}</span>
<span class="uscript-line">01334</span>                  <span class="uscript-operator">}</span>
<span class="uscript-line">01335</span>              <span class="uscript-operator">}</span>
<span class="uscript-line">01336</span>  
<span class="uscript-line">01337</span>              <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>i<span class="uscript-operator">&lt;</span>CurS<span class="uscript-operator">.</span>getSALength<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">01338</span>              <span class="uscript-operator">{</span>
<span class="uscript-line">01339</span>                  TempStr <span class="uscript-operator">=</span> CurS<span class="uscript-operator">.</span>GetServerActor<span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01340</span>                  <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>j<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>j<span class="uscript-operator">&lt;</span>ConfigM<span class="uscript-operator">.</span>ManagedActors<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">;</span>j<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">01341</span>                  <span class="uscript-operator">{</span>
<span class="uscript-line">01342</span>                      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>TempStr <span class="uscript-operator">~=</span> <span class="uscript-type">string</span><span class="uscript-operator">(</span>ConfigM<span class="uscript-operator">.</span>ManagedActors<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>SAClass<span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">01343</span>                      <span class="uscript-operator">{</span>
<span class="uscript-line">01344</span>                          TempSA <span class="uscript-operator">=</span> <span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>Info<span class="uscript-operator">&gt;</span><span class="uscript-operator">(</span>DynamicLoadObject<span class="uscript-operator">(</span>TempStr<span class="uscript-operator">,</span><span class="uscript-keyword">class</span><span class="uscript-name">'Class'</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01345</span>                          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>TempSA <span class="uscript-operator">!=</span> <span class="uscript-keyword">None</span><span class="uscript-operator">)</span>
<span class="uscript-line">01346</span>                              ServerActors<span class="uscript-operator">.</span>Add<span class="uscript-operator">(</span><span class="uscript-type">string</span><span class="uscript-operator">(</span>j<span class="uscript-operator">)</span><span class="uscript-operator">,</span>ConfigM<span class="uscript-operator">.</span>ManagedActors<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>SAName<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01347</span>                      <span class="uscript-operator">}</span>
<span class="uscript-line">01348</span>                  <span class="uscript-operator">}</span>
<span class="uscript-line">01349</span>              <span class="uscript-operator">}</span>
<span class="uscript-line">01350</span>  
<span class="uscript-line">01351</span>              Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SectionName"</span><span class="uscript-operator">,</span> TableTitle<span class="uscript-operator">[</span><span class="uscript-number">2</span><span class="uscript-operator">]</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01352</span>              Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SpecialInstructions"</span><span class="uscript-operator">,</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01353</span>              ViewRows <span class="uscript-operator">=</span> ViewRows<span class="uscript-operator">$</span>WebInclude<span class="uscript-operator">(</span>IncludeSection<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01354</span>  
<span class="uscript-line">01355</span>              <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i <span class="uscript-operator">=</span> <span class="uscript-number">0</span><span class="uscript-operator">;</span> i<span class="uscript-operator">&lt;</span>ServerActors<span class="uscript-operator">.</span>Count<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">01356</span>              <span class="uscript-operator">{</span>
<span class="uscript-line">01357</span>                  j <span class="uscript-operator">=</span> <span class="uscript-type">int</span><span class="uscript-operator">(</span>ServerActors<span class="uscript-operator">.</span>GetItem<span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01358</span>                  Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SettingName"</span><span class="uscript-operator">,</span> ServerActors<span class="uscript-operator">.</span>GetTag<span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01359</span>                  <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>CurS<span class="uscript-operator">.</span>SARequired<span class="uscript-operator">(</span><span class="uscript-type">string</span><span class="uscript-operator">(</span>ConfigM<span class="uscript-operator">.</span>ManagedActors<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>SAClass<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">01360</span>                      Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SettingData"</span><span class="uscript-operator">,</span> RequiredText<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01361</span>                  <span class="uscript-keyword">else</span> Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SettingData"</span><span class="uscript-operator">,</span> <span class="uscript-string">"&amp;nbsp;&amp;nbsp;"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01362</span>                  ViewRows <span class="uscript-operator">=</span> ViewRows <span class="uscript-operator">$</span> WebInclude<span class="uscript-operator">(</span>IncludeRows<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01363</span>              <span class="uscript-operator">}</span>
<span class="uscript-line">01364</span>              ViewRows <span class="uscript-operator">=</span> ViewRows <span class="uscript-operator">$</span> <span class="uscript-string">"&lt;tr&gt;&lt;td colspan=\"2\"&gt;&amp;nbsp;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;"</span><span class="uscript-operator">;</span>
<span class="uscript-line">01365</span>              <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i <span class="uscript-operator">=</span> <span class="uscript-number">0</span><span class="uscript-operator">;</span> i<span class="uscript-operator">&lt;</span>Mutators<span class="uscript-operator">.</span>Count<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">01366</span>              <span class="uscript-operator">{</span>
<span class="uscript-line">01367</span>                  j <span class="uscript-operator">=</span> <span class="uscript-type">int</span><span class="uscript-operator">(</span>Mutators<span class="uscript-operator">.</span>GetItem<span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01368</span>                  Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SettingName"</span><span class="uscript-operator">,</span> AllMutators<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>FriendlyName<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01369</span>                  <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>CurS<span class="uscript-operator">.</span>MutRequired<span class="uscript-operator">(</span>AllMutators<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>ClassName<span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">01370</span>                      Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SettingData"</span><span class="uscript-operator">,</span> RequiredText<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01371</span>                  <span class="uscript-keyword">else</span> Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SettingData"</span><span class="uscript-operator">,</span> <span class="uscript-string">"&amp;nbsp;&amp;nbsp;"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01372</span>                  ViewRows <span class="uscript-operator">=</span> ViewRows<span class="uscript-operator">$</span>WebInclude<span class="uscript-operator">(</span>IncludeRows<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01373</span>              <span class="uscript-operator">}</span>
<span class="uscript-line">01374</span>  
<span class="uscript-line">01375</span>              Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SectionName"</span><span class="uscript-operator">,</span> TableTitle<span class="uscript-operator">[</span><span class="uscript-number">3</span><span class="uscript-operator">]</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01376</span>              Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SpecialInstructions"</span><span class="uscript-operator">,</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01377</span>              ViewRows <span class="uscript-operator">=</span> ViewRows<span class="uscript-operator">$</span>WebInclude<span class="uscript-operator">(</span>IncludeSection<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01378</span>  
<span class="uscript-line">01379</span>              Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SettingName"</span><span class="uscript-operator">,</span> LabelMaxMaps<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01380</span>              TempStr <span class="uscript-operator">=</span> CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"MaxMaps"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01381</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>TempStr <span class="uscript-operator">==</span> <span class="uscript-string">"0"</span><span class="uscript-operator">)</span>
<span class="uscript-line">01382</span>                  TempStr <span class="uscript-operator">=</span> UnlimitedText<span class="uscript-operator">;</span>
<span class="uscript-line">01383</span>              Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SettingData"</span><span class="uscript-operator">,</span> TempStr<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01384</span>              Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"Extra"</span><span class="uscript-operator">,</span> <span class="uscript-string">"&lt;tr&gt;&lt;td colspan=\"2\"&gt;&amp;nbsp;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01385</span>              ViewRows <span class="uscript-operator">=</span> ViewRows<span class="uscript-operator">$</span>WebInclude<span class="uscript-operator">(</span>IncludeRows<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01386</span>              <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>i<span class="uscript-operator">&lt;</span>CurS<span class="uscript-operator">.</span>getMapLength<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">01387</span>              <span class="uscript-operator">{</span>
<span class="uscript-line">01388</span>                  TempStr <span class="uscript-operator">=</span> CurS<span class="uscript-operator">.</span>getMap<span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01389</span>                  Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SettingName"</span><span class="uscript-operator">,</span> TempStr<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01390</span>                  Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"Extra"</span><span class="uscript-operator">,</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01391</span>                  <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>CurS<span class="uscript-operator">.</span>MapRequired<span class="uscript-operator">(</span>TempStr<span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">01392</span>                      Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SettingData"</span><span class="uscript-operator">,</span> RequiredText<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01393</span>                  <span class="uscript-keyword">else</span> Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SettingData"</span><span class="uscript-operator">,</span> <span class="uscript-string">"&amp;nbsp;&amp;nbsp"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01394</span>  
<span class="uscript-line">01395</span>                  ViewRows <span class="uscript-operator">=</span> ViewRows<span class="uscript-operator">$</span>WebInclude<span class="uscript-operator">(</span>IncludeRows<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01396</span>              <span class="uscript-operator">}</span>
<span class="uscript-line">01397</span>  
<span class="uscript-line">01398</span>              Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SectionName"</span><span class="uscript-operator">,</span> TableTitle<span class="uscript-operator">[</span><span class="uscript-number">4</span><span class="uscript-operator">]</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01399</span>              Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SpecialInstructions"</span><span class="uscript-operator">,</span> <span class="uscript-string">"&amp;nbsp;&amp;nbsp;"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01400</span>              ViewRows <span class="uscript-operator">=</span> ViewRows <span class="uscript-operator">$</span> WebInclude<span class="uscript-operator">(</span>IncludeSection<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01401</span>              ViewRows <span class="uscript-operator">=</span> ViewRows <span class="uscript-operator">$</span> <span class="uscript-string">"&lt;tr&gt;&lt;td colspan=\"2\"&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;"</span> <span class="uscript-operator">$</span> GeneratePlayInfoRows<span class="uscript-operator">(</span>Req<span class="uscript-operator">,</span> Res<span class="uscript-operator">,</span> IncludeRows<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01402</span>          <span class="uscript-operator">}</span>
<span class="uscript-line">01403</span>  
<span class="uscript-line">01404</span>      <span class="uscript-comment">// We have no profile currently active</span>
<span class="uscript-line">01405</span>          <span class="uscript-keyword">else</span>
<span class="uscript-line">01406</span>          <span class="uscript-operator">{</span>
<span class="uscript-line">01407</span>              Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SettingName"</span><span class="uscript-operator">,</span> PageCaption<span class="uscript-operator">[</span><span class="uscript-number">0</span><span class="uscript-operator">]</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01408</span>              ViewRows <span class="uscript-operator">=</span> ViewRows <span class="uscript-operator">$</span> WebInclude<span class="uscript-operator">(</span>IncludeRows<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01409</span>          <span class="uscript-operator">}</span>
<span class="uscript-line">01410</span>  
<span class="uscript-line">01411</span>          TempStr <span class="uscript-operator">=</span> CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"ProfileName"</span><span class="uscript-operator">,</span> PageCaption<span class="uscript-operator">[</span><span class="uscript-number">0</span><span class="uscript-operator">]</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01412</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>LadderRules<span class="uscript-operator">.</span>GetRemainingMatches<span class="uscript-operator">(</span><span class="uscript-operator">)</span> <span class="uscript-operator">&gt;</span> <span class="uscript-number">0</span> <span class="uscript-operator">&amp;&amp;</span> TempStr <span class="uscript-operator">==</span> LadderRules<span class="uscript-operator">.</span>Profiles<span class="uscript-operator">[</span>GetCurrentConfigIndex<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">]</span><span class="uscript-operator">.</span>ProfileName<span class="uscript-operator">)</span>
<span class="uscript-line">01413</span>              TempStr <span class="uscript-operator">=</span> TempStr <span class="uscript-operator">@</span> LabelNumberMatchesLeft <span class="uscript-operator">@</span> <span class="uscript-type">string</span><span class="uscript-operator">(</span>LadderRules<span class="uscript-operator">.</span>GetRemainingMatches<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01414</span>  
<span class="uscript-line">01415</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"TableRows"</span><span class="uscript-operator">,</span> ViewRows<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01416</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"LadderTable"</span><span class="uscript-operator">,</span> WebInclude<span class="uscript-operator">(</span>IncludeCaptionButton<span class="uscript-operator">)</span><span class="uscript-operator">$</span>WebInclude<span class="uscript-operator">(</span>IncludeTable<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01417</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"Section"</span><span class="uscript-operator">,</span> LinkViewProfile<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01418</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SubTitle"</span><span class="uscript-operator">,</span> TempStr<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01419</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"PageHelp"</span><span class="uscript-operator">,</span> HelpViewProfile<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01420</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"PostAction"</span><span class="uscript-operator">,</span> ProfileViewURI<span class="uscript-operator">$</span><span class="uscript-string">"?SessionID="</span><span class="uscript-operator">$</span>SID<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01421</span>  
<span class="uscript-line">01422</span>          ShowPage<span class="uscript-operator">(</span>Res<span class="uscript-operator">,</span> MasterPage<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01423</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">01424</span>  
<span class="uscript-line">01425</span>      <span class="uscript-keyword">else</span> AccessDenied<span class="uscript-operator">(</span>Res<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01426</span>  <span class="uscript-operator">}</span>
<span class="uscript-line">01427</span>  
<span class="uscript-line">01428</span>  <span class="uscript-keyword">function</span> QueryLadderEdit<span class="uscript-operator">(</span>WebRequest Req<span class="uscript-operator">,</span> WebResponse Res<span class="uscript-operator">)</span>
<span class="uscript-line">01429</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">01430</span>      <span class="uscript-keyword">local</span> Session CurS<span class="uscript-operator">;</span>
<span class="uscript-line">01431</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">bool</span>  bAllMuts<span class="uscript-operator">;</span>
<span class="uscript-line">01432</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">int</span>   i<span class="uscript-operator">,</span>j<span class="uscript-operator">,</span>k<span class="uscript-operator">,</span>z<span class="uscript-operator">,</span>
<span class="uscript-line">01433</span>                  id<span class="uscript-operator">,</span>
<span class="uscript-line">01434</span>                  Count<span class="uscript-operator">,</span>
<span class="uscript-line">01435</span>                  MoveCount<span class="uscript-operator">;</span>
<span class="uscript-line">01436</span>  
<span class="uscript-line">01437</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">string</span>    SID<span class="uscript-operator">,</span>
<span class="uscript-line">01438</span>                      EditRows<span class="uscript-operator">,</span>
<span class="uscript-line">01439</span>                      TempStr<span class="uscript-operator">,</span> Tmp<span class="uscript-operator">,</span> NewProfile<span class="uscript-operator">,</span> NewGameType<span class="uscript-operator">,</span>
<span class="uscript-line">01440</span>                      lastgroup<span class="uscript-operator">,</span> thisgroup<span class="uscript-operator">,</span> nextgroup<span class="uscript-operator">,</span> EmptyRow<span class="uscript-operator">;</span>
<span class="uscript-line">01441</span>  
<span class="uscript-line">01442</span>      <span class="uscript-keyword">local</span> ProfileConfigSet      TempPCS<span class="uscript-operator">;</span>
<span class="uscript-line">01443</span>      <span class="uscript-keyword">local</span> <span class="uscript-keyword">array</span><span class="uscript-operator">&lt;</span><span class="uscript-type">string</span><span class="uscript-operator">&gt;</span>         TempMutes<span class="uscript-operator">;</span>
<span class="uscript-line">01444</span>      <span class="uscript-keyword">local</span> <span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>GameInfo<span class="uscript-operator">&gt;</span>       GIClass<span class="uscript-operator">;</span>
<span class="uscript-line">01445</span>      <span class="uscript-keyword">local</span> <span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>AccessControl<span class="uscript-operator">&gt;</span>  ACClass<span class="uscript-operator">;</span>
<span class="uscript-line">01446</span>      <span class="uscript-keyword">local</span> <span class="uscript-keyword">array</span><span class="uscript-operator">&lt;</span>ProfileConfigSet<span class="uscript-operator">.</span>ProfileMap<span class="uscript-operator">&gt;</span>        AllPCSMaps<span class="uscript-operator">;</span>
<span class="uscript-line">01447</span>      <span class="uscript-keyword">local</span> <span class="uscript-keyword">array</span><span class="uscript-operator">&lt;</span>ProfileConfigSet<span class="uscript-operator">.</span>ProfileMutator<span class="uscript-operator">&gt;</span>    AllPCSMutators<span class="uscript-operator">;</span>
<span class="uscript-line">01448</span>      <span class="uscript-keyword">local</span> <span class="uscript-keyword">array</span><span class="uscript-operator">&lt;</span>ProfileConfigSet<span class="uscript-operator">.</span>ProfileSA<span class="uscript-operator">&gt;</span>         AllPCSServerActors<span class="uscript-operator">;</span>
<span class="uscript-line">01449</span>      <span class="uscript-keyword">local</span> StringArray
<span class="uscript-line">01450</span>                  Mutators<span class="uscript-operator">,</span> GroupsOnly<span class="uscript-operator">,</span> Required<span class="uscript-operator">,</span> ServerActors<span class="uscript-operator">,</span> ReqSA<span class="uscript-operator">,</span>
<span class="uscript-line">01451</span>                  RequiredMaps<span class="uscript-operator">,</span> IncludeMaps<span class="uscript-operator">,</span> ExcludeMaps<span class="uscript-operator">,</span> MovedMaps<span class="uscript-operator">;</span>
<span class="uscript-line">01452</span>  
<span class="uscript-line">01453</span>      SID <span class="uscript-operator">=</span> Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span><span class="uscript-string">"SessionID"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01454</span>      CurS <span class="uscript-operator">=</span> SMaster<span class="uscript-operator">.</span>getSession<span class="uscript-operator">(</span>SID<span class="uscript-operator">,</span><span class="uscript-keyword">true</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01455</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>CanPerform<span class="uscript-operator">(</span><span class="uscript-string">"Le"</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">01456</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">01457</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>CanPerform<span class="uscript-operator">(</span><span class="uscript-string">"Ls"</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">01458</span>          <span class="uscript-operator">{</span>
<span class="uscript-line">01459</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span><span class="uscript-string">"SetProfileName"</span><span class="uscript-operator">,</span><span class="uscript-string">""</span><span class="uscript-operator">)</span><span class="uscript-operator">!=</span><span class="uscript-string">""</span><span class="uscript-operator">)</span> <span class="uscript-comment">// We would like to view a different profile</span>
<span class="uscript-line">01460</span>                  TempStr <span class="uscript-operator">=</span> Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span><span class="uscript-string">"ProfileNameSelect"</span><span class="uscript-operator">,</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01461</span>  
<span class="uscript-line">01462</span>              <span class="uscript-keyword">If</span> <span class="uscript-operator">(</span>TempStr <span class="uscript-operator">==</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span>  <span class="uscript-comment">// Not selecting a new profile to view</span>
<span class="uscript-line">01463</span>              <span class="uscript-operator">{</span>
<span class="uscript-line">01464</span>              <span class="uscript-comment">// First, see if the current session is holding a profile</span>
<span class="uscript-line">01465</span>                  NewProfile <span class="uscript-operator">=</span> CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"ProfileIndex"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01466</span>  
<span class="uscript-line">01467</span>                  <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>NewProfile <span class="uscript-operator">==</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">01468</span>                  <span class="uscript-operator">{</span>
<span class="uscript-line">01469</span>                  <span class="uscript-comment">// See if a profile is currently loaded</span>
<span class="uscript-line">01470</span>                      j <span class="uscript-operator">=</span> GetCurrentConfigIndex<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01471</span>                      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>j<span class="uscript-operator">!=</span><span class="uscript-operator">-</span><span class="uscript-number">1</span><span class="uscript-operator">)</span>      <span class="uscript-comment">// Found an active profile - this profile should be selected</span>
<span class="uscript-line">01472</span>                          NewProfile <span class="uscript-operator">=</span> <span class="uscript-type">string</span><span class="uscript-operator">(</span>j<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01473</span>                  <span class="uscript-operator">}</span>
<span class="uscript-line">01474</span>  
<span class="uscript-line">01475</span>              <span class="uscript-operator">}</span>
<span class="uscript-line">01476</span>  
<span class="uscript-line">01477</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>TempStr<span class="uscript-operator">!=</span><span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">01478</span>                  NewProfile <span class="uscript-operator">=</span> TempStr<span class="uscript-operator">;</span>
<span class="uscript-line">01479</span>  
<span class="uscript-line">01480</span>              Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"ButtonName"</span><span class="uscript-operator">,</span> <span class="uscript-string">"SetProfileName"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01481</span>              Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"ButtonValue"</span><span class="uscript-operator">,</span> ButtonLoadProfile<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01482</span>              Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"PageCaption"</span><span class="uscript-operator">,</span> <span class="uscript-string">"&lt;select class=mini name='ProfileNameSelect'&gt;"</span><span class="uscript-operator">$</span>GenerateSwitchProfileOptions<span class="uscript-operator">(</span>NewProfile<span class="uscript-operator">)</span><span class="uscript-operator">$</span><span class="uscript-string">"&lt;/select&gt;"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01483</span>          <span class="uscript-operator">}</span>
<span class="uscript-line">01484</span>          CurS<span class="uscript-operator">.</span>setValue<span class="uscript-operator">(</span><span class="uscript-string">"CurrentPage"</span><span class="uscript-operator">,</span> ProfileEditURI<span class="uscript-operator">,</span> <span class="uscript-keyword">true</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01485</span>          CurS<span class="uscript-operator">.</span>setValue<span class="uscript-operator">(</span><span class="uscript-string">"ButtonName"</span><span class="uscript-operator">,</span> <span class="uscript-string">"ApplyProfileChanges"</span><span class="uscript-operator">,</span><span class="uscript-keyword">true</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01486</span>          CurS<span class="uscript-operator">.</span>setValue<span class="uscript-operator">(</span><span class="uscript-string">"ButtonValue"</span><span class="uscript-operator">,</span> ButtonApplyProfileChanges<span class="uscript-operator">,</span> <span class="uscript-keyword">true</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01487</span>  
<span class="uscript-line">01488</span>  <span class="uscript-comment">// If admin doesn't have switch privileges, check for current profile</span>
<span class="uscript-line">01489</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>NewProfile <span class="uscript-operator">==</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">01490</span>          <span class="uscript-operator">{</span>
<span class="uscript-line">01491</span>              NewProfile <span class="uscript-operator">=</span> CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"ProfileIndex"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01492</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>NewProfile <span class="uscript-operator">==</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">01493</span>              <span class="uscript-operator">{</span>
<span class="uscript-line">01494</span>                  j <span class="uscript-operator">=</span> GetCurrentConfigIndex<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01495</span>                  <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>j <span class="uscript-operator">!=</span> <span class="uscript-operator">-</span><span class="uscript-number">1</span><span class="uscript-operator">)</span>
<span class="uscript-line">01496</span>                      NewProfile <span class="uscript-operator">=</span> <span class="uscript-type">string</span><span class="uscript-operator">(</span>j<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01497</span>              <span class="uscript-operator">}</span>
<span class="uscript-line">01498</span>          <span class="uscript-operator">}</span>
<span class="uscript-line">01499</span>  
<span class="uscript-line">01500</span>          CurS<span class="uscript-operator">.</span>setValue<span class="uscript-operator">(</span><span class="uscript-string">"ProfileIndex"</span><span class="uscript-operator">,</span> NewProfile<span class="uscript-operator">,</span> <span class="uscript-keyword">True</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01501</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>NewProfile <span class="uscript-operator">!=</span> <span class="uscript-string">""</span> <span class="uscript-operator">&amp;&amp;</span> LadderRules<span class="uscript-operator">.</span>AllLadderProfiles<span class="uscript-operator">.</span>Count<span class="uscript-operator">(</span><span class="uscript-operator">)</span> <span class="uscript-operator">&gt;</span> <span class="uscript-number">0</span><span class="uscript-operator">)</span>
<span class="uscript-line">01502</span>          <span class="uscript-operator">{</span>
<span class="uscript-line">01503</span>              ProfileMaps<span class="uscript-operator">.</span>Reset<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01504</span>              Required <span class="uscript-operator">=</span> <span class="uscript-keyword">new</span><span class="uscript-operator">(</span><span class="uscript-keyword">None</span><span class="uscript-operator">)</span>        <span class="uscript-keyword">class</span><span class="uscript-name">'SortedStringArray'</span><span class="uscript-operator">;</span>
<span class="uscript-line">01505</span>              ReqSA   <span class="uscript-operator">=</span> <span class="uscript-keyword">new</span><span class="uscript-operator">(</span><span class="uscript-keyword">None</span><span class="uscript-operator">)</span>         <span class="uscript-keyword">class</span><span class="uscript-name">'SortedStringArray'</span><span class="uscript-operator">;</span>
<span class="uscript-line">01506</span>              Mutators <span class="uscript-operator">=</span> <span class="uscript-keyword">new</span><span class="uscript-operator">(</span><span class="uscript-keyword">None</span><span class="uscript-operator">)</span>        <span class="uscript-keyword">class</span><span class="uscript-name">'SortedStringArray'</span><span class="uscript-operator">;</span>
<span class="uscript-line">01507</span>              MovedMaps <span class="uscript-operator">=</span> <span class="uscript-keyword">new</span><span class="uscript-operator">(</span><span class="uscript-keyword">None</span><span class="uscript-operator">)</span>       <span class="uscript-keyword">class</span><span class="uscript-name">'SortedStringArray'</span><span class="uscript-operator">;</span>
<span class="uscript-line">01508</span>              GroupsOnly <span class="uscript-operator">=</span> <span class="uscript-keyword">new</span><span class="uscript-operator">(</span><span class="uscript-keyword">None</span><span class="uscript-operator">)</span>      <span class="uscript-keyword">class</span><span class="uscript-name">'SortedStringArray'</span><span class="uscript-operator">;</span>
<span class="uscript-line">01509</span>              ServerActors <span class="uscript-operator">=</span> <span class="uscript-keyword">new</span><span class="uscript-operator">(</span><span class="uscript-keyword">None</span><span class="uscript-operator">)</span>    <span class="uscript-keyword">class</span><span class="uscript-name">'SortedStringArray'</span><span class="uscript-operator">;</span>
<span class="uscript-line">01510</span>              IncludeMaps <span class="uscript-operator">=</span> <span class="uscript-keyword">new</span><span class="uscript-operator">(</span><span class="uscript-keyword">None</span><span class="uscript-operator">)</span>     <span class="uscript-keyword">class</span><span class="uscript-name">'SortedStringArray'</span><span class="uscript-operator">;</span>
<span class="uscript-line">01511</span>              ExcludeMaps <span class="uscript-operator">=</span> <span class="uscript-keyword">new</span><span class="uscript-operator">(</span><span class="uscript-keyword">None</span><span class="uscript-operator">)</span>     <span class="uscript-keyword">class</span><span class="uscript-name">'SortedStringArray'</span><span class="uscript-operator">;</span>
<span class="uscript-line">01512</span>              RequiredMaps <span class="uscript-operator">=</span> <span class="uscript-keyword">new</span><span class="uscript-operator">(</span><span class="uscript-keyword">None</span><span class="uscript-operator">)</span>    <span class="uscript-keyword">class</span><span class="uscript-name">'SortedStringArray'</span><span class="uscript-operator">;</span>
<span class="uscript-line">01513</span>  
<span class="uscript-line">01514</span>              CreateSessionInfo<span class="uscript-operator">(</span>NewProfile<span class="uscript-operator">,</span>SID<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01515</span>              TempPCS <span class="uscript-operator">=</span> LadderRules<span class="uscript-operator">.</span>LadderProfiles<span class="uscript-operator">[</span><span class="uscript-type">int</span><span class="uscript-operator">(</span>NewProfile<span class="uscript-operator">)</span><span class="uscript-operator">]</span><span class="uscript-operator">;</span>
<span class="uscript-line">01516</span>              TempPCS<span class="uscript-operator">.</span>StartEdit<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01517</span>  
<span class="uscript-line">01518</span>              NewGameType <span class="uscript-operator">=</span> CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"GameType"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01519</span>              GIClass <span class="uscript-operator">=</span> <span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>GameInfo<span class="uscript-operator">&gt;</span><span class="uscript-operator">(</span>DynamicLoadObject<span class="uscript-operator">(</span>NewGameType<span class="uscript-operator">,</span><span class="uscript-keyword">class</span><span class="uscript-name">'Class'</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01520</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>GIClass<span class="uscript-operator">==</span><span class="uscript-keyword">None</span><span class="uscript-operator">)</span>
<span class="uscript-line">01521</span>              <span class="uscript-operator">{</span>
<span class="uscript-line">01522</span>                  ShowMessage<span class="uscript-operator">(</span>Res<span class="uscript-operator">,</span>ErrorGameClassTitle<span class="uscript-operator">,</span>ErrorGameClassText<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01523</span>                  <span class="uscript-keyword">return</span><span class="uscript-operator">;</span>
<span class="uscript-line">01524</span>              <span class="uscript-operator">}</span>
<span class="uscript-line">01525</span>  
<span class="uscript-line">01526</span>              TempStr <span class="uscript-operator">=</span> CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"ACClass"</span><span class="uscript-operator">,</span> Level<span class="uscript-operator">.</span>Game<span class="uscript-operator">.</span>AccessControlClass<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01527</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>TempStr <span class="uscript-operator">!=</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">01528</span>                  ACClass <span class="uscript-operator">=</span> <span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>AccessControl<span class="uscript-operator">&gt;</span><span class="uscript-operator">(</span>DynamicLoadObject<span class="uscript-operator">(</span>TempStr<span class="uscript-operator">,</span><span class="uscript-keyword">class</span><span class="uscript-name">'Class'</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01529</span>              AllPCSMutators <span class="uscript-operator">=</span> TempPCS<span class="uscript-operator">.</span>GetProfileMutators<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01530</span>              AllPCSMaps <span class="uscript-operator">=</span> TempPCS<span class="uscript-operator">.</span>GetProfileMaps<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01531</span>              AllPCSServerActors <span class="uscript-operator">=</span> TempPCS<span class="uscript-operator">.</span>GetProfileServerActors<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01532</span>  
<span class="uscript-line">01533</span>      <span class="uscript-comment">// Load Exclude Maps</span>
<span class="uscript-line">01534</span>              <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>i<span class="uscript-operator">&lt;</span>AllPCSMaps<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">;</span>i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">01535</span>              <span class="uscript-operator">{</span>
<span class="uscript-line">01536</span>                  ProfileMaps<span class="uscript-operator">.</span>Add<span class="uscript-operator">(</span><span class="uscript-type">string</span><span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">,</span> AllPCSMaps<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>MapName<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01537</span>                  <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>AllPCSMaps<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>bRequired<span class="uscript-operator">)</span>
<span class="uscript-line">01538</span>                  <span class="uscript-operator">{</span>
<span class="uscript-line">01539</span>                      RequiredMaps<span class="uscript-operator">.</span>Add<span class="uscript-operator">(</span><span class="uscript-type">string</span><span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">,</span><span class="uscript-type">string</span><span class="uscript-operator">(</span>AllPCSMaps<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>MapListOrder<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01540</span>                      IncludeMaps<span class="uscript-operator">.</span>Add<span class="uscript-operator">(</span><span class="uscript-type">string</span><span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">,</span><span class="uscript-type">string</span><span class="uscript-operator">(</span>AllPCSMaps<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>MapListOrder<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01541</span>                  <span class="uscript-operator">}</span>
<span class="uscript-line">01542</span>  
<span class="uscript-line">01543</span>                  <span class="uscript-keyword">else</span> ExcludeMaps<span class="uscript-operator">.</span>Add<span class="uscript-operator">(</span><span class="uscript-type">string</span><span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">,</span><span class="uscript-type">string</span><span class="uscript-operator">(</span>AllPCSMaps<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>MapListOrder<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01544</span>              <span class="uscript-operator">}</span>
<span class="uscript-line">01545</span>  
<span class="uscript-line">01546</span>              <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>i<span class="uscript-operator">&lt;</span>CurS<span class="uscript-operator">.</span>GetMapLength<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">01547</span>              <span class="uscript-operator">{</span>
<span class="uscript-line">01548</span>                  j <span class="uscript-operator">=</span> ExcludeMaps<span class="uscript-operator">.</span>FindItemId<span class="uscript-operator">(</span>ProfileMaps<span class="uscript-operator">.</span>GetItem<span class="uscript-operator">(</span>ProfileMaps<span class="uscript-operator">.</span>FindTagId<span class="uscript-operator">(</span>CurS<span class="uscript-operator">.</span>getMap<span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01549</span>                  <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>j <span class="uscript-operator">&gt;=</span> <span class="uscript-number">0</span><span class="uscript-operator">)</span> IncludeMaps<span class="uscript-operator">.</span>MoveFromId<span class="uscript-operator">(</span>ExcludeMaps<span class="uscript-operator">,</span> j<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01550</span>              <span class="uscript-operator">}</span>
<span class="uscript-line">01551</span>  
<span class="uscript-line">01552</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span><span class="uscript-string">"ApplyProfileChanges"</span><span class="uscript-operator">,</span><span class="uscript-string">""</span><span class="uscript-operator">)</span><span class="uscript-operator">!=</span><span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">01553</span>              <span class="uscript-operator">{</span>
<span class="uscript-line">01554</span>                  <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>i<span class="uscript-operator">&lt;</span>AllPCSMutators<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">;</span>i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">01555</span>                      <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>j<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>j<span class="uscript-operator">&lt;</span>AllMutators<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">;</span>j<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">01556</span>                          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>AllPCSMutators<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>MutatorName <span class="uscript-operator">~=</span> AllMutators<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>ClassName<span class="uscript-operator">)</span>
<span class="uscript-line">01557</span>                              Mutators<span class="uscript-operator">.</span>Add<span class="uscript-operator">(</span><span class="uscript-type">string</span><span class="uscript-operator">(</span>j<span class="uscript-operator">)</span><span class="uscript-operator">,</span>AllPCSMutators<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>MutatorName<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01558</span>  
<span class="uscript-line">01559</span>                  <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>i<span class="uscript-operator">&lt;</span>Mutators<span class="uscript-operator">.</span>Count<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">01560</span>                  <span class="uscript-operator">{</span>
<span class="uscript-line">01561</span>                      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">(</span>Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span>Mutators<span class="uscript-operator">.</span>GetTag<span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">,</span><span class="uscript-string">""</span><span class="uscript-operator">)</span><span class="uscript-operator">!=</span><span class="uscript-string">""</span><span class="uscript-operator">)</span><span class="uscript-operator">||</span><span class="uscript-operator">(</span>Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span>AllMutators<span class="uscript-operator">[</span><span class="uscript-type">int</span><span class="uscript-operator">(</span>Mutators<span class="uscript-operator">.</span>GetItem<span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">]</span><span class="uscript-operator">.</span>GroupName<span class="uscript-operator">)</span><span class="uscript-operator">~=</span>Mutators<span class="uscript-operator">.</span>GetTag<span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">01562</span>                          TempPCS<span class="uscript-operator">.</span>AddMutator<span class="uscript-operator">(</span>Mutators<span class="uscript-operator">.</span>GetTag<span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01563</span>                      <span class="uscript-keyword">else</span> TempPCS<span class="uscript-operator">.</span>DelMutator<span class="uscript-operator">(</span>Mutators<span class="uscript-operator">.</span>GetTag<span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01564</span>                  <span class="uscript-operator">}</span>
<span class="uscript-line">01565</span>  
<span class="uscript-line">01566</span>                  <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>i<span class="uscript-operator">&lt;</span>AllPCSServerActors<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">;</span>i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">01567</span>                  <span class="uscript-operator">{</span>
<span class="uscript-line">01568</span>                      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span>AllPCSServerActors<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>ActorClass<span class="uscript-operator">,</span><span class="uscript-string">""</span><span class="uscript-operator">)</span> <span class="uscript-operator">!=</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">01569</span>                          TempPCS<span class="uscript-operator">.</span>AddServerActor<span class="uscript-operator">(</span>AllPCSServerActors<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>ActorClass<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01570</span>                      <span class="uscript-keyword">else</span> TempPCS<span class="uscript-operator">.</span>DelServerActor<span class="uscript-operator">(</span>AllPCSServerActors<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>ActorClass<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01571</span>                  <span class="uscript-operator">}</span>
<span class="uscript-line">01572</span>  
<span class="uscript-line">01573</span>                  <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>i<span class="uscript-operator">&lt;</span>AllPCSMaps<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">;</span>i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">01574</span>                  <span class="uscript-operator">{</span>
<span class="uscript-line">01575</span>                      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>AllPCSMaps<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>bRequired<span class="uscript-operator">)</span> TempPCS<span class="uscript-operator">.</span>AddMap<span class="uscript-operator">(</span>AllPCSMaps<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>MapName<span class="uscript-operator">,</span><span class="uscript-type">int</span><span class="uscript-operator">(</span>RequiredMaps<span class="uscript-operator">.</span>GetTag<span class="uscript-operator">(</span>RequiredMaps<span class="uscript-operator">.</span>FindItemId<span class="uscript-operator">(</span><span class="uscript-type">string</span><span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01576</span>                      <span class="uscript-keyword">else</span> <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>IncludeMaps<span class="uscript-operator">.</span>FindItemId<span class="uscript-operator">(</span><span class="uscript-type">string</span><span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">&gt;=</span> <span class="uscript-number">0</span><span class="uscript-operator">)</span> TempPCS<span class="uscript-operator">.</span>AddMap<span class="uscript-operator">(</span>AllPCSMaps<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>MapName<span class="uscript-operator">,</span><span class="uscript-type">int</span><span class="uscript-operator">(</span>IncludeMaps<span class="uscript-operator">.</span>GetTag<span class="uscript-operator">(</span>IncludeMaps<span class="uscript-operator">.</span>FindItemId<span class="uscript-operator">(</span><span class="uscript-type">string</span><span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01577</span>                      <span class="uscript-keyword">else</span> TempPCS<span class="uscript-operator">.</span>RemoveMap<span class="uscript-operator">(</span>AllPCSMaps<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>MapName<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01578</span>                  <span class="uscript-operator">}</span>
<span class="uscript-line">01579</span>  
<span class="uscript-line">01580</span>                  CreateSessionInfo<span class="uscript-operator">(</span>NewProfile<span class="uscript-operator">,</span>SID<span class="uscript-operator">,</span><span class="uscript-keyword">false</span><span class="uscript-operator">,</span><span class="uscript-keyword">true</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01581</span>              <span class="uscript-operator">}</span>
<span class="uscript-line">01582</span>              <span class="uscript-keyword">else</span> <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span><span class="uscript-string">"AddMap"</span><span class="uscript-operator">,</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span> <span class="uscript-operator">!=</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">01583</span>              <span class="uscript-operator">{</span>
<span class="uscript-line">01584</span>                  Count <span class="uscript-operator">=</span> Req<span class="uscript-operator">.</span>GetVariableCount<span class="uscript-operator">(</span><span class="uscript-string">"ExcludeMapsSelect"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01585</span>                  <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span> i<span class="uscript-operator">&lt;</span>Count<span class="uscript-operator">;</span> i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">01586</span>                  <span class="uscript-operator">{</span>
<span class="uscript-line">01587</span>                      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>IncludeMaps<span class="uscript-operator">.</span>Count<span class="uscript-operator">(</span><span class="uscript-operator">)</span> <span class="uscript-operator">&gt;=</span> TempPCS<span class="uscript-operator">.</span>MaxMaps <span class="uscript-operator">&amp;&amp;</span> TempPCS<span class="uscript-operator">.</span>MaxMaps <span class="uscript-operator">&gt;</span> <span class="uscript-number">0</span><span class="uscript-operator">)</span>
<span class="uscript-line">01588</span>                          <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>
<span class="uscript-line">01589</span>                      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>ExcludeMaps<span class="uscript-operator">.</span>Count<span class="uscript-operator">(</span><span class="uscript-operator">)</span> <span class="uscript-operator">&gt;</span> <span class="uscript-number">0</span><span class="uscript-operator">)</span>
<span class="uscript-line">01590</span>                      <span class="uscript-operator">{</span>
<span class="uscript-line">01591</span>                          id <span class="uscript-operator">=</span> IncludeMaps<span class="uscript-operator">.</span>MoveFromId<span class="uscript-operator">(</span>ExcludeMaps<span class="uscript-operator">,</span> ExcludeMaps<span class="uscript-operator">.</span>FindItemId<span class="uscript-operator">(</span>ProfileMaps<span class="uscript-operator">.</span>GetItem<span class="uscript-operator">(</span>ProfileMaps<span class="uscript-operator">.</span>FindTagId<span class="uscript-operator">(</span>Req<span class="uscript-operator">.</span>GetVariableNumber<span class="uscript-operator">(</span><span class="uscript-string">"ExcludeMapsSelect"</span><span class="uscript-operator">,</span> i<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01592</span>                          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>id <span class="uscript-operator">&gt;=</span> <span class="uscript-number">0</span><span class="uscript-operator">)</span>
<span class="uscript-line">01593</span>                          <span class="uscript-operator">{</span>
<span class="uscript-line">01594</span>                              TempPCS<span class="uscript-operator">.</span>AddMap<span class="uscript-operator">(</span>AllPCSMaps<span class="uscript-operator">[</span><span class="uscript-type">int</span><span class="uscript-operator">(</span>IncludeMaps<span class="uscript-operator">.</span>getItem<span class="uscript-operator">(</span>id<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">]</span><span class="uscript-operator">.</span>MapName<span class="uscript-operator">,</span><span class="uscript-type">int</span><span class="uscript-operator">(</span>IncludeMaps<span class="uscript-operator">.</span>getTag<span class="uscript-operator">(</span>id<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01595</span>                              MovedMaps<span class="uscript-operator">.</span>CopyFromId<span class="uscript-operator">(</span>IncludeMaps<span class="uscript-operator">,</span> id<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01596</span>                          <span class="uscript-operator">}</span>
<span class="uscript-line">01597</span>                          <span class="uscript-keyword">else</span>
<span class="uscript-line">01598</span>                              Log<span class="uscript-operator">(</span>ErrorExcludeMapNotFound<span class="uscript-operator">@</span>Req<span class="uscript-operator">.</span>GetVariableNumber<span class="uscript-operator">(</span><span class="uscript-string">"ExcludeMapsSelect"</span><span class="uscript-operator">,</span> i<span class="uscript-operator">)</span><span class="uscript-operator">,</span>LOGNAME<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01599</span>                      <span class="uscript-operator">}</span>
<span class="uscript-line">01600</span>                  <span class="uscript-operator">}</span>
<span class="uscript-line">01601</span>                  <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>i<span class="uscript-operator">&lt;</span>IncludeMaps<span class="uscript-operator">.</span>Count<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">01602</span>                      TempPCS<span class="uscript-operator">.</span>AddMap<span class="uscript-operator">(</span>AllPCSMaps<span class="uscript-operator">[</span><span class="uscript-type">int</span><span class="uscript-operator">(</span>IncludeMaps<span class="uscript-operator">.</span>getItem<span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">]</span><span class="uscript-operator">.</span>MapName<span class="uscript-operator">,</span>i<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01603</span>  
<span class="uscript-line">01604</span>                  CreateSessionInfo<span class="uscript-operator">(</span>NewProfile<span class="uscript-operator">,</span>SID<span class="uscript-operator">,</span><span class="uscript-keyword">false</span><span class="uscript-operator">,</span><span class="uscript-keyword">true</span><span class="uscript-operator">,</span><span class="uscript-keyword">True</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01605</span>              <span class="uscript-operator">}</span>
<span class="uscript-line">01606</span>  
<span class="uscript-line">01607</span>              <span class="uscript-keyword">else</span> <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span><span class="uscript-string">"DelMap"</span><span class="uscript-operator">,</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span> <span class="uscript-operator">!=</span> <span class="uscript-string">""</span> <span class="uscript-operator">&amp;&amp;</span> Req<span class="uscript-operator">.</span>GetVariableCount<span class="uscript-operator">(</span><span class="uscript-string">"IncludeMapsSelect"</span><span class="uscript-operator">)</span> <span class="uscript-operator">&gt;</span> <span class="uscript-number">0</span><span class="uscript-operator">)</span>
<span class="uscript-line">01608</span>              <span class="uscript-operator">{</span>
<span class="uscript-line">01609</span>                  Count <span class="uscript-operator">=</span> Req<span class="uscript-operator">.</span>GetVariableCount<span class="uscript-operator">(</span><span class="uscript-string">"IncludeMapsSelect"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01610</span>                  <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span> i<span class="uscript-operator">&lt;</span>Count<span class="uscript-operator">;</span> i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">01611</span>                  <span class="uscript-operator">{</span>
<span class="uscript-line">01612</span>                      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>RequiredMaps<span class="uscript-operator">.</span>FindItemId<span class="uscript-operator">(</span>ProfileMaps<span class="uscript-operator">.</span>GetItem<span class="uscript-operator">(</span>ProfileMaps<span class="uscript-operator">.</span>FindTagId<span class="uscript-operator">(</span>Req<span class="uscript-operator">.</span>GetVariableNumber<span class="uscript-operator">(</span><span class="uscript-string">"IncludeMapsSelect"</span><span class="uscript-operator">,</span> i<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">&lt;</span> <span class="uscript-number">0</span><span class="uscript-operator">)</span>
<span class="uscript-line">01613</span>                      <span class="uscript-operator">{</span>
<span class="uscript-line">01614</span>                          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>IncludeMaps<span class="uscript-operator">.</span>Count<span class="uscript-operator">(</span><span class="uscript-operator">)</span> <span class="uscript-operator">&gt;</span> <span class="uscript-number">0</span><span class="uscript-operator">)</span>
<span class="uscript-line">01615</span>                          <span class="uscript-operator">{</span>
<span class="uscript-line">01616</span>                              id <span class="uscript-operator">=</span> ExcludeMaps<span class="uscript-operator">.</span>MoveFromId<span class="uscript-operator">(</span>IncludeMaps<span class="uscript-operator">,</span> IncludeMaps<span class="uscript-operator">.</span>FindItemId<span class="uscript-operator">(</span>ProfileMaps<span class="uscript-operator">.</span>GetItem<span class="uscript-operator">(</span>ProfileMaps<span class="uscript-operator">.</span>FindTagId<span class="uscript-operator">(</span>Req<span class="uscript-operator">.</span>GetVariableNumber<span class="uscript-operator">(</span><span class="uscript-string">"IncludeMapsSelect"</span><span class="uscript-operator">,</span> i<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01617</span>                              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>id <span class="uscript-operator">&gt;=</span> <span class="uscript-number">0</span><span class="uscript-operator">)</span>
<span class="uscript-line">01618</span>                              <span class="uscript-operator">{</span>
<span class="uscript-line">01619</span>                                  TempPCS<span class="uscript-operator">.</span>RemoveMap<span class="uscript-operator">(</span>AllPCSMaps<span class="uscript-operator">[</span><span class="uscript-type">int</span><span class="uscript-operator">(</span>ExcludeMaps<span class="uscript-operator">.</span>GetItem<span class="uscript-operator">(</span>id<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">]</span><span class="uscript-operator">.</span>MapName<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01620</span>                                  MovedMaps<span class="uscript-operator">.</span>CopyFromId<span class="uscript-operator">(</span>ExcludeMaps<span class="uscript-operator">,</span> id<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01621</span>                              <span class="uscript-operator">}</span>
<span class="uscript-line">01622</span>                              <span class="uscript-keyword">else</span>
<span class="uscript-line">01623</span>                                  Log<span class="uscript-operator">(</span>ErrorIncludeMapNotFound<span class="uscript-operator">@</span>Req<span class="uscript-operator">.</span>GetVariableNumber<span class="uscript-operator">(</span><span class="uscript-string">"IncludeMapsSelect"</span><span class="uscript-operator">,</span> i<span class="uscript-operator">)</span><span class="uscript-operator">,</span>LOGNAME<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01624</span>                          <span class="uscript-operator">}</span>
<span class="uscript-line">01625</span>                      <span class="uscript-operator">}</span>
<span class="uscript-line">01626</span>                  <span class="uscript-operator">}</span>
<span class="uscript-line">01627</span>                  CreateSessionInfo<span class="uscript-operator">(</span>NewProfile<span class="uscript-operator">,</span>SID<span class="uscript-operator">,</span><span class="uscript-keyword">false</span><span class="uscript-operator">,</span><span class="uscript-keyword">true</span><span class="uscript-operator">,</span><span class="uscript-keyword">True</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01628</span>              <span class="uscript-operator">}</span>
<span class="uscript-line">01629</span>              <span class="uscript-keyword">else</span> <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span><span class="uscript-string">"AddAllMap"</span><span class="uscript-operator">,</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span> <span class="uscript-operator">!=</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">01630</span>              <span class="uscript-operator">{</span>
<span class="uscript-line">01631</span>                  <span class="uscript-keyword">while</span> <span class="uscript-operator">(</span>ExcludeMaps<span class="uscript-operator">.</span>Count<span class="uscript-operator">(</span><span class="uscript-operator">)</span> <span class="uscript-operator">&gt;</span> <span class="uscript-number">0</span> <span class="uscript-operator">&amp;&amp;</span> <span class="uscript-operator">(</span>IncludeMaps<span class="uscript-operator">.</span>Count<span class="uscript-operator">(</span><span class="uscript-operator">)</span> <span class="uscript-operator">&lt;</span> TempPCS<span class="uscript-operator">.</span>MaxMaps <span class="uscript-operator">||</span> TempPCS<span class="uscript-operator">.</span>MaxMaps <span class="uscript-operator">==</span> <span class="uscript-number">0</span><span class="uscript-operator">)</span> <span class="uscript-operator">)</span>
<span class="uscript-line">01632</span>                  <span class="uscript-operator">{</span>
<span class="uscript-line">01633</span>                      id <span class="uscript-operator">=</span> IncludeMaps<span class="uscript-operator">.</span>MoveFromId<span class="uscript-operator">(</span>ExcludeMaps<span class="uscript-operator">,</span> ExcludeMaps<span class="uscript-operator">.</span>Count<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">-</span><span class="uscript-number">1</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01634</span>                      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>id <span class="uscript-operator">&gt;=</span> <span class="uscript-number">0</span><span class="uscript-operator">)</span>
<span class="uscript-line">01635</span>                      <span class="uscript-operator">{</span>
<span class="uscript-line">01636</span>                          TempPCS<span class="uscript-operator">.</span>AddMap<span class="uscript-operator">(</span>AllPCSMaps<span class="uscript-operator">[</span><span class="uscript-type">int</span><span class="uscript-operator">(</span>IncludeMaps<span class="uscript-operator">.</span>getItem<span class="uscript-operator">(</span>id<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">]</span><span class="uscript-operator">.</span>MapName<span class="uscript-operator">,</span><span class="uscript-type">int</span><span class="uscript-operator">(</span>IncludeMaps<span class="uscript-operator">.</span>getTag<span class="uscript-operator">(</span>id<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01637</span>                          MovedMaps<span class="uscript-operator">.</span>CopyFromId<span class="uscript-operator">(</span>IncludeMaps<span class="uscript-operator">,</span> id<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01638</span>                      <span class="uscript-operator">}</span>
<span class="uscript-line">01639</span>                  <span class="uscript-operator">}</span>
<span class="uscript-line">01640</span>                  <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>i<span class="uscript-operator">&lt;</span>IncludeMaps<span class="uscript-operator">.</span>Count<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">01641</span>                      TempPCS<span class="uscript-operator">.</span>AddMap<span class="uscript-operator">(</span>AllPCSMaps<span class="uscript-operator">[</span><span class="uscript-type">int</span><span class="uscript-operator">(</span>IncludeMaps<span class="uscript-operator">.</span>getItem<span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">]</span><span class="uscript-operator">.</span>MapName<span class="uscript-operator">,</span>i<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01642</span>                 CreateSessionInfo<span class="uscript-operator">(</span>NewProfile<span class="uscript-operator">,</span>SID<span class="uscript-operator">,</span><span class="uscript-keyword">false</span><span class="uscript-operator">,</span><span class="uscript-keyword">true</span><span class="uscript-operator">,</span><span class="uscript-keyword">True</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01643</span>              <span class="uscript-operator">}</span>
<span class="uscript-line">01644</span>              <span class="uscript-keyword">else</span> <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span><span class="uscript-string">"DelAllMap"</span><span class="uscript-operator">,</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span> <span class="uscript-operator">!=</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">01645</span>              <span class="uscript-operator">{</span>
<span class="uscript-line">01646</span>                  i <span class="uscript-operator">=</span> IncludeMaps<span class="uscript-operator">.</span>Count<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01647</span>                  <span class="uscript-keyword">while</span> <span class="uscript-operator">(</span>i <span class="uscript-operator">&gt;</span> <span class="uscript-number">0</span> <span class="uscript-operator">&amp;&amp;</span> IncludeMaps<span class="uscript-operator">.</span>Count<span class="uscript-operator">(</span><span class="uscript-operator">)</span> <span class="uscript-operator">&gt;</span> RequiredMaps<span class="uscript-operator">.</span>Count<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">01648</span>                  <span class="uscript-operator">{</span>
<span class="uscript-line">01649</span>                      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>RequiredMaps<span class="uscript-operator">.</span>FindItemId<span class="uscript-operator">(</span>IncludeMaps<span class="uscript-operator">.</span>GetItem<span class="uscript-operator">(</span>i<span class="uscript-number">-1</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">&lt;</span> <span class="uscript-number">0</span><span class="uscript-operator">)</span>
<span class="uscript-line">01650</span>                      <span class="uscript-operator">{</span>
<span class="uscript-line">01651</span>                          id <span class="uscript-operator">=</span>  ExcludeMaps<span class="uscript-operator">.</span>MoveFromId<span class="uscript-operator">(</span>IncludeMaps<span class="uscript-operator">,</span> i<span class="uscript-number">-1</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01652</span>                          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>id <span class="uscript-operator">&gt;=</span> <span class="uscript-number">0</span><span class="uscript-operator">)</span>
<span class="uscript-line">01653</span>                          <span class="uscript-operator">{</span>
<span class="uscript-line">01654</span>                              TempPCS<span class="uscript-operator">.</span>RemoveMap<span class="uscript-operator">(</span>AllPCSMaps<span class="uscript-operator">[</span><span class="uscript-type">int</span><span class="uscript-operator">(</span>ExcludeMaps<span class="uscript-operator">.</span>GetItem<span class="uscript-operator">(</span>id<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">]</span><span class="uscript-operator">.</span>MapName<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01655</span>                              MovedMaps<span class="uscript-operator">.</span>CopyFromId<span class="uscript-operator">(</span>ExcludeMaps<span class="uscript-operator">,</span> id<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01656</span>                          <span class="uscript-operator">}</span>
<span class="uscript-line">01657</span>                      <span class="uscript-operator">}</span>
<span class="uscript-line">01658</span>                      i<span class="uscript-operator">--</span><span class="uscript-operator">;</span>
<span class="uscript-line">01659</span>                  <span class="uscript-operator">}</span>
<span class="uscript-line">01660</span>                  CreateSessionInfo<span class="uscript-operator">(</span>NewProfile<span class="uscript-operator">,</span>SID<span class="uscript-operator">,</span><span class="uscript-keyword">false</span><span class="uscript-operator">,</span><span class="uscript-keyword">true</span><span class="uscript-operator">,</span><span class="uscript-keyword">True</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01661</span>              <span class="uscript-operator">}</span>
<span class="uscript-line">01662</span>              <span class="uscript-keyword">else</span> <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span><span class="uscript-string">"MoveMap"</span><span class="uscript-operator">,</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span> <span class="uscript-operator">!=</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">01663</span>              <span class="uscript-operator">{</span>
<span class="uscript-line">01664</span>                  MoveCount <span class="uscript-operator">=</span> <span class="uscript-type">int</span><span class="uscript-operator">(</span>Abs<span class="uscript-operator">(</span><span class="uscript-type">float</span><span class="uscript-operator">(</span>Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span><span class="uscript-string">"MoveMapCount"</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01665</span>                  <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>MoveCount <span class="uscript-operator">!=</span> <span class="uscript-number">0</span><span class="uscript-operator">)</span>
<span class="uscript-line">01666</span>                  <span class="uscript-operator">{</span>
<span class="uscript-line">01667</span>                      Count <span class="uscript-operator">=</span> Req<span class="uscript-operator">.</span>GetVariableCount<span class="uscript-operator">(</span><span class="uscript-string">"IncludeMapsSelect"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01668</span>  
<span class="uscript-line">01669</span>                      <span class="uscript-comment">// 1) Create a sorted MovedMaps list</span>
<span class="uscript-line">01670</span>                      <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i <span class="uscript-operator">=</span> <span class="uscript-number">0</span><span class="uscript-operator">;</span> i<span class="uscript-operator">&lt;</span>Count<span class="uscript-operator">;</span> i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">01671</span>                          MovedMaps<span class="uscript-operator">.</span>CopyFromId<span class="uscript-operator">(</span>IncludeMaps<span class="uscript-operator">,</span> IncludeMaps<span class="uscript-operator">.</span>FindItemId<span class="uscript-operator">(</span>ProfileMaps<span class="uscript-operator">.</span>GetItem<span class="uscript-operator">(</span>ProfileMaps<span class="uscript-operator">.</span>FindTagId<span class="uscript-operator">(</span>Req<span class="uscript-operator">.</span>GetVariableNumber<span class="uscript-operator">(</span><span class="uscript-string">"IncludeMapsSelect"</span><span class="uscript-operator">,</span> i<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01672</span>  
<span class="uscript-line">01673</span>                      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span><span class="uscript-string">"MoveMap"</span><span class="uscript-operator">)</span> <span class="uscript-operator">~=</span> <span class="uscript-string">"Down"</span><span class="uscript-operator">)</span>
<span class="uscript-line">01674</span>                      <span class="uscript-operator">{</span>
<span class="uscript-line">01675</span>                          <span class="uscript-comment">// 2) Browse from Last to 0 until all maps are moved by count</span>
<span class="uscript-line">01676</span>                          <span class="uscript-comment">//    but stop moving them if hitting bottom</span>
<span class="uscript-line">01677</span>                          <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i <span class="uscript-operator">=</span> IncludeMaps<span class="uscript-operator">.</span>Count<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">-</span><span class="uscript-number">1</span><span class="uscript-operator">;</span> i <span class="uscript-operator">&gt;=</span> <span class="uscript-number">0</span><span class="uscript-operator">;</span> i<span class="uscript-operator">--</span><span class="uscript-operator">)</span>
<span class="uscript-line">01678</span>                              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>MovedMaps<span class="uscript-operator">.</span>FindItemId<span class="uscript-operator">(</span>IncludeMaps<span class="uscript-operator">.</span>GetItem<span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">&gt;=</span> <span class="uscript-number">0</span><span class="uscript-operator">)</span>
<span class="uscript-line">01679</span>                                  IncludeMaps<span class="uscript-operator">.</span>ShiftStrict<span class="uscript-operator">(</span>i<span class="uscript-operator">,</span> MoveCount<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01680</span>                      <span class="uscript-operator">}</span>
<span class="uscript-line">01681</span>                      <span class="uscript-keyword">else</span>
<span class="uscript-line">01682</span>                      <span class="uscript-operator">{</span>
<span class="uscript-line">01683</span>                          MoveCount <span class="uscript-operator">=</span> <span class="uscript-operator">-</span>MoveCount<span class="uscript-operator">;</span>
<span class="uscript-line">01684</span>                          <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i <span class="uscript-operator">=</span> <span class="uscript-number">0</span><span class="uscript-operator">;</span> i<span class="uscript-operator">&lt;</span>IncludeMaps<span class="uscript-operator">.</span>Count<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">01685</span>                              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>MovedMaps<span class="uscript-operator">.</span>FindItemId<span class="uscript-operator">(</span>IncludeMaps<span class="uscript-operator">.</span>GetItem<span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">&gt;=</span> <span class="uscript-number">0</span><span class="uscript-operator">)</span>
<span class="uscript-line">01686</span>                                  IncludeMaps<span class="uscript-operator">.</span>ShiftStrict<span class="uscript-operator">(</span>i<span class="uscript-operator">,</span> MoveCount<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01687</span>                      <span class="uscript-operator">}</span>
<span class="uscript-line">01688</span>                  <span class="uscript-operator">}</span>
<span class="uscript-line">01689</span>  
<span class="uscript-line">01690</span>                  <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>i<span class="uscript-operator">&lt;</span>IncludeMaps<span class="uscript-operator">.</span>Count<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">01691</span>                      TempPCS<span class="uscript-operator">.</span>AddMap<span class="uscript-operator">(</span>AllPCSMaps<span class="uscript-operator">[</span><span class="uscript-type">int</span><span class="uscript-operator">(</span>IncludeMaps<span class="uscript-operator">.</span>getItem<span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">]</span><span class="uscript-operator">.</span>MapName<span class="uscript-operator">,</span>i<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01692</span>  
<span class="uscript-line">01693</span>                  CreateSessionInfo<span class="uscript-operator">(</span>NewProfile<span class="uscript-operator">,</span>SID<span class="uscript-operator">,</span><span class="uscript-keyword">false</span><span class="uscript-operator">,</span><span class="uscript-keyword">true</span><span class="uscript-operator">,</span><span class="uscript-keyword">True</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01694</span>              <span class="uscript-operator">}</span>
<span class="uscript-line">01695</span>  
<span class="uscript-line">01696</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>TempPCS<span class="uscript-operator">.</span>CanEdit<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">01697</span>                  TempPCS<span class="uscript-operator">.</span>StartEdit<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01698</span>  <span class="uscript-comment">// Mutator Section</span>
<span class="uscript-line">01699</span>              Mutators<span class="uscript-operator">.</span>Reset<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01700</span>      <span class="uscript-comment">// Set active ServerActors</span>
<span class="uscript-line">01701</span>              TempMutes <span class="uscript-operator">=</span> LoadActiveProfileServerActors<span class="uscript-operator">(</span>NewProfile<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01702</span>              TempStr <span class="uscript-operator">=</span> <span class="uscript-keyword">class</span><span class="uscript-name">'wUtils103.wArray'</span><span class="uscript-operator">.</span><span class="uscript-keyword">static</span><span class="uscript-operator">.</span>Join<span class="uscript-operator">(</span>TempMutes<span class="uscript-operator">,</span><span class="uscript-string">","</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01703</span>  
<span class="uscript-line">01704</span>              bAllMuts <span class="uscript-operator">=</span> TempMutes<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span> <span class="uscript-operator">==</span> ConfigM<span class="uscript-operator">.</span>ManagedActors<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">;</span>
<span class="uscript-line">01705</span>  
<span class="uscript-line">01706</span>              <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>i<span class="uscript-operator">&lt;</span>AllPCSServerActors<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">;</span>i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">01707</span>              <span class="uscript-operator">{</span>
<span class="uscript-line">01708</span>                  <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>j <span class="uscript-operator">=</span> <span class="uscript-number">0</span><span class="uscript-operator">;</span> j <span class="uscript-operator">&lt;</span> ConfigM<span class="uscript-operator">.</span>ManagedActors<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">;</span> j<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">01709</span>                  <span class="uscript-operator">{</span>
<span class="uscript-line">01710</span>                      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>AllPCSServerActors<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>ActorClass <span class="uscript-operator">~=</span> <span class="uscript-type">string</span><span class="uscript-operator">(</span>ConfigM<span class="uscript-operator">.</span>ManagedActors<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>SAClass<span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">01711</span>                      <span class="uscript-operator">{</span>
<span class="uscript-line">01712</span>                          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>AllPCSServerActors<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>bRequired<span class="uscript-operator">)</span>
<span class="uscript-line">01713</span>                              ReqSA<span class="uscript-operator">.</span>Add<span class="uscript-operator">(</span><span class="uscript-type">string</span><span class="uscript-operator">(</span>j<span class="uscript-operator">)</span><span class="uscript-operator">,</span> ConfigM<span class="uscript-operator">.</span>ManagedActors<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>SAName<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01714</span>                          <span class="uscript-keyword">else</span> ServerActors<span class="uscript-operator">.</span>Add<span class="uscript-operator">(</span><span class="uscript-type">string</span><span class="uscript-operator">(</span>j<span class="uscript-operator">)</span><span class="uscript-operator">,</span>ConfigM<span class="uscript-operator">.</span>ManagedActors<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>SAName<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01715</span>                          <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>
<span class="uscript-line">01716</span>                      <span class="uscript-operator">}</span>
<span class="uscript-line">01717</span>                  <span class="uscript-operator">}</span>
<span class="uscript-line">01718</span>              <span class="uscript-operator">}</span>
<span class="uscript-line">01719</span>              TempMutes <span class="uscript-operator">=</span> LoadActiveProfileMutators<span class="uscript-operator">(</span>NewProfile<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01720</span>              TempStr <span class="uscript-operator">=</span> <span class="uscript-keyword">class</span><span class="uscript-name">'wUtils103.wArray'</span><span class="uscript-operator">.</span><span class="uscript-keyword">static</span><span class="uscript-operator">.</span>Join<span class="uscript-operator">(</span>TempMutes<span class="uscript-operator">,</span><span class="uscript-string">","</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01721</span>          <span class="uscript-comment">// Set Available Mutators for this profile</span>
<span class="uscript-line">01722</span>              bAllMuts <span class="uscript-operator">=</span> bAllMuts <span class="uscript-operator">&amp;&amp;</span> AllPCSMutators<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span> <span class="uscript-operator">==</span> AllMutators<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">;</span>
<span class="uscript-line">01723</span>              <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>i<span class="uscript-operator">&lt;</span>AllPCSMutators<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">;</span>i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">01724</span>              <span class="uscript-operator">{</span>
<span class="uscript-line">01725</span>                  <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>j<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>j<span class="uscript-operator">&lt;</span>AllMutators<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">;</span>j<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">01726</span>                  <span class="uscript-operator">{</span>
<span class="uscript-line">01727</span>                      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>AllMutators<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>ClassName <span class="uscript-operator">~=</span> AllPCSMutators<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>MutatorName<span class="uscript-operator">)</span>
<span class="uscript-line">01728</span>                      <span class="uscript-operator">{</span>
<span class="uscript-line">01729</span>                          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>AllPCSMutators<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>bRequired<span class="uscript-operator">)</span>
<span class="uscript-line">01730</span>                              Required<span class="uscript-operator">.</span>Add<span class="uscript-operator">(</span><span class="uscript-type">string</span><span class="uscript-operator">(</span>j<span class="uscript-operator">)</span><span class="uscript-operator">,</span>AllMutators<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>FriendlyName<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01731</span>                          <span class="uscript-keyword">else</span>
<span class="uscript-line">01732</span>                          <span class="uscript-operator">{</span>
<span class="uscript-line">01733</span>                      <span class="uscript-comment">// Don't add available mutator if it belongs in the same group as a required mutator</span>
<span class="uscript-line">01734</span>                              <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>k<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>k<span class="uscript-operator">&lt;</span>Required<span class="uscript-operator">.</span>Count<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>k<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">01735</span>                                  <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>AllMutators<span class="uscript-operator">[</span><span class="uscript-type">int</span><span class="uscript-operator">(</span>Required<span class="uscript-operator">.</span>GetItem<span class="uscript-operator">(</span>k<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">]</span><span class="uscript-operator">.</span>GroupName <span class="uscript-operator">~=</span> AllMutators<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>GroupName<span class="uscript-operator">)</span>
<span class="uscript-line">01736</span>                                      <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>
<span class="uscript-line">01737</span>                              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>k<span class="uscript-operator">==</span>Required<span class="uscript-operator">.</span>Count<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">01738</span>                                  Mutators<span class="uscript-operator">.</span>Add<span class="uscript-operator">(</span><span class="uscript-type">string</span><span class="uscript-operator">(</span>j<span class="uscript-operator">)</span><span class="uscript-operator">,</span>AllPCSMutators<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>MutatorName<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01739</span>                          <span class="uscript-operator">}</span>
<span class="uscript-line">01740</span>                          <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>
<span class="uscript-line">01741</span>                      <span class="uscript-operator">}</span>
<span class="uscript-line">01742</span>                  <span class="uscript-operator">}</span>
<span class="uscript-line">01743</span>              <span class="uscript-operator">}</span>
<span class="uscript-line">01744</span>  <span class="uscript-comment">// BEGIN OUTPUT ////////////////////////////////////////////</span>
<span class="uscript-line">01745</span>  <span class="uscript-comment">/*
<span class="uscript-line">01746</span>      TempMutes is an array of active mutators, including required ones
<span class="uscript-line">01747</span>      AllPCSMutators is a ProfileMutator array, which includes a required flag
<span class="uscript-line">01748</span>  
<span class="uscript-line">01749</span>      Need to generate a regular mutator selection list, but list all required
<span class="uscript-line">01750</span>      first, followed by the list of all other mutators which are available
<span class="uscript-line">01751</span>  */</span>
<span class="uscript-line">01752</span>  <span class="uscript-comment">// MAPS</span>
<span class="uscript-line">01753</span>              Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SpanLength"</span><span class="uscript-operator">,</span> <span class="uscript-string">"2"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01754</span>              Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SpanContent"</span><span class="uscript-operator">,</span> <span class="uscript-string">"&amp;nbsp;&amp;nbsp;"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01755</span>              EmptyRow <span class="uscript-operator">=</span> <span class="uscript-string">"&lt;tr&gt;"</span> <span class="uscript-operator">$</span> WebInclude<span class="uscript-operator">(</span>CellColSpan<span class="uscript-operator">)</span> <span class="uscript-operator">$</span> <span class="uscript-string">"&lt;/tr&gt;"</span><span class="uscript-operator">;</span>
<span class="uscript-line">01756</span>  
<span class="uscript-line">01757</span>              Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SectionName"</span><span class="uscript-operator">,</span> TableTitle<span class="uscript-operator">[</span><span class="uscript-number">3</span><span class="uscript-operator">]</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01758</span>              TempStr <span class="uscript-operator">=</span> <span class="uscript-type">string</span><span class="uscript-operator">(</span>TempPCS<span class="uscript-operator">.</span>GetMaxMaps<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01759</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>TempStr <span class="uscript-operator">==</span> <span class="uscript-string">"0"</span><span class="uscript-operator">)</span> TempStr <span class="uscript-operator">=</span> <span class="uscript-string">"Unlimited"</span><span class="uscript-operator">;</span>
<span class="uscript-line">01760</span>              Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SpecialInstructions"</span><span class="uscript-operator">,</span> LabelMaxMaps<span class="uscript-operator">$</span><span class="uscript-string">":"</span><span class="uscript-operator">@</span>TempStr<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01761</span>              EditRows <span class="uscript-operator">+=</span> WebInclude<span class="uscript-operator">(</span>IncludeSection<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01762</span>  
<span class="uscript-line">01763</span>              j <span class="uscript-operator">=</span> RequiredMaps<span class="uscript-operator">.</span>Count<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01764</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>j <span class="uscript-operator">&gt;</span> <span class="uscript-number">0</span><span class="uscript-operator">)</span>
<span class="uscript-line">01765</span>              <span class="uscript-operator">{</span>
<span class="uscript-line">01766</span>                  EditRows <span class="uscript-operator">=</span> EditRows <span class="uscript-operator">$</span> EmptyRow <span class="uscript-operator">$</span> <span class="uscript-string">"&lt;tr&gt;&lt;td class=ttext&gt;"</span> <span class="uscript-operator">$</span> RequiredText <span class="uscript-operator">@</span> MapText <span class="uscript-operator">$</span> <span class="uscript-string">"&lt;/td&gt;&lt;td class=ttext&gt;"</span> <span class="uscript-operator">$</span> FollowingMaps<span class="uscript-operator">@</span>AreAssignedText <span class="uscript-operator">$</span> <span class="uscript-string">"&lt;/td&gt;&lt;/tr&gt;"</span><span class="uscript-operator">;</span>
<span class="uscript-line">01767</span>                  i<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>
<span class="uscript-line">01768</span>                  <span class="uscript-keyword">while</span> <span class="uscript-operator">(</span>i<span class="uscript-operator">&lt;</span>j<span class="uscript-operator">)</span>
<span class="uscript-line">01769</span>                  <span class="uscript-operator">{</span>
<span class="uscript-line">01770</span>                      Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SettingName"</span><span class="uscript-operator">,</span> AllPCSMaps<span class="uscript-operator">[</span><span class="uscript-type">int</span><span class="uscript-operator">(</span>RequiredMaps<span class="uscript-operator">.</span>GetItem<span class="uscript-operator">(</span>i<span class="uscript-operator">++</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">]</span><span class="uscript-operator">.</span>MapName<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01771</span>                      Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SettingData"</span><span class="uscript-operator">,</span> StringIf<span class="uscript-operator">(</span>i <span class="uscript-operator">&lt;</span> j<span class="uscript-operator">,</span> AllPCSMaps<span class="uscript-operator">[</span><span class="uscript-type">int</span><span class="uscript-operator">(</span>RequiredMaps<span class="uscript-operator">.</span>GetItem<span class="uscript-operator">(</span>i<span class="uscript-operator">++</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">]</span><span class="uscript-operator">.</span>MapName<span class="uscript-operator">,</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01772</span>  
<span class="uscript-line">01773</span>                      Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"Extra"</span><span class="uscript-operator">,</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01774</span>                      EditRows <span class="uscript-operator">+=</span> WebInclude<span class="uscript-operator">(</span>IncludeRows<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01775</span>                  <span class="uscript-operator">}</span>
<span class="uscript-line">01776</span>              <span class="uscript-operator">}</span>
<span class="uscript-line">01777</span>  
<span class="uscript-line">01778</span>              EditRows <span class="uscript-operator">=</span> EditRows <span class="uscript-operator">$</span> EmptyRow <span class="uscript-operator">$</span> <span class="uscript-string">"&lt;tr&gt;&lt;td class=ttext&gt;"</span> <span class="uscript-operator">$</span> AvailableText<span class="uscript-operator">@</span>MapText <span class="uscript-operator">$</span> <span class="uscript-string">"&lt;/td&gt;&lt;td class=ttext&gt;"</span> <span class="uscript-operator">$</span> LabelChangeMaplist <span class="uscript-operator">$</span> <span class="uscript-string">"&lt;/td&gt;&lt;/tr&gt;"</span><span class="uscript-operator">;</span>
<span class="uscript-line">01779</span>  
<span class="uscript-line">01780</span>              Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"ExcludeMapsOptions"</span><span class="uscript-operator">,</span> CreateMapListSelect<span class="uscript-operator">(</span>AllPCSMaps<span class="uscript-operator">,</span> ExcludeMaps<span class="uscript-operator">,</span>MovedMaps<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01781</span>              Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"IncludeMapsOptions"</span><span class="uscript-operator">,</span> CreateMapListSelect<span class="uscript-operator">(</span>AllPCSMaps<span class="uscript-operator">,</span> IncludeMaps<span class="uscript-operator">,</span>MovedMaps<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01782</span>              Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SpanContent"</span><span class="uscript-operator">,</span> WebInclude<span class="uscript-operator">(</span>IncludeMapSelect<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01783</span>              Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"RowContent"</span><span class="uscript-operator">,</span> WebInclude<span class="uscript-operator">(</span>CellColSpan<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01784</span>              EditRows <span class="uscript-operator">+=</span> WebInclude<span class="uscript-operator">(</span>RowLeft<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01785</span>  
<span class="uscript-line">01786</span>  <span class="uscript-comment">// MUTATORS</span>
<span class="uscript-line">01787</span>              CreateFullMutatorList<span class="uscript-operator">(</span>Mutators<span class="uscript-operator">,</span>GroupsOnly<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01788</span>              Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SectionName"</span><span class="uscript-operator">,</span> TableTitle<span class="uscript-operator">[</span><span class="uscript-number">2</span><span class="uscript-operator">]</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01789</span>              Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SpecialInstructions"</span><span class="uscript-operator">,</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01790</span>              EditRows <span class="uscript-operator">+=</span> WebInclude<span class="uscript-operator">(</span>IncludeSection<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01791</span>  
<span class="uscript-line">01792</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>ReqSA<span class="uscript-operator">.</span>Count<span class="uscript-operator">(</span><span class="uscript-operator">)</span> <span class="uscript-operator">&gt;</span> <span class="uscript-number">0</span> <span class="uscript-operator">||</span> Required<span class="uscript-operator">.</span>Count<span class="uscript-operator">(</span><span class="uscript-operator">)</span> <span class="uscript-operator">&gt;</span> <span class="uscript-number">0</span><span class="uscript-operator">)</span>
<span class="uscript-line">01793</span>                  EditRows <span class="uscript-operator">=</span> EditRows <span class="uscript-operator">$</span> EmptyRow <span class="uscript-operator">$</span> <span class="uscript-string">"&lt;tr&gt;&lt;td class=ttext&gt;"</span> <span class="uscript-operator">$</span> RequiredText<span class="uscript-operator">@</span>MutatorText <span class="uscript-operator">$</span> <span class="uscript-string">"&lt;/td&gt;&lt;td class=ttext&gt;"</span> <span class="uscript-operator">$</span> FollowingMutators<span class="uscript-operator">@</span>AreAssignedText <span class="uscript-operator">$</span> <span class="uscript-string">"&lt;/td&gt;&lt;/tr&gt;"</span><span class="uscript-operator">;</span>
<span class="uscript-line">01794</span>  <span class="uscript-comment">// Include ServerActors first</span>
<span class="uscript-line">01795</span>              <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>i<span class="uscript-operator">&lt;</span>ReqSA<span class="uscript-operator">.</span>Count<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">01796</span>              <span class="uscript-operator">{</span>
<span class="uscript-line">01797</span>                  j <span class="uscript-operator">=</span> <span class="uscript-type">int</span><span class="uscript-operator">(</span>ReqSA<span class="uscript-operator">.</span>GetItem<span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01798</span>                  Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SettingName"</span><span class="uscript-operator">,</span> ReqSA<span class="uscript-operator">.</span>GetTag<span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01799</span>                  Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SettingData"</span><span class="uscript-operator">,</span> ConfigM<span class="uscript-operator">.</span>ManagedActors<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>SADescription<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01800</span>                  Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"Extra"</span><span class="uscript-operator">,</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01801</span>  
<span class="uscript-line">01802</span>                  EditRows <span class="uscript-operator">+=</span> WebInclude<span class="uscript-operator">(</span>IncludeRows<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01803</span>              <span class="uscript-operator">}</span>
<span class="uscript-line">01804</span>  
<span class="uscript-line">01805</span>              <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>i<span class="uscript-operator">&lt;</span>Required<span class="uscript-operator">.</span>Count<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">01806</span>              <span class="uscript-operator">{</span>
<span class="uscript-line">01807</span>                  j<span class="uscript-operator">=</span><span class="uscript-type">int</span><span class="uscript-operator">(</span>Required<span class="uscript-operator">.</span>GetItem<span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01808</span>                  Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SettingName"</span><span class="uscript-operator">,</span> AllMutators<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>FriendlyName<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01809</span>                  Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SettingData"</span><span class="uscript-operator">,</span> AllMutators<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>Description<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01810</span>                  Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"Extra"</span><span class="uscript-operator">,</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01811</span>  
<span class="uscript-line">01812</span>                  EditRows <span class="uscript-operator">+=</span> WebInclude<span class="uscript-operator">(</span>IncludeRows<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01813</span>              <span class="uscript-operator">}</span>
<span class="uscript-line">01814</span>  
<span class="uscript-line">01815</span>              EditRows <span class="uscript-operator">=</span> EditRows <span class="uscript-operator">$</span> EmptyRow <span class="uscript-operator">$</span> <span class="uscript-string">"&lt;tr&gt;&lt;td class=ttext&gt;"</span> <span class="uscript-operator">$</span> AvailableText<span class="uscript-operator">@</span>MutatorText <span class="uscript-operator">$</span> <span class="uscript-string">"&lt;/td&gt;&lt;td class=ttext&gt;"</span> <span class="uscript-operator">$</span> FollowingMutators<span class="uscript-operator">@</span>AreAvailableText <span class="uscript-operator">$</span> <span class="uscript-string">"&lt;/td&gt;&lt;/tr&gt;"</span><span class="uscript-operator">;</span>
<span class="uscript-line">01816</span>              <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>i<span class="uscript-operator">&lt;</span>GroupsOnly<span class="uscript-operator">.</span>Count<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">01817</span>              <span class="uscript-operator">{</span>
<span class="uscript-line">01818</span>                  j<span class="uscript-operator">=</span><span class="uscript-type">int</span><span class="uscript-operator">(</span>GroupsOnly<span class="uscript-operator">.</span>GetItem<span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01819</span>                  <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>AllMutators<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>GroupName<span class="uscript-operator">==</span><span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">01820</span>                      thisgroup<span class="uscript-operator">=</span><span class="uscript-string">"Z"</span><span class="uscript-operator">$</span><span class="uscript-type">string</span><span class="uscript-operator">(</span>z<span class="uscript-operator">++</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01821</span>                  <span class="uscript-keyword">else</span> thisgroup <span class="uscript-operator">=</span> AllMutators<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>GroupName<span class="uscript-operator">;</span>
<span class="uscript-line">01822</span>                  <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span> <span class="uscript-operator">(</span>i <span class="uscript-operator">+</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> GroupsOnly<span class="uscript-operator">.</span>Count<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">01823</span>                      nextgroup <span class="uscript-operator">=</span> <span class="uscript-string">""</span><span class="uscript-operator">;</span>
<span class="uscript-line">01824</span>                  <span class="uscript-keyword">else</span>
<span class="uscript-line">01825</span>                  <span class="uscript-operator">{</span>
<span class="uscript-line">01826</span>                  <span class="uscript-comment">// Assign nextgroup to the next mutators group</span>
<span class="uscript-line">01827</span>                      k <span class="uscript-operator">=</span> <span class="uscript-type">int</span><span class="uscript-operator">(</span>GroupsOnly<span class="uscript-operator">.</span>GetItem<span class="uscript-operator">(</span>i <span class="uscript-operator">+</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01828</span>                      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>AllMutators<span class="uscript-operator">[</span>k<span class="uscript-operator">]</span><span class="uscript-operator">.</span>GroupName<span class="uscript-operator">==</span><span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">01829</span>                          nextgroup<span class="uscript-operator">=</span><span class="uscript-string">"Z"</span><span class="uscript-operator">$</span><span class="uscript-type">string</span><span class="uscript-operator">(</span>z<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01830</span>                      <span class="uscript-keyword">else</span> nextgroup <span class="uscript-operator">=</span> AllMutators<span class="uscript-operator">[</span>k<span class="uscript-operator">]</span><span class="uscript-operator">.</span>GroupName<span class="uscript-operator">;</span>
<span class="uscript-line">01831</span>                  <span class="uscript-operator">}</span>
<span class="uscript-line">01832</span>  
<span class="uscript-line">01833</span>                  Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"GroupName"</span><span class="uscript-operator">,</span> thisgroup<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01834</span>                  Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"MutatorClass"</span><span class="uscript-operator">,</span> AllMutators<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>ClassName<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01835</span>                  Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"MutatorName"</span><span class="uscript-operator">,</span> AllMutators<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>FriendlyName<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01836</span>                  Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"MutatorDesc"</span><span class="uscript-operator">,</span> AllMutators<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>Description<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01837</span>  
<span class="uscript-line">01838</span>                  <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">(</span>lastgroup <span class="uscript-operator">!=</span> thisgroup<span class="uscript-operator">)</span> <span class="uscript-operator">&amp;&amp;</span> <span class="uscript-operator">(</span>thisgroup <span class="uscript-operator">==</span> nextgroup<span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-comment">// and the next mut is in the same group as this one</span>
<span class="uscript-line">01839</span>                  <span class="uscript-operator">{</span>
<span class="uscript-line">01840</span>                      Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"Checked"</span><span class="uscript-operator">,</span> <span class="uscript-string">" checked"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01841</span>                      EditRows <span class="uscript-operator">+=</span> WebInclude<span class="uscript-operator">(</span><span class="uscript-string">"current_mutators_group"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01842</span>                  <span class="uscript-operator">}</span>
<span class="uscript-line">01843</span>  
<span class="uscript-line">01844</span>                  Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"Checked"</span><span class="uscript-operator">,</span> StringIf<span class="uscript-operator">(</span>CurS<span class="uscript-operator">.</span>HasMutator<span class="uscript-operator">(</span>AllMutators<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>ClassName<span class="uscript-operator">)</span><span class="uscript-operator">,</span> <span class="uscript-string">" checked"</span><span class="uscript-operator">,</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01845</span>                  EditRows <span class="uscript-operator">+=</span> WebInclude<span class="uscript-operator">(</span><span class="uscript-string">"current_mutators_group_row"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01846</span>  
<span class="uscript-line">01847</span>                  lastgroup<span class="uscript-operator">=</span>thisgroup<span class="uscript-operator">;</span>
<span class="uscript-line">01848</span>              <span class="uscript-operator">}</span>
<span class="uscript-line">01849</span>  <span class="uscript-comment">// Add ServerActors first</span>
<span class="uscript-line">01850</span>              <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i <span class="uscript-operator">=</span> <span class="uscript-number">0</span><span class="uscript-operator">;</span> i <span class="uscript-operator">&lt;</span> ServerActors<span class="uscript-operator">.</span>Count<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">01851</span>              <span class="uscript-operator">{</span>
<span class="uscript-line">01852</span>                  TempStr <span class="uscript-operator">=</span> <span class="uscript-string">""</span><span class="uscript-operator">;</span>
<span class="uscript-line">01853</span>                  j <span class="uscript-operator">=</span> <span class="uscript-type">int</span><span class="uscript-operator">(</span>ServerActors<span class="uscript-operator">.</span>GetItem<span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01854</span>  
<span class="uscript-line">01855</span>                  Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"Content"</span><span class="uscript-operator">,</span> Checkbox<span class="uscript-operator">(</span><span class="uscript-type">string</span><span class="uscript-operator">(</span>ConfigM<span class="uscript-operator">.</span>ManagedActors<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>SAClass<span class="uscript-operator">)</span><span class="uscript-operator">,</span> CurS<span class="uscript-operator">.</span>HasServerActor<span class="uscript-operator">(</span><span class="uscript-type">string</span><span class="uscript-operator">(</span>ConfigM<span class="uscript-operator">.</span>ManagedActors<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>SAClass<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">$</span> <span class="uscript-string">"&amp;nbsp;"</span> <span class="uscript-operator">$</span> ServerActors<span class="uscript-operator">.</span>GetTag<span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01856</span>                  TempStr <span class="uscript-operator">=</span> WebInclude<span class="uscript-operator">(</span>NowrapLeft<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01857</span>                  Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"Content"</span><span class="uscript-operator">,</span> ConfigM<span class="uscript-operator">.</span>ManagedActors<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>SADescription<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01858</span>                  Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"RowContent"</span><span class="uscript-operator">,</span> TempStr <span class="uscript-operator">$</span> WebInclude<span class="uscript-operator">(</span>CellLeft<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01859</span>                  EditRows <span class="uscript-operator">+=</span> WebInclude<span class="uscript-operator">(</span>RowLeft<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01860</span>              <span class="uscript-operator">}</span>
<span class="uscript-line">01861</span>  
<span class="uscript-line">01862</span>              <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i <span class="uscript-operator">=</span> <span class="uscript-number">0</span><span class="uscript-operator">;</span> i<span class="uscript-operator">&lt;</span>Mutators<span class="uscript-operator">.</span>Count<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">01863</span>              <span class="uscript-operator">{</span>
<span class="uscript-line">01864</span>                  TempStr <span class="uscript-operator">=</span> <span class="uscript-string">""</span><span class="uscript-operator">;</span>
<span class="uscript-line">01865</span>                  j <span class="uscript-operator">=</span> <span class="uscript-type">int</span><span class="uscript-operator">(</span>Mutators<span class="uscript-operator">.</span>GetItem<span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01866</span>  
<span class="uscript-line">01867</span>                  Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"Content"</span><span class="uscript-operator">,</span> Checkbox<span class="uscript-operator">(</span>AllMutators<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>ClassName<span class="uscript-operator">,</span>CurS<span class="uscript-operator">.</span>HasMutator<span class="uscript-operator">(</span>AllMutators<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>ClassName<span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">$</span> <span class="uscript-string">"&amp;nbsp;"</span> <span class="uscript-operator">$</span> AllMutators<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>FriendlyName<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01868</span>                  TempStr <span class="uscript-operator">+=</span> WebInclude<span class="uscript-operator">(</span>NowrapLeft<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01869</span>                  Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"Content"</span><span class="uscript-operator">,</span> AllMutators<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>Description<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01870</span>                  Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"RowContent"</span><span class="uscript-operator">,</span> TempStr <span class="uscript-operator">$</span> WebInclude<span class="uscript-operator">(</span>CellLeft<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01871</span>                  EditRows <span class="uscript-operator">+=</span> WebInclude<span class="uscript-operator">(</span>RowLeft<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01872</span>              <span class="uscript-operator">}</span>
<span class="uscript-line">01873</span>              TempPCS<span class="uscript-operator">.</span>EndEdit<span class="uscript-operator">(</span><span class="uscript-keyword">False</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01874</span>          <span class="uscript-operator">}</span>
<span class="uscript-line">01875</span>      <span class="uscript-comment">// We have no profile currently active</span>
<span class="uscript-line">01876</span>          <span class="uscript-keyword">else</span>
<span class="uscript-line">01877</span>          <span class="uscript-operator">{</span>
<span class="uscript-line">01878</span>              Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SettingName"</span><span class="uscript-operator">,</span> PageCaption<span class="uscript-operator">[</span><span class="uscript-number">0</span><span class="uscript-operator">]</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01879</span>              EditRows <span class="uscript-operator">+=</span> WebInclude<span class="uscript-operator">(</span>IncludeRows<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01880</span>          <span class="uscript-operator">}</span>
<span class="uscript-line">01881</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"TableRows"</span><span class="uscript-operator">,</span> EditRows<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01882</span>          TempStr <span class="uscript-operator">=</span> <span class="uscript-string">""</span><span class="uscript-operator">;</span>
<span class="uscript-line">01883</span>          TempStr <span class="uscript-operator">=</span> WebInclude<span class="uscript-operator">(</span>IncludeCaptionButton<span class="uscript-operator">)</span><span class="uscript-operator">$</span>Tmp<span class="uscript-operator">$</span>WebInclude<span class="uscript-operator">(</span>IncludeTable<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01884</span>  
<span class="uscript-line">01885</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>NewProfile <span class="uscript-operator">!=</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">01886</span>          <span class="uscript-operator">{</span>
<span class="uscript-line">01887</span>              Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"ButtonName"</span><span class="uscript-operator">,</span> curS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"ButtonName"</span><span class="uscript-operator">,</span><span class="uscript-string">"ApplyProfileChanges"</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01888</span>              Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"ButtonValue"</span><span class="uscript-operator">,</span> ButtonApplyProfileChanges<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01889</span>              Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"PageCaption"</span><span class="uscript-operator">,</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01890</span>              TempStr <span class="uscript-operator">+=</span> WebInclude<span class="uscript-operator">(</span>IncludeCaptionButton<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01891</span>          <span class="uscript-operator">}</span>
<span class="uscript-line">01892</span>  
<span class="uscript-line">01893</span>          Tmp <span class="uscript-operator">=</span> CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"ProfileName"</span><span class="uscript-operator">,</span>PageCaption<span class="uscript-operator">[</span><span class="uscript-number">0</span><span class="uscript-operator">]</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01894</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>LadderRules<span class="uscript-operator">.</span>GetRemainingMatches<span class="uscript-operator">(</span><span class="uscript-operator">)</span> <span class="uscript-operator">&gt;</span> <span class="uscript-number">0</span> <span class="uscript-operator">&amp;&amp;</span> Tmp <span class="uscript-operator">==</span> LadderRules<span class="uscript-operator">.</span>Profiles<span class="uscript-operator">[</span>GetCurrentConfigIndex<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">]</span><span class="uscript-operator">.</span>ProfileName<span class="uscript-operator">)</span>
<span class="uscript-line">01895</span>              Tmp <span class="uscript-operator">=</span> Tmp <span class="uscript-operator">@</span> LabelNumberMatchesLeft <span class="uscript-operator">@</span> <span class="uscript-type">string</span><span class="uscript-operator">(</span>LadderRules<span class="uscript-operator">.</span>GetRemainingMatches<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01896</span>  
<span class="uscript-line">01897</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"LadderTable"</span><span class="uscript-operator">,</span>    TempStr<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01898</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"Section"</span><span class="uscript-operator">,</span>        LinkEditProfile<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01899</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SubTitle"</span><span class="uscript-operator">,</span>       Tmp<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01900</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"PageHelp"</span><span class="uscript-operator">,</span>       HelpEditProfile<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01901</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"PostAction"</span><span class="uscript-operator">,</span>     ProfileEditURI<span class="uscript-operator">$</span><span class="uscript-string">"?SessionID="</span><span class="uscript-operator">$</span>SID<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01902</span>          ShowPage<span class="uscript-operator">(</span>Res<span class="uscript-operator">,</span> MasterPage<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01903</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">01904</span>  
<span class="uscript-line">01905</span>      <span class="uscript-keyword">else</span> AccessDenied<span class="uscript-operator">(</span>Res<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01906</span>  <span class="uscript-operator">}</span>
<span class="uscript-line">01907</span>  
<span class="uscript-line">01908</span>  <span class="uscript-keyword">function</span> QueryLadderSwitch<span class="uscript-operator">(</span>WebRequest Req<span class="uscript-operator">,</span> WebResponse Res<span class="uscript-operator">)</span>
<span class="uscript-line">01909</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">01910</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">int</span>       j<span class="uscript-operator">,</span> NumMatches<span class="uscript-operator">;</span>
<span class="uscript-line">01911</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">bool</span>      bDelayChange<span class="uscript-operator">,</span> bSwitching<span class="uscript-operator">;</span>
<span class="uscript-line">01912</span>      <span class="uscript-keyword">local</span> Session   CurS<span class="uscript-operator">;</span>
<span class="uscript-line">01913</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">string</span>    SID<span class="uscript-operator">,</span>
<span class="uscript-line">01914</span>                      TempStr<span class="uscript-operator">,</span> Tmp<span class="uscript-operator">,</span>
<span class="uscript-line">01915</span>                      Checked<span class="uscript-operator">;</span>
<span class="uscript-line">01916</span>  
<span class="uscript-line">01917</span>      SID <span class="uscript-operator">=</span> Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span><span class="uscript-string">"SessionID"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01918</span>      CurS <span class="uscript-operator">=</span> SMaster<span class="uscript-operator">.</span>getSession<span class="uscript-operator">(</span>SID<span class="uscript-operator">,</span><span class="uscript-keyword">true</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01919</span>  
<span class="uscript-line">01920</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>CanPerform<span class="uscript-operator">(</span><span class="uscript-string">"Ls"</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">01921</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">01922</span>          TempStr <span class="uscript-operator">=</span> Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span><span class="uscript-string">"ProfileNameSelect"</span><span class="uscript-operator">,</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01923</span>          Tmp <span class="uscript-operator">=</span> Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span><span class="uscript-string">"SetNewProfile"</span><span class="uscript-operator">,</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01924</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>Tmp <span class="uscript-operator">!=</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">01925</span>          <span class="uscript-operator">{</span>
<span class="uscript-line">01926</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>TempStr <span class="uscript-operator">!=</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">01927</span>              <span class="uscript-operator">{</span>
<span class="uscript-line">01928</span>                  NumMatches <span class="uscript-operator">=</span> <span class="uscript-type">int</span><span class="uscript-operator">(</span>Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span><span class="uscript-string">"NumMatches"</span><span class="uscript-operator">,</span> <span class="uscript-string">"0"</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01929</span>                  bDelayChange <span class="uscript-operator">=</span> Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span><span class="uscript-string">"DelaySwitch"</span><span class="uscript-operator">,</span><span class="uscript-string">""</span><span class="uscript-operator">)</span> <span class="uscript-operator">!=</span> <span class="uscript-string">""</span><span class="uscript-operator">;</span>
<span class="uscript-line">01930</span>                  <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>bDelayChange<span class="uscript-operator">)</span>
<span class="uscript-line">01931</span>                  <span class="uscript-operator">{</span>
<span class="uscript-line">01932</span>                      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>LadderRules<span class="uscript-operator">.</span>WaitApplyProfile<span class="uscript-operator">(</span>TempStr<span class="uscript-operator">,</span> NumMatches<span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">01933</span>                      <span class="uscript-operator">{</span>
<span class="uscript-line">01934</span>                          CurS<span class="uscript-operator">.</span>setValue<span class="uscript-operator">(</span><span class="uscript-string">"ProfileIndex"</span><span class="uscript-operator">,</span> TempStr<span class="uscript-operator">,</span> <span class="uscript-keyword">True</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01935</span>                          bSwitching <span class="uscript-operator">=</span> <span class="uscript-keyword">True</span><span class="uscript-operator">;</span>
<span class="uscript-line">01936</span>                      <span class="uscript-operator">}</span>
<span class="uscript-line">01937</span>                  <span class="uscript-operator">}</span>
<span class="uscript-line">01938</span>                  <span class="uscript-keyword">else</span>
<span class="uscript-line">01939</span>                  <span class="uscript-operator">{</span>
<span class="uscript-line">01940</span>                  <span class="uscript-comment">// We would like to switch immediately</span>
<span class="uscript-line">01941</span>                      LadderRules<span class="uscript-operator">.</span>ApplyProfile<span class="uscript-operator">(</span>TempStr<span class="uscript-operator">,</span> NumMatches<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01942</span>                      MapIsChanging<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01943</span>                      <span class="uscript-keyword">return</span><span class="uscript-operator">;</span>
<span class="uscript-line">01944</span>                  <span class="uscript-operator">}</span>
<span class="uscript-line">01945</span>              <span class="uscript-operator">}</span>
<span class="uscript-line">01946</span>              <span class="uscript-keyword">else</span> StatusError<span class="uscript-operator">(</span>Res<span class="uscript-operator">,</span> ErrorNoProfilesExist<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01947</span>          <span class="uscript-operator">}</span>
<span class="uscript-line">01948</span>  
<span class="uscript-line">01949</span>          <span class="uscript-keyword">else</span> <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>LadderRules<span class="uscript-operator">.</span>Profiles<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span> <span class="uscript-operator">&gt;</span> <span class="uscript-number">0</span><span class="uscript-operator">)</span>
<span class="uscript-line">01950</span>          <span class="uscript-operator">{</span>
<span class="uscript-line">01951</span>              j <span class="uscript-operator">=</span> GetCurrentConfigIndex<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01952</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>j <span class="uscript-operator">&gt;=</span> <span class="uscript-number">0</span><span class="uscript-operator">)</span> TempStr <span class="uscript-operator">=</span> <span class="uscript-type">string</span><span class="uscript-operator">(</span>j<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01953</span>          <span class="uscript-operator">}</span>
<span class="uscript-line">01954</span>  
<span class="uscript-line">01955</span>          bDelayChange <span class="uscript-operator">=</span> Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span><span class="uscript-string">"DelaySwitch"</span><span class="uscript-operator">,</span><span class="uscript-string">""</span><span class="uscript-operator">)</span> <span class="uscript-operator">!=</span> <span class="uscript-string">""</span> <span class="uscript-operator">||</span> LadderRules<span class="uscript-operator">.</span>bWaitingToSwitch<span class="uscript-operator">;</span>
<span class="uscript-line">01956</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>bDelayChange<span class="uscript-operator">)</span>
<span class="uscript-line">01957</span>              Checked <span class="uscript-operator">=</span> <span class="uscript-string">" checked"</span><span class="uscript-operator">;</span>
<span class="uscript-line">01958</span>          <span class="uscript-keyword">else</span> Checked <span class="uscript-operator">=</span> <span class="uscript-string">""</span><span class="uscript-operator">;</span>
<span class="uscript-line">01959</span>  
<span class="uscript-line">01960</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"ProfileSelect"</span><span class="uscript-operator">,</span>      GenerateSwitchProfileOptions<span class="uscript-operator">(</span>TempStr<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01961</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"NumberGamesText"</span><span class="uscript-operator">,</span>    LabelNumberGames<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01962</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"TextName"</span><span class="uscript-operator">,</span>           <span class="uscript-string">"NumMatches"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01963</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"TextValue"</span><span class="uscript-operator">,</span>          <span class="uscript-type">string</span><span class="uscript-operator">(</span>NumMatches<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01964</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"TextSize"</span><span class="uscript-operator">,</span>           <span class="uscript-string">"3"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01965</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"TextLength"</span><span class="uscript-operator">,</span>         <span class="uscript-string">"3"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01966</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SwitchButtonName"</span><span class="uscript-operator">,</span>   <span class="uscript-string">"SetNewProfile"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01967</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SwitchButtonValue"</span><span class="uscript-operator">,</span>  ButtonLoadProfile<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01968</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"DelayCheckName"</span><span class="uscript-operator">,</span>     <span class="uscript-string">"DelaySwitch"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01969</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"Checked"</span><span class="uscript-operator">,</span>            Checked<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01970</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"DelayCheckLabel"</span><span class="uscript-operator">,</span>    LabelDelayProfileChange<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01971</span>  
<span class="uscript-line">01972</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>Tmp <span class="uscript-operator">!=</span> <span class="uscript-string">""</span> <span class="uscript-operator">&amp;&amp;</span> bSwitching<span class="uscript-operator">)</span>
<span class="uscript-line">01973</span>              StatusOK<span class="uscript-operator">(</span>Res<span class="uscript-operator">,</span> SuccessSwitchProfile<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01974</span>  
<span class="uscript-line">01975</span>          Tmp <span class="uscript-operator">=</span> CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"ProfileName"</span><span class="uscript-operator">,</span> PageCaption<span class="uscript-operator">[</span><span class="uscript-number">0</span><span class="uscript-operator">]</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01976</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>LadderRules<span class="uscript-operator">.</span>GetRemainingMatches<span class="uscript-operator">(</span><span class="uscript-operator">)</span> <span class="uscript-operator">&gt;</span> <span class="uscript-number">0</span> <span class="uscript-operator">&amp;&amp;</span> Tmp <span class="uscript-operator">==</span> LadderRules<span class="uscript-operator">.</span>Profiles<span class="uscript-operator">[</span>GetCurrentConfigIndex<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">]</span><span class="uscript-operator">.</span>ProfileName<span class="uscript-operator">)</span>
<span class="uscript-line">01977</span>              Tmp <span class="uscript-operator">=</span> Tmp <span class="uscript-operator">@</span> LabelNumberMatchesLeft <span class="uscript-operator">@</span> <span class="uscript-type">string</span><span class="uscript-operator">(</span>LadderRules<span class="uscript-operator">.</span>GetRemainingMatches<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01978</span>  
<span class="uscript-line">01979</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"LadderTable"</span><span class="uscript-operator">,</span>    WebInclude<span class="uscript-operator">(</span>IncludeSwitch<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01980</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"Section"</span><span class="uscript-operator">,</span>        LinkSwitchProfile<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01981</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SubTitle"</span><span class="uscript-operator">,</span>       Tmp<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01982</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"PageHelp"</span><span class="uscript-operator">,</span>       HelpSwitchProfile<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01983</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"PostAction"</span><span class="uscript-operator">,</span>     ProfileSwitchURI<span class="uscript-operator">$</span><span class="uscript-string">"?SessionID="</span><span class="uscript-operator">$</span>SID<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01984</span>  
<span class="uscript-line">01985</span>          ShowPage<span class="uscript-operator">(</span>Res<span class="uscript-operator">,</span> MasterPage<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01986</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">01987</span>      <span class="uscript-keyword">else</span> AccessDenied<span class="uscript-operator">(</span>Res<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01988</span>  <span class="uscript-operator">}</span>
<span class="uscript-line">01989</span>  
<span class="uscript-line">01990</span>  <span class="uscript-keyword">function</span> QuerySubImport<span class="uscript-operator">(</span>WebRequest Req<span class="uscript-operator">,</span> WebResponse Res<span class="uscript-operator">)</span>
<span class="uscript-line">01991</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">01992</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">string</span>                    SID<span class="uscript-operator">;</span>
<span class="uscript-line">01993</span>      <span class="uscript-keyword">local</span> Session                   CurS<span class="uscript-operator">;</span>
<span class="uscript-line">01994</span>      <span class="uscript-keyword">local</span> ProfileConfigSet          TempPCS<span class="uscript-operator">;</span>
<span class="uscript-line">01995</span>  
<span class="uscript-line">01996</span>      SID <span class="uscript-operator">=</span> Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span><span class="uscript-string">"SessionID"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01997</span>      CurS <span class="uscript-operator">=</span> SMaster<span class="uscript-operator">.</span>getSession<span class="uscript-operator">(</span>SID<span class="uscript-operator">,</span><span class="uscript-keyword">true</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">01998</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>CanPerform<span class="uscript-operator">(</span><span class="uscript-string">"Lm"</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">01999</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">02000</span>      <span class="uscript-comment">// We've gotten our profile - want to integrate it into the server now</span>
<span class="uscript-line">02001</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span><span class="uscript-string">"ImportRemoteProfile"</span><span class="uscript-operator">,</span><span class="uscript-string">""</span><span class="uscript-operator">)</span> <span class="uscript-operator">!=</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">02002</span>          <span class="uscript-operator">{</span>
<span class="uscript-line">02003</span>              TempPCS <span class="uscript-operator">=</span> CreateImportSessionInfo<span class="uscript-operator">(</span>CurS<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02004</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>TempPCS <span class="uscript-operator">==</span> <span class="uscript-keyword">None</span><span class="uscript-operator">)</span>
<span class="uscript-line">02005</span>              <span class="uscript-operator">{</span>
<span class="uscript-line">02006</span>                  ShowMessage<span class="uscript-operator">(</span>Res<span class="uscript-operator">,</span> ImportProfileFailTitle<span class="uscript-operator">,</span> ImportProfileFailText<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02007</span>                  <span class="uscript-keyword">return</span><span class="uscript-operator">;</span>
<span class="uscript-line">02008</span>              <span class="uscript-operator">}</span>
<span class="uscript-line">02009</span>              ShowMessage<span class="uscript-operator">(</span>Res<span class="uscript-operator">,</span> SuccessImportProfileTitle<span class="uscript-operator">,</span> SuccessImportProfile<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02010</span>              <span class="uscript-keyword">return</span><span class="uscript-operator">;</span>
<span class="uscript-line">02011</span>          <span class="uscript-operator">}</span>
<span class="uscript-line">02012</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">02013</span>  
<span class="uscript-line">02014</span>      <span class="uscript-keyword">else</span> AccessDenied<span class="uscript-operator">(</span>Res<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02015</span>  <span class="uscript-operator">}</span>
<span class="uscript-line">02016</span>  
<span class="uscript-line">02017</span>  <span class="uscript-keyword">function</span> RemoteImport<span class="uscript-operator">(</span>ProfileImporter ProfileConn<span class="uscript-operator">)</span>
<span class="uscript-line">02018</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">02019</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">int</span> i<span class="uscript-operator">,</span>j<span class="uscript-operator">;</span>
<span class="uscript-line">02020</span>      <span class="uscript-keyword">local</span> Session   CurS<span class="uscript-operator">;</span>
<span class="uscript-line">02021</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">string</span>    Tmp<span class="uscript-operator">,</span> TempStr<span class="uscript-operator">,</span>
<span class="uscript-line">02022</span>                      ImportRows<span class="uscript-operator">,</span>
<span class="uscript-line">02023</span>                      PackageLink<span class="uscript-operator">,</span>
<span class="uscript-line">02024</span>                      NewGameType<span class="uscript-operator">,</span> CustomGameLocation<span class="uscript-operator">,</span>
<span class="uscript-line">02025</span>                      NewAccessType<span class="uscript-operator">,</span> CustomAccessLocation<span class="uscript-operator">,</span>
<span class="uscript-line">02026</span>                      ImportProfileHTML<span class="uscript-operator">,</span>
<span class="uscript-line">02027</span>                      MapLocation<span class="uscript-operator">,</span> MutatorLocation<span class="uscript-operator">,</span> MutatorName<span class="uscript-operator">;</span>
<span class="uscript-line">02028</span>      <span class="uscript-keyword">local</span> StringArray ImportMaps<span class="uscript-operator">,</span> ImportMutators<span class="uscript-operator">;</span>
<span class="uscript-line">02029</span>  
<span class="uscript-line">02030</span>      <span class="uscript-keyword">local</span> WebRequest        Req<span class="uscript-operator">;</span>
<span class="uscript-line">02031</span>      <span class="uscript-keyword">local</span> WebResponse       Res<span class="uscript-operator">;</span>
<span class="uscript-line">02032</span>  
<span class="uscript-line">02033</span>      Req <span class="uscript-operator">=</span> ProfileConn<span class="uscript-operator">.</span>QueryRequest<span class="uscript-operator">;</span>
<span class="uscript-line">02034</span>      Res <span class="uscript-operator">=</span> ProfileConn<span class="uscript-operator">.</span>QueryResponse<span class="uscript-operator">;</span>
<span class="uscript-line">02035</span>  
<span class="uscript-line">02036</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>Res <span class="uscript-operator">==</span> <span class="uscript-keyword">None</span><span class="uscript-operator">)</span>
<span class="uscript-line">02037</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">02038</span>          ShowMessage<span class="uscript-operator">(</span>Res<span class="uscript-operator">,</span> ErrorText<span class="uscript-operator">,</span> ErrorTimeout<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02039</span>          <span class="uscript-keyword">return</span><span class="uscript-operator">;</span>
<span class="uscript-line">02040</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">02041</span>  
<span class="uscript-line">02042</span>      <span class="uscript-keyword">switch</span> <span class="uscript-operator">(</span>ProfileConn<span class="uscript-operator">.</span>ImportResult<span class="uscript-operator">)</span>
<span class="uscript-line">02043</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">02044</span>      <span class="uscript-keyword">case</span> IMPORT_BadURL:         ShowMessage<span class="uscript-operator">(</span>Res<span class="uscript-operator">,</span>ErrorText<span class="uscript-operator">,</span>ErrorBadURL<span class="uscript-operator">)</span><span class="uscript-operator">;</span>         CleanupQuery<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-keyword">return</span><span class="uscript-operator">;</span>
<span class="uscript-line">02045</span>      <span class="uscript-keyword">case</span> IMPORT_ResolveError:   ShowMessage<span class="uscript-operator">(</span>Res<span class="uscript-operator">,</span>ErrorText<span class="uscript-operator">,</span>ErrorResolve<span class="uscript-operator">)</span><span class="uscript-operator">;</span>        CleanupQuery<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-keyword">return</span><span class="uscript-operator">;</span>
<span class="uscript-line">02046</span>      <span class="uscript-keyword">case</span> IMPORT_BindError:      ShowMessage<span class="uscript-operator">(</span>Res<span class="uscript-operator">,</span>ErrorText<span class="uscript-operator">,</span>ErrorBind<span class="uscript-operator">)</span><span class="uscript-operator">;</span>           CleanupQuery<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-keyword">return</span><span class="uscript-operator">;</span>
<span class="uscript-line">02047</span>      <span class="uscript-keyword">case</span> IMPORT_TimeOut:        ShowMessage<span class="uscript-operator">(</span>Res<span class="uscript-operator">,</span>ErrorText<span class="uscript-operator">,</span>ErrorTimeout<span class="uscript-operator">)</span><span class="uscript-operator">;</span>        CleanupQuery<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-keyword">return</span><span class="uscript-operator">;</span>
<span class="uscript-line">02048</span>      <span class="uscript-keyword">case</span> IMPORT_ServerError:    ShowMessage<span class="uscript-operator">(</span>Res<span class="uscript-operator">,</span>ErrorText<span class="uscript-operator">,</span>ErrorServer<span class="uscript-operator">)</span><span class="uscript-operator">;</span>         CleanupQuery<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-keyword">return</span><span class="uscript-operator">;</span>
<span class="uscript-line">02049</span>      <span class="uscript-keyword">case</span> IMPORT_BadRequest:     ShowMessage<span class="uscript-operator">(</span>Res<span class="uscript-operator">,</span>ErrorText<span class="uscript-operator">,</span>ErrorBadRequest<span class="uscript-operator">)</span><span class="uscript-operator">;</span>     CleanupQuery<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-keyword">return</span><span class="uscript-operator">;</span>
<span class="uscript-line">02050</span>      <span class="uscript-keyword">case</span> IMPORT_Unauthorized:   ShowMessage<span class="uscript-operator">(</span>Res<span class="uscript-operator">,</span>ErrorText<span class="uscript-operator">,</span>ErrorUnauthorized<span class="uscript-operator">)</span><span class="uscript-operator">;</span>   CleanupQuery<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-keyword">return</span><span class="uscript-operator">;</span>
<span class="uscript-line">02051</span>      <span class="uscript-keyword">case</span> IMPORT_Forbidden:      ShowMessage<span class="uscript-operator">(</span>Res<span class="uscript-operator">,</span>ErrorText<span class="uscript-operator">,</span>ErrorForbidden<span class="uscript-operator">)</span><span class="uscript-operator">;</span>      CleanupQuery<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-keyword">return</span><span class="uscript-operator">;</span>
<span class="uscript-line">02052</span>      <span class="uscript-keyword">case</span> IMPORT_NotFound:       ShowMessage<span class="uscript-operator">(</span>Res<span class="uscript-operator">,</span>ErrorText<span class="uscript-operator">,</span>ErrorNotFound<span class="uscript-operator">)</span><span class="uscript-operator">;</span>       CleanupQuery<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-keyword">return</span><span class="uscript-operator">;</span>
<span class="uscript-line">02053</span>      <span class="uscript-keyword">case</span> IMPORT_InvalidProfile: ShowMessage<span class="uscript-operator">(</span>Res<span class="uscript-operator">,</span>ErrorText<span class="uscript-operator">,</span>ErrorProfile<span class="uscript-operator">)</span><span class="uscript-operator">;</span>        CleanupQuery<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> <span class="uscript-keyword">return</span><span class="uscript-operator">;</span>
<span class="uscript-line">02054</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">02055</span>  
<span class="uscript-line">02056</span>      CurS <span class="uscript-operator">=</span> ProfileConn<span class="uscript-operator">.</span>ImportS<span class="uscript-operator">;</span>
<span class="uscript-line">02057</span>      ImportMaps <span class="uscript-operator">=</span> <span class="uscript-keyword">new</span><span class="uscript-operator">(</span><span class="uscript-keyword">None</span><span class="uscript-operator">)</span> <span class="uscript-keyword">class</span><span class="uscript-name">'SortedStringArray'</span><span class="uscript-operator">;</span>
<span class="uscript-line">02058</span>      ImportMutators <span class="uscript-operator">=</span> <span class="uscript-keyword">new</span><span class="uscript-operator">(</span><span class="uscript-keyword">None</span><span class="uscript-operator">)</span> <span class="uscript-keyword">class</span><span class="uscript-name">'SortedStringArray'</span><span class="uscript-operator">;</span>
<span class="uscript-line">02059</span>  
<span class="uscript-line">02060</span>  <span class="uscript-comment">// General Profile Info</span>
<span class="uscript-line">02061</span>      Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SectionName"</span><span class="uscript-operator">,</span> LabelGeneralProfile<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02062</span>      Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SpecialInstructions"</span><span class="uscript-operator">,</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02063</span>      ImportRows <span class="uscript-operator">+=</span> WebInclude<span class="uscript-operator">(</span>IncludeSection<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02064</span>  
<span class="uscript-line">02065</span>      Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SettingName"</span><span class="uscript-operator">,</span> LabelProfileName<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02066</span>      Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SettingData"</span><span class="uscript-operator">,</span> CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"ProfileName"</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02067</span>      Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"Extra"</span><span class="uscript-operator">,</span><span class="uscript-string">""</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02068</span>      ImportRows <span class="uscript-operator">+=</span> WebInclude<span class="uscript-operator">(</span>IncludeRows<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02069</span>  
<span class="uscript-line">02070</span>  <span class="uscript-comment">// Profile Gametype Class</span>
<span class="uscript-line">02071</span>      NewGameType <span class="uscript-operator">=</span> CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"GameType"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02072</span>      CustomGameLocation <span class="uscript-operator">=</span> CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"CustomGameLoc"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02073</span>  
<span class="uscript-line">02074</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>CustomGameLocation <span class="uscript-operator">!=</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">02075</span>          PackageLink <span class="uscript-operator">=</span> <span class="uscript-string">"&lt;a href=\""</span><span class="uscript-operator">$</span>CustomGameLocation<span class="uscript-operator">$</span><span class="uscript-string">"\" target=\"_blank\"&gt;"</span><span class="uscript-operator">$</span>CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"GameName"</span><span class="uscript-operator">)</span><span class="uscript-operator">$</span><span class="uscript-string">"&lt;/a&gt;"</span><span class="uscript-operator">;</span>
<span class="uscript-line">02076</span>      <span class="uscript-keyword">else</span> PackageLink <span class="uscript-operator">=</span> CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"GameName"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02077</span>  
<span class="uscript-line">02078</span>      Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SettingName"</span><span class="uscript-operator">,</span> LabelGameType<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02079</span>      Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SettingData"</span><span class="uscript-operator">,</span> PackageLink<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02080</span>      Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"Extra"</span><span class="uscript-operator">,</span><span class="uscript-string">""</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02081</span>      ImportRows <span class="uscript-operator">+=</span> WebInclude<span class="uscript-operator">(</span>IncludeRows<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02082</span>  
<span class="uscript-line">02083</span>  <span class="uscript-comment">// Profile access control class</span>
<span class="uscript-line">02084</span>      NewAccessType <span class="uscript-operator">=</span> CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"ACClass"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02085</span>      CustomAccessLocation <span class="uscript-operator">=</span> CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"CustomACLoc"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02086</span>  
<span class="uscript-line">02087</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>CustomAccessLocation <span class="uscript-operator">!=</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">02088</span>          PackageLink <span class="uscript-operator">=</span> <span class="uscript-string">"&lt;a href=\""</span><span class="uscript-operator">$</span>CustomAccessLocation<span class="uscript-operator">$</span><span class="uscript-string">"\" target=\"_blank\"&gt;"</span><span class="uscript-operator">$</span>NewAccessType<span class="uscript-operator">$</span><span class="uscript-string">"&lt;/a&gt;"</span><span class="uscript-operator">;</span>
<span class="uscript-line">02089</span>      <span class="uscript-keyword">else</span> PackageLink <span class="uscript-operator">=</span> NewAccessType<span class="uscript-operator">;</span>
<span class="uscript-line">02090</span>  
<span class="uscript-line">02091</span>      Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SettingName"</span><span class="uscript-operator">,</span> LabelAccessControl<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02092</span>      Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SettingData"</span><span class="uscript-operator">,</span> PackageLink<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02093</span>      Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"Extra"</span><span class="uscript-operator">,</span><span class="uscript-string">""</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02094</span>      ImportRows <span class="uscript-operator">+=</span> WebInclude<span class="uscript-operator">(</span>IncludeRows<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02095</span>  
<span class="uscript-line">02096</span>  <span class="uscript-comment">// Map Information</span>
<span class="uscript-line">02097</span>  
<span class="uscript-line">02098</span>      Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SectionName"</span><span class="uscript-operator">,</span> TableTitle<span class="uscript-operator">[</span><span class="uscript-number">3</span><span class="uscript-operator">]</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02099</span>      Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SpecialInstructions"</span><span class="uscript-operator">,</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02100</span>      ImportRows <span class="uscript-operator">+=</span> WebInclude<span class="uscript-operator">(</span>IncludeSection<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02101</span>  
<span class="uscript-line">02102</span>      <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i <span class="uscript-operator">=</span> <span class="uscript-number">0</span><span class="uscript-operator">;</span> i <span class="uscript-operator">&lt;</span> CurS<span class="uscript-operator">.</span>getMapLength<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">02103</span>          ImportMaps<span class="uscript-operator">.</span>Add<span class="uscript-operator">(</span><span class="uscript-type">string</span><span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">,</span> <span class="uscript-type">string</span><span class="uscript-operator">(</span>CurS<span class="uscript-operator">.</span>MapOrder<span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02104</span>  
<span class="uscript-line">02105</span>      <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i <span class="uscript-operator">=</span> <span class="uscript-number">0</span><span class="uscript-operator">;</span> i <span class="uscript-operator">&lt;</span> ImportMaps<span class="uscript-operator">.</span>Count<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">02106</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">02107</span>          TempStr <span class="uscript-operator">=</span> CurS<span class="uscript-operator">.</span>getMap<span class="uscript-operator">(</span> <span class="uscript-type">int</span><span class="uscript-operator">(</span>ImportMaps<span class="uscript-operator">.</span>getItem<span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02108</span>          MapLocation <span class="uscript-operator">=</span> ProfileConn<span class="uscript-operator">.</span>FindRemoteZipLocation<span class="uscript-operator">(</span>TempStr<span class="uscript-operator">,</span>ProfileConn<span class="uscript-operator">.</span>ProfileServerAddress <span class="uscript-operator">$</span> ProfileConn<span class="uscript-operator">.</span>RemoteProfilePath<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02109</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>MapLocation <span class="uscript-operator">!=</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span> PackageLink <span class="uscript-operator">=</span> <span class="uscript-string">"&lt;a href=\""</span><span class="uscript-operator">$</span>MapLocation<span class="uscript-operator">$</span><span class="uscript-string">"\" target=\"_blank\"&gt;"</span><span class="uscript-operator">$</span>TempStr<span class="uscript-operator">$</span><span class="uscript-string">"&lt;/a&gt;"</span><span class="uscript-operator">;</span>
<span class="uscript-line">02110</span>          <span class="uscript-keyword">else</span> PackageLink <span class="uscript-operator">=</span> TempStr<span class="uscript-operator">;</span>
<span class="uscript-line">02111</span>  
<span class="uscript-line">02112</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>CurS<span class="uscript-operator">.</span>MapRequired<span class="uscript-operator">(</span> TempStr <span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">02113</span>              TempStr <span class="uscript-operator">=</span> <span class="uscript-string">"&lt;font color=\"red\"&gt;"</span><span class="uscript-operator">$</span>RequiredText<span class="uscript-operator">$</span><span class="uscript-string">"&lt;/font&gt;"</span><span class="uscript-operator">;</span>
<span class="uscript-line">02114</span>          <span class="uscript-keyword">else</span> TempStr <span class="uscript-operator">=</span> AvailableText<span class="uscript-operator">;</span>
<span class="uscript-line">02115</span>  
<span class="uscript-line">02116</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SettingName"</span><span class="uscript-operator">,</span> TempStr<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02117</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SettingData"</span><span class="uscript-operator">,</span> PackageLink<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02118</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"Extra"</span><span class="uscript-operator">,</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02119</span>          ImportRows <span class="uscript-operator">=</span> ImportRows <span class="uscript-operator">$</span> WebInclude<span class="uscript-operator">(</span>IncludeRows<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02120</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">02121</span>  
<span class="uscript-line">02122</span>  <span class="uscript-comment">// Mutator Information</span>
<span class="uscript-line">02123</span>      Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SectionName"</span><span class="uscript-operator">,</span> TableTitle<span class="uscript-operator">[</span><span class="uscript-number">2</span><span class="uscript-operator">]</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02124</span>      Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SpecialInstructions"</span><span class="uscript-operator">,</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02125</span>      ImportRows <span class="uscript-operator">+=</span> WebInclude<span class="uscript-operator">(</span>IncludeSection<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02126</span>  
<span class="uscript-line">02127</span>      <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i <span class="uscript-operator">=</span> <span class="uscript-number">0</span><span class="uscript-operator">;</span> i <span class="uscript-operator">&lt;</span> CurS<span class="uscript-operator">.</span>getMutatorLength<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">02128</span>          ImportMutators<span class="uscript-operator">.</span>Add<span class="uscript-operator">(</span><span class="uscript-type">string</span><span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">,</span> CurS<span class="uscript-operator">.</span>getMutator<span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02129</span>  
<span class="uscript-line">02130</span>      <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i <span class="uscript-operator">=</span> <span class="uscript-number">0</span><span class="uscript-operator">;</span> i <span class="uscript-operator">&lt;</span> ImportMutators<span class="uscript-operator">.</span>Count<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">02131</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">02132</span>          TempStr <span class="uscript-operator">=</span> CurS<span class="uscript-operator">.</span>getMutator<span class="uscript-operator">(</span> <span class="uscript-type">int</span><span class="uscript-operator">(</span>ImportMutators<span class="uscript-operator">.</span>getItem<span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02133</span>          <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>j<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>j<span class="uscript-operator">&lt;</span>CurS<span class="uscript-operator">.</span>getDataLength<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>j<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">02134</span>          <span class="uscript-operator">{</span>
<span class="uscript-line">02135</span>              CurS<span class="uscript-operator">.</span>getIDValue<span class="uscript-operator">(</span>j<span class="uscript-operator">,</span>MutatorName<span class="uscript-operator">,</span>Tmp<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02136</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>Tmp <span class="uscript-operator">~=</span> TempStr<span class="uscript-operator">)</span> <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>
<span class="uscript-line">02137</span>          <span class="uscript-operator">}</span>
<span class="uscript-line">02138</span>  
<span class="uscript-line">02139</span>          MutatorLocation <span class="uscript-operator">=</span> ProfileConn<span class="uscript-operator">.</span>FindRemoteZipLocation<span class="uscript-operator">(</span>TempStr<span class="uscript-operator">,</span>ProfileConn<span class="uscript-operator">.</span>ProfileServerAddress <span class="uscript-operator">$</span> ProfileConn<span class="uscript-operator">.</span>RemoteProfilePath<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02140</span>          PackageLink <span class="uscript-operator">=</span> StringIf<span class="uscript-operator">(</span>MutatorLocation <span class="uscript-operator">!=</span> <span class="uscript-string">""</span><span class="uscript-operator">,</span> <span class="uscript-string">"&lt;a href=\""</span><span class="uscript-operator">$</span>MutatorLocation<span class="uscript-operator">$</span><span class="uscript-string">"\" target=\"_blank\"&gt;"</span><span class="uscript-operator">$</span>MutatorName<span class="uscript-operator">$</span><span class="uscript-string">"&lt;/a&gt;"</span><span class="uscript-operator">,</span> MutatorName<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02141</span>          TempStr <span class="uscript-operator">=</span> Stringif<span class="uscript-operator">(</span>CurS<span class="uscript-operator">.</span>MutRequired<span class="uscript-operator">(</span>TempStr<span class="uscript-operator">)</span><span class="uscript-operator">,</span> <span class="uscript-string">"&lt;font color=\"red\"&gt;"</span><span class="uscript-operator">$</span>RequiredText<span class="uscript-operator">$</span><span class="uscript-string">"&lt;/font&gt;"</span><span class="uscript-operator">,</span> AvailableText<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02142</span>  
<span class="uscript-line">02143</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SettingName"</span><span class="uscript-operator">,</span> TempStr<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02144</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SettingData"</span><span class="uscript-operator">,</span> PackageLink<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02145</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"Extra"</span><span class="uscript-operator">,</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02146</span>          ImportRows <span class="uscript-operator">+=</span> WebInclude<span class="uscript-operator">(</span>IncludeRows<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02147</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">02148</span>  
<span class="uscript-line">02149</span>  <span class="uscript-comment">// PlayInfo Information</span>
<span class="uscript-line">02150</span>      Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SectionName"</span><span class="uscript-operator">,</span> TableTitle<span class="uscript-operator">[</span><span class="uscript-number">4</span><span class="uscript-operator">]</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02151</span>      Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SpecialInstructions"</span><span class="uscript-operator">,</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02152</span>      ImportRows <span class="uscript-operator">+=</span> WebInclude<span class="uscript-operator">(</span>IncludeSection<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02153</span>      ImportRows <span class="uscript-operator">=</span> ImportRows <span class="uscript-operator">$</span><span class="uscript-string">"&lt;tr&gt;&lt;td colspan=\"2\"&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;"</span><span class="uscript-operator">$</span> GeneratePlayInfoRows<span class="uscript-operator">(</span>Req<span class="uscript-operator">,</span>Res<span class="uscript-operator">,</span>IncludeRows<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02154</span>  
<span class="uscript-line">02155</span>  <span class="uscript-comment">// Build Subst's</span>
<span class="uscript-line">02156</span>      Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"ButtonName"</span><span class="uscript-operator">,</span> <span class="uscript-string">"ImportRemoteProfile"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02157</span>      Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"ButtonValue"</span><span class="uscript-operator">,</span> ButtonApplyImportProfile<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02158</span>      Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"PageCaption"</span><span class="uscript-operator">,</span> LabelApplyImportProfile<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02159</span>      ImportProfileHTML <span class="uscript-operator">=</span> WebInclude<span class="uscript-operator">(</span>IncludeCaptionButton<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02160</span>  
<span class="uscript-line">02161</span>      Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"TableRows"</span><span class="uscript-operator">,</span> ImportRows<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02162</span>      Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"LadderTable"</span><span class="uscript-operator">,</span> WebInclude<span class="uscript-operator">(</span>IncludeTable<span class="uscript-operator">)</span> <span class="uscript-operator">$</span> ImportProfileHTML<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02163</span>  
<span class="uscript-line">02164</span>      Tmp <span class="uscript-operator">=</span> CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"ProfileName"</span><span class="uscript-operator">,</span> PageCaption<span class="uscript-operator">[</span><span class="uscript-number">0</span><span class="uscript-operator">]</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02165</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>LadderRules<span class="uscript-operator">.</span>GetRemainingMatches<span class="uscript-operator">(</span><span class="uscript-operator">)</span> <span class="uscript-operator">&gt;</span> <span class="uscript-number">0</span> <span class="uscript-operator">&amp;&amp;</span> Tmp <span class="uscript-operator">==</span> LadderRules<span class="uscript-operator">.</span>Profiles<span class="uscript-operator">[</span>GetCurrentConfigIndex<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">]</span><span class="uscript-operator">.</span>ProfileName<span class="uscript-operator">)</span>
<span class="uscript-line">02166</span>          Tmp <span class="uscript-operator">=</span> Tmp <span class="uscript-operator">@</span> LabelNumberMatchesLeft <span class="uscript-operator">@</span> <span class="uscript-type">string</span><span class="uscript-operator">(</span>LadderRules<span class="uscript-operator">.</span>GetRemainingMatches<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02167</span>  
<span class="uscript-line">02168</span>      Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"Section"</span><span class="uscript-operator">,</span> LinkImportProfile<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02169</span>      Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SubTitle"</span><span class="uscript-operator">,</span> Tmp<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02170</span>      Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"PageHelp"</span><span class="uscript-operator">,</span> HelpImportProfile<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02171</span>      Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"PostAction"</span><span class="uscript-operator">,</span> SubImportURI<span class="uscript-operator">$</span><span class="uscript-string">"?SessionID="</span><span class="uscript-operator">$</span>CurS<span class="uscript-operator">.</span>getHash<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02172</span>      ShowPage<span class="uscript-operator">(</span>Res<span class="uscript-operator">,</span> MasterPage<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02173</span>      CleanupQuery<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02174</span>  <span class="uscript-operator">}</span>
<span class="uscript-line">02175</span>  
<span class="uscript-line">02176</span>  <span class="uscript-keyword">function</span> QuerySubExport<span class="uscript-operator">(</span>WebRequest Req<span class="uscript-operator">,</span> WebResponse Res<span class="uscript-operator">)</span>
<span class="uscript-line">02177</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">02178</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">int</span> i<span class="uscript-operator">,</span>j<span class="uscript-operator">;</span>
<span class="uscript-line">02179</span>      <span class="uscript-keyword">local</span> PlayInfo  TempPI<span class="uscript-operator">;</span>
<span class="uscript-line">02180</span>      <span class="uscript-keyword">local</span> FileLog   EProfile<span class="uscript-operator">;</span>
<span class="uscript-line">02181</span>      <span class="uscript-keyword">local</span> Session   CurS<span class="uscript-operator">;</span>
<span class="uscript-line">02182</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">string</span>    SID<span class="uscript-operator">,</span> Logname<span class="uscript-operator">,</span>
<span class="uscript-line">02183</span>                      TempStr<span class="uscript-operator">,</span> Tmp<span class="uscript-operator">,</span>
<span class="uscript-line">02184</span>                      dataname<span class="uscript-operator">,</span> datavalue<span class="uscript-operator">,</span>
<span class="uscript-line">02185</span>                      ProfileIndex<span class="uscript-operator">,</span> NewGameType<span class="uscript-operator">,</span>
<span class="uscript-line">02186</span>                      ExportRows<span class="uscript-operator">,</span> Location<span class="uscript-operator">;</span>
<span class="uscript-line">02187</span>  
<span class="uscript-line">02188</span>      <span class="uscript-keyword">local</span> <span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>GameInfo<span class="uscript-operator">&gt;</span>       GIClass<span class="uscript-operator">;</span>
<span class="uscript-line">02189</span>      <span class="uscript-keyword">local</span> <span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>AccessControl<span class="uscript-operator">&gt;</span>  ACClass<span class="uscript-operator">;</span>
<span class="uscript-line">02190</span>      <span class="uscript-keyword">local</span> <span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>Mutator<span class="uscript-operator">&gt;</span>        TempMut<span class="uscript-operator">;</span>
<span class="uscript-line">02191</span>      <span class="uscript-keyword">local</span> <span class="uscript-keyword">array</span><span class="uscript-operator">&lt;</span><span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>Mutator<span class="uscript-operator">&gt;</span> <span class="uscript-operator">&gt;</span> MClass<span class="uscript-operator">;</span>
<span class="uscript-line">02192</span>      <span class="uscript-keyword">local</span> <span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>Info<span class="uscript-operator">&gt;</span>           TempSA<span class="uscript-operator">;</span>
<span class="uscript-line">02193</span>      <span class="uscript-keyword">local</span> <span class="uscript-keyword">array</span><span class="uscript-operator">&lt;</span><span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>Info<span class="uscript-operator">&gt;</span> <span class="uscript-operator">&gt;</span>   SAClass<span class="uscript-operator">;</span>
<span class="uscript-line">02194</span>      <span class="uscript-keyword">local</span> StringArray Mutators<span class="uscript-operator">,</span>GroupsOnly<span class="uscript-operator">;</span>
<span class="uscript-line">02195</span>  
<span class="uscript-line">02196</span>  
<span class="uscript-line">02197</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>CanPerform<span class="uscript-operator">(</span><span class="uscript-string">"Lm"</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">02198</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">02199</span>          SID <span class="uscript-operator">=</span> Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span><span class="uscript-string">"SessionID"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02200</span>          CurS <span class="uscript-operator">=</span> SMaster<span class="uscript-operator">.</span>getSession<span class="uscript-operator">(</span>SID<span class="uscript-operator">,</span><span class="uscript-keyword">true</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02201</span>          ProfileIndex <span class="uscript-operator">=</span> Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span><span class="uscript-string">"ProfileNameSelect"</span><span class="uscript-operator">,</span> CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"ProfileIndex"</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02202</span>  
<span class="uscript-line">02203</span>          CreateSessionInfo<span class="uscript-operator">(</span>ProfileIndex<span class="uscript-operator">,</span>SID<span class="uscript-operator">,</span><span class="uscript-keyword">True</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02204</span>          Logname <span class="uscript-operator">=</span> CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"Logname"</span><span class="uscript-operator">,</span>Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span><span class="uscript-string">"TextInput"</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02205</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>Logname <span class="uscript-operator">==</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">02206</span>              Logname <span class="uscript-operator">=</span> CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"ProfileName"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02207</span>  
<span class="uscript-line">02208</span>          CurS<span class="uscript-operator">.</span>setValue<span class="uscript-operator">(</span><span class="uscript-string">"Logname"</span><span class="uscript-operator">,</span>Logname<span class="uscript-operator">,</span><span class="uscript-keyword">True</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02209</span>          <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>i<span class="uscript-operator">&lt;</span>CurS<span class="uscript-operator">.</span>getMutatorLength<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">02210</span>          <span class="uscript-operator">{</span>
<span class="uscript-line">02211</span>              TempStr <span class="uscript-operator">=</span> CurS<span class="uscript-operator">.</span>getMutator<span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02212</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>EpicPackage<span class="uscript-operator">(</span>TempStr<span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">02213</span>                  <span class="uscript-keyword">continue</span><span class="uscript-operator">;</span>
<span class="uscript-line">02214</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span><span class="uscript-string">"Save"</span><span class="uscript-operator">$</span>TempStr<span class="uscript-operator">,</span><span class="uscript-string">""</span><span class="uscript-operator">)</span> <span class="uscript-operator">!=</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">02215</span>                  SetLocation<span class="uscript-operator">(</span>TempStr<span class="uscript-operator">,</span>Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span>TempStr<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02216</span>          <span class="uscript-operator">}</span>
<span class="uscript-line">02217</span>  
<span class="uscript-line">02218</span>          <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>i<span class="uscript-operator">&lt;</span>CurS<span class="uscript-operator">.</span>getMapLength<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">02219</span>          <span class="uscript-operator">{</span>
<span class="uscript-line">02220</span>              TempStr <span class="uscript-operator">=</span> CurS<span class="uscript-operator">.</span>getMap<span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02221</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>EpicPackage<span class="uscript-operator">(</span>TempStr<span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">02222</span>                  <span class="uscript-keyword">continue</span><span class="uscript-operator">;</span>
<span class="uscript-line">02223</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span><span class="uscript-string">"Save"</span><span class="uscript-operator">$</span>TempStr<span class="uscript-operator">,</span><span class="uscript-string">""</span><span class="uscript-operator">)</span> <span class="uscript-operator">!=</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">02224</span>                  SetLocation<span class="uscript-operator">(</span>TempStr<span class="uscript-operator">,</span>Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span>TempStr<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02225</span>          <span class="uscript-operator">}</span>
<span class="uscript-line">02226</span>  
<span class="uscript-line">02227</span>          NewGameType <span class="uscript-operator">=</span> CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"GameType"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02228</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>NewGameType <span class="uscript-operator">!=</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">02229</span>              GIClass <span class="uscript-operator">=</span> <span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>GameInfo<span class="uscript-operator">&gt;</span><span class="uscript-operator">(</span>DynamicLoadObject<span class="uscript-operator">(</span>NewGameType<span class="uscript-operator">,</span><span class="uscript-keyword">class</span><span class="uscript-name">'Class'</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02230</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>GIClass<span class="uscript-operator">==</span><span class="uscript-keyword">None</span><span class="uscript-operator">)</span>
<span class="uscript-line">02231</span>          <span class="uscript-operator">{</span>
<span class="uscript-line">02232</span>              ShowMessage<span class="uscript-operator">(</span>Res<span class="uscript-operator">,</span>ErrorGameClassTitle<span class="uscript-operator">,</span>ErrorGameClassText<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02233</span>              <span class="uscript-keyword">return</span><span class="uscript-operator">;</span>
<span class="uscript-line">02234</span>          <span class="uscript-operator">}</span>
<span class="uscript-line">02235</span>  
<span class="uscript-line">02236</span>          TempStr <span class="uscript-operator">=</span> CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"ACClass"</span><span class="uscript-operator">,</span> Level<span class="uscript-operator">.</span>Game<span class="uscript-operator">.</span>AccessControlClass<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02237</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>TempStr <span class="uscript-operator">!=</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">02238</span>              ACClass <span class="uscript-operator">=</span> <span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>AccessControl<span class="uscript-operator">&gt;</span><span class="uscript-operator">(</span>DynamicLoadObject<span class="uscript-operator">(</span>TempStr<span class="uscript-operator">,</span><span class="uscript-keyword">class</span><span class="uscript-name">'Class'</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02239</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>ACClass <span class="uscript-operator">==</span> <span class="uscript-keyword">None</span><span class="uscript-operator">)</span>
<span class="uscript-line">02240</span>          <span class="uscript-operator">{</span>
<span class="uscript-line">02241</span>              ShowMessage<span class="uscript-operator">(</span>Res<span class="uscript-operator">,</span>ErrorAccessControlTitle<span class="uscript-operator">,</span>ErrorAccessControlText<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02242</span>              <span class="uscript-keyword">return</span><span class="uscript-operator">;</span>
<span class="uscript-line">02243</span>          <span class="uscript-operator">}</span>
<span class="uscript-line">02244</span>  
<span class="uscript-line">02245</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span><span class="uscript-string">"Export"</span><span class="uscript-operator">,</span><span class="uscript-string">""</span><span class="uscript-operator">)</span><span class="uscript-operator">!=</span><span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">02246</span>          <span class="uscript-operator">{</span>
<span class="uscript-line">02247</span>          <span class="uscript-comment">// Write file locations to .ini</span>
<span class="uscript-line">02248</span>              EProfile <span class="uscript-operator">=</span> Level<span class="uscript-operator">.</span>Spawn<span class="uscript-operator">(</span><span class="uscript-keyword">class</span><span class="uscript-name">'FileLog'</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02249</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>EProfile <span class="uscript-operator">==</span> <span class="uscript-keyword">None</span><span class="uscript-operator">)</span>
<span class="uscript-line">02250</span>              <span class="uscript-operator">{</span>
<span class="uscript-line">02251</span>                  ShowMessage<span class="uscript-operator">(</span>Res<span class="uscript-operator">,</span> ErrorText<span class="uscript-operator">,</span> ErrorExportingProfile<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02252</span>                  <span class="uscript-keyword">return</span><span class="uscript-operator">;</span>
<span class="uscript-line">02253</span>              <span class="uscript-operator">}</span>
<span class="uscript-line">02254</span>  
<span class="uscript-line">02255</span>              EProfile<span class="uscript-operator">.</span>OpenLog<span class="uscript-operator">(</span>RemoveStr<span class="uscript-operator">(</span>CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"Logname"</span><span class="uscript-operator">)</span><span class="uscript-operator">,</span><span class="uscript-string">" "</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02256</span>              EProfile<span class="uscript-operator">.</span>Logf<span class="uscript-operator">(</span><span class="uscript-string">"Profile:"</span><span class="uscript-operator">$</span>CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"ProfileName"</span><span class="uscript-operator">)</span><span class="uscript-operator">$</span>Chr<span class="uscript-operator">(</span><span class="uscript-number">21</span><span class="uscript-operator">)</span><span class="uscript-operator">$</span>CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"GameType"</span><span class="uscript-operator">)</span><span class="uscript-operator">$</span>Chr<span class="uscript-operator">(</span><span class="uscript-number">21</span><span class="uscript-operator">)</span><span class="uscript-operator">$</span>CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"MaxMaps"</span><span class="uscript-operator">)</span><span class="uscript-operator">$</span>Chr<span class="uscript-operator">(</span><span class="uscript-number">21</span><span class="uscript-operator">)</span><span class="uscript-operator">$</span>GIClass<span class="uscript-operator">.</span><span class="uscript-keyword">default</span><span class="uscript-operator">.</span>GameName<span class="uscript-operator">$</span>Chr<span class="uscript-operator">(</span><span class="uscript-number">21</span><span class="uscript-operator">)</span><span class="uscript-operator">$</span><span class="uscript-type">string</span><span class="uscript-operator">(</span>ACClass<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02257</span>  
<span class="uscript-line">02258</span>              <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>i<span class="uscript-operator">&lt;</span>CurS<span class="uscript-operator">.</span>getMapLength<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">02259</span>              <span class="uscript-operator">{</span>
<span class="uscript-line">02260</span>                  TempStr <span class="uscript-operator">=</span> CurS<span class="uscript-operator">.</span>getMap<span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02261</span>  
<span class="uscript-line">02262</span>                  <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span>TempStr<span class="uscript-operator">,</span><span class="uscript-string">""</span><span class="uscript-operator">)</span> <span class="uscript-operator">!=</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">02263</span>                      Location <span class="uscript-operator">=</span> Chr<span class="uscript-operator">(</span><span class="uscript-number">21</span><span class="uscript-operator">)</span> <span class="uscript-operator">$</span> Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span>TempStr<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02264</span>                  <span class="uscript-keyword">else</span> Location <span class="uscript-operator">=</span> <span class="uscript-string">""</span><span class="uscript-operator">;</span>
<span class="uscript-line">02265</span>  
<span class="uscript-line">02266</span>                  EProfile<span class="uscript-operator">.</span>Logf<span class="uscript-operator">(</span><span class="uscript-string">"Map:"</span><span class="uscript-operator">$</span>TempStr<span class="uscript-operator">$</span>Chr<span class="uscript-operator">(</span><span class="uscript-number">21</span><span class="uscript-operator">)</span><span class="uscript-operator">$</span>CurS<span class="uscript-operator">.</span>MapOrder<span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">$</span>Chr<span class="uscript-operator">(</span><span class="uscript-number">21</span><span class="uscript-operator">)</span><span class="uscript-operator">$</span>CurS<span class="uscript-operator">.</span>MapRequired<span class="uscript-operator">(</span>TempStr<span class="uscript-operator">)</span><span class="uscript-operator">$</span>Location<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02267</span>              <span class="uscript-operator">}</span>
<span class="uscript-line">02268</span>  
<span class="uscript-line">02269</span>              <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>i<span class="uscript-operator">&lt;</span>CurS<span class="uscript-operator">.</span>getSALength<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">02270</span>              <span class="uscript-operator">{</span>
<span class="uscript-line">02271</span>                  TempStr <span class="uscript-operator">=</span> CurS<span class="uscript-operator">.</span>getServerActor<span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02272</span>                  <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>j<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>j<span class="uscript-operator">&lt;</span>ConfigM<span class="uscript-operator">.</span>ManagedActors<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">;</span>j<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">02273</span>                      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-type">string</span><span class="uscript-operator">(</span>ConfigM<span class="uscript-operator">.</span>ManagedActors<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>SAClass<span class="uscript-operator">)</span> <span class="uscript-operator">~=</span> TempStr<span class="uscript-operator">)</span>
<span class="uscript-line">02274</span>                          DataName <span class="uscript-operator">=</span> ConfigM<span class="uscript-operator">.</span>ManagedActors<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>SAName<span class="uscript-operator">;</span>
<span class="uscript-line">02275</span>  
<span class="uscript-line">02276</span>                  <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span>TempStr<span class="uscript-operator">,</span><span class="uscript-string">""</span><span class="uscript-operator">)</span> <span class="uscript-operator">!=</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">02277</span>                      Location <span class="uscript-operator">=</span> Chr<span class="uscript-operator">(</span><span class="uscript-number">21</span><span class="uscript-operator">)</span> <span class="uscript-operator">$</span> Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span>TempStr<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02278</span>                  <span class="uscript-keyword">else</span> Location <span class="uscript-operator">=</span> <span class="uscript-string">""</span><span class="uscript-operator">;</span>
<span class="uscript-line">02279</span>  
<span class="uscript-line">02280</span>                  EProfile<span class="uscript-operator">.</span>Logf<span class="uscript-operator">(</span><span class="uscript-string">"Mutator:"</span><span class="uscript-operator">$</span>DataName<span class="uscript-operator">$</span>Chr<span class="uscript-operator">(</span><span class="uscript-number">21</span><span class="uscript-operator">)</span><span class="uscript-operator">$</span>TempStr<span class="uscript-operator">$</span>Chr<span class="uscript-operator">(</span><span class="uscript-number">21</span><span class="uscript-operator">)</span><span class="uscript-operator">$</span>CurS<span class="uscript-operator">.</span>SARequired<span class="uscript-operator">(</span>TempStr<span class="uscript-operator">)</span><span class="uscript-operator">$</span>Location<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02281</span>              <span class="uscript-operator">}</span>
<span class="uscript-line">02282</span>  
<span class="uscript-line">02283</span>              <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>i<span class="uscript-operator">&lt;</span>CurS<span class="uscript-operator">.</span>getMutatorLength<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">02284</span>              <span class="uscript-operator">{</span>
<span class="uscript-line">02285</span>                  TempStr <span class="uscript-operator">=</span> CurS<span class="uscript-operator">.</span>getMutator<span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02286</span>                  <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>j<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>j<span class="uscript-operator">&lt;</span>AllMutators<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">;</span>j<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">02287</span>                      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>AllMutators<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>ClassName <span class="uscript-operator">==</span> TempStr<span class="uscript-operator">)</span>
<span class="uscript-line">02288</span>                          DataName <span class="uscript-operator">=</span> AllMutators<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>FriendlyName<span class="uscript-operator">;</span>
<span class="uscript-line">02289</span>  
<span class="uscript-line">02290</span>                  <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span>TempStr<span class="uscript-operator">,</span><span class="uscript-string">""</span><span class="uscript-operator">)</span> <span class="uscript-operator">!=</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">02291</span>                      Location <span class="uscript-operator">=</span> Chr<span class="uscript-operator">(</span><span class="uscript-number">21</span><span class="uscript-operator">)</span> <span class="uscript-operator">$</span> Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span>TempStr<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02292</span>                  <span class="uscript-keyword">else</span> Location <span class="uscript-operator">=</span> <span class="uscript-string">""</span><span class="uscript-operator">;</span>
<span class="uscript-line">02293</span>  
<span class="uscript-line">02294</span>                  EProfile<span class="uscript-operator">.</span>Logf<span class="uscript-operator">(</span><span class="uscript-string">"Mutator:"</span><span class="uscript-operator">$</span>DataName<span class="uscript-operator">$</span>Chr<span class="uscript-operator">(</span><span class="uscript-number">21</span><span class="uscript-operator">)</span><span class="uscript-operator">$</span>TempStr<span class="uscript-operator">$</span>Chr<span class="uscript-operator">(</span><span class="uscript-number">21</span><span class="uscript-operator">)</span><span class="uscript-operator">$</span>CurS<span class="uscript-operator">.</span>MutRequired<span class="uscript-operator">(</span>TempStr<span class="uscript-operator">)</span><span class="uscript-operator">$</span>Location<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02295</span>              <span class="uscript-operator">}</span>
<span class="uscript-line">02296</span>  
<span class="uscript-line">02297</span>              i<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>
<span class="uscript-line">02298</span>              j<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>
<span class="uscript-line">02299</span>              <span class="uscript-keyword">while</span> <span class="uscript-operator">(</span>i<span class="uscript-operator">&lt;</span>CurS<span class="uscript-operator">.</span>getDataLength<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">02300</span>              <span class="uscript-operator">{</span>
<span class="uscript-line">02301</span>                  CurS<span class="uscript-operator">.</span>getIdValue<span class="uscript-operator">(</span>i<span class="uscript-operator">,</span>dataname<span class="uscript-operator">,</span>datavalue<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02302</span>                  <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>InStr<span class="uscript-operator">(</span>dataname<span class="uscript-operator">,</span><span class="uscript-string">"."</span><span class="uscript-operator">)</span> <span class="uscript-operator">!=</span> <span class="uscript-operator">-</span><span class="uscript-number">1</span><span class="uscript-operator">)</span>
<span class="uscript-line">02303</span>                      EProfile<span class="uscript-operator">.</span>Logf<span class="uscript-operator">(</span><span class="uscript-string">"Data:"</span><span class="uscript-operator">$</span>DataName<span class="uscript-operator">$</span>Chr<span class="uscript-operator">(</span><span class="uscript-number">21</span><span class="uscript-operator">)</span><span class="uscript-operator">$</span>DataValue<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02304</span>                  i<span class="uscript-operator">++</span><span class="uscript-operator">;</span>
<span class="uscript-line">02305</span>              <span class="uscript-operator">}</span>
<span class="uscript-line">02306</span>              EProfile<span class="uscript-operator">.</span>Destroy<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02307</span>              ShowMessage<span class="uscript-operator">(</span>Res<span class="uscript-operator">,</span> SuccessText<span class="uscript-operator">,</span> SuccessExportProfile<span class="uscript-operator">$</span>RemoveStr<span class="uscript-operator">(</span>LogName<span class="uscript-operator">,</span><span class="uscript-string">" "</span><span class="uscript-operator">)</span><span class="uscript-operator">$</span><span class="uscript-string">".txt"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02308</span>              <span class="uscript-keyword">return</span><span class="uscript-operator">;</span>
<span class="uscript-line">02309</span>          <span class="uscript-operator">}</span>
<span class="uscript-line">02310</span>  
<span class="uscript-line">02311</span>  
<span class="uscript-line">02312</span>      <span class="uscript-comment">// Mutator Section</span>
<span class="uscript-line">02313</span>          Mutators <span class="uscript-operator">=</span> <span class="uscript-keyword">new</span><span class="uscript-operator">(</span><span class="uscript-keyword">None</span><span class="uscript-operator">)</span> <span class="uscript-keyword">class</span><span class="uscript-name">'SortedStringArray'</span><span class="uscript-operator">;</span>
<span class="uscript-line">02314</span>          GroupsOnly <span class="uscript-operator">=</span> <span class="uscript-keyword">new</span><span class="uscript-operator">(</span><span class="uscript-keyword">None</span><span class="uscript-operator">)</span> <span class="uscript-keyword">class</span><span class="uscript-name">'SortedStringArray'</span><span class="uscript-operator">;</span>
<span class="uscript-line">02315</span>          <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>i<span class="uscript-operator">&lt;</span>CurS<span class="uscript-operator">.</span>getMutatorLength<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">02316</span>          <span class="uscript-operator">{</span>
<span class="uscript-line">02317</span>              TempStr <span class="uscript-operator">=</span> CurS<span class="uscript-operator">.</span>getMutator<span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02318</span>              <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>j<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>j<span class="uscript-operator">&lt;</span>AllMutators<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">;</span>j<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">02319</span>                  <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>TempStr <span class="uscript-operator">~=</span> AllMutators<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>ClassName<span class="uscript-operator">)</span>
<span class="uscript-line">02320</span>                      Mutators<span class="uscript-operator">.</span>Add<span class="uscript-operator">(</span><span class="uscript-type">string</span><span class="uscript-operator">(</span>j<span class="uscript-operator">)</span><span class="uscript-operator">,</span> AllMutators<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>FriendlyName<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02321</span>              TempMut <span class="uscript-operator">=</span> <span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>Mutator<span class="uscript-operator">&gt;</span><span class="uscript-operator">(</span>DynamicLoadObject<span class="uscript-operator">(</span>TempStr<span class="uscript-operator">,</span><span class="uscript-keyword">class</span><span class="uscript-name">'Class'</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02322</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>TempMut <span class="uscript-operator">!=</span> <span class="uscript-keyword">None</span><span class="uscript-operator">)</span>
<span class="uscript-line">02323</span>                  MClass<span class="uscript-operator">[</span>MClass<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">]</span> <span class="uscript-operator">=</span> TempMut<span class="uscript-operator">;</span>
<span class="uscript-line">02324</span>          <span class="uscript-operator">}</span>
<span class="uscript-line">02325</span>  
<span class="uscript-line">02326</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SectionName"</span><span class="uscript-operator">,</span> TableTitle<span class="uscript-operator">[</span><span class="uscript-number">2</span><span class="uscript-operator">]</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02327</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SpecialInstructions"</span><span class="uscript-operator">,</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02328</span>          ExportRows <span class="uscript-operator">+=</span> WebInclude<span class="uscript-operator">(</span>IncludeSection<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02329</span>  
<span class="uscript-line">02330</span>          <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i <span class="uscript-operator">=</span> <span class="uscript-number">0</span><span class="uscript-operator">;</span> i<span class="uscript-operator">&lt;</span>Mutators<span class="uscript-operator">.</span>Count<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">02331</span>          <span class="uscript-operator">{</span>
<span class="uscript-line">02332</span>              j <span class="uscript-operator">=</span> <span class="uscript-type">int</span><span class="uscript-operator">(</span>Mutators<span class="uscript-operator">.</span>GetItem<span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02333</span>  
<span class="uscript-line">02334</span>              Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SettingName"</span><span class="uscript-operator">,</span> AllMutators<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>FriendlyName<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02335</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>EpicPackage<span class="uscript-operator">(</span>AllMutators<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>ClassName<span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">02336</span>                  Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SettingData"</span><span class="uscript-operator">,</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02337</span>              <span class="uscript-keyword">else</span> Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SettingData"</span><span class="uscript-operator">,</span> Textbox<span class="uscript-operator">(</span>AllMutators<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>ClassName<span class="uscript-operator">,</span>Min<span class="uscript-operator">(</span>Max<span class="uscript-operator">(</span>GetLongestURL<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">,</span><span class="uscript-number">16</span><span class="uscript-operator">)</span><span class="uscript-operator">,</span><span class="uscript-number">64</span><span class="uscript-operator">)</span><span class="uscript-operator">,</span><span class="uscript-number">128</span><span class="uscript-operator">,</span>GetLocation<span class="uscript-operator">(</span>AllMutators<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>ClassName<span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">$</span> <span class="uscript-string">"&amp;nbsp;&amp;nbsp;"</span> <span class="uscript-operator">$</span> SubmitButton<span class="uscript-operator">(</span><span class="uscript-string">"Save"</span><span class="uscript-operator">$</span>AllMutators<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>ClassName<span class="uscript-operator">,</span>ProfileButtonName<span class="uscript-operator">[</span><span class="uscript-number">0</span><span class="uscript-operator">]</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02338</span>  
<span class="uscript-line">02339</span>              Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"Extra"</span><span class="uscript-operator">,</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02340</span>              ExportRows <span class="uscript-operator">+=</span> WebInclude<span class="uscript-operator">(</span>IncludeRows<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02341</span>          <span class="uscript-operator">}</span>
<span class="uscript-line">02342</span>  
<span class="uscript-line">02343</span>          <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>i<span class="uscript-operator">&lt;</span>CurS<span class="uscript-operator">.</span>getSALength<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">02344</span>          <span class="uscript-operator">{</span>
<span class="uscript-line">02345</span>              TempStr <span class="uscript-operator">=</span> CurS<span class="uscript-operator">.</span>getServerActor<span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02346</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>TempStr <span class="uscript-operator">!=</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">02347</span>              <span class="uscript-operator">{</span>
<span class="uscript-line">02348</span>                  TempSA <span class="uscript-operator">=</span> <span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>Info<span class="uscript-operator">&gt;</span><span class="uscript-operator">(</span>DynamicLoadObject<span class="uscript-operator">(</span>TempStr<span class="uscript-operator">,</span><span class="uscript-keyword">class</span><span class="uscript-name">'class'</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02349</span>                  <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>TempSA <span class="uscript-operator">!=</span> <span class="uscript-keyword">None</span><span class="uscript-operator">)</span>
<span class="uscript-line">02350</span>                      SAClass<span class="uscript-operator">[</span>SAClass<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">]</span> <span class="uscript-operator">=</span> TempSA<span class="uscript-operator">;</span>
<span class="uscript-line">02351</span>              <span class="uscript-operator">}</span>
<span class="uscript-line">02352</span>          <span class="uscript-operator">}</span>
<span class="uscript-line">02353</span>  
<span class="uscript-line">02354</span>          TempPI <span class="uscript-operator">=</span> <span class="uscript-keyword">new</span><span class="uscript-operator">(</span><span class="uscript-keyword">None</span><span class="uscript-operator">)</span> <span class="uscript-keyword">class</span><span class="uscript-name">'PlayInfo'</span><span class="uscript-operator">;</span>
<span class="uscript-line">02355</span>          LoadThisPlayInfo<span class="uscript-operator">(</span>TempPI<span class="uscript-operator">,</span> GIClass<span class="uscript-operator">,</span> ACClass<span class="uscript-operator">,</span> MClass<span class="uscript-operator">,</span> SAClass<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02356</span>  
<span class="uscript-line">02357</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SectionName"</span><span class="uscript-operator">,</span> TableTitle<span class="uscript-operator">[</span><span class="uscript-number">3</span><span class="uscript-operator">]</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02358</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SpecialInstructions"</span><span class="uscript-operator">,</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02359</span>          ExportRows <span class="uscript-operator">+=</span> WebInclude<span class="uscript-operator">(</span>IncludeSection<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02360</span>  
<span class="uscript-line">02361</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SettingName"</span><span class="uscript-operator">,</span> LabelMaxMaps<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02362</span>          TempStr <span class="uscript-operator">=</span> CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"MaxMaps"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02363</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>TempStr <span class="uscript-operator">==</span> <span class="uscript-string">"0"</span><span class="uscript-operator">)</span>
<span class="uscript-line">02364</span>              TempStr <span class="uscript-operator">=</span> UnlimitedText<span class="uscript-operator">;</span>
<span class="uscript-line">02365</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SettingData"</span><span class="uscript-operator">,</span> TempStr<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02366</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"Extra"</span><span class="uscript-operator">,</span> <span class="uscript-string">"&lt;tr&gt;&lt;td colspan=\"2\"&gt;&amp;nbsp;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02367</span>          ExportRows <span class="uscript-operator">+=</span> WebInclude<span class="uscript-operator">(</span>IncludeRows<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02368</span>  
<span class="uscript-line">02369</span>  <span class="uscript-comment">// Map Section</span>
<span class="uscript-line">02370</span>          <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>i<span class="uscript-operator">&lt;</span>CurS<span class="uscript-operator">.</span>getMapLength<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">02371</span>          <span class="uscript-operator">{</span>
<span class="uscript-line">02372</span>              TempStr <span class="uscript-operator">=</span> CurS<span class="uscript-operator">.</span>getMap<span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02373</span>              Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SettingName"</span><span class="uscript-operator">,</span> TempStr<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02374</span>              Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"Extra"</span><span class="uscript-operator">,</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02375</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>EpicPackage<span class="uscript-operator">(</span>TempStr<span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">02376</span>                  Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SettingData"</span><span class="uscript-operator">,</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02377</span>              <span class="uscript-keyword">else</span> Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SettingData"</span><span class="uscript-operator">,</span> Textbox<span class="uscript-operator">(</span>TempStr<span class="uscript-operator">,</span>Min<span class="uscript-operator">(</span>Max<span class="uscript-operator">(</span>GetLongestURL<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">,</span><span class="uscript-number">16</span><span class="uscript-operator">)</span><span class="uscript-operator">,</span><span class="uscript-number">64</span><span class="uscript-operator">)</span><span class="uscript-operator">,</span><span class="uscript-number">128</span><span class="uscript-operator">,</span>GetLocation<span class="uscript-operator">(</span>TempStr<span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">$</span> <span class="uscript-string">"&amp;nbsp;&amp;nbsp;"</span> <span class="uscript-operator">$</span> SubmitButton<span class="uscript-operator">(</span><span class="uscript-string">"Save"</span><span class="uscript-operator">$</span>TempStr<span class="uscript-operator">,</span>ProfileButtonName<span class="uscript-operator">[</span><span class="uscript-number">0</span><span class="uscript-operator">]</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02378</span>  
<span class="uscript-line">02379</span>              ExportRows <span class="uscript-operator">+=</span> WebInclude<span class="uscript-operator">(</span>IncludeRows<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02380</span>          <span class="uscript-operator">}</span>
<span class="uscript-line">02381</span>  
<span class="uscript-line">02382</span>  <span class="uscript-comment">// PlayInfo section</span>
<span class="uscript-line">02383</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SectionName"</span><span class="uscript-operator">,</span> TableTitle<span class="uscript-operator">[</span><span class="uscript-number">4</span><span class="uscript-operator">]</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02384</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SpecialInstructions"</span><span class="uscript-operator">,</span> <span class="uscript-string">"&amp;nbsp;&amp;nbsp;"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02385</span>          ExportRows <span class="uscript-operator">+=</span> WebInclude<span class="uscript-operator">(</span>IncludeSection<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02386</span>          ExportRows <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span><span class="uscript-string">"&lt;tr&gt;&lt;td colspan=\"2\"&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;"</span> <span class="uscript-operator">$</span> GeneratePlayInfoRows<span class="uscript-operator">(</span>Req<span class="uscript-operator">,</span> Res<span class="uscript-operator">,</span> IncludeRows<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02387</span>          ExportRows <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span><span class="uscript-string">"&lt;tr&gt;&lt;td colspan=\"2\"&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td colspan=\"2\"&gt;"</span><span class="uscript-operator">$</span>LabelApplyExportProfile<span class="uscript-operator">$</span><span class="uscript-string">"&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td colspan=\"2\"&gt;"</span><span class="uscript-operator">$</span>SubmitButton<span class="uscript-operator">(</span><span class="uscript-string">"Export"</span><span class="uscript-operator">,</span>ButtonApplyExportProfile<span class="uscript-operator">)</span><span class="uscript-operator">$</span><span class="uscript-string">"&lt;/td&gt;&lt;/tr&gt;"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02388</span>  
<span class="uscript-line">02389</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"TableRows"</span><span class="uscript-operator">,</span> ExportRows<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02390</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"LadderTable"</span><span class="uscript-operator">,</span> WebInclude<span class="uscript-operator">(</span>IncludeTable<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02391</span>  
<span class="uscript-line">02392</span>          Tmp <span class="uscript-operator">=</span> CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"ProfileName"</span><span class="uscript-operator">,</span> PageCaption<span class="uscript-operator">[</span><span class="uscript-number">0</span><span class="uscript-operator">]</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02393</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>LadderRules<span class="uscript-operator">.</span>GetRemainingMatches<span class="uscript-operator">(</span><span class="uscript-operator">)</span> <span class="uscript-operator">&gt;</span> <span class="uscript-number">0</span> <span class="uscript-operator">&amp;&amp;</span> Tmp <span class="uscript-operator">==</span> LadderRules<span class="uscript-operator">.</span>Profiles<span class="uscript-operator">[</span>GetCurrentConfigIndex<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">]</span><span class="uscript-operator">.</span>ProfileName<span class="uscript-operator">)</span>
<span class="uscript-line">02394</span>              Tmp <span class="uscript-operator">=</span> Tmp <span class="uscript-operator">@</span> LabelNumberMatchesLeft <span class="uscript-operator">@</span> <span class="uscript-type">string</span><span class="uscript-operator">(</span>LadderRules<span class="uscript-operator">.</span>GetRemainingMatches<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02395</span>  
<span class="uscript-line">02396</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"Section"</span><span class="uscript-operator">,</span> LinkExportProfile<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02397</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"PageHelp"</span><span class="uscript-operator">,</span> HelpExportProfile<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02398</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SubTitle"</span><span class="uscript-operator">,</span> Tmp<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02399</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"PostAction"</span><span class="uscript-operator">,</span> SubExportURI<span class="uscript-operator">$</span><span class="uscript-string">"?SessionID="</span><span class="uscript-operator">$</span>SID<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02400</span>          ShowPage<span class="uscript-operator">(</span>Res<span class="uscript-operator">,</span> MasterPage<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02401</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">02402</span>  
<span class="uscript-line">02403</span>      <span class="uscript-keyword">else</span> AccessDenied<span class="uscript-operator">(</span>Res<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02404</span>  <span class="uscript-operator">}</span>
<span class="uscript-line">02405</span>  
<span class="uscript-line">02406</span>  <span class="uscript-comment">//****************************************************************</span>
<span class="uscript-line">02407</span>  <span class="uscript-comment">//****************************************************************</span>
<span class="uscript-line">02408</span>  <span class="uscript-comment">// Query subpages for Add &amp; Manage Modules</span>
<span class="uscript-line">02409</span>  <span class="uscript-comment">//</span>
<span class="uscript-line">02410</span>  <span class="uscript-comment">//</span>
<span class="uscript-line">02411</span>  
<span class="uscript-line">02412</span>  <span class="uscript-comment">// Page 0</span>
<span class="uscript-line">02413</span>  <span class="uscript-keyword">function</span> QueryLadderManage<span class="uscript-operator">(</span>WebRequest Req<span class="uscript-operator">,</span> WebResponse Res<span class="uscript-operator">)</span>
<span class="uscript-line">02414</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">02415</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">string</span>    HeaderRows<span class="uscript-operator">,</span> ManagementRows<span class="uscript-operator">,</span>
<span class="uscript-line">02416</span>                      TempStr<span class="uscript-operator">,</span> Tmp<span class="uscript-operator">,</span> SID<span class="uscript-operator">;</span>
<span class="uscript-line">02417</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">bool</span>      bAdd<span class="uscript-operator">,</span> bModify<span class="uscript-operator">,</span> bCopy<span class="uscript-operator">,</span> bDelete<span class="uscript-operator">,</span> bImport<span class="uscript-operator">,</span> bExport<span class="uscript-operator">;</span>
<span class="uscript-line">02418</span>      <span class="uscript-keyword">local</span> Session   CurS<span class="uscript-operator">;</span>
<span class="uscript-line">02419</span>      <span class="uscript-keyword">local</span> ProfileImporter ProfileConn<span class="uscript-operator">;</span>
<span class="uscript-line">02420</span>  
<span class="uscript-line">02421</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>CanPerform<span class="uscript-operator">(</span><span class="uscript-string">"Lm"</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">02422</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">02423</span>          SID <span class="uscript-operator">=</span> Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span><span class="uscript-string">"SessionID"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02424</span>          CurS <span class="uscript-operator">=</span> SMaster<span class="uscript-operator">.</span>getSession<span class="uscript-operator">(</span>SID<span class="uscript-operator">,</span> <span class="uscript-keyword">True</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02425</span>  
<span class="uscript-line">02426</span>          <span class="uscript-comment">// Submit button was pressed</span>
<span class="uscript-line">02427</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span>ProfileButtonName<span class="uscript-operator">[</span><span class="uscript-number">0</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span> <span class="uscript-operator">!=</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">02428</span>          <span class="uscript-operator">{</span>
<span class="uscript-line">02429</span>              <span class="uscript-keyword">switch</span> <span class="uscript-operator">(</span>Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span><span class="uscript-string">"Actions"</span><span class="uscript-operator">,</span><span class="uscript-string">""</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">02430</span>              <span class="uscript-operator">{</span>
<span class="uscript-line">02431</span>                  <span class="uscript-keyword">case</span> <span class="uscript-string">"Add"</span>:
<span class="uscript-line">02432</span>                      bAdd <span class="uscript-operator">=</span> <span class="uscript-keyword">True</span><span class="uscript-operator">;</span>
<span class="uscript-line">02433</span>                      QuerySubFrame<span class="uscript-operator">(</span>Req<span class="uscript-operator">,</span> Res<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02434</span>                      <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>
<span class="uscript-line">02435</span>  
<span class="uscript-line">02436</span>                  <span class="uscript-keyword">case</span> <span class="uscript-string">"Modify"</span>:
<span class="uscript-line">02437</span>                      bModify <span class="uscript-operator">=</span> <span class="uscript-keyword">True</span><span class="uscript-operator">;</span>
<span class="uscript-line">02438</span>                      TempStr <span class="uscript-operator">=</span> Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span><span class="uscript-string">"ProfileNameSelect"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02439</span>                      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>TempStr <span class="uscript-operator">==</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">02440</span>                      <span class="uscript-operator">{</span>
<span class="uscript-line">02441</span>                          StatusError<span class="uscript-operator">(</span>Res<span class="uscript-operator">,</span> ErrorNoProfilesExist<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02442</span>                          <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>
<span class="uscript-line">02443</span>                      <span class="uscript-operator">}</span>
<span class="uscript-line">02444</span>                      QuerySubFrame<span class="uscript-operator">(</span>Req<span class="uscript-operator">,</span> Res<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02445</span>                      <span class="uscript-keyword">return</span><span class="uscript-operator">;</span>
<span class="uscript-line">02446</span>  
<span class="uscript-line">02447</span>                  <span class="uscript-keyword">case</span> <span class="uscript-string">"Copy"</span>:
<span class="uscript-line">02448</span>                      bCopy <span class="uscript-operator">=</span> <span class="uscript-keyword">True</span><span class="uscript-operator">;</span>
<span class="uscript-line">02449</span>                      Tmp <span class="uscript-operator">=</span> Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span><span class="uscript-string">"ProfileNameSelect"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02450</span>                      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>Tmp <span class="uscript-operator">==</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">02451</span>                          StatusError<span class="uscript-operator">(</span>Res<span class="uscript-operator">,</span> ErrorNoProfilesExist<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02452</span>  
<span class="uscript-line">02453</span>                      TempStr <span class="uscript-operator">=</span> Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span><span class="uscript-string">"TextInput"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02454</span>                      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>TempStr <span class="uscript-operator">==</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">02455</span>                      <span class="uscript-operator">{</span>
<span class="uscript-line">02456</span>                          StatusError<span class="uscript-operator">(</span>Res<span class="uscript-operator">,</span> ErrorCopyNoName<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02457</span>                          <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>
<span class="uscript-line">02458</span>                      <span class="uscript-operator">}</span>
<span class="uscript-line">02459</span>  
<span class="uscript-line">02460</span>                      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>LadderRules<span class="uscript-operator">.</span>CopyProfile<span class="uscript-operator">(</span><span class="uscript-type">int</span><span class="uscript-operator">(</span>Tmp<span class="uscript-operator">)</span><span class="uscript-operator">,</span>TempStr<span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">02461</span>                          StatusOK<span class="uscript-operator">(</span>Res<span class="uscript-operator">,</span>SuccessCopyProfile<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02462</span>                      <span class="uscript-keyword">else</span> StatusError<span class="uscript-operator">(</span>Res<span class="uscript-operator">,</span> ErrorCopyFrom<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02463</span>                      <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>
<span class="uscript-line">02464</span>  
<span class="uscript-line">02465</span>                  <span class="uscript-keyword">case</span> <span class="uscript-string">"Delete"</span>:
<span class="uscript-line">02466</span>                      bDelete <span class="uscript-operator">=</span> <span class="uscript-keyword">True</span><span class="uscript-operator">;</span>
<span class="uscript-line">02467</span>                      TempStr <span class="uscript-operator">=</span> Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span><span class="uscript-string">"ProfileNameSelect"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02468</span>                      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>TempStr <span class="uscript-operator">!=</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">02469</span>                      <span class="uscript-operator">{</span>
<span class="uscript-line">02470</span>                          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>LadderRules<span class="uscript-operator">.</span>RemoveProfile<span class="uscript-operator">(</span><span class="uscript-type">int</span><span class="uscript-operator">(</span>TempStr<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">02471</span>                              StatusOK<span class="uscript-operator">(</span>Res<span class="uscript-operator">,</span> SuccessDeleteProfile<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02472</span>                          <span class="uscript-keyword">else</span> StatusError<span class="uscript-operator">(</span>Res<span class="uscript-operator">,</span> ErrorDeletingProfile<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02473</span>                      <span class="uscript-operator">}</span>
<span class="uscript-line">02474</span>                      <span class="uscript-keyword">else</span> StatusError<span class="uscript-operator">(</span>Res<span class="uscript-operator">,</span> ErrorNoProfilesExist<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02475</span>                      <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>
<span class="uscript-line">02476</span>  
<span class="uscript-line">02477</span>                  <span class="uscript-keyword">case</span> <span class="uscript-string">"Import"</span>:
<span class="uscript-line">02478</span>                      bImport <span class="uscript-operator">=</span> <span class="uscript-keyword">True</span><span class="uscript-operator">;</span>
<span class="uscript-line">02479</span>                      TempStr <span class="uscript-operator">=</span> Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span><span class="uscript-string">"TextInput"</span><span class="uscript-operator">,</span><span class="uscript-string">""</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02480</span>                      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">!</span><span class="uscript-operator">(</span>Left<span class="uscript-operator">(</span>TempStr<span class="uscript-operator">,</span><span class="uscript-number">7</span><span class="uscript-operator">)</span> <span class="uscript-operator">~=</span> <span class="uscript-string">"http://"</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">02481</span>                      <span class="uscript-operator">{</span>
<span class="uscript-line">02482</span>                          StatusError<span class="uscript-operator">(</span>Res<span class="uscript-operator">,</span> ErrorBadURL<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02483</span>                          <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>
<span class="uscript-line">02484</span>                      <span class="uscript-operator">}</span>
<span class="uscript-line">02485</span>  
<span class="uscript-line">02486</span>                  <span class="uscript-comment">// Spawn class to handle network interaction to receive remote profile</span>
<span class="uscript-line">02487</span>                      ProfileConn <span class="uscript-operator">=</span> Level<span class="uscript-operator">.</span>Spawn<span class="uscript-operator">(</span><span class="uscript-keyword">Class</span><span class="uscript-name">'ProfileImporter'</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02488</span>                      <span class="uscript-keyword">If</span> <span class="uscript-operator">(</span>ProfileConn <span class="uscript-operator">==</span> <span class="uscript-keyword">None</span><span class="uscript-operator">)</span>
<span class="uscript-line">02489</span>                      <span class="uscript-operator">{</span>
<span class="uscript-line">02490</span>                          ShowMessage<span class="uscript-operator">(</span>Res<span class="uscript-operator">,</span> ErrorText<span class="uscript-operator">,</span> ImportClassSpawnError<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02491</span>                          <span class="uscript-keyword">return</span><span class="uscript-operator">;</span>
<span class="uscript-line">02492</span>                      <span class="uscript-operator">}</span>
<span class="uscript-line">02493</span>  
<span class="uscript-line">02494</span>                  <span class="uscript-comment">// Assign local connection objects to importer class</span>
<span class="uscript-line">02495</span>                      ProfileConn<span class="uscript-operator">.</span>QueryPage <span class="uscript-operator">=</span> <span class="uscript-keyword">Self</span><span class="uscript-operator">;</span>
<span class="uscript-line">02496</span>                      ProfileConn<span class="uscript-operator">.</span>QueryRequest <span class="uscript-operator">=</span> Req<span class="uscript-operator">;</span>
<span class="uscript-line">02497</span>                      ProfileConn<span class="uscript-operator">.</span>QueryResponse <span class="uscript-operator">=</span> Res<span class="uscript-operator">;</span>
<span class="uscript-line">02498</span>  
<span class="uscript-line">02499</span>                  <span class="uscript-comment">// Setting bDelayCleanup prevents the connection from being closed</span>
<span class="uscript-line">02500</span>                  <span class="uscript-comment">// when QueryProfileImport() returns to Query()</span>
<span class="uscript-line">02501</span>                  <span class="uscript-comment">// Set this prior to initializing connection, to ensure correct behavior</span>
<span class="uscript-line">02502</span>                      Res<span class="uscript-operator">.</span>Connection<span class="uscript-operator">.</span>bDelayCleanup <span class="uscript-operator">=</span> <span class="uscript-keyword">True</span><span class="uscript-operator">;</span>
<span class="uscript-line">02503</span>  
<span class="uscript-line">02504</span>                  <span class="uscript-comment">// Initialize connection to foreign host, pass Importer class a Session</span>
<span class="uscript-line">02505</span>                  <span class="uscript-comment">// object to allow it to build a profile config set.</span>
<span class="uscript-line">02506</span>                      ProfileConn<span class="uscript-operator">.</span>Connect<span class="uscript-operator">(</span>TempStr<span class="uscript-operator">,</span> CurS<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02507</span>                      <span class="uscript-keyword">return</span><span class="uscript-operator">;</span>
<span class="uscript-line">02508</span>  
<span class="uscript-line">02509</span>                  <span class="uscript-keyword">case</span> <span class="uscript-string">"Export"</span>:
<span class="uscript-line">02510</span>                      bExport <span class="uscript-operator">=</span> <span class="uscript-keyword">True</span><span class="uscript-operator">;</span>
<span class="uscript-line">02511</span>                      TempStr <span class="uscript-operator">=</span> Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span><span class="uscript-string">"ProfileNameSelect"</span><span class="uscript-operator">,</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02512</span>                      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>TempStr <span class="uscript-operator">==</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">02513</span>                      <span class="uscript-operator">{</span>
<span class="uscript-line">02514</span>                          StatusError<span class="uscript-operator">(</span>Res<span class="uscript-operator">,</span> ErrorNoProfilesExist<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02515</span>                          <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>
<span class="uscript-line">02516</span>                      <span class="uscript-operator">}</span>
<span class="uscript-line">02517</span>                      QuerySubExport<span class="uscript-operator">(</span>Req<span class="uscript-operator">,</span>Res<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02518</span>                      <span class="uscript-keyword">return</span><span class="uscript-operator">;</span>
<span class="uscript-line">02519</span>  
<span class="uscript-line">02520</span>                  <span class="uscript-keyword">default</span>:
<span class="uscript-line">02521</span>                      bModify <span class="uscript-operator">=</span> <span class="uscript-keyword">True</span><span class="uscript-operator">;</span>
<span class="uscript-line">02522</span>              <span class="uscript-operator">}</span>
<span class="uscript-line">02523</span>          <span class="uscript-operator">}</span>
<span class="uscript-line">02524</span>  
<span class="uscript-line">02525</span>      <span class="uscript-comment">// Output code -</span>
<span class="uscript-line">02526</span>      <span class="uscript-comment">// TODO: move to .inc file</span>
<span class="uscript-line">02527</span>          HeaderRows <span class="uscript-operator">=</span> <span class="uscript-string">"&lt;tr&gt;&lt;td nowrap&gt;"</span><span class="uscript-operator">$</span>LabelChooseAction<span class="uscript-operator">$</span><span class="uscript-string">"&lt;/td&gt;&lt;td nowrap&gt;"</span><span class="uscript-operator">$</span>LabelInputDescription<span class="uscript-operator">$</span><span class="uscript-string">"&lt;/td&gt;&lt;/tr&gt;"</span><span class="uscript-operator">;</span>
<span class="uscript-line">02528</span>          ManagementRows <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span><span class="uscript-string">"&lt;tr&gt;&lt;td nowrap&gt;"</span><span class="uscript-operator">$</span>RadioButton<span class="uscript-operator">(</span><span class="uscript-string">"Actions"</span><span class="uscript-operator">,</span> <span class="uscript-string">"Add"</span><span class="uscript-operator">,</span> bAdd<span class="uscript-operator">)</span><span class="uscript-operator">$</span>LabelAddProfile<span class="uscript-operator">$</span><span class="uscript-string">"&lt;br&gt;"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02529</span>          ManagementRows <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span>RadioButton<span class="uscript-operator">(</span><span class="uscript-string">"Actions"</span><span class="uscript-operator">,</span> <span class="uscript-string">"Modify"</span><span class="uscript-operator">,</span> bModify<span class="uscript-operator">)</span><span class="uscript-operator">$</span>LabelModifyProfile<span class="uscript-operator">$</span><span class="uscript-string">"&lt;/td&gt;"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02530</span>          ManagementRows <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span><span class="uscript-string">"&lt;td&gt;&lt;select class=mini name='ProfileNameSelect'&gt;"</span><span class="uscript-operator">$</span>GenerateSwitchProfileOptions<span class="uscript-operator">(</span>TempStr<span class="uscript-operator">)</span><span class="uscript-operator">$</span><span class="uscript-string">"&lt;/select&gt;&amp;nbsp;"</span><span class="uscript-operator">$</span>LabelSelectActions<span class="uscript-operator">$</span><span class="uscript-string">"&lt;/td&gt;&lt;/tr&gt;"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02531</span>          ManagementRows <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span><span class="uscript-string">"&lt;tr&gt;&lt;td nowrap&gt;"</span><span class="uscript-operator">$</span>RadioButton<span class="uscript-operator">(</span><span class="uscript-string">"Actions"</span><span class="uscript-operator">,</span> <span class="uscript-string">"Copy"</span><span class="uscript-operator">,</span> bCopy<span class="uscript-operator">)</span><span class="uscript-operator">$</span>LabelCopyProfile<span class="uscript-operator">$</span><span class="uscript-string">"&lt;br&gt;"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02532</span>          ManagementRows <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span>RadioButton<span class="uscript-operator">(</span><span class="uscript-string">"Actions"</span><span class="uscript-operator">,</span> <span class="uscript-string">"Delete"</span><span class="uscript-operator">,</span> bDelete<span class="uscript-operator">)</span><span class="uscript-operator">$</span>LabelDeleteProfile<span class="uscript-operator">$</span><span class="uscript-string">"&lt;/td&gt;"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02533</span>          ManagementRows <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span><span class="uscript-string">"&lt;td nowrap&gt;"</span><span class="uscript-operator">$</span>Textbox<span class="uscript-operator">(</span><span class="uscript-string">"TextInput"</span><span class="uscript-operator">,</span><span class="uscript-number">64</span><span class="uscript-operator">,</span><span class="uscript-number">128</span><span class="uscript-operator">)</span><span class="uscript-operator">$</span><span class="uscript-string">"&amp;nbsp;"</span><span class="uscript-operator">$</span>LabelTextboxActions<span class="uscript-operator">$</span><span class="uscript-string">"&lt;/td&gt;&lt;/tr&gt;"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02534</span>          ManagementRows <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span><span class="uscript-string">"&lt;tr&gt;&lt;td nowrap&gt;"</span><span class="uscript-operator">$</span>RadioButton<span class="uscript-operator">(</span><span class="uscript-string">"Actions"</span><span class="uscript-operator">,</span> <span class="uscript-string">"Import"</span><span class="uscript-operator">,</span> bImport<span class="uscript-operator">)</span><span class="uscript-operator">$</span>LabelImportProfile<span class="uscript-operator">$</span><span class="uscript-string">"&lt;br&gt;"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02535</span>          ManagementRows <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span>RadioButton<span class="uscript-operator">(</span><span class="uscript-string">"Actions"</span><span class="uscript-operator">,</span> <span class="uscript-string">"Export"</span><span class="uscript-operator">,</span> bExport<span class="uscript-operator">)</span><span class="uscript-operator">$</span>LabelExportProfile<span class="uscript-operator">$</span><span class="uscript-string">"&lt;/td&gt;"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02536</span>          ManagementRows <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span><span class="uscript-string">"&lt;td&gt;"</span><span class="uscript-operator">$</span>SubmitButton<span class="uscript-operator">(</span>ProfileButtonName<span class="uscript-operator">[</span><span class="uscript-number">0</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span>ProfileButtonValue<span class="uscript-operator">[</span><span class="uscript-number">0</span><span class="uscript-operator">]</span><span class="uscript-operator">)</span><span class="uscript-operator">$</span><span class="uscript-string">"&lt;/td&gt;&lt;/tr&gt;"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02537</span>  
<span class="uscript-line">02538</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"TableTitle"</span><span class="uscript-operator">,</span> TableTitle<span class="uscript-operator">[</span><span class="uscript-number">0</span><span class="uscript-operator">]</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02539</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"HeaderRow"</span><span class="uscript-operator">,</span> HeaderRows<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02540</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"TableRows"</span><span class="uscript-operator">,</span>ManagementRows<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02541</span>  
<span class="uscript-line">02542</span>          Tmp <span class="uscript-operator">=</span> CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"ProfileName"</span><span class="uscript-operator">,</span> PageCaption<span class="uscript-operator">[</span><span class="uscript-number">0</span><span class="uscript-operator">]</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02543</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>LadderRules<span class="uscript-operator">.</span>GetRemainingMatches<span class="uscript-operator">(</span><span class="uscript-operator">)</span> <span class="uscript-operator">&gt;</span> <span class="uscript-number">0</span> <span class="uscript-operator">&amp;&amp;</span> Tmp <span class="uscript-operator">==</span> LadderRules<span class="uscript-operator">.</span>Profiles<span class="uscript-operator">[</span>GetCurrentConfigIndex<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">]</span><span class="uscript-operator">.</span>ProfileName<span class="uscript-operator">)</span>
<span class="uscript-line">02544</span>              Tmp <span class="uscript-operator">@</span><span class="uscript-operator">=</span> <span class="uscript-operator">(</span>LabelNumberMatchesLeft <span class="uscript-operator">@</span> <span class="uscript-type">string</span><span class="uscript-operator">(</span>LadderRules<span class="uscript-operator">.</span>GetRemainingMatches<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02545</span>  
<span class="uscript-line">02546</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"Section"</span><span class="uscript-operator">,</span> LabelManagement<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02547</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"PageHelp"</span><span class="uscript-operator">,</span> HelpManageProfile<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02548</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SubTitle"</span><span class="uscript-operator">,</span> Tmp<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02549</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"LadderTable"</span><span class="uscript-operator">,</span> WebInclude<span class="uscript-operator">(</span>IncludeTable<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02550</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"PostAction"</span><span class="uscript-operator">,</span> ProfileManageURI<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02551</span>          ShowPage<span class="uscript-operator">(</span>Res<span class="uscript-operator">,</span> MasterPage<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02552</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">02553</span>  
<span class="uscript-line">02554</span>      <span class="uscript-keyword">else</span> AccessDenied<span class="uscript-operator">(</span>Res<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02555</span>  <span class="uscript-operator">}</span>
<span class="uscript-line">02556</span>  
<span class="uscript-line">02557</span>  <span class="uscript-comment">// Page 1</span>
<span class="uscript-line">02558</span>  <span class="uscript-keyword">function</span> QuerySubGameType<span class="uscript-operator">(</span>WebRequest Req<span class="uscript-operator">,</span> WebResponse Res<span class="uscript-operator">)</span>
<span class="uscript-line">02559</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">02560</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">int</span> i<span class="uscript-operator">;</span>
<span class="uscript-line">02561</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">string</span> DataName<span class="uscript-operator">,</span> DataValue<span class="uscript-operator">,</span> SID<span class="uscript-operator">,</span> NewName<span class="uscript-operator">,</span> OldName<span class="uscript-operator">;</span>
<span class="uscript-line">02562</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">string</span> GameTypeRows<span class="uscript-operator">,</span> OldGameType<span class="uscript-operator">,</span> CommandLineRows<span class="uscript-operator">;</span>
<span class="uscript-line">02563</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">string</span> GameTypeTable<span class="uscript-operator">,</span> CommandLineTable<span class="uscript-operator">,</span> ApplyTable<span class="uscript-operator">;</span>
<span class="uscript-line">02564</span>      <span class="uscript-keyword">local</span> Session CurS<span class="uscript-operator">;</span>
<span class="uscript-line">02565</span>      <span class="uscript-keyword">local</span> LadderProfiles LadderMaster<span class="uscript-operator">;</span>
<span class="uscript-line">02566</span>  
<span class="uscript-line">02567</span>  
<span class="uscript-line">02568</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>CanPerform<span class="uscript-operator">(</span><span class="uscript-string">"Lm"</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">02569</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">02570</span>          SID <span class="uscript-operator">=</span> Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span><span class="uscript-string">"SessionID"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02571</span>          CurS <span class="uscript-operator">=</span> SMaster<span class="uscript-operator">.</span>getSession<span class="uscript-operator">(</span>SID<span class="uscript-operator">,</span> <span class="uscript-keyword">true</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02572</span>  
<span class="uscript-line">02573</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span>CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"ButtonName"</span><span class="uscript-operator">,</span><span class="uscript-string">""</span><span class="uscript-operator">)</span><span class="uscript-operator">,</span><span class="uscript-string">""</span><span class="uscript-operator">)</span><span class="uscript-operator">!=</span><span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">02574</span>          <span class="uscript-operator">{</span>
<span class="uscript-line">02575</span>              NewName <span class="uscript-operator">=</span> Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span><span class="uscript-string">"NewProfile"</span><span class="uscript-operator">,</span>DefaultProfileName<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02576</span>              OldName <span class="uscript-operator">=</span> CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"ProfileName"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02577</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">(</span>OldName <span class="uscript-operator">!=</span> <span class="uscript-string">""</span> <span class="uscript-operator">&amp;&amp;</span> <span class="uscript-operator">!</span><span class="uscript-operator">(</span>OldName <span class="uscript-operator">~=</span> NewName<span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">||</span> OldName <span class="uscript-operator">==</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">02578</span>              <span class="uscript-operator">{</span>
<span class="uscript-line">02579</span>                  <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>i<span class="uscript-operator">&lt;</span>LadderRules<span class="uscript-operator">.</span>Profiles<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">;</span>i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">02580</span>                  <span class="uscript-operator">{</span>
<span class="uscript-line">02581</span>                      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>NewName <span class="uscript-operator">~=</span> LadderRules<span class="uscript-operator">.</span>Profiles<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>ProfileName<span class="uscript-operator">)</span>
<span class="uscript-line">02582</span>                      <span class="uscript-operator">{</span>
<span class="uscript-line">02583</span>                          StatusError<span class="uscript-operator">(</span>Res<span class="uscript-operator">,</span> ErrorSameProfileName<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02584</span>                          NewName <span class="uscript-operator">=</span> DefaultProfileName<span class="uscript-operator">;</span>
<span class="uscript-line">02585</span>                          <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>
<span class="uscript-line">02586</span>                      <span class="uscript-operator">}</span>
<span class="uscript-line">02587</span>                  <span class="uscript-operator">}</span>
<span class="uscript-line">02588</span>              <span class="uscript-operator">}</span>
<span class="uscript-line">02589</span>              CurS<span class="uscript-operator">.</span>setValue<span class="uscript-operator">(</span><span class="uscript-string">"ProfileName"</span><span class="uscript-operator">,</span> NewName<span class="uscript-operator">,</span> <span class="uscript-keyword">true</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02590</span>              CurS<span class="uscript-operator">.</span>setValue<span class="uscript-operator">(</span><span class="uscript-string">"GameType"</span><span class="uscript-operator">,</span> Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span><span class="uscript-string">"NewGameType"</span><span class="uscript-operator">)</span><span class="uscript-operator">,</span> <span class="uscript-keyword">True</span><span class="uscript-operator">,</span> OldGameType<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02591</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">!</span><span class="uscript-operator">(</span>OldGameType <span class="uscript-operator">~=</span> CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"GameType"</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">02592</span>              <span class="uscript-operator">{</span>
<span class="uscript-line">02593</span>                  CurS<span class="uscript-operator">.</span>ClearMaps<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02594</span>              <span class="uscript-comment">// Reset all stored PlayInfo information</span>
<span class="uscript-line">02595</span>                  <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>i<span class="uscript-operator">&lt;</span>CurS<span class="uscript-operator">.</span>getDataLength<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">02596</span>                  <span class="uscript-operator">{</span>
<span class="uscript-line">02597</span>                      CurS<span class="uscript-operator">.</span>getIDValue<span class="uscript-operator">(</span>i<span class="uscript-operator">,</span>DataName<span class="uscript-operator">,</span>DataValue<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02598</span>                      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>InStr<span class="uscript-operator">(</span>DataName<span class="uscript-operator">,</span> <span class="uscript-string">"."</span><span class="uscript-operator">)</span> <span class="uscript-operator">!=</span> <span class="uscript-operator">-</span><span class="uscript-number">1</span><span class="uscript-operator">)</span>
<span class="uscript-line">02599</span>                      <span class="uscript-operator">{</span>
<span class="uscript-line">02600</span>                          CurS<span class="uscript-operator">.</span>delValue<span class="uscript-operator">(</span>DataName<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02601</span>                          i<span class="uscript-operator">--</span><span class="uscript-operator">;</span>
<span class="uscript-line">02602</span>                      <span class="uscript-operator">}</span>
<span class="uscript-line">02603</span>                  <span class="uscript-operator">}</span>
<span class="uscript-line">02604</span>              <span class="uscript-operator">}</span>
<span class="uscript-line">02605</span>          <span class="uscript-operator">}</span>
<span class="uscript-line">02606</span>  
<span class="uscript-line">02607</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"NewProfileName"</span><span class="uscript-operator">,</span> CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"ProfileName"</span><span class="uscript-operator">,</span> DefaultProfileName<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02608</span>          GameTypeRows <span class="uscript-operator">=</span> WebInclude<span class="uscript-operator">(</span>IncludeProfileName<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02609</span>  
<span class="uscript-line">02610</span>          <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>i<span class="uscript-operator">&lt;</span>AGameType<span class="uscript-operator">.</span>Count<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">02611</span>          <span class="uscript-operator">{</span>
<span class="uscript-line">02612</span>              Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"GameTypeClass"</span><span class="uscript-operator">,</span>  AGameType<span class="uscript-operator">.</span>GetItem<span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02613</span>              Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"GameTypeName"</span><span class="uscript-operator">,</span>   AGameType<span class="uscript-operator">.</span>GetTag<span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02614</span>              Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"Selected"</span><span class="uscript-operator">,</span>       StringIf<span class="uscript-operator">(</span>CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"GameType"</span><span class="uscript-operator">)</span> <span class="uscript-operator">~=</span> AGameType<span class="uscript-operator">.</span>GetItem<span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">,</span> <span class="uscript-string">" checked"</span><span class="uscript-operator">,</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02615</span>              GameTypeRows <span class="uscript-operator">+=</span> WebInclude<span class="uscript-operator">(</span>IncludeGameType<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02616</span>          <span class="uscript-operator">}</span>
<span class="uscript-line">02617</span>  
<span class="uscript-line">02618</span>      <span class="uscript-comment">// Fill in caption table values</span>
<span class="uscript-line">02619</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"PageCaption"</span><span class="uscript-operator">,</span>    CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"PageCaption"</span><span class="uscript-operator">,</span> PageCaption<span class="uscript-operator">[</span><span class="uscript-number">1</span><span class="uscript-operator">]</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02620</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"ButtonName"</span><span class="uscript-operator">,</span>     CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"ButtonName"</span><span class="uscript-operator">,</span> ProfileButtonName<span class="uscript-operator">[</span><span class="uscript-number">1</span><span class="uscript-operator">]</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02621</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"ButtonValue"</span><span class="uscript-operator">,</span>    CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"ButtonValue"</span><span class="uscript-operator">,</span> ProfileButtonValue<span class="uscript-operator">[</span><span class="uscript-number">1</span><span class="uscript-operator">]</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02622</span>  
<span class="uscript-line">02623</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"TableRows"</span><span class="uscript-operator">,</span>      GameTypeRows<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02624</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"LadderTable"</span><span class="uscript-operator">,</span>    WebInclude<span class="uscript-operator">(</span>IncludeTable<span class="uscript-operator">)</span><span class="uscript-operator">$</span>WebInclude<span class="uscript-operator">(</span>IncludeCaptionButton<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02625</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"PostAction"</span><span class="uscript-operator">,</span>     CurS<span class="uscript-operator">.</span>GetValue<span class="uscript-operator">(</span><span class="uscript-string">"CurrentPage"</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02626</span>          ShowPage<span class="uscript-operator">(</span>Res<span class="uscript-operator">,</span> SubFrameContent<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02627</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">02628</span>  
<span class="uscript-line">02629</span>      <span class="uscript-keyword">else</span> AccessDenied<span class="uscript-operator">(</span>Res<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02630</span>  <span class="uscript-operator">}</span>
<span class="uscript-line">02631</span>  
<span class="uscript-line">02632</span>  <span class="uscript-comment">// Page 2</span>
<span class="uscript-line">02633</span>  <span class="uscript-keyword">function</span> QuerySubMutators<span class="uscript-operator">(</span>WebRequest Req<span class="uscript-operator">,</span> WebResponse Res<span class="uscript-operator">)</span>
<span class="uscript-line">02634</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">02635</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">int</span> i<span class="uscript-operator">,</span>j<span class="uscript-operator">;</span>
<span class="uscript-line">02636</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">bool</span>      bAllMuts<span class="uscript-operator">,</span>
<span class="uscript-line">02637</span>                      bClearMuts<span class="uscript-operator">,</span>
<span class="uscript-line">02638</span>                      bChecked<span class="uscript-operator">;</span>
<span class="uscript-line">02639</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">string</span>    MutatorRows<span class="uscript-operator">,</span>
<span class="uscript-line">02640</span>                      SID<span class="uscript-operator">,</span> TempStr<span class="uscript-operator">;</span>
<span class="uscript-line">02641</span>  
<span class="uscript-line">02642</span>      <span class="uscript-keyword">local</span> Session CurS<span class="uscript-operator">;</span>
<span class="uscript-line">02643</span>      <span class="uscript-keyword">local</span> StringArray Mutators<span class="uscript-operator">,</span> ServerActors<span class="uscript-operator">;</span>
<span class="uscript-line">02644</span>      <span class="uscript-keyword">local</span> <span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>Mutator<span class="uscript-operator">&gt;</span> MutClass<span class="uscript-operator">;</span>
<span class="uscript-line">02645</span>  
<span class="uscript-line">02646</span>  
<span class="uscript-line">02647</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>CanPerform<span class="uscript-operator">(</span><span class="uscript-string">"Lm"</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">02648</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">02649</span>          SID <span class="uscript-operator">=</span> Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span><span class="uscript-string">"SessionID"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02650</span>          CurS <span class="uscript-operator">=</span> SMaster<span class="uscript-operator">.</span>getSession<span class="uscript-operator">(</span>SID<span class="uscript-operator">,</span> <span class="uscript-keyword">true</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02651</span>  
<span class="uscript-line">02652</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span>CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"ButtonName"</span><span class="uscript-operator">,</span><span class="uscript-string">""</span><span class="uscript-operator">)</span><span class="uscript-operator">,</span><span class="uscript-string">""</span><span class="uscript-operator">)</span><span class="uscript-operator">!=</span><span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">02653</span>          <span class="uscript-operator">{</span>
<span class="uscript-line">02654</span>              bAllMuts <span class="uscript-operator">=</span> Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span><span class="uscript-string">"AllowAllMutators"</span><span class="uscript-operator">)</span><span class="uscript-operator">!=</span><span class="uscript-string">""</span><span class="uscript-operator">;</span>
<span class="uscript-line">02655</span>              bClearMuts <span class="uscript-operator">=</span> Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span><span class="uscript-string">"ClearAllMutators"</span><span class="uscript-operator">)</span><span class="uscript-operator">!=</span><span class="uscript-string">""</span><span class="uscript-operator">;</span>
<span class="uscript-line">02656</span>  <span class="uscript-comment">//          CurS.ClearMutators();</span>
<span class="uscript-line">02657</span>  
<span class="uscript-line">02658</span>              <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>i<span class="uscript-operator">&lt;</span>ConfigM<span class="uscript-operator">.</span>ManagedActors<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">;</span>i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">02659</span>              <span class="uscript-operator">{</span>
<span class="uscript-line">02660</span>                  TempStr <span class="uscript-operator">=</span> <span class="uscript-type">string</span><span class="uscript-operator">(</span>ConfigM<span class="uscript-operator">.</span>ManagedActors<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>SAClass<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02661</span>                  <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>bAllMuts <span class="uscript-operator">||</span> <span class="uscript-operator">(</span><span class="uscript-operator">!</span>bClearMuts <span class="uscript-operator">&amp;&amp;</span> Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span>TempStr<span class="uscript-operator">,</span><span class="uscript-string">""</span><span class="uscript-operator">)</span> <span class="uscript-operator">!=</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">02662</span>                      CurS<span class="uscript-operator">.</span>setServerActor<span class="uscript-operator">(</span>TempStr<span class="uscript-operator">,</span> <span class="uscript-keyword">True</span><span class="uscript-operator">,</span> CurS<span class="uscript-operator">.</span>SARequired<span class="uscript-operator">(</span>TempStr<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02663</span>                  <span class="uscript-keyword">else</span> CurS<span class="uscript-operator">.</span>delServerActor<span class="uscript-operator">(</span>TempStr<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02664</span>              <span class="uscript-operator">}</span>
<span class="uscript-line">02665</span>  
<span class="uscript-line">02666</span>              <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>i<span class="uscript-operator">&lt;</span>AllMutators<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">;</span>i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">02667</span>              <span class="uscript-operator">{</span>
<span class="uscript-line">02668</span>                  <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>bAllMuts <span class="uscript-operator">||</span> <span class="uscript-operator">(</span><span class="uscript-operator">!</span>bClearMuts <span class="uscript-operator">&amp;&amp;</span> <span class="uscript-operator">(</span>Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span>AllMutators<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>ClassName<span class="uscript-operator">,</span><span class="uscript-string">""</span><span class="uscript-operator">)</span><span class="uscript-operator">!=</span><span class="uscript-string">""</span> <span class="uscript-operator">||</span> Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span>AllMutators<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>GroupName<span class="uscript-operator">)</span><span class="uscript-operator">~=</span>AllMutators<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>ClassName<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">02669</span>                      CurS<span class="uscript-operator">.</span>setMutator<span class="uscript-operator">(</span>AllMutators<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>ClassName<span class="uscript-operator">,</span><span class="uscript-keyword">true</span><span class="uscript-operator">,</span>CurS<span class="uscript-operator">.</span>MutRequired<span class="uscript-operator">(</span>AllMutators<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>ClassName<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02670</span>                  <span class="uscript-keyword">else</span> <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span>AllMutators<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>GroupName<span class="uscript-operator">)</span> <span class="uscript-operator">~=</span> <span class="uscript-string">"None"</span><span class="uscript-operator">)</span>
<span class="uscript-line">02671</span>                      CurS<span class="uscript-operator">.</span>setMutator<span class="uscript-operator">(</span>AllMutators<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>GroupName<span class="uscript-operator">,</span><span class="uscript-keyword">true</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02672</span>                  <span class="uscript-keyword">else</span>
<span class="uscript-line">02673</span>                  <span class="uscript-operator">{</span>
<span class="uscript-line">02674</span>                      CurS<span class="uscript-operator">.</span>delMutator<span class="uscript-operator">(</span>AllMutators<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>ClassName<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02675</span>                      CurS<span class="uscript-operator">.</span>delMutator<span class="uscript-operator">(</span>AllMutators<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>GroupName<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02676</span>                  <span class="uscript-operator">}</span>
<span class="uscript-line">02677</span>              <span class="uscript-operator">}</span>
<span class="uscript-line">02678</span>          <span class="uscript-operator">}</span>
<span class="uscript-line">02679</span>  
<span class="uscript-line">02680</span>          Mutators <span class="uscript-operator">=</span> <span class="uscript-keyword">new</span><span class="uscript-operator">(</span><span class="uscript-keyword">None</span><span class="uscript-operator">)</span> <span class="uscript-keyword">class</span><span class="uscript-name">'SortedStringArray'</span><span class="uscript-operator">;</span>
<span class="uscript-line">02681</span>          ServerActors <span class="uscript-operator">=</span> <span class="uscript-keyword">new</span><span class="uscript-operator">(</span><span class="uscript-keyword">None</span><span class="uscript-operator">)</span> <span class="uscript-keyword">class</span><span class="uscript-name">'SortedStringArray'</span><span class="uscript-operator">;</span>
<span class="uscript-line">02682</span>  <span class="uscript-comment">//      GroupsOnly = new(None) class'SortedStringArray';</span>
<span class="uscript-line">02683</span>          <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i <span class="uscript-operator">=</span> <span class="uscript-number">0</span><span class="uscript-operator">;</span> i<span class="uscript-operator">&lt;</span>AllMutators<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">;</span> i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">02684</span>          <span class="uscript-operator">{</span>
<span class="uscript-line">02685</span>              MutClass <span class="uscript-operator">=</span> <span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>Mutator<span class="uscript-operator">&gt;</span><span class="uscript-operator">(</span>DynamicLoadObject<span class="uscript-operator">(</span>AllMutators<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>ClassName<span class="uscript-operator">,</span> <span class="uscript-keyword">class</span><span class="uscript-name">'Class'</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02686</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>MutClass <span class="uscript-operator">!=</span> <span class="uscript-keyword">None</span><span class="uscript-operator">)</span>
<span class="uscript-line">02687</span>                  Mutators<span class="uscript-operator">.</span>Add<span class="uscript-operator">(</span><span class="uscript-type">string</span><span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">,</span>AllMutators<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>FriendlyName<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02688</span>          <span class="uscript-operator">}</span>
<span class="uscript-line">02689</span>  
<span class="uscript-line">02690</span>          <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>i<span class="uscript-operator">&lt;</span>ConfigM<span class="uscript-operator">.</span>ManagedActors<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">;</span>i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">02691</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>ConfigM<span class="uscript-operator">.</span>ManagedActors<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>SAClass <span class="uscript-operator">!=</span> <span class="uscript-keyword">None</span><span class="uscript-operator">)</span>
<span class="uscript-line">02692</span>                  ServerActors<span class="uscript-operator">.</span>Add<span class="uscript-operator">(</span><span class="uscript-type">string</span><span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">,</span>ConfigM<span class="uscript-operator">.</span>ManagedActors<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>SAName<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02693</span>  
<span class="uscript-line">02694</span>  <span class="uscript-comment">// Uncomment this to allow mutators to be grouped according to MutatorGroup</span>
<span class="uscript-line">02695</span>  <span class="uscript-comment">/*
<span class="uscript-line">02696</span>          CreateFullMutatorList(Mutators,GroupsOnly);
<span class="uscript-line">02697</span>  
<span class="uscript-line">02698</span>          for (i=0;i&lt;CurS.GetMutatorLength();i++)
<span class="uscript-line">02699</span>          {
<span class="uscript-line">02700</span>              k = 0-1;
<span class="uscript-line">02701</span>              for (j=0;j&lt;AllMutators.Length;j++)
<span class="uscript-line">02702</span>                  if (CurS.GetMutator(i) ~= AllMutators[j].ClassName)
<span class="uscript-line">02703</span>                      break;
<span class="uscript-line">02704</span>              if (j&lt;AllMutators.Length) k = GroupsOnly.FindItemId(string(j));
<span class="uscript-line">02705</span>              if (k &gt;= 0)
<span class="uscript-line">02706</span>              {
<span class="uscript-line">02707</span>                  for (z=0;z&lt;TempA.Length;z++)
<span class="uscript-line">02708</span>                  {
<span class="uscript-line">02709</span>                      if (TempA[z] ~= AllMutators[j].GroupName)
<span class="uscript-line">02710</span>                      {
<span class="uscript-line">02711</span>                          bAllMuts = True;
<span class="uscript-line">02712</span>                          break;
<span class="uscript-line">02713</span>                      }
<span class="uscript-line">02714</span>                  }
<span class="uscript-line">02715</span>  
<span class="uscript-line">02716</span>                  if (!bAllMuts) TempA[TempA.Length] = AllMutators[j].GroupName;
<span class="uscript-line">02717</span>              }
<span class="uscript-line">02718</span>              if (bAllMuts)
<span class="uscript-line">02719</span>                  break;
<span class="uscript-line">02720</span>          }
<span class="uscript-line">02721</span>  
<span class="uscript-line">02722</span>          lastgroup = "";
<span class="uscript-line">02723</span>          thisgroup = "";
<span class="uscript-line">02724</span>          nextgroup = "";
<span class="uscript-line">02725</span>          MutatorRows="";
<span class="uscript-line">02726</span>  
<span class="uscript-line">02727</span>          for (i=0;i&lt;GroupsOnly.Count();i++)
<span class="uscript-line">02728</span>          {
<span class="uscript-line">02729</span>              j=int(GroupsOnly.GetItem(i));
<span class="uscript-line">02730</span>              if (AllMutators[j].GroupName=="")
<span class="uscript-line">02731</span>                  thisgroup="Z"$string(z++);
<span class="uscript-line">02732</span>              else thisgroup = AllMutators[j].GroupName;
<span class="uscript-line">02733</span>              if ( (i + 1) == GroupsOnly.Count())
<span class="uscript-line">02734</span>                  nextgroup = "";
<span class="uscript-line">02735</span>              else
<span class="uscript-line">02736</span>              {
<span class="uscript-line">02737</span>              // Assign nextgroup to the next mutators group
<span class="uscript-line">02738</span>                  k = int(GroupsOnly.GetItem(i + 1));
<span class="uscript-line">02739</span>                  if (AllMutators[k].GroupName=="")
<span class="uscript-line">02740</span>                      nextgroup="Z"$string(z);
<span class="uscript-line">02741</span>                  else nextgroup = AllMutators[k].GroupName;
<span class="uscript-line">02742</span>              }
<span class="uscript-line">02743</span>  
<span class="uscript-line">02744</span>              Res.Subst("GroupName", thisgroup);
<span class="uscript-line">02745</span>              Res.Subst("MutatorClass", AllMutators[j].ClassName);
<span class="uscript-line">02746</span>              Res.Subst("MutatorName", AllMutators[j].FriendlyName);
<span class="uscript-line">02747</span>              Res.Subst("MutatorDesc", AllMutators[j].Description);
<span class="uscript-line">02748</span>  
<span class="uscript-line">02749</span>              if ((lastgroup != thisgroup) &amp;&amp; (thisgroup == nextgroup)) // and the next mut is in the same group as this one
<span class="uscript-line">02750</span>              {
<span class="uscript-line">02751</span>                  if (bAllMuts||CurS.HasMutator(thisgroup)) Res.Subst("Checked", "checked");
<span class="uscript-line">02752</span>                  MutatorRows = MutatorRows$WebInclude("current_mutators_group");
<span class="uscript-line">02753</span>              }
<span class="uscript-line">02754</span>              else
<span class="uscript-line">02755</span>              {
<span class="uscript-line">02756</span>                  if (CurS.HasMutator(AllMutators[j].ClassName) &amp;&amp; !bAllMuts) Res.Subst("Checked", "checked"); else Res.Subst("Checked", "");
<span class="uscript-line">02757</span>                  MutatorRows = MutatorRows$WebInclude("current_mutators_group_row");
<span class="uscript-line">02758</span>              }
<span class="uscript-line">02759</span>  
<span class="uscript-line">02760</span>              lastgroup=thisgroup;
<span class="uscript-line">02761</span>          }
<span class="uscript-line">02762</span>  */</span>
<span class="uscript-line">02763</span>          bAllMuts <span class="uscript-operator">=</span> <span class="uscript-keyword">True</span><span class="uscript-operator">;</span>
<span class="uscript-line">02764</span>          <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i <span class="uscript-operator">=</span> <span class="uscript-number">0</span><span class="uscript-operator">;</span> i<span class="uscript-operator">&lt;</span>ServerActors<span class="uscript-operator">.</span>Count<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">02765</span>          <span class="uscript-operator">{</span>
<span class="uscript-line">02766</span>              TempStr <span class="uscript-operator">=</span> <span class="uscript-string">""</span><span class="uscript-operator">;</span> bChecked <span class="uscript-operator">=</span> <span class="uscript-keyword">False</span><span class="uscript-operator">;</span>
<span class="uscript-line">02767</span>              j <span class="uscript-operator">=</span> <span class="uscript-type">int</span><span class="uscript-operator">(</span>ServerActors<span class="uscript-operator">.</span>GetItem<span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02768</span>  
<span class="uscript-line">02769</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>CurS<span class="uscript-operator">.</span>HasServerActor<span class="uscript-operator">(</span><span class="uscript-type">string</span><span class="uscript-operator">(</span>ConfigM<span class="uscript-operator">.</span>ManagedActors<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>SAClass<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">02770</span>                  bChecked <span class="uscript-operator">=</span> <span class="uscript-keyword">True</span><span class="uscript-operator">;</span>
<span class="uscript-line">02771</span>              <span class="uscript-keyword">else</span> <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>bAllMuts<span class="uscript-operator">)</span> bAllMuts <span class="uscript-operator">=</span> <span class="uscript-keyword">False</span><span class="uscript-operator">;</span>
<span class="uscript-line">02772</span>  
<span class="uscript-line">02773</span>              Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"Content"</span><span class="uscript-operator">,</span> Checkbox<span class="uscript-operator">(</span><span class="uscript-type">string</span><span class="uscript-operator">(</span>ConfigM<span class="uscript-operator">.</span>ManagedActors<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>SAClass<span class="uscript-operator">)</span><span class="uscript-operator">,</span>bChecked<span class="uscript-operator">)</span> <span class="uscript-operator">$</span> <span class="uscript-string">"&amp;nbsp;"</span> <span class="uscript-operator">$</span> ServerActors<span class="uscript-operator">.</span>GetTag<span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02774</span>              TempStr <span class="uscript-operator">=</span> WebInclude<span class="uscript-operator">(</span>NowrapLeft<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02775</span>              Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"Content"</span><span class="uscript-operator">,</span> ConfigM<span class="uscript-operator">.</span>ManagedActors<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>SADescription<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02776</span>              Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"RowContent"</span><span class="uscript-operator">,</span> TempStr <span class="uscript-operator">$</span> WebInclude<span class="uscript-operator">(</span>CellLeft<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02777</span>  
<span class="uscript-line">02778</span>              MutatorRows <span class="uscript-operator">+=</span> WebInclude<span class="uscript-operator">(</span>RowLeft<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02779</span>          <span class="uscript-operator">}</span>
<span class="uscript-line">02780</span>  
<span class="uscript-line">02781</span>          <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i <span class="uscript-operator">=</span> <span class="uscript-number">0</span><span class="uscript-operator">;</span> i<span class="uscript-operator">&lt;</span>Mutators<span class="uscript-operator">.</span>Count<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">02782</span>          <span class="uscript-operator">{</span>
<span class="uscript-line">02783</span>              TempStr <span class="uscript-operator">=</span> <span class="uscript-string">""</span><span class="uscript-operator">;</span> bChecked <span class="uscript-operator">=</span> <span class="uscript-keyword">False</span><span class="uscript-operator">;</span>
<span class="uscript-line">02784</span>              j <span class="uscript-operator">=</span> <span class="uscript-type">int</span><span class="uscript-operator">(</span>Mutators<span class="uscript-operator">.</span>GetItem<span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02785</span>  
<span class="uscript-line">02786</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>CurS<span class="uscript-operator">.</span>HasMutator<span class="uscript-operator">(</span>AllMutators<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>ClassName<span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">02787</span>                  bChecked <span class="uscript-operator">=</span> <span class="uscript-keyword">True</span><span class="uscript-operator">;</span>
<span class="uscript-line">02788</span>              <span class="uscript-keyword">else</span> <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>bAllMuts<span class="uscript-operator">)</span> bAllMuts <span class="uscript-operator">=</span> <span class="uscript-keyword">False</span><span class="uscript-operator">;</span>
<span class="uscript-line">02789</span>  
<span class="uscript-line">02790</span>              Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"Content"</span><span class="uscript-operator">,</span> CheckBox<span class="uscript-operator">(</span>AllMutators<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>ClassName<span class="uscript-operator">,</span> bChecked<span class="uscript-operator">)</span> <span class="uscript-operator">$</span> <span class="uscript-string">"&amp;nbsp;"</span> <span class="uscript-operator">$</span> AllMutators<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>FriendlyName<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02791</span>              TempStr <span class="uscript-operator">=</span> WebInclude<span class="uscript-operator">(</span>NowrapLeft<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02792</span>              Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"Content"</span><span class="uscript-operator">,</span> AllMutators<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>Description<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02793</span>              Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"RowContent"</span><span class="uscript-operator">,</span> TempStr <span class="uscript-operator">$</span> WebInclude<span class="uscript-operator">(</span>CellLeft<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02794</span>  
<span class="uscript-line">02795</span>              MutatorRows <span class="uscript-operator">+=</span> WebInclude<span class="uscript-operator">(</span>RowLeft<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02796</span>          <span class="uscript-operator">}</span>
<span class="uscript-line">02797</span>  
<span class="uscript-line">02798</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>bAllMuts<span class="uscript-operator">)</span>
<span class="uscript-line">02799</span>              Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"Content"</span><span class="uscript-operator">,</span> Checkbox<span class="uscript-operator">(</span><span class="uscript-string">"ClearAllMutators"</span><span class="uscript-operator">,</span> <span class="uscript-keyword">False</span><span class="uscript-operator">)</span><span class="uscript-operator">@</span>LabelUncheckAllMutator<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02800</span>          <span class="uscript-keyword">else</span>
<span class="uscript-line">02801</span>              Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"Content"</span><span class="uscript-operator">,</span> Checkbox<span class="uscript-operator">(</span><span class="uscript-string">"AllowAllMutators"</span><span class="uscript-operator">,</span> <span class="uscript-keyword">False</span><span class="uscript-operator">)</span><span class="uscript-operator">@</span>LabelCheckAllMutator<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02802</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SpanLength"</span><span class="uscript-operator">,</span> <span class="uscript-string">"2"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02803</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SpanContent"</span><span class="uscript-operator">,</span> <span class="uscript-string">"&amp;nbsp;&amp;nbsp;"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02804</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"RowContent"</span><span class="uscript-operator">,</span> WebInclude<span class="uscript-operator">(</span>CellColSpan<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02805</span>          MutatorRows <span class="uscript-operator">+=</span> WebInclude<span class="uscript-operator">(</span>RowLeft<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02806</span>  
<span class="uscript-line">02807</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"RowContent"</span><span class="uscript-operator">,</span> WebInclude<span class="uscript-operator">(</span>CellLeft<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02808</span>          MutatorRows <span class="uscript-operator">+=</span> WebInclude<span class="uscript-operator">(</span>RowLeft<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02809</span>  
<span class="uscript-line">02810</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"TableRows"</span><span class="uscript-operator">,</span> MutatorRows<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02811</span>      <span class="uscript-comment">// Fill in caption table values</span>
<span class="uscript-line">02812</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"PageCaption"</span><span class="uscript-operator">,</span>    CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"PageCaption"</span><span class="uscript-operator">,</span> PageCaption<span class="uscript-operator">[</span><span class="uscript-number">2</span><span class="uscript-operator">]</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02813</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"ButtonName"</span><span class="uscript-operator">,</span>     CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"ButtonName"</span><span class="uscript-operator">,</span> ProfileButtonName<span class="uscript-operator">[</span><span class="uscript-number">2</span><span class="uscript-operator">]</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02814</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"ButtonValue"</span><span class="uscript-operator">,</span>    CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"ButtonValue"</span><span class="uscript-operator">,</span> ProfileButtonValue<span class="uscript-operator">[</span><span class="uscript-number">2</span><span class="uscript-operator">]</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02815</span>  
<span class="uscript-line">02816</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"LadderTable"</span><span class="uscript-operator">,</span>    WebInclude<span class="uscript-operator">(</span>IncludeTable<span class="uscript-operator">)</span><span class="uscript-operator">$</span>WebInclude<span class="uscript-operator">(</span>IncludeCaptionButton<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02817</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"PostAction"</span><span class="uscript-operator">,</span>     CurS<span class="uscript-operator">.</span>GetValue<span class="uscript-operator">(</span><span class="uscript-string">"CurrentPage"</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02818</span>          ShowPage<span class="uscript-operator">(</span>Res<span class="uscript-operator">,</span> SubFrameContent<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02819</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">02820</span>  
<span class="uscript-line">02821</span>      <span class="uscript-keyword">else</span> AccessDenied<span class="uscript-operator">(</span>Res<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02822</span>  <span class="uscript-operator">}</span>
<span class="uscript-line">02823</span>  
<span class="uscript-line">02824</span>  <span class="uscript-comment">// Page3</span>
<span class="uscript-line">02825</span>  <span class="uscript-keyword">function</span> QuerySubMaps<span class="uscript-operator">(</span>WebRequest Req<span class="uscript-operator">,</span> WebResponse Res<span class="uscript-operator">)</span>
<span class="uscript-line">02826</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">02827</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">int</span> i<span class="uscript-operator">;</span>
<span class="uscript-line">02828</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">string</span>    SID<span class="uscript-operator">,</span>
<span class="uscript-line">02829</span>                      MapRows<span class="uscript-operator">,</span>
<span class="uscript-line">02830</span>                      TempStr<span class="uscript-operator">,</span> Temp<span class="uscript-operator">,</span>
<span class="uscript-line">02831</span>                      CheckString<span class="uscript-operator">;</span>
<span class="uscript-line">02832</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">bool</span>      bAllMaps<span class="uscript-operator">,</span>
<span class="uscript-line">02833</span>                      bClearMaps<span class="uscript-operator">,</span>
<span class="uscript-line">02834</span>                      bChecked<span class="uscript-operator">;</span>
<span class="uscript-line">02835</span>  
<span class="uscript-line">02836</span>      <span class="uscript-keyword">local</span> Session CurS<span class="uscript-operator">;</span>
<span class="uscript-line">02837</span>      <span class="uscript-keyword">local</span> StringArray SortedMaps<span class="uscript-operator">;</span>
<span class="uscript-line">02838</span>      <span class="uscript-keyword">local</span> <span class="uscript-keyword">array</span><span class="uscript-operator">&lt;</span><span class="uscript-type">string</span><span class="uscript-operator">&gt;</span> TempMaps<span class="uscript-operator">;</span>
<span class="uscript-line">02839</span>      <span class="uscript-keyword">local</span> <span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>GameInfo<span class="uscript-operator">&gt;</span> GIClass<span class="uscript-operator">;</span>
<span class="uscript-line">02840</span>  
<span class="uscript-line">02841</span>  
<span class="uscript-line">02842</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>CanPerform<span class="uscript-operator">(</span><span class="uscript-string">"Lm"</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">02843</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">02844</span>          SID <span class="uscript-operator">=</span> Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span><span class="uscript-string">"SessionID"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02845</span>          CurS <span class="uscript-operator">=</span> SMaster<span class="uscript-operator">.</span>getSession<span class="uscript-operator">(</span>SID<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02846</span>  
<span class="uscript-line">02847</span>          TempStr <span class="uscript-operator">=</span> CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"GameType"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02848</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>TempStr <span class="uscript-operator">!=</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">02849</span>              GIClass <span class="uscript-operator">=</span> <span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>GameInfo<span class="uscript-operator">&gt;</span><span class="uscript-operator">(</span>DynamicLoadObject<span class="uscript-operator">(</span>TempStr<span class="uscript-operator">,</span><span class="uscript-keyword">class</span><span class="uscript-name">'Class'</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02850</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>GIClass <span class="uscript-operator">==</span> <span class="uscript-keyword">None</span><span class="uscript-operator">)</span>
<span class="uscript-line">02851</span>          <span class="uscript-operator">{</span>
<span class="uscript-line">02852</span>              ShowFramedMessage<span class="uscript-operator">(</span>Res<span class="uscript-operator">,</span>ErrorGameClassText<span class="uscript-operator">,</span><span class="uscript-keyword">True</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02853</span>              <span class="uscript-keyword">return</span><span class="uscript-operator">;</span>
<span class="uscript-line">02854</span>          <span class="uscript-operator">}</span>
<span class="uscript-line">02855</span>          <span class="uscript-comment">// Build a string array of maps valid for this gametype.</span>
<span class="uscript-line">02856</span>          GIClass<span class="uscript-operator">.</span><span class="uscript-keyword">static</span><span class="uscript-operator">.</span>LoadMapList<span class="uscript-operator">(</span>GIClass<span class="uscript-operator">.</span><span class="uscript-keyword">default</span><span class="uscript-operator">.</span>MapPrefix<span class="uscript-operator">,</span> TempMaps<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02857</span>  
<span class="uscript-line">02858</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span>CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"ButtonName"</span><span class="uscript-operator">,</span><span class="uscript-string">""</span><span class="uscript-operator">)</span><span class="uscript-operator">,</span><span class="uscript-string">""</span><span class="uscript-operator">)</span><span class="uscript-operator">!=</span><span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">02859</span>          <span class="uscript-operator">{</span>
<span class="uscript-line">02860</span>              bAllMaps <span class="uscript-operator">=</span> Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span><span class="uscript-string">"AllowAllMaps"</span><span class="uscript-operator">,</span><span class="uscript-string">""</span><span class="uscript-operator">)</span><span class="uscript-operator">!=</span><span class="uscript-string">""</span><span class="uscript-operator">;</span>
<span class="uscript-line">02861</span>              bClearMaps <span class="uscript-operator">=</span> Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span><span class="uscript-string">"ClearAllMaps"</span><span class="uscript-operator">,</span><span class="uscript-string">""</span><span class="uscript-operator">)</span><span class="uscript-operator">!=</span><span class="uscript-string">""</span><span class="uscript-operator">;</span>
<span class="uscript-line">02862</span>  
<span class="uscript-line">02863</span>              <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>i<span class="uscript-operator">&lt;</span>TempMaps<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">;</span>i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">02864</span>                  <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>bAllMaps <span class="uscript-operator">||</span> <span class="uscript-operator">(</span><span class="uscript-operator">!</span>bClearMaps <span class="uscript-operator">&amp;&amp;</span> Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span>TempMaps<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">)</span><span class="uscript-operator">!=</span><span class="uscript-string">""</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">02865</span>                      CurS<span class="uscript-operator">.</span>setMap<span class="uscript-operator">(</span>TempMaps<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">,</span><span class="uscript-number">0</span><span class="uscript-operator">,</span><span class="uscript-keyword">True</span><span class="uscript-operator">,</span>CurS<span class="uscript-operator">.</span>MapRequired<span class="uscript-operator">(</span>TempMaps<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02866</span>                  <span class="uscript-keyword">else</span> CurS<span class="uscript-operator">.</span>delMap<span class="uscript-operator">(</span>TempMaps<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02867</span>          <span class="uscript-operator">}</span>
<span class="uscript-line">02868</span>          <span class="uscript-comment">// Add the map name array to a sorted string array for sorting</span>
<span class="uscript-line">02869</span>          SortedMaps <span class="uscript-operator">=</span> <span class="uscript-keyword">new</span><span class="uscript-operator">(</span><span class="uscript-keyword">None</span><span class="uscript-operator">)</span> <span class="uscript-keyword">class</span><span class="uscript-name">'SortedStringArray'</span><span class="uscript-operator">;</span>
<span class="uscript-line">02870</span>          <span class="uscript-keyword">for</span><span class="uscript-operator">(</span>i<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>i<span class="uscript-operator">&lt;</span>TempMaps<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">;</span>i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">02871</span>              SortedMaps<span class="uscript-operator">.</span>Add<span class="uscript-operator">(</span><span class="uscript-type">string</span><span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">,</span>TempMaps<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02872</span>  
<span class="uscript-line">02873</span>          bAllMaps <span class="uscript-operator">=</span> <span class="uscript-keyword">True</span><span class="uscript-operator">;</span>
<span class="uscript-line">02874</span>          <span class="uscript-comment">// Now build the map rows</span>
<span class="uscript-line">02875</span>          <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>i<span class="uscript-operator">&lt;</span>SortedMaps<span class="uscript-operator">.</span>Count<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">02876</span>          <span class="uscript-operator">{</span>
<span class="uscript-line">02877</span>              Temp <span class="uscript-operator">=</span> <span class="uscript-string">""</span><span class="uscript-operator">;</span> bChecked <span class="uscript-operator">=</span> <span class="uscript-keyword">False</span><span class="uscript-operator">;</span>
<span class="uscript-line">02878</span>              TempStr <span class="uscript-operator">=</span> SortedMaps<span class="uscript-operator">.</span>GetTag<span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02879</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>CurS<span class="uscript-operator">.</span>HasMap<span class="uscript-operator">(</span>TempStr<span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">02880</span>                  bChecked <span class="uscript-operator">=</span> <span class="uscript-keyword">True</span><span class="uscript-operator">;</span>
<span class="uscript-line">02881</span>              <span class="uscript-keyword">else</span> <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>bAllMaps<span class="uscript-operator">)</span> bAllMaps <span class="uscript-operator">=</span> <span class="uscript-keyword">False</span><span class="uscript-operator">;</span>
<span class="uscript-line">02882</span>  
<span class="uscript-line">02883</span>              Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"Content"</span><span class="uscript-operator">,</span> Checkbox<span class="uscript-operator">(</span>TempStr<span class="uscript-operator">,</span> bChecked<span class="uscript-operator">)</span> <span class="uscript-operator">$</span> <span class="uscript-string">"&amp;nbsp;"</span> <span class="uscript-operator">$</span> TempStr<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02884</span>              Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"RowContent"</span><span class="uscript-operator">,</span> WebInclude<span class="uscript-operator">(</span>CellLeft<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02885</span>          <span class="uscript-comment">// Build string for javascript function</span>
<span class="uscript-line">02886</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>CheckString<span class="uscript-operator">!=</span><span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">02887</span>                  CheckString <span class="uscript-operator">+=</span> <span class="uscript-string">"','"</span><span class="uscript-operator">;</span>
<span class="uscript-line">02888</span>              CheckString <span class="uscript-operator">+=</span> TempStr<span class="uscript-operator">;</span>
<span class="uscript-line">02889</span>  
<span class="uscript-line">02890</span>              MapRows <span class="uscript-operator">+=</span> WebInclude<span class="uscript-operator">(</span>RowLeft<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02891</span>          <span class="uscript-operator">}</span>
<span class="uscript-line">02892</span>  
<span class="uscript-line">02893</span>      <span class="uscript-comment">// Fill Javascript substs</span>
<span class="uscript-line">02894</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"JavaScripts"</span><span class="uscript-operator">,</span><span class="uscript-string">"&lt;script language=\"JavaScript\" type=\"text/JavaScript\"&gt;function MM_findObj(n,d){var p,i,x;if(!d)d=document;if((p=n.indexOf(\"?\"))&gt;0&amp;&amp;parent.frames.length){d=parent.frames[n.substring(p+1)].document;n=n.substring(0,p);}if(!(x=d[n])&amp;&amp;d.all)x=d.all[n];for(i=0;!x&amp;&amp;i&lt;d.forms.length;i++)x=d.forms[i][n];for(i=0;!x&amp;&amp;d.layers&amp;&amp;i&lt;d.layers.length;i++)x=MM_findObj(n,d.layers[i].document);if(!x&amp;&amp;d.getElementById)x=d.getElementById(n);return x;}function CheckMaps(){var maps=CheckMaps.arguments;var MapChecked=false;for(var i=0;i&lt;maps.length;i++){var myObj=MM_findObj(maps[i]);if(myObj.checked==true){MapChecked=true}}if(MapChecked==false){alert('You must check at least one map to continue!')}document.MM_returnValue=(MapChecked);}&lt;/script&gt;"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02895</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"JCheck"</span><span class="uscript-operator">,</span><span class="uscript-string">" onClick=\"CheckMaps('AllowAllMaps','"</span><span class="uscript-operator">$</span>CheckString<span class="uscript-operator">$</span><span class="uscript-string">"');return document.MM_returnValue\""</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02896</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"Checked"</span><span class="uscript-operator">,</span><span class="uscript-string">""</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02897</span>  
<span class="uscript-line">02898</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>bAllMaps<span class="uscript-operator">)</span>
<span class="uscript-line">02899</span>              Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"Content"</span><span class="uscript-operator">,</span> Checkbox<span class="uscript-operator">(</span><span class="uscript-string">"ClearAllMaps"</span><span class="uscript-operator">,</span> <span class="uscript-keyword">False</span><span class="uscript-operator">)</span> <span class="uscript-operator">@</span> LabelUncheckAllMap<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02900</span>          <span class="uscript-keyword">else</span> Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"Content"</span><span class="uscript-operator">,</span> Checkbox<span class="uscript-operator">(</span><span class="uscript-string">"AllowAllMaps"</span><span class="uscript-operator">,</span> <span class="uscript-keyword">False</span><span class="uscript-operator">)</span> <span class="uscript-operator">@</span> LabelCheckAllMap<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02901</span>  
<span class="uscript-line">02902</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SpanLength"</span><span class="uscript-operator">,</span> <span class="uscript-string">"2"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02903</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SpanContent"</span><span class="uscript-operator">,</span> <span class="uscript-string">"&amp;nbsp;&amp;nbsp;"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02904</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"RowContent"</span><span class="uscript-operator">,</span> WebInclude<span class="uscript-operator">(</span>CellColSpan<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02905</span>          MapRows <span class="uscript-operator">+=</span> WebInclude<span class="uscript-operator">(</span>RowLeft<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02906</span>  
<span class="uscript-line">02907</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"RowContent"</span><span class="uscript-operator">,</span> WebInclude<span class="uscript-operator">(</span>CellLeft<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02908</span>          MapRows <span class="uscript-operator">+=</span> WebInclude<span class="uscript-operator">(</span>RowLeft<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02909</span>  
<span class="uscript-line">02910</span>          <span class="uscript-comment">// Set ladder_caption_table subst's</span>
<span class="uscript-line">02911</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"PageCaption"</span><span class="uscript-operator">,</span>    CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"PageCaption"</span><span class="uscript-operator">,</span>PageCaption<span class="uscript-operator">[</span><span class="uscript-number">3</span><span class="uscript-operator">]</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02912</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"ButtonName"</span><span class="uscript-operator">,</span>     CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"ButtonName"</span><span class="uscript-operator">,</span> ProfileButtonName<span class="uscript-operator">[</span><span class="uscript-number">3</span><span class="uscript-operator">]</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02913</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"ButtonValue"</span><span class="uscript-operator">,</span>    CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"ButtonValue"</span><span class="uscript-operator">,</span> ProfileButtonValue<span class="uscript-operator">[</span><span class="uscript-number">3</span><span class="uscript-operator">]</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02914</span>  
<span class="uscript-line">02915</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"TableRows"</span><span class="uscript-operator">,</span> MapRows<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02916</span>  
<span class="uscript-line">02917</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"LadderTable"</span><span class="uscript-operator">,</span>    WebInclude<span class="uscript-operator">(</span>IncludeTable<span class="uscript-operator">)</span><span class="uscript-operator">$</span>WebInclude<span class="uscript-operator">(</span>IncludeCaptionButton<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02918</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"PostAction"</span><span class="uscript-operator">,</span>     CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"CurrentPage"</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02919</span>          ShowPage<span class="uscript-operator">(</span>Res<span class="uscript-operator">,</span> SubFrameContent<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02920</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">02921</span>  
<span class="uscript-line">02922</span>      <span class="uscript-keyword">else</span> AccessDenied<span class="uscript-operator">(</span>Res<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02923</span>  <span class="uscript-operator">}</span>
<span class="uscript-line">02924</span>  
<span class="uscript-line">02925</span>  <span class="uscript-comment">// Page 4</span>
<span class="uscript-line">02926</span>  <span class="uscript-keyword">function</span> QuerySubRules<span class="uscript-operator">(</span>WebRequest Req<span class="uscript-operator">,</span> WebResponse Res<span class="uscript-operator">)</span>
<span class="uscript-line">02927</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">02928</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">int</span> i<span class="uscript-operator">;</span>
<span class="uscript-line">02929</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">string</span>    TempStr<span class="uscript-operator">,</span>
<span class="uscript-line">02930</span>                      SID<span class="uscript-operator">;</span>
<span class="uscript-line">02931</span>      <span class="uscript-keyword">local</span> Session   CurS<span class="uscript-operator">;</span>
<span class="uscript-line">02932</span>      <span class="uscript-keyword">local</span> PlayInfo  TempPI<span class="uscript-operator">;</span>
<span class="uscript-line">02933</span>      <span class="uscript-keyword">local</span> <span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>Mutator<span class="uscript-operator">&gt;</span>        TempClass<span class="uscript-operator">;</span>
<span class="uscript-line">02934</span>      <span class="uscript-keyword">local</span> <span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>GameInfo<span class="uscript-operator">&gt;</span>       GIClass<span class="uscript-operator">;</span>
<span class="uscript-line">02935</span>      <span class="uscript-keyword">local</span> <span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>AccessControl<span class="uscript-operator">&gt;</span>  ACClass<span class="uscript-operator">;</span>
<span class="uscript-line">02936</span>      <span class="uscript-keyword">local</span> <span class="uscript-keyword">array</span><span class="uscript-operator">&lt;</span><span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>Mutator<span class="uscript-operator">&gt;</span> <span class="uscript-operator">&gt;</span> MClass<span class="uscript-operator">;</span>
<span class="uscript-line">02937</span>      <span class="uscript-keyword">local</span> <span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>Info<span class="uscript-operator">&gt;</span>           TempSA<span class="uscript-operator">;</span>
<span class="uscript-line">02938</span>      <span class="uscript-keyword">local</span> <span class="uscript-keyword">array</span><span class="uscript-operator">&lt;</span><span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>Info<span class="uscript-operator">&gt;</span> <span class="uscript-operator">&gt;</span>   SAClass<span class="uscript-operator">;</span>
<span class="uscript-line">02939</span>  
<span class="uscript-line">02940</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>CanPerform<span class="uscript-operator">(</span><span class="uscript-string">"Lm"</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">02941</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">02942</span>          SID <span class="uscript-operator">=</span> Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span><span class="uscript-string">"SessionID"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02943</span>          CurS <span class="uscript-operator">=</span> SMaster<span class="uscript-operator">.</span>GetSession<span class="uscript-operator">(</span>SID<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02944</span>  
<span class="uscript-line">02945</span>          TempStr <span class="uscript-operator">=</span> CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"GameType"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02946</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>TempStr <span class="uscript-operator">!=</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">02947</span>              GIClass <span class="uscript-operator">=</span> <span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>GameInfo<span class="uscript-operator">&gt;</span><span class="uscript-operator">(</span>DynamicLoadObject<span class="uscript-operator">(</span>TempStr<span class="uscript-operator">,</span><span class="uscript-keyword">class</span><span class="uscript-name">'Class'</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02948</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>GIClass <span class="uscript-operator">==</span> <span class="uscript-keyword">None</span><span class="uscript-operator">)</span>
<span class="uscript-line">02949</span>          <span class="uscript-operator">{</span>
<span class="uscript-line">02950</span>              ShowFramedMessage<span class="uscript-operator">(</span>Res<span class="uscript-operator">,</span>ErrorGameClassText<span class="uscript-operator">,</span><span class="uscript-keyword">True</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02951</span>              <span class="uscript-keyword">return</span><span class="uscript-operator">;</span>
<span class="uscript-line">02952</span>          <span class="uscript-operator">}</span>
<span class="uscript-line">02953</span>  
<span class="uscript-line">02954</span>          TempStr <span class="uscript-operator">=</span> CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"ACClass"</span><span class="uscript-operator">,</span> Level<span class="uscript-operator">.</span>Game<span class="uscript-operator">.</span>AccessControlClass<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02955</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>TempStr <span class="uscript-operator">!=</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">02956</span>              ACClass <span class="uscript-operator">=</span> <span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>AccessControl<span class="uscript-operator">&gt;</span><span class="uscript-operator">(</span>DynamicLoadObject<span class="uscript-operator">(</span>TempStr<span class="uscript-operator">,</span><span class="uscript-keyword">class</span><span class="uscript-name">'Class'</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02957</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>ACClass <span class="uscript-operator">==</span> <span class="uscript-keyword">None</span><span class="uscript-operator">)</span>
<span class="uscript-line">02958</span>          <span class="uscript-operator">{</span>
<span class="uscript-line">02959</span>              ShowFramedMessage<span class="uscript-operator">(</span>Res<span class="uscript-operator">,</span>ErrorAccessControlText<span class="uscript-operator">,</span><span class="uscript-keyword">True</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02960</span>              <span class="uscript-keyword">return</span><span class="uscript-operator">;</span>
<span class="uscript-line">02961</span>          <span class="uscript-operator">}</span>
<span class="uscript-line">02962</span>  
<span class="uscript-line">02963</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span>CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"ButtonName"</span><span class="uscript-operator">,</span><span class="uscript-string">""</span><span class="uscript-operator">)</span><span class="uscript-operator">,</span><span class="uscript-string">""</span><span class="uscript-operator">)</span><span class="uscript-operator">!=</span><span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">02964</span>          <span class="uscript-operator">{</span>
<span class="uscript-line">02965</span>              <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>i<span class="uscript-operator">&lt;</span>CurS<span class="uscript-operator">.</span>GetMutatorLength<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">02966</span>              <span class="uscript-operator">{</span>
<span class="uscript-line">02967</span>                  TempStr <span class="uscript-operator">=</span> CurS<span class="uscript-operator">.</span>getMutator<span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02968</span>                  <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>TempStr <span class="uscript-operator">!=</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">02969</span>                  <span class="uscript-operator">{</span>
<span class="uscript-line">02970</span>                      TempClass <span class="uscript-operator">=</span> <span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>Mutator<span class="uscript-operator">&gt;</span><span class="uscript-operator">(</span>DynamicLoadObject<span class="uscript-operator">(</span>TempStr<span class="uscript-operator">,</span><span class="uscript-keyword">class</span><span class="uscript-name">'Class'</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02971</span>                      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>TempClass <span class="uscript-operator">!=</span> <span class="uscript-keyword">None</span><span class="uscript-operator">)</span>
<span class="uscript-line">02972</span>                          MClass<span class="uscript-operator">[</span>MClass<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">]</span> <span class="uscript-operator">=</span> TempClass<span class="uscript-operator">;</span>
<span class="uscript-line">02973</span>                  <span class="uscript-operator">}</span>
<span class="uscript-line">02974</span>              <span class="uscript-operator">}</span>
<span class="uscript-line">02975</span>  
<span class="uscript-line">02976</span>              TempPI <span class="uscript-operator">=</span> <span class="uscript-keyword">new</span><span class="uscript-operator">(</span><span class="uscript-keyword">None</span><span class="uscript-operator">)</span> <span class="uscript-keyword">class</span><span class="uscript-name">'PlayInfo'</span><span class="uscript-operator">;</span>
<span class="uscript-line">02977</span>              <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>i<span class="uscript-operator">&lt;</span>CurS<span class="uscript-operator">.</span>getSALength<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">02978</span>              <span class="uscript-operator">{</span>
<span class="uscript-line">02979</span>                  TempStr <span class="uscript-operator">=</span> CurS<span class="uscript-operator">.</span>getServerActor<span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02980</span>                  <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>TempStr <span class="uscript-operator">!=</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">02981</span>                  <span class="uscript-operator">{</span>
<span class="uscript-line">02982</span>                      TempSA <span class="uscript-operator">=</span> <span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>Info<span class="uscript-operator">&gt;</span><span class="uscript-operator">(</span>DynamicLoadObject<span class="uscript-operator">(</span>TempStr<span class="uscript-operator">,</span><span class="uscript-keyword">class</span><span class="uscript-name">'Class'</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02983</span>                      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>TempSA <span class="uscript-operator">!=</span> <span class="uscript-keyword">None</span><span class="uscript-operator">)</span>
<span class="uscript-line">02984</span>                          SAClass<span class="uscript-operator">[</span>SAClass<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">]</span> <span class="uscript-operator">=</span> TempSA<span class="uscript-operator">;</span>
<span class="uscript-line">02985</span>                  <span class="uscript-operator">}</span>
<span class="uscript-line">02986</span>              <span class="uscript-operator">}</span>
<span class="uscript-line">02987</span>  
<span class="uscript-line">02988</span>              LoadThisPlayInfo<span class="uscript-operator">(</span>TempPI<span class="uscript-operator">,</span> GIClass<span class="uscript-operator">,</span> ACClass<span class="uscript-operator">,</span> MClass<span class="uscript-operator">,</span> SAClass<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02989</span>              <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>i<span class="uscript-operator">&lt;</span>TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">;</span>i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">02990</span>              <span class="uscript-operator">{</span>
<span class="uscript-line">02991</span>                  <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">!</span>SettingIsAllowed<span class="uscript-operator">(</span>TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>SecLevel<span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-keyword">continue</span><span class="uscript-operator">;</span>
<span class="uscript-line">02992</span>                  TempStr <span class="uscript-operator">=</span> Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span>TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>SettingName<span class="uscript-operator">,</span>TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>Value<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02993</span>  
<span class="uscript-line">02994</span>                  <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>RenderType <span class="uscript-operator">==</span> <span class="uscript-string">"Text"</span><span class="uscript-operator">)</span>
<span class="uscript-line">02995</span>                      CheckSettingValue<span class="uscript-operator">(</span>TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>Data<span class="uscript-operator">,</span> TempStr<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02996</span>  
<span class="uscript-line">02997</span>                  CurS<span class="uscript-operator">.</span>setValue<span class="uscript-operator">(</span>TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>SettingName<span class="uscript-operator">,</span>TempStr<span class="uscript-operator">,</span><span class="uscript-keyword">true</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">02998</span>              <span class="uscript-operator">}</span>
<span class="uscript-line">02999</span>          <span class="uscript-operator">}</span>
<span class="uscript-line">03000</span>  
<span class="uscript-line">03001</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"TableRows"</span><span class="uscript-operator">,</span>      GeneratePlayInfoRows<span class="uscript-operator">(</span>Req<span class="uscript-operator">,</span> Res<span class="uscript-operator">,</span> <span class="uscript-string">"defaults_row"</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03002</span>  
<span class="uscript-line">03003</span>          <span class="uscript-comment">// Set ladder_caption_table subst's</span>
<span class="uscript-line">03004</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"PageCaption"</span><span class="uscript-operator">,</span>    CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"PageCaption"</span><span class="uscript-operator">,</span>PageCaption<span class="uscript-operator">[</span><span class="uscript-number">4</span><span class="uscript-operator">]</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03005</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"ButtonName"</span><span class="uscript-operator">,</span>     CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"ButtonName"</span><span class="uscript-operator">,</span> ProfileButtonName<span class="uscript-operator">[</span><span class="uscript-number">4</span><span class="uscript-operator">]</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03006</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"ButtonValue"</span><span class="uscript-operator">,</span>    CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"ButtonValue"</span><span class="uscript-operator">,</span> ProfileButtonValue<span class="uscript-operator">[</span><span class="uscript-number">4</span><span class="uscript-operator">]</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03007</span>  
<span class="uscript-line">03008</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"LadderTable"</span><span class="uscript-operator">,</span>    WebInclude<span class="uscript-operator">(</span>IncludeTable<span class="uscript-operator">)</span><span class="uscript-operator">$</span>WebInclude<span class="uscript-operator">(</span>IncludeCaptionButton<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03009</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"PostAction"</span><span class="uscript-operator">,</span>     CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"CurrentPage"</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03010</span>          ShowPage<span class="uscript-operator">(</span>Res<span class="uscript-operator">,</span> SubFrameContent<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03011</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">03012</span>  
<span class="uscript-line">03013</span>      <span class="uscript-keyword">else</span> AccessDenied<span class="uscript-operator">(</span>Res<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03014</span>  <span class="uscript-operator">}</span>
<span class="uscript-line">03015</span>  
<span class="uscript-line">03016</span>  <span class="uscript-comment">// Page 5</span>
<span class="uscript-line">03017</span>  <span class="uscript-keyword">function</span> QuerySubReview<span class="uscript-operator">(</span>WebRequest Req<span class="uscript-operator">,</span> WebResponse Res<span class="uscript-operator">)</span>
<span class="uscript-line">03018</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">03019</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">int</span> i<span class="uscript-operator">,</span>j<span class="uscript-operator">,</span>k<span class="uscript-operator">,</span>z<span class="uscript-operator">;</span>
<span class="uscript-line">03020</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">string</span>    SID<span class="uscript-operator">,</span>
<span class="uscript-line">03021</span>                      TempStr<span class="uscript-operator">,</span> TempSA<span class="uscript-operator">,</span>
<span class="uscript-line">03022</span>                      ReviewRows<span class="uscript-operator">,</span>
<span class="uscript-line">03023</span>                      thisgroup<span class="uscript-operator">,</span> lastgroup<span class="uscript-operator">,</span> nextgroup<span class="uscript-operator">;</span>
<span class="uscript-line">03024</span>  
<span class="uscript-line">03025</span>      <span class="uscript-keyword">local</span> Session CurS<span class="uscript-operator">;</span>
<span class="uscript-line">03026</span>      <span class="uscript-keyword">local</span> StringArray Mutators<span class="uscript-operator">,</span> GroupsOnly<span class="uscript-operator">;</span>
<span class="uscript-line">03027</span>      <span class="uscript-keyword">local</span> <span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>Mutator<span class="uscript-operator">&gt;</span>        TempClass<span class="uscript-operator">;</span>
<span class="uscript-line">03028</span>      <span class="uscript-keyword">local</span> <span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>Info<span class="uscript-operator">&gt;</span>           TempSAClass<span class="uscript-operator">;</span>
<span class="uscript-line">03029</span>      <span class="uscript-keyword">local</span> <span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>GameInfo<span class="uscript-operator">&gt;</span>       GIClass<span class="uscript-operator">;</span>
<span class="uscript-line">03030</span>      <span class="uscript-keyword">local</span> <span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>AccessControl<span class="uscript-operator">&gt;</span>  ACClass<span class="uscript-operator">;</span>
<span class="uscript-line">03031</span>      <span class="uscript-keyword">local</span> <span class="uscript-keyword">array</span><span class="uscript-operator">&lt;</span><span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>Mutator<span class="uscript-operator">&gt;</span> <span class="uscript-operator">&gt;</span> MClass<span class="uscript-operator">;</span>
<span class="uscript-line">03032</span>  
<span class="uscript-line">03033</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>CanPerform<span class="uscript-operator">(</span><span class="uscript-string">"Lm"</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">03034</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">03035</span>          SID <span class="uscript-operator">=</span> Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span><span class="uscript-string">"SessionID"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03036</span>          CurS <span class="uscript-operator">=</span> SMaster<span class="uscript-operator">.</span>getSession<span class="uscript-operator">(</span>SID<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03037</span>  
<span class="uscript-line">03038</span>          TempStr <span class="uscript-operator">=</span> CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"GameType"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03039</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>TempStr <span class="uscript-operator">!=</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">03040</span>              GIClass <span class="uscript-operator">=</span> <span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>GameInfo<span class="uscript-operator">&gt;</span><span class="uscript-operator">(</span>DynamicLoadObject<span class="uscript-operator">(</span>TempStr<span class="uscript-operator">,</span><span class="uscript-keyword">class</span><span class="uscript-name">'Class'</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03041</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>GIClass <span class="uscript-operator">==</span> <span class="uscript-keyword">None</span><span class="uscript-operator">)</span>
<span class="uscript-line">03042</span>          <span class="uscript-operator">{</span>
<span class="uscript-line">03043</span>              ShowFramedMessage<span class="uscript-operator">(</span>Res<span class="uscript-operator">,</span>ErrorGameClassText<span class="uscript-operator">,</span><span class="uscript-keyword">True</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03044</span>              <span class="uscript-keyword">return</span><span class="uscript-operator">;</span>
<span class="uscript-line">03045</span>          <span class="uscript-operator">}</span>
<span class="uscript-line">03046</span>  
<span class="uscript-line">03047</span>          TempStr <span class="uscript-operator">=</span> CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"ACClass"</span><span class="uscript-operator">,</span>Level<span class="uscript-operator">.</span>Game<span class="uscript-operator">.</span>AccessControlClass<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03048</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>TempStr <span class="uscript-operator">!=</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">03049</span>              ACClass <span class="uscript-operator">=</span> <span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>AccessControl<span class="uscript-operator">&gt;</span><span class="uscript-operator">(</span>DynamicLoadObject<span class="uscript-operator">(</span>TempStr<span class="uscript-operator">,</span><span class="uscript-keyword">class</span><span class="uscript-name">'Class'</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03050</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>ACClass <span class="uscript-operator">==</span> <span class="uscript-keyword">None</span><span class="uscript-operator">)</span>
<span class="uscript-line">03051</span>          <span class="uscript-operator">{</span>
<span class="uscript-line">03052</span>              ShowFramedMessage<span class="uscript-operator">(</span>Res<span class="uscript-operator">,</span>ErrorAccessControlText<span class="uscript-operator">,</span><span class="uscript-keyword">True</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03053</span>              <span class="uscript-keyword">return</span><span class="uscript-operator">;</span>
<span class="uscript-line">03054</span>          <span class="uscript-operator">}</span>
<span class="uscript-line">03055</span>  
<span class="uscript-line">03056</span>          Mutators <span class="uscript-operator">=</span> <span class="uscript-keyword">new</span><span class="uscript-operator">(</span><span class="uscript-keyword">None</span><span class="uscript-operator">)</span> <span class="uscript-keyword">class</span><span class="uscript-name">'SortedStringArray'</span><span class="uscript-operator">;</span>
<span class="uscript-line">03057</span>          GroupsOnly <span class="uscript-operator">=</span> <span class="uscript-keyword">new</span><span class="uscript-operator">(</span><span class="uscript-keyword">None</span><span class="uscript-operator">)</span> <span class="uscript-keyword">class</span><span class="uscript-name">'SortedStringArray'</span><span class="uscript-operator">;</span>
<span class="uscript-line">03058</span>          <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i <span class="uscript-operator">=</span> <span class="uscript-number">0</span><span class="uscript-operator">;</span> i<span class="uscript-operator">&lt;</span>AllMutators<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">;</span> i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">03059</span>          <span class="uscript-operator">{</span>
<span class="uscript-line">03060</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>CurS<span class="uscript-operator">.</span>HasMutator<span class="uscript-operator">(</span>AllMutators<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>ClassName<span class="uscript-operator">)</span><span class="uscript-operator">||</span>CurS<span class="uscript-operator">.</span>HasMutator<span class="uscript-operator">(</span>AllMutators<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>GroupName<span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">03061</span>              <span class="uscript-operator">{</span>
<span class="uscript-line">03062</span>                  TempClass <span class="uscript-operator">=</span> <span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>Mutator<span class="uscript-operator">&gt;</span><span class="uscript-operator">(</span>DynamicLoadObject<span class="uscript-operator">(</span>AllMutators<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>ClassName<span class="uscript-operator">,</span> <span class="uscript-keyword">class</span><span class="uscript-name">'Class'</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03063</span>                  <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>TempClass <span class="uscript-operator">!=</span> <span class="uscript-keyword">None</span><span class="uscript-operator">)</span>
<span class="uscript-line">03064</span>                  <span class="uscript-operator">{</span>
<span class="uscript-line">03065</span>                      MClass<span class="uscript-operator">[</span>MClass<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">]</span> <span class="uscript-operator">=</span> TempClass<span class="uscript-operator">;</span>
<span class="uscript-line">03066</span>                      Mutators<span class="uscript-operator">.</span>Add<span class="uscript-operator">(</span><span class="uscript-type">string</span><span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">,</span>AllMutators<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>FriendlyName<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03067</span>                  <span class="uscript-operator">}</span>
<span class="uscript-line">03068</span>              <span class="uscript-operator">}</span>
<span class="uscript-line">03069</span>          <span class="uscript-operator">}</span>
<span class="uscript-line">03070</span>  
<span class="uscript-line">03071</span>          CreateFullMutatorList<span class="uscript-operator">(</span>Mutators<span class="uscript-operator">,</span>GroupsOnly<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03072</span>          lastgroup <span class="uscript-operator">=</span> <span class="uscript-string">""</span><span class="uscript-operator">;</span> thisgroup <span class="uscript-operator">=</span> <span class="uscript-string">""</span><span class="uscript-operator">;</span> nextgroup <span class="uscript-operator">=</span> <span class="uscript-string">""</span><span class="uscript-operator">;</span>
<span class="uscript-line">03073</span>  
<span class="uscript-line">03074</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SectionName"</span><span class="uscript-operator">,</span> TableTitle<span class="uscript-operator">[</span><span class="uscript-number">2</span><span class="uscript-operator">]</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03075</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SpecialInstructions"</span><span class="uscript-operator">,</span> LabelRequiredMutators<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03076</span>          ReviewRows <span class="uscript-operator">+=</span> WebInclude<span class="uscript-operator">(</span>IncludeSection<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03077</span>  
<span class="uscript-line">03078</span>          <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>i<span class="uscript-operator">&lt;</span>GroupsOnly<span class="uscript-operator">.</span>Count<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">03079</span>          <span class="uscript-operator">{</span>
<span class="uscript-line">03080</span>              j<span class="uscript-operator">=</span><span class="uscript-type">int</span><span class="uscript-operator">(</span>GroupsOnly<span class="uscript-operator">.</span>GetItem<span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03081</span>  
<span class="uscript-line">03082</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>AllMutators<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>GroupName<span class="uscript-operator">==</span><span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">03083</span>                  thisgroup<span class="uscript-operator">=</span><span class="uscript-string">"Z"</span><span class="uscript-operator">$</span><span class="uscript-type">string</span><span class="uscript-operator">(</span>z<span class="uscript-operator">++</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03084</span>              <span class="uscript-keyword">else</span> thisgroup <span class="uscript-operator">=</span> AllMutators<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>GroupName<span class="uscript-operator">;</span>
<span class="uscript-line">03085</span>  
<span class="uscript-line">03086</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span> <span class="uscript-operator">(</span>i <span class="uscript-operator">+</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span> <span class="uscript-operator">==</span> GroupsOnly<span class="uscript-operator">.</span>Count<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">03087</span>                  nextgroup <span class="uscript-operator">=</span> <span class="uscript-string">""</span><span class="uscript-operator">;</span>
<span class="uscript-line">03088</span>              <span class="uscript-keyword">else</span>
<span class="uscript-line">03089</span>              <span class="uscript-operator">{</span>
<span class="uscript-line">03090</span>              <span class="uscript-comment">// Assign nextgroup to the next mutators group</span>
<span class="uscript-line">03091</span>                  k <span class="uscript-operator">=</span> <span class="uscript-type">int</span><span class="uscript-operator">(</span>GroupsOnly<span class="uscript-operator">.</span>GetItem<span class="uscript-operator">(</span>i <span class="uscript-operator">+</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03092</span>                  <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>AllMutators<span class="uscript-operator">[</span>k<span class="uscript-operator">]</span><span class="uscript-operator">.</span>GroupName<span class="uscript-operator">==</span><span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">03093</span>                      nextgroup<span class="uscript-operator">=</span><span class="uscript-string">"Z"</span><span class="uscript-operator">$</span><span class="uscript-type">string</span><span class="uscript-operator">(</span>z<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03094</span>                  <span class="uscript-keyword">else</span> nextgroup <span class="uscript-operator">=</span> AllMutators<span class="uscript-operator">[</span>k<span class="uscript-operator">]</span><span class="uscript-operator">.</span>GroupName<span class="uscript-operator">;</span>
<span class="uscript-line">03095</span>              <span class="uscript-operator">}</span>
<span class="uscript-line">03096</span>  
<span class="uscript-line">03097</span>              Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"GroupName"</span><span class="uscript-operator">,</span> thisgroup<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03098</span>              Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"MutatorClass"</span><span class="uscript-operator">,</span> AllMutators<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>ClassName<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03099</span>              Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"MutatorName"</span><span class="uscript-operator">,</span> AllMutators<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>FriendlyName<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03100</span>              Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"MutatorDesc"</span><span class="uscript-operator">,</span> AllMutators<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>Description<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03101</span>  
<span class="uscript-line">03102</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">(</span>lastgroup <span class="uscript-operator">!=</span> thisgroup<span class="uscript-operator">)</span> <span class="uscript-operator">&amp;&amp;</span> <span class="uscript-operator">(</span>thisgroup <span class="uscript-operator">==</span> nextgroup<span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-comment">// and the next mut is in the same group as this one</span>
<span class="uscript-line">03103</span>              <span class="uscript-operator">{</span>
<span class="uscript-line">03104</span>                  Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"Checked"</span><span class="uscript-operator">,</span> <span class="uscript-string">" checked"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03105</span>                  ReviewRows <span class="uscript-operator">+=</span> WebInclude<span class="uscript-operator">(</span><span class="uscript-string">"current_mutators_group"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03106</span>              <span class="uscript-operator">}</span>
<span class="uscript-line">03107</span>  
<span class="uscript-line">03108</span>              Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"Checked"</span><span class="uscript-operator">,</span> StringIf<span class="uscript-operator">(</span>CurS<span class="uscript-operator">.</span>MutRequired<span class="uscript-operator">(</span>AllMutators<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>ClassName<span class="uscript-operator">)</span><span class="uscript-operator">,</span> <span class="uscript-string">" checked"</span><span class="uscript-operator">,</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03109</span>              ReviewRows <span class="uscript-operator">+=</span> WebInclude<span class="uscript-operator">(</span><span class="uscript-string">"current_mutators_group_row"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03110</span>  
<span class="uscript-line">03111</span>              lastgroup<span class="uscript-operator">=</span>thisgroup<span class="uscript-operator">;</span>
<span class="uscript-line">03112</span>          <span class="uscript-operator">}</span>
<span class="uscript-line">03113</span>  
<span class="uscript-line">03114</span>          <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i <span class="uscript-operator">=</span> <span class="uscript-number">0</span><span class="uscript-operator">;</span> i<span class="uscript-operator">&lt;</span>Mutators<span class="uscript-operator">.</span>Count<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span> i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">03115</span>          <span class="uscript-operator">{</span>
<span class="uscript-line">03116</span>              TempStr <span class="uscript-operator">=</span> <span class="uscript-string">""</span><span class="uscript-operator">;</span>
<span class="uscript-line">03117</span>              j <span class="uscript-operator">=</span> <span class="uscript-type">int</span><span class="uscript-operator">(</span>Mutators<span class="uscript-operator">.</span>GetItem<span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03118</span>  
<span class="uscript-line">03119</span>              Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"Content"</span><span class="uscript-operator">,</span> CheckBox<span class="uscript-operator">(</span>AllMutators<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>ClassName<span class="uscript-operator">,</span> CurS<span class="uscript-operator">.</span>MutRequired<span class="uscript-operator">(</span>AllMutators<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>ClassName<span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">$</span> <span class="uscript-string">"&amp;nbsp;"</span> <span class="uscript-operator">$</span> AllMutators<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>FriendlyName<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03120</span>              TempStr <span class="uscript-operator">=</span> WebInclude<span class="uscript-operator">(</span>NowrapLeft<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03121</span>              Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"Content"</span><span class="uscript-operator">,</span> AllMutators<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>Description<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03122</span>              Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"RowContent"</span><span class="uscript-operator">,</span> TempStr <span class="uscript-operator">$</span> WebInclude<span class="uscript-operator">(</span>CellLeft<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03123</span>  
<span class="uscript-line">03124</span>              ReviewRows <span class="uscript-operator">+=</span> WebInclude<span class="uscript-operator">(</span>RowLeft<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03125</span>          <span class="uscript-operator">}</span>
<span class="uscript-line">03126</span>  
<span class="uscript-line">03127</span>          Mutators<span class="uscript-operator">.</span>Reset<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03128</span>          <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i <span class="uscript-operator">=</span> <span class="uscript-number">0</span><span class="uscript-operator">;</span> i <span class="uscript-operator">&lt;</span> ConfigM<span class="uscript-operator">.</span>ManagedActors<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">;</span> i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">03129</span>          <span class="uscript-operator">{</span>
<span class="uscript-line">03130</span>              TempSA <span class="uscript-operator">=</span> <span class="uscript-type">string</span><span class="uscript-operator">(</span>ConfigM<span class="uscript-operator">.</span>ManagedActors<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>SAClass<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03131</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>CurS<span class="uscript-operator">.</span>HasServerActor<span class="uscript-operator">(</span>TempSA<span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">03132</span>              <span class="uscript-operator">{</span>
<span class="uscript-line">03133</span>                  TempSAClass <span class="uscript-operator">=</span> <span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>Info<span class="uscript-operator">&gt;</span><span class="uscript-operator">(</span>DynamicLoadObject<span class="uscript-operator">(</span>TempSA<span class="uscript-operator">,</span><span class="uscript-keyword">class</span><span class="uscript-name">'Class'</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03134</span>                  <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>TempSAClass <span class="uscript-operator">!=</span> <span class="uscript-keyword">None</span><span class="uscript-operator">)</span>
<span class="uscript-line">03135</span>                      Mutators<span class="uscript-operator">.</span>Add<span class="uscript-operator">(</span><span class="uscript-type">string</span><span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">,</span>ConfigM<span class="uscript-operator">.</span>ManagedActors<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>SAName<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03136</span>              <span class="uscript-operator">}</span>
<span class="uscript-line">03137</span>          <span class="uscript-operator">}</span>
<span class="uscript-line">03138</span>          lastgroup <span class="uscript-operator">=</span> <span class="uscript-string">""</span><span class="uscript-operator">;</span>
<span class="uscript-line">03139</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SpanLength"</span><span class="uscript-operator">,</span> <span class="uscript-string">"2"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03140</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SpanContent"</span><span class="uscript-operator">,</span> <span class="uscript-string">"&amp;nbsp;&amp;nbsp;"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03141</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"RowContent"</span><span class="uscript-operator">,</span> WebInclude<span class="uscript-operator">(</span>CellColSpan<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03142</span>          lastgroup <span class="uscript-operator">=</span> WebInclude<span class="uscript-operator">(</span>RowLeft<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03143</span>          ReviewRows <span class="uscript-operator">+=</span> lastgroup<span class="uscript-operator">;</span>
<span class="uscript-line">03144</span>  
<span class="uscript-line">03145</span>          <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>i<span class="uscript-operator">&lt;</span>Mutators<span class="uscript-operator">.</span>Count<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">03146</span>          <span class="uscript-operator">{</span>
<span class="uscript-line">03147</span>              TempStr <span class="uscript-operator">=</span> <span class="uscript-string">""</span><span class="uscript-operator">;</span>
<span class="uscript-line">03148</span>              j <span class="uscript-operator">=</span> <span class="uscript-type">int</span><span class="uscript-operator">(</span>Mutators<span class="uscript-operator">.</span>GetItem<span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03149</span>  
<span class="uscript-line">03150</span>              Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"Content"</span><span class="uscript-operator">,</span> Checkbox<span class="uscript-operator">(</span><span class="uscript-type">string</span><span class="uscript-operator">(</span>ConfigM<span class="uscript-operator">.</span>ManagedActors<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>SAClass<span class="uscript-operator">)</span><span class="uscript-operator">,</span> CurS<span class="uscript-operator">.</span>SARequired<span class="uscript-operator">(</span><span class="uscript-type">string</span><span class="uscript-operator">(</span>ConfigM<span class="uscript-operator">.</span>ManagedActors<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>SAClass<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">$</span> <span class="uscript-string">"&amp;nbsp;"</span> <span class="uscript-operator">$</span> Mutators<span class="uscript-operator">.</span>GetTag<span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03151</span>              TempStr <span class="uscript-operator">=</span> WebInclude<span class="uscript-operator">(</span>NowrapLeft<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03152</span>              Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"Content"</span><span class="uscript-operator">,</span> ConfigM<span class="uscript-operator">.</span>ManagedActors<span class="uscript-operator">[</span>j<span class="uscript-operator">]</span><span class="uscript-operator">.</span>SADescription<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03153</span>              Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"RowContent"</span><span class="uscript-operator">,</span> TempStr <span class="uscript-operator">$</span> WebInclude<span class="uscript-operator">(</span>CellLeft<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03154</span>              ReviewRows <span class="uscript-operator">+=</span> WebInclude<span class="uscript-operator">(</span>RowLeft<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03155</span>          <span class="uscript-operator">}</span>
<span class="uscript-line">03156</span>  
<span class="uscript-line">03157</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SectionName"</span><span class="uscript-operator">,</span> TableTitle<span class="uscript-operator">[</span><span class="uscript-number">3</span><span class="uscript-operator">]</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03158</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SpecialInstructions"</span><span class="uscript-operator">,</span> LabelRequiredMaps<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03159</span>          ReviewRows <span class="uscript-operator">+=</span> WebInclude<span class="uscript-operator">(</span>IncludeSection<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03160</span>  
<span class="uscript-line">03161</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SettingName"</span><span class="uscript-operator">,</span> LabelMaxMaps<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03162</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SettingData"</span><span class="uscript-operator">,</span> Textbox<span class="uscript-operator">(</span><span class="uscript-string">"MaxMaps"</span><span class="uscript-operator">,</span> <span class="uscript-number">3</span><span class="uscript-operator">,</span> <span class="uscript-number">3</span><span class="uscript-operator">,</span> CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"MaxMaps"</span><span class="uscript-operator">,</span><span class="uscript-string">"3"</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03163</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"Extra"</span><span class="uscript-operator">,</span> lastgroup<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03164</span>          ReviewRows <span class="uscript-operator">+=</span> WebInclude<span class="uscript-operator">(</span>IncludeRows<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03165</span>          <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>i<span class="uscript-operator">&lt;</span>CurS<span class="uscript-operator">.</span>GetMapLength<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">03166</span>          <span class="uscript-operator">{</span>
<span class="uscript-line">03167</span>              Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SettingName"</span><span class="uscript-operator">,</span> CurS<span class="uscript-operator">.</span>getMap<span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03168</span>              Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"Extra"</span><span class="uscript-operator">,</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03169</span>              Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SettingData"</span><span class="uscript-operator">,</span> Checkbox<span class="uscript-operator">(</span>CurS<span class="uscript-operator">.</span>getMap<span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">,</span> CurS<span class="uscript-operator">.</span>MapRequired<span class="uscript-operator">(</span>CurS<span class="uscript-operator">.</span>getMap<span class="uscript-operator">(</span>i<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03170</span>  
<span class="uscript-line">03171</span>              ReviewRows <span class="uscript-operator">+=</span> WebInclude<span class="uscript-operator">(</span>IncludeRows<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03172</span>          <span class="uscript-operator">}</span>
<span class="uscript-line">03173</span>  
<span class="uscript-line">03174</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SectionName"</span><span class="uscript-operator">,</span> TableTitle<span class="uscript-operator">[</span><span class="uscript-number">4</span><span class="uscript-operator">]</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03175</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SpecialInstructions"</span><span class="uscript-operator">,</span> LabelPlayInfo<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03176</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"Extra"</span><span class="uscript-operator">,</span> lastgroup<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03177</span>          ReviewRows <span class="uscript-operator">+=</span> WebInclude<span class="uscript-operator">(</span>IncludeSection<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03178</span>  
<span class="uscript-line">03179</span>          ReviewRows <span class="uscript-operator">+=</span> <span class="uscript-operator">(</span>lastgroup <span class="uscript-operator">$</span> GeneratePlayInfoRows<span class="uscript-operator">(</span>Req<span class="uscript-operator">,</span> Res<span class="uscript-operator">,</span> IncludeRows<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03180</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"TableRows"</span><span class="uscript-operator">,</span> ReviewRows<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03181</span>  
<span class="uscript-line">03182</span>      <span class="uscript-comment">// Set ladder_caption_table subst's</span>
<span class="uscript-line">03183</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"PageCaption"</span><span class="uscript-operator">,</span>    CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"PageCaption"</span><span class="uscript-operator">,</span>PageCaption<span class="uscript-operator">[</span><span class="uscript-number">5</span><span class="uscript-operator">]</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03184</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"ButtonName"</span><span class="uscript-operator">,</span>     CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"ButtonName"</span><span class="uscript-operator">,</span> ProfileButtonName<span class="uscript-operator">[</span><span class="uscript-number">5</span><span class="uscript-operator">]</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03185</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"ButtonValue"</span><span class="uscript-operator">,</span>    CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"ButtonValue"</span><span class="uscript-operator">,</span> ProfileButtonValue<span class="uscript-operator">[</span><span class="uscript-number">5</span><span class="uscript-operator">]</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03186</span>  
<span class="uscript-line">03187</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"LadderTable"</span><span class="uscript-operator">,</span>    WebInclude<span class="uscript-operator">(</span>IncludeTable<span class="uscript-operator">)</span><span class="uscript-operator">$</span>WebInclude<span class="uscript-operator">(</span>IncludeCaptionButton<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03188</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"PostAction"</span><span class="uscript-operator">,</span>     SubSavedURI<span class="uscript-operator">$</span><span class="uscript-string">"?SessionID="</span><span class="uscript-operator">$</span>SID<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03189</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"NewTarget"</span><span class="uscript-operator">,</span>      <span class="uscript-string">" target=\"_parent\""</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03190</span>          ShowPage<span class="uscript-operator">(</span>Res<span class="uscript-operator">,</span> SubFrameContent<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03191</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">03192</span>  
<span class="uscript-line">03193</span>      <span class="uscript-keyword">else</span> AccessDenied<span class="uscript-operator">(</span>Res<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03194</span>  <span class="uscript-operator">}</span>
<span class="uscript-line">03195</span>  
<span class="uscript-line">03196</span>  <span class="uscript-comment">// Page 6</span>
<span class="uscript-line">03197</span>  <span class="uscript-keyword">function</span> QuerySubSaved<span class="uscript-operator">(</span>WebRequest Req<span class="uscript-operator">,</span> WebResponse Res<span class="uscript-operator">)</span>
<span class="uscript-line">03198</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">03199</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">int</span> i<span class="uscript-operator">,</span>k<span class="uscript-operator">,</span> x<span class="uscript-operator">;</span>
<span class="uscript-line">03200</span>      <span class="uscript-keyword">local</span> <span class="uscript-type">string</span>    SID<span class="uscript-operator">,</span>
<span class="uscript-line">03201</span>                      tmp<span class="uscript-operator">,</span> tmp1<span class="uscript-operator">,</span>
<span class="uscript-line">03202</span>                      TempStr<span class="uscript-operator">;</span>
<span class="uscript-line">03203</span>      <span class="uscript-keyword">local</span> Session               CurS<span class="uscript-operator">;</span>
<span class="uscript-line">03204</span>      <span class="uscript-keyword">local</span> PlayInfo              TempPI<span class="uscript-operator">;</span>
<span class="uscript-line">03205</span>      <span class="uscript-keyword">local</span> ProfileConfigSet      TempPCS<span class="uscript-operator">;</span>
<span class="uscript-line">03206</span>      <span class="uscript-keyword">local</span> <span class="uscript-keyword">array</span><span class="uscript-operator">&lt;</span><span class="uscript-type">string</span><span class="uscript-operator">&gt;</span>         TempArr<span class="uscript-operator">;</span>
<span class="uscript-line">03207</span>      <span class="uscript-keyword">local</span> <span class="uscript-keyword">array</span><span class="uscript-operator">&lt;</span><span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>Mutator<span class="uscript-operator">&gt;</span> <span class="uscript-operator">&gt;</span> MClass<span class="uscript-operator">;</span>
<span class="uscript-line">03208</span>      <span class="uscript-keyword">local</span> <span class="uscript-keyword">array</span><span class="uscript-operator">&lt;</span><span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>Info<span class="uscript-operator">&gt;</span> <span class="uscript-operator">&gt;</span>   SAClass<span class="uscript-operator">;</span>
<span class="uscript-line">03209</span>  
<span class="uscript-line">03210</span>      <span class="uscript-keyword">local</span> <span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>Mutator<span class="uscript-operator">&gt;</span>        MutClass<span class="uscript-operator">;</span>
<span class="uscript-line">03211</span>      <span class="uscript-keyword">local</span> <span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>GameInfo<span class="uscript-operator">&gt;</span>       GIClass<span class="uscript-operator">;</span>
<span class="uscript-line">03212</span>      <span class="uscript-keyword">local</span> <span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>AccessControl<span class="uscript-operator">&gt;</span>  ACClass<span class="uscript-operator">;</span>
<span class="uscript-line">03213</span>      <span class="uscript-keyword">local</span> <span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>Info<span class="uscript-operator">&gt;</span>           TempSA<span class="uscript-operator">;</span>
<span class="uscript-line">03214</span>  
<span class="uscript-line">03215</span>  
<span class="uscript-line">03216</span>      SID <span class="uscript-operator">=</span> Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span><span class="uscript-string">"SessionID"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03217</span>      CurS <span class="uscript-operator">=</span> SMaster<span class="uscript-operator">.</span>getSession<span class="uscript-operator">(</span>SID<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03218</span>      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>CanPerform<span class="uscript-operator">(</span><span class="uscript-string">"Lm"</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">03219</span>      <span class="uscript-operator">{</span>
<span class="uscript-line">03220</span>          TempStr <span class="uscript-operator">=</span> CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"GameType"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03221</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>TempStr <span class="uscript-operator">!=</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">03222</span>              GIClass <span class="uscript-operator">=</span> <span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>GameInfo<span class="uscript-operator">&gt;</span><span class="uscript-operator">(</span>DynamicLoadObject<span class="uscript-operator">(</span>TempStr<span class="uscript-operator">,</span><span class="uscript-keyword">class</span><span class="uscript-name">'Class'</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03223</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>GIClass <span class="uscript-operator">==</span> <span class="uscript-keyword">None</span><span class="uscript-operator">)</span>
<span class="uscript-line">03224</span>          <span class="uscript-operator">{</span>
<span class="uscript-line">03225</span>              ShowFramedMessage<span class="uscript-operator">(</span>Res<span class="uscript-operator">,</span>ErrorGameClassText<span class="uscript-operator">,</span><span class="uscript-keyword">True</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03226</span>              <span class="uscript-keyword">return</span><span class="uscript-operator">;</span>
<span class="uscript-line">03227</span>          <span class="uscript-operator">}</span>
<span class="uscript-line">03228</span>  
<span class="uscript-line">03229</span>          TempStr <span class="uscript-operator">=</span> CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"ACClass"</span><span class="uscript-operator">,</span>Level<span class="uscript-operator">.</span>Game<span class="uscript-operator">.</span>AccessControlClass<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03230</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>TempStr <span class="uscript-operator">!=</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">03231</span>              ACClass <span class="uscript-operator">=</span> <span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>AccessControl<span class="uscript-operator">&gt;</span><span class="uscript-operator">(</span>DynamicLoadObject<span class="uscript-operator">(</span>TempStr<span class="uscript-operator">,</span><span class="uscript-keyword">class</span><span class="uscript-name">'Class'</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03232</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>ACClass <span class="uscript-operator">==</span> <span class="uscript-keyword">None</span><span class="uscript-operator">)</span>
<span class="uscript-line">03233</span>          <span class="uscript-operator">{</span>
<span class="uscript-line">03234</span>              ShowFramedMessage<span class="uscript-operator">(</span>Res<span class="uscript-operator">,</span>ErrorAccessControlText<span class="uscript-operator">,</span><span class="uscript-keyword">True</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03235</span>              <span class="uscript-keyword">return</span><span class="uscript-operator">;</span>
<span class="uscript-line">03236</span>          <span class="uscript-operator">}</span>
<span class="uscript-line">03237</span>          TempPI <span class="uscript-operator">=</span> <span class="uscript-keyword">new</span><span class="uscript-operator">(</span><span class="uscript-keyword">None</span><span class="uscript-operator">)</span> <span class="uscript-keyword">class</span><span class="uscript-name">'PlayInfo'</span><span class="uscript-operator">;</span>
<span class="uscript-line">03238</span>  
<span class="uscript-line">03239</span>          <span class="uscript-comment">// We are managing an existing profile</span>
<span class="uscript-line">03240</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>CurS<span class="uscript-operator">.</span>hasData<span class="uscript-operator">(</span><span class="uscript-string">"ProfileIndex"</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">03241</span>          <span class="uscript-operator">{</span>
<span class="uscript-line">03242</span>              k <span class="uscript-operator">=</span> <span class="uscript-type">int</span><span class="uscript-operator">(</span>CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"ProfileIndex"</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03243</span>              TempPCS <span class="uscript-operator">=</span> LadderRules<span class="uscript-operator">.</span>LadderProfiles<span class="uscript-operator">[</span>k<span class="uscript-operator">]</span><span class="uscript-operator">;</span>
<span class="uscript-line">03244</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>LadderRules<span class="uscript-operator">.</span>Profiles<span class="uscript-operator">[</span>k<span class="uscript-operator">]</span><span class="uscript-operator">.</span>ProfileName <span class="uscript-operator">!=</span> CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"ProfileName"</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">03245</span>              <span class="uscript-operator">{</span>
<span class="uscript-line">03246</span>                  LadderRules<span class="uscript-operator">.</span>Profiles<span class="uscript-operator">[</span>k<span class="uscript-operator">]</span><span class="uscript-operator">.</span>ProfileName <span class="uscript-operator">=</span> CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"ProfileName"</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03247</span>                  LadderRules<span class="uscript-operator">.</span>AllLadderProfiles<span class="uscript-operator">.</span><span class="uscript-keyword">Remove</span><span class="uscript-operator">(</span>LadderRules<span class="uscript-operator">.</span>AllLadderProfiles<span class="uscript-operator">.</span>FindItemId<span class="uscript-operator">(</span><span class="uscript-type">string</span><span class="uscript-operator">(</span>k<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03248</span>                  LadderRules<span class="uscript-operator">.</span>AllLadderProfiles<span class="uscript-operator">.</span>Add<span class="uscript-operator">(</span><span class="uscript-type">string</span><span class="uscript-operator">(</span>k<span class="uscript-operator">)</span><span class="uscript-operator">,</span>LadderRules<span class="uscript-operator">.</span>Profiles<span class="uscript-operator">[</span>k<span class="uscript-operator">]</span><span class="uscript-operator">.</span>ProfileName<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03249</span>                  LadderRules<span class="uscript-operator">.</span>SaveConfig<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03250</span>              <span class="uscript-operator">}</span>
<span class="uscript-line">03251</span>  
<span class="uscript-line">03252</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>TempPCS<span class="uscript-operator">.</span>StartEdit<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">03253</span>              <span class="uscript-operator">{</span>
<span class="uscript-line">03254</span>                  TempPCS<span class="uscript-operator">.</span>SetGameType<span class="uscript-operator">(</span>CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"GameType"</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03255</span>                  TempPCS<span class="uscript-operator">.</span>EndEdit<span class="uscript-operator">(</span><span class="uscript-keyword">False</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03256</span>              <span class="uscript-operator">}</span>
<span class="uscript-line">03257</span>          <span class="uscript-operator">}</span>
<span class="uscript-line">03258</span>  
<span class="uscript-line">03259</span>          <span class="uscript-keyword">else</span> TempPCS <span class="uscript-operator">=</span> LadderRules<span class="uscript-operator">.</span>AddProfile<span class="uscript-operator">(</span>CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"ProfileName"</span><span class="uscript-operator">)</span><span class="uscript-operator">,</span> CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"GameType"</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03260</span>  
<span class="uscript-line">03261</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>TempPCS<span class="uscript-operator">.</span>StartEdit<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">03262</span>          <span class="uscript-operator">{</span>
<span class="uscript-line">03263</span>              <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>i<span class="uscript-operator">&lt;</span>AllMutators<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">;</span>i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">03264</span>              <span class="uscript-operator">{</span>
<span class="uscript-line">03265</span>                  MutClass <span class="uscript-operator">=</span> <span class="uscript-keyword">class</span><span class="uscript-operator">&lt;</span>Mutator<span class="uscript-operator">&gt;</span><span class="uscript-operator">(</span>DynamicLoadObject<span class="uscript-operator">(</span>AllMutators<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>ClassName<span class="uscript-operator">,</span><span class="uscript-keyword">class</span><span class="uscript-name">'Class'</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03266</span>                  <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>MutClass <span class="uscript-operator">!=</span> <span class="uscript-keyword">None</span><span class="uscript-operator">)</span>
<span class="uscript-line">03267</span>                  <span class="uscript-operator">{</span>
<span class="uscript-line">03268</span>                      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">(</span>Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span>AllMutators<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>ClassName<span class="uscript-operator">,</span><span class="uscript-string">""</span><span class="uscript-operator">)</span><span class="uscript-operator">!=</span><span class="uscript-string">""</span><span class="uscript-operator">)</span><span class="uscript-operator">||</span><span class="uscript-operator">(</span>Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span>AllMutators<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>GroupName<span class="uscript-operator">,</span><span class="uscript-string">""</span><span class="uscript-operator">)</span><span class="uscript-operator">~=</span>AllMutators<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>ClassName<span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">03269</span>                          CurS<span class="uscript-operator">.</span>setMutator<span class="uscript-operator">(</span>AllMutators<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>ClassName<span class="uscript-operator">,</span><span class="uscript-keyword">true</span><span class="uscript-operator">,</span><span class="uscript-keyword">true</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03270</span>                      <span class="uscript-keyword">else</span> CurS<span class="uscript-operator">.</span>setMutator<span class="uscript-operator">(</span>AllMutators<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>ClassName<span class="uscript-operator">,</span><span class="uscript-keyword">false</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03271</span>  
<span class="uscript-line">03272</span>                      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>CurS<span class="uscript-operator">.</span>HasMutator<span class="uscript-operator">(</span>AllMutators<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>ClassName<span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">03273</span>                      <span class="uscript-operator">{</span>
<span class="uscript-line">03274</span>                          MClass<span class="uscript-operator">[</span>MClass<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">]</span> <span class="uscript-operator">=</span> MutClass<span class="uscript-operator">;</span>
<span class="uscript-line">03275</span>                          TempPCS<span class="uscript-operator">.</span>AddProfileMutator<span class="uscript-operator">(</span>AllMutators<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>ClassName<span class="uscript-operator">,</span>CurS<span class="uscript-operator">.</span>MutRequired<span class="uscript-operator">(</span>AllMutators<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>ClassName<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03276</span>                      <span class="uscript-operator">}</span>
<span class="uscript-line">03277</span>                      <span class="uscript-keyword">else</span> TempPCS<span class="uscript-operator">.</span>DelProfileMutator<span class="uscript-operator">(</span>AllMutators<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>ClassName<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03278</span>                  <span class="uscript-operator">}</span>
<span class="uscript-line">03279</span>              <span class="uscript-operator">}</span>
<span class="uscript-line">03280</span>  
<span class="uscript-line">03281</span>              <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>i<span class="uscript-operator">&lt;</span>ConfigM<span class="uscript-operator">.</span>ManagedActors<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">;</span>i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">03282</span>              <span class="uscript-operator">{</span>
<span class="uscript-line">03283</span>                  TempSA <span class="uscript-operator">=</span> ConfigM<span class="uscript-operator">.</span>ManagedActors<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>SAClass<span class="uscript-operator">;</span>
<span class="uscript-line">03284</span>                  <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>TempSA <span class="uscript-operator">!=</span> <span class="uscript-keyword">None</span><span class="uscript-operator">)</span>
<span class="uscript-line">03285</span>                  <span class="uscript-operator">{</span>
<span class="uscript-line">03286</span>                      TempStr <span class="uscript-operator">=</span> <span class="uscript-type">string</span><span class="uscript-operator">(</span>ConfigM<span class="uscript-operator">.</span>ManagedActors<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>SAClass<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03287</span>                      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span>TempStr<span class="uscript-operator">,</span><span class="uscript-string">""</span><span class="uscript-operator">)</span> <span class="uscript-operator">!=</span> <span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">03288</span>                          CurS<span class="uscript-operator">.</span>setServerActor<span class="uscript-operator">(</span>TempStr<span class="uscript-operator">,</span> <span class="uscript-keyword">True</span><span class="uscript-operator">,</span> <span class="uscript-keyword">True</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03289</span>                      <span class="uscript-keyword">else</span> CurS<span class="uscript-operator">.</span>setServerActor<span class="uscript-operator">(</span>TempStr<span class="uscript-operator">,</span> <span class="uscript-keyword">False</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03290</span>  
<span class="uscript-line">03291</span>                      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>CurS<span class="uscript-operator">.</span>HasServerActor<span class="uscript-operator">(</span>TempStr<span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">03292</span>                      <span class="uscript-operator">{</span>
<span class="uscript-line">03293</span>                          SAClass<span class="uscript-operator">[</span>SAClass<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">]</span> <span class="uscript-operator">=</span> TempSA<span class="uscript-operator">;</span>
<span class="uscript-line">03294</span>                          TempPCS<span class="uscript-operator">.</span>AddProfileServerActor<span class="uscript-operator">(</span>TempStr<span class="uscript-operator">,</span>CurS<span class="uscript-operator">.</span>SARequired<span class="uscript-operator">(</span>TempStr<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03295</span>                      <span class="uscript-operator">}</span>
<span class="uscript-line">03296</span>                      <span class="uscript-keyword">else</span> TempPCS<span class="uscript-operator">.</span>DelProfileServerActor<span class="uscript-operator">(</span>TempStr<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03297</span>                  <span class="uscript-operator">}</span>
<span class="uscript-line">03298</span>              <span class="uscript-operator">}</span>
<span class="uscript-line">03299</span>  
<span class="uscript-line">03300</span>              x <span class="uscript-operator">=</span> LoadThisPlayInfo<span class="uscript-operator">(</span>TempPI<span class="uscript-operator">,</span> GIClass<span class="uscript-operator">,</span> ACClass<span class="uscript-operator">,</span> MClass<span class="uscript-operator">,</span> SAClass<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03301</span>              <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>x <span class="uscript-operator">&gt;=</span> <span class="uscript-number">0</span><span class="uscript-operator">)</span>
<span class="uscript-line">03302</span>              <span class="uscript-operator">{</span>
<span class="uscript-line">03303</span>                  ShowFramedMessage<span class="uscript-operator">(</span>Res<span class="uscript-operator">,</span> ErrorLoadingPlayInfoText<span class="uscript-operator">[</span>x<span class="uscript-operator">]</span><span class="uscript-operator">,</span><span class="uscript-keyword">True</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03304</span>                  <span class="uscript-keyword">return</span><span class="uscript-operator">;</span>
<span class="uscript-line">03305</span>              <span class="uscript-operator">}</span>
<span class="uscript-line">03306</span>              CurS<span class="uscript-operator">.</span>setValue<span class="uscript-operator">(</span><span class="uscript-string">"MaxMaps"</span><span class="uscript-operator">,</span>Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span><span class="uscript-string">"MaxMaps"</span><span class="uscript-operator">)</span><span class="uscript-operator">,</span><span class="uscript-keyword">true</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03307</span>              TempPCS<span class="uscript-operator">.</span>MaxMaps <span class="uscript-operator">=</span> <span class="uscript-type">int</span><span class="uscript-operator">(</span>CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"MaxMaps"</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03308</span>  
<span class="uscript-line">03309</span>              GIClass<span class="uscript-operator">.</span><span class="uscript-keyword">static</span><span class="uscript-operator">.</span>LoadMapList<span class="uscript-operator">(</span>GIClass<span class="uscript-operator">.</span><span class="uscript-keyword">default</span><span class="uscript-operator">.</span>MapPrefix<span class="uscript-operator">,</span> TempArr<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03310</span>              <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>i<span class="uscript-operator">&lt;</span>TempArr<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">;</span>i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">03311</span>              <span class="uscript-operator">{</span>
<span class="uscript-line">03312</span>                  <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>Req<span class="uscript-operator">.</span>GetVariable<span class="uscript-operator">(</span>TempArr<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">,</span><span class="uscript-string">""</span><span class="uscript-operator">)</span><span class="uscript-operator">!=</span><span class="uscript-string">""</span><span class="uscript-operator">)</span>
<span class="uscript-line">03313</span>                      CurS<span class="uscript-operator">.</span>setMap<span class="uscript-operator">(</span>TempArr<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">,</span><span class="uscript-number">0</span><span class="uscript-operator">,</span><span class="uscript-keyword">true</span><span class="uscript-operator">,</span><span class="uscript-keyword">true</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03314</span>                  <span class="uscript-keyword">else</span> CurS<span class="uscript-operator">.</span>setMap<span class="uscript-operator">(</span>TempArr<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">,</span><span class="uscript-number">0</span><span class="uscript-operator">,</span><span class="uscript-keyword">false</span><span class="uscript-operator">,</span><span class="uscript-keyword">false</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03315</span>  
<span class="uscript-line">03316</span>                  <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>CurS<span class="uscript-operator">.</span>HasMap<span class="uscript-operator">(</span>TempArr<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">03317</span>                      TempPCS<span class="uscript-operator">.</span>AddProfileMap<span class="uscript-operator">(</span>TempArr<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">,</span> CurS<span class="uscript-operator">.</span>MapRequired<span class="uscript-operator">(</span>TempArr<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03318</span>                  <span class="uscript-keyword">else</span> TempPCS<span class="uscript-operator">.</span>DelProfileMap<span class="uscript-operator">(</span>TempArr<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03319</span>              <span class="uscript-operator">}</span>
<span class="uscript-line">03320</span>  
<span class="uscript-line">03321</span>              <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span>i<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>i<span class="uscript-operator">&lt;</span>TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">;</span>i<span class="uscript-operator">++</span><span class="uscript-operator">)</span>
<span class="uscript-line">03322</span>              <span class="uscript-operator">{</span>
<span class="uscript-line">03323</span>                  <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>SecLevel <span class="uscript-operator">&gt;</span> CurAdmin<span class="uscript-operator">.</span>MaxSecLevel<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-keyword">continue</span><span class="uscript-operator">;</span>
<span class="uscript-line">03324</span>                  tmp <span class="uscript-operator">=</span> <span class="uscript-string">""</span><span class="uscript-operator">;</span> tmp1<span class="uscript-operator">=</span><span class="uscript-string">""</span><span class="uscript-operator">;</span>
<span class="uscript-line">03325</span>                  <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>CurS<span class="uscript-operator">.</span>getIdValue<span class="uscript-operator">(</span>i<span class="uscript-operator">,</span>tmp<span class="uscript-operator">,</span>tmp1<span class="uscript-operator">)</span> <span class="uscript-operator">==</span> <span class="uscript-operator">-</span><span class="uscript-number">1</span><span class="uscript-operator">)</span>
<span class="uscript-line">03326</span>                      <span class="uscript-keyword">break</span><span class="uscript-operator">;</span>
<span class="uscript-line">03327</span>                  <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span><span class="uscript-operator">!</span>TempPCS<span class="uscript-operator">.</span>SetProfileNamedParam<span class="uscript-operator">(</span>TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>SettingName<span class="uscript-operator">,</span> CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span>TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>SettingName<span class="uscript-operator">,</span>TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>Value<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
<span class="uscript-line">03328</span>                      TempPCS<span class="uscript-operator">.</span>SetProfileParam<span class="uscript-operator">(</span>TempPCS<span class="uscript-operator">.</span>Count<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">,</span>TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>SettingName<span class="uscript-operator">,</span>CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span>TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>SettingName<span class="uscript-operator">,</span>TempPI<span class="uscript-operator">.</span>Settings<span class="uscript-operator">[</span>i<span class="uscript-operator">]</span><span class="uscript-operator">.</span>Value<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03329</span>              <span class="uscript-operator">}</span>
<span class="uscript-line">03330</span>  
<span class="uscript-line">03331</span>              TempPCS<span class="uscript-operator">.</span>EndEdit<span class="uscript-operator">(</span><span class="uscript-keyword">true</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03332</span>          <span class="uscript-operator">}</span>
<span class="uscript-line">03333</span>  
<span class="uscript-line">03334</span>          <span class="uscript-keyword">else</span>
<span class="uscript-line">03335</span>          <span class="uscript-operator">{</span>
<span class="uscript-line">03336</span>              StatusError<span class="uscript-operator">(</span>Res<span class="uscript-operator">,</span>ErrorSavingProfile<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03337</span>              QuerySubReview<span class="uscript-operator">(</span>Req<span class="uscript-operator">,</span> Res<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03338</span>              <span class="uscript-keyword">return</span><span class="uscript-operator">;</span>
<span class="uscript-line">03339</span>          <span class="uscript-operator">}</span>
<span class="uscript-line">03340</span>          Tmp <span class="uscript-operator">=</span> CurS<span class="uscript-operator">.</span>getValue<span class="uscript-operator">(</span><span class="uscript-string">"ProfileName"</span><span class="uscript-operator">,</span> PageCaption<span class="uscript-operator">[</span><span class="uscript-number">0</span><span class="uscript-operator">]</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03341</span>          <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>LadderRules<span class="uscript-operator">.</span>GetRemainingMatches<span class="uscript-operator">(</span><span class="uscript-operator">)</span> <span class="uscript-operator">&gt;</span> <span class="uscript-number">0</span> <span class="uscript-operator">&amp;&amp;</span> Tmp <span class="uscript-operator">==</span> LadderRules<span class="uscript-operator">.</span>Profiles<span class="uscript-operator">[</span>GetCurrentConfigIndex<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">]</span><span class="uscript-operator">.</span>ProfileName<span class="uscript-operator">)</span>
<span class="uscript-line">03342</span>              Tmp <span class="uscript-operator">=</span> Tmp <span class="uscript-operator">@</span> LabelNumberMatchesLeft <span class="uscript-operator">@</span> <span class="uscript-type">string</span><span class="uscript-operator">(</span>LadderRules<span class="uscript-operator">.</span>GetRemainingMatches<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03343</span>          Res<span class="uscript-operator">.</span>Subst<span class="uscript-operator">(</span><span class="uscript-string">"SubTitle"</span><span class="uscript-operator">,</span> Tmp<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03344</span>          ShowMessage<span class="uscript-operator">(</span>Res<span class="uscript-operator">,</span> TableTitle<span class="uscript-operator">[</span><span class="uscript-number">6</span><span class="uscript-operator">]</span><span class="uscript-operator">,</span> PageCaption<span class="uscript-operator">[</span><span class="uscript-number">6</span><span class="uscript-operator">]</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03345</span>          <span class="uscript-keyword">return</span><span class="uscript-operator">;</span>
<span class="uscript-line">03346</span>      <span class="uscript-operator">}</span>
<span class="uscript-line">03347</span>  
<span class="uscript-line">03348</span>      <span class="uscript-keyword">else</span> AccessDenied<span class="uscript-operator">(</span>Res<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-line">03349</span>  <span class="uscript-operator">}</span>
<span class="uscript-line">03350</span>  
<span class="uscript-line">03351</span>  <span class="uscript-keyword">defaultproperties</span>
<span class="uscript-line">03352</span>  <span class="uscript-operator">{</span>
<span class="uscript-line">03353</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">0</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"BR-Anubis"</span>
<span class="uscript-line">03354</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">1</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"BR-Bifrost"</span>
<span class="uscript-line">03355</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">2</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"BR-Disclosure"</span>
<span class="uscript-line">03356</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">3</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"BR-IceFields"</span>
<span class="uscript-line">03357</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">4</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"BR-Skyline"</span>
<span class="uscript-line">03358</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">5</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"BR-Slaughterhouse"</span>
<span class="uscript-line">03359</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">6</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"BR-TwinTombs"</span>
<span class="uscript-line">03360</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">7</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"CTF-Chrome"</span>
<span class="uscript-line">03361</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">8</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"CTF-Citadel"</span>
<span class="uscript-line">03362</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">9</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"CTF-December"</span>
<span class="uscript-line">03363</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">10</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"CTF-Face3"</span>
<span class="uscript-line">03364</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">11</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"CTF-Geothermal"</span>
<span class="uscript-line">03365</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">12</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"CTF-Lostfaith"</span>
<span class="uscript-line">03366</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">13</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"CTF-Magma"</span>
<span class="uscript-line">03367</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">14</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"CTF-Maul"</span>
<span class="uscript-line">03368</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">15</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"CTF-Orbital2"</span>
<span class="uscript-line">03369</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">16</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"DM-Antalus"</span>
<span class="uscript-line">03370</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">17</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"DM-Asbestos"</span>
<span class="uscript-line">03371</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">18</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"DM-Compressed"</span>
<span class="uscript-line">03372</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">19</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"DM-Curse3"</span>
<span class="uscript-line">03373</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">20</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"DM-Flux2"</span>
<span class="uscript-line">03374</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">21</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"DM-Gael"</span>
<span class="uscript-line">03375</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">22</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"DM-Inferno"</span>
<span class="uscript-line">03376</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">23</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"DM-Insidious"</span>
<span class="uscript-line">03377</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">24</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"DM-Leviathan"</span>
<span class="uscript-line">03378</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">25</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"DM-Oceanic"</span>
<span class="uscript-line">03379</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">26</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"DM-Phobos2"</span>
<span class="uscript-line">03380</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">27</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"DM-Plunge"</span>
<span class="uscript-line">03381</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">28</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"DM-Serpentine"</span>
<span class="uscript-line">03382</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">29</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"DM-TokaraForest"</span>
<span class="uscript-line">03383</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">30</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"DM-TrainingDay"</span>
<span class="uscript-line">03384</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">31</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"DOM-Core"</span>
<span class="uscript-line">03385</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">32</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"DOM-OutRigger"</span>
<span class="uscript-line">03386</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">33</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"DOM-Ruination"</span>
<span class="uscript-line">03387</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">34</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"DOM-ScorchedEarth"</span>
<span class="uscript-line">03388</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">35</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"DOM-SepukkuGorge"</span>
<span class="uscript-line">03389</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">36</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"DOM-Suntemple"</span>
<span class="uscript-line">03390</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">37</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"Entry"</span>
<span class="uscript-line">03391</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">38</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"NvidiaLogo"</span>
<span class="uscript-line">03392</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">39</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"TUT-BR"</span>
<span class="uscript-line">03393</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">40</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"TUT-CTF"</span>
<span class="uscript-line">03394</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">41</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"TUT-DM"</span>
<span class="uscript-line">03395</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">42</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"TUT-DOM"</span>
<span class="uscript-line">03396</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">43</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"UT2-intro"</span>
<span class="uscript-line">03397</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">44</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"VehicleDemo"</span>
<span class="uscript-line">03398</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">45</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"endgame"</span>
<span class="uscript-line">03399</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">46</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"Core"</span>
<span class="uscript-line">03400</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">47</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"Editor"</span>
<span class="uscript-line">03401</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">48</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"Engine"</span>
<span class="uscript-line">03402</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">49</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"Fire"</span>
<span class="uscript-line">03403</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">50</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"GamePlay"</span>
<span class="uscript-line">03404</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">51</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"IpDrv"</span>
<span class="uscript-line">03405</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">52</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"UWeb"</span>
<span class="uscript-line">03406</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">53</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"UnrealEd"</span>
<span class="uscript-line">03407</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">54</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"UnrealGame"</span>
<span class="uscript-line">03408</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">55</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"Vehicles"</span>
<span class="uscript-line">03409</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">56</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"XAdmin"</span>
<span class="uscript-line">03410</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">57</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"XEffects"</span>
<span class="uscript-line">03411</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">58</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"XGame"</span>
<span class="uscript-line">03412</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">59</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"XGame_rc"</span>
<span class="uscript-line">03413</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">60</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"XInterface"</span>
<span class="uscript-line">03414</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">61</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"XPickups"</span>
<span class="uscript-line">03415</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">62</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"XPickups_rc"</span>
<span class="uscript-line">03416</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">63</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"XWeapons"</span>
<span class="uscript-line">03417</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">64</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"XWeapons_rc"</span>
<span class="uscript-line">03418</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">65</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"XWebAdmin"</span>
<span class="uscript-line">03419</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">66</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"BR-DE-ElecFields"</span>
<span class="uscript-line">03420</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">67</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"CTF-DE-ElecFields"</span>
<span class="uscript-line">03421</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">68</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"CTF-DE-LavaGiant2"</span>
<span class="uscript-line">03422</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">69</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"DM-DE-Grendelkeep"</span>
<span class="uscript-line">03423</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">70</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"DM-DE-Ironic"</span>
<span class="uscript-line">03424</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">71</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"DM-DE-Osiris2"</span>
<span class="uscript-line">03425</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">72</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"BR-Canyon"</span>
<span class="uscript-line">03426</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">73</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"CTF-Avaris"</span>
<span class="uscript-line">03427</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">74</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"DM-1on1-Crash"</span>
<span class="uscript-line">03428</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">75</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"DM-1on1-Mixer"</span>
<span class="uscript-line">03429</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">76</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"DM-Icetomb"</span>
<span class="uscript-line">03430</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">77</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"DM-Injector"</span>
<span class="uscript-line">03431</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">78</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"DM-IronDeity"</span>
<span class="uscript-line">03432</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">79</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"DM-Rustatorium"</span>
<span class="uscript-line">03433</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">80</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"DOM-Junkyard"</span>
<span class="uscript-line">03434</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">81</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"SkaarjPack"</span>
<span class="uscript-line">03435</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">82</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"SkaarjPack_rc"</span>
<span class="uscript-line">03436</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">83</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"BonusPack"</span>
<span class="uscript-line">03437</span>       EpicPackages<span class="uscript-operator">(</span><span class="uscript-number">84</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"OGGPlayer"</span>
<span class="uscript-line">03438</span>       MasterPage<span class="uscript-operator">=</span><span class="uscript-string">"ladder"</span>
<span class="uscript-line">03439</span>       SubFrame<span class="uscript-operator">=</span><span class="uscript-string">"ladder_frame"</span>
<span class="uscript-line">03440</span>       SubFrameMenu<span class="uscript-operator">=</span><span class="uscript-string">"ladder_frame1"</span>
<span class="uscript-line">03441</span>       SubFrameContent<span class="uscript-operator">=</span><span class="uscript-string">"ladder_frame2"</span>
<span class="uscript-line">03442</span>       IncludeTable<span class="uscript-operator">=</span><span class="uscript-string">"ladder_table"</span>
<span class="uscript-line">03443</span>       IncludeSection<span class="uscript-operator">=</span><span class="uscript-string">"ladder_section"</span>
<span class="uscript-line">03444</span>       IncludeRows<span class="uscript-operator">=</span><span class="uscript-string">"ladder_rows"</span>
<span class="uscript-line">03445</span>       IncludeCaptionButton<span class="uscript-operator">=</span><span class="uscript-string">"ladder_caption"</span>
<span class="uscript-line">03446</span>       IncludeMapSelect<span class="uscript-operator">=</span><span class="uscript-string">"ladder_mapselect"</span>
<span class="uscript-line">03447</span>       IncludeProfileName<span class="uscript-operator">=</span><span class="uscript-string">"ladder_name"</span>
<span class="uscript-line">03448</span>       IncludeGameType<span class="uscript-operator">=</span><span class="uscript-string">"ladder_gametype"</span>
<span class="uscript-line">03449</span>       IncludeCheckBox<span class="uscript-operator">=</span><span class="uscript-string">"ladder_checkrow"</span>
<span class="uscript-line">03450</span>       IncludeSwitch<span class="uscript-operator">=</span><span class="uscript-string">"ladder_switch"</span>
<span class="uscript-line">03451</span>       ProfileViewURI<span class="uscript-operator">=</span><span class="uscript-string">"ladder_view"</span>
<span class="uscript-line">03452</span>       ProfileEditURI<span class="uscript-operator">=</span><span class="uscript-string">"ladder_edit"</span>
<span class="uscript-line">03453</span>       ProfileMenuURI<span class="uscript-operator">=</span><span class="uscript-string">"ladder_menu"</span>
<span class="uscript-line">03454</span>       ProfileSwitchURI<span class="uscript-operator">=</span><span class="uscript-string">"ladder_switch"</span>
<span class="uscript-line">03455</span>       ProfileManageURI<span class="uscript-operator">=</span><span class="uscript-string">"ladder_manage"</span>
<span class="uscript-line">03456</span>       SubFrameURI<span class="uscript-operator">=</span><span class="uscript-string">"profile_management"</span>
<span class="uscript-line">03457</span>       SubFrameMenuURI<span class="uscript-operator">=</span><span class="uscript-string">"management_menu"</span>
<span class="uscript-line">03458</span>       SubMapsURI<span class="uscript-operator">=</span><span class="uscript-string">"ladder_maps"</span>
<span class="uscript-line">03459</span>       SubSavedURI<span class="uscript-operator">=</span><span class="uscript-string">"ladder_save"</span>
<span class="uscript-line">03460</span>       SubRulesURI<span class="uscript-operator">=</span><span class="uscript-string">"ladder_rules"</span>
<span class="uscript-line">03461</span>       SubReviewURI<span class="uscript-operator">=</span><span class="uscript-string">"ladder_review"</span>
<span class="uscript-line">03462</span>       SubGametypeURI<span class="uscript-operator">=</span><span class="uscript-string">"management_game_type"</span>
<span class="uscript-line">03463</span>       SubMutatorsURI<span class="uscript-operator">=</span><span class="uscript-string">"ladder_mutators"</span>
<span class="uscript-line">03464</span>       SubImportURI<span class="uscript-operator">=</span><span class="uscript-string">"profile_import"</span>
<span class="uscript-line">03465</span>       SubExportURI<span class="uscript-operator">=</span><span class="uscript-string">"profile_export"</span>
<span class="uscript-line">03466</span>       LinkEditProfile<span class="uscript-operator">=</span><span class="uscript-string">"Edit Profiles"</span>
<span class="uscript-line">03467</span>       LinkViewProfile<span class="uscript-operator">=</span><span class="uscript-string">"View Profiles"</span>
<span class="uscript-line">03468</span>       LinkSwitchProfile<span class="uscript-operator">=</span><span class="uscript-string">"Switch Profiles"</span>
<span class="uscript-line">03469</span>       LinkManageProfile<span class="uscript-operator">=</span><span class="uscript-string">"Manage Profiles"</span>
<span class="uscript-line">03470</span>       LinkImportProfile<span class="uscript-operator">=</span><span class="uscript-string">"Import Profile"</span>
<span class="uscript-line">03471</span>       LinkExportProfile<span class="uscript-operator">=</span><span class="uscript-string">"Export Profile"</span>
<span class="uscript-line">03472</span>       TableTitle<span class="uscript-operator">(</span><span class="uscript-number">0</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"Profile Management Portal"</span>
<span class="uscript-line">03473</span>       TableTitle<span class="uscript-operator">(</span><span class="uscript-number">1</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"Profile GameType"</span>
<span class="uscript-line">03474</span>       TableTitle<span class="uscript-operator">(</span><span class="uscript-number">2</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"Profile Mutators"</span>
<span class="uscript-line">03475</span>       TableTitle<span class="uscript-operator">(</span><span class="uscript-number">3</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"Profile Maps"</span>
<span class="uscript-line">03476</span>       TableTitle<span class="uscript-operator">(</span><span class="uscript-number">4</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"Profile Settings"</span>
<span class="uscript-line">03477</span>       TableTitle<span class="uscript-operator">(</span><span class="uscript-number">5</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"Review Profile"</span>
<span class="uscript-line">03478</span>       TableTitle<span class="uscript-operator">(</span><span class="uscript-number">6</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"Profile Saved"</span>
<span class="uscript-line">03479</span>       PageCaption<span class="uscript-operator">(</span><span class="uscript-number">0</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"No Profile Loaded"</span>
<span class="uscript-line">03480</span>       PageCaption<span class="uscript-operator">(</span><span class="uscript-number">1</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"Select the gametype that will be associated with this profile."</span>
<span class="uscript-line">03481</span>       PageCaption<span class="uscript-operator">(</span><span class="uscript-number">2</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"Select the mutators that will be available in this profile."</span>
<span class="uscript-line">03482</span>       PageCaption<span class="uscript-operator">(</span><span class="uscript-number">3</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"Select the maps that will be available in this profile."</span>
<span class="uscript-line">03483</span>       PageCaption<span class="uscript-operator">(</span><span class="uscript-number">4</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"Select the settings that will be associated with this profile."</span>
<span class="uscript-line">03484</span>       PageCaption<span class="uscript-operator">(</span><span class="uscript-number">5</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"Review all settings for accuracy before saving to file."</span>
<span class="uscript-line">03485</span>       PageCaption<span class="uscript-operator">(</span><span class="uscript-number">6</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"Settings were saved successfully!"</span>
<span class="uscript-line">03486</span>       ProfileButtonName<span class="uscript-operator">(</span><span class="uscript-number">0</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"Save Location"</span>
<span class="uscript-line">03487</span>       ProfileButtonName<span class="uscript-operator">(</span><span class="uscript-number">1</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"GameType"</span>
<span class="uscript-line">03488</span>       ProfileButtonName<span class="uscript-operator">(</span><span class="uscript-number">2</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"Mutators"</span>
<span class="uscript-line">03489</span>       ProfileButtonName<span class="uscript-operator">(</span><span class="uscript-number">3</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"Maps"</span>
<span class="uscript-line">03490</span>       ProfileButtonName<span class="uscript-operator">(</span><span class="uscript-number">4</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"Rules"</span>
<span class="uscript-line">03491</span>       ProfileButtonName<span class="uscript-operator">(</span><span class="uscript-number">5</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"Review"</span>
<span class="uscript-line">03492</span>       ProfileButtonName<span class="uscript-operator">(</span><span class="uscript-number">6</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"Saved"</span>
<span class="uscript-line">03493</span>       ProfileButtonValue<span class="uscript-operator">(</span><span class="uscript-number">0</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"Proceed"</span>
<span class="uscript-line">03494</span>       ProfileButtonValue<span class="uscript-operator">(</span><span class="uscript-number">1</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"Set GameType"</span>
<span class="uscript-line">03495</span>       ProfileButtonValue<span class="uscript-operator">(</span><span class="uscript-number">2</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"Set Mutators"</span>
<span class="uscript-line">03496</span>       ProfileButtonValue<span class="uscript-operator">(</span><span class="uscript-number">3</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"Set Maps"</span>
<span class="uscript-line">03497</span>       ProfileButtonValue<span class="uscript-operator">(</span><span class="uscript-number">4</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"Set Rules"</span>
<span class="uscript-line">03498</span>       ProfileButtonValue<span class="uscript-operator">(</span><span class="uscript-number">5</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"Save Profile"</span>
<span class="uscript-line">03499</span>       ProfileButtonValue<span class="uscript-operator">(</span><span class="uscript-number">6</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"Profile Saved"</span>
<span class="uscript-line">03500</span>       MapText<span class="uscript-operator">=</span><span class="uscript-string">"Maps"</span>
<span class="uscript-line">03501</span>       ErrorText<span class="uscript-operator">=</span><span class="uscript-string">"Error"</span>
<span class="uscript-line">03502</span>       MutatorText<span class="uscript-operator">=</span><span class="uscript-string">"Mutators"</span>
<span class="uscript-line">03503</span>       RequiredText<span class="uscript-operator">=</span><span class="uscript-string">"Required"</span>
<span class="uscript-line">03504</span>       AvailableText<span class="uscript-operator">=</span><span class="uscript-string">"Available"</span>
<span class="uscript-line">03505</span>       UnlimitedText<span class="uscript-operator">=</span><span class="uscript-string">"Unlimited"</span>
<span class="uscript-line">03506</span>       FollowingMaps<span class="uscript-operator">=</span><span class="uscript-string">"The following maps"</span>
<span class="uscript-line">03507</span>       AreAssignedText<span class="uscript-operator">=</span><span class="uscript-string">"are assigned to this profile and cannot be removed."</span>
<span class="uscript-line">03508</span>       AreAvailableText<span class="uscript-operator">=</span><span class="uscript-string">"may be added to this profile."</span>
<span class="uscript-line">03509</span>       FollowingMutators<span class="uscript-operator">=</span><span class="uscript-string">"The following mutators"</span>
<span class="uscript-line">03510</span>       CommandLineOptionsTitle<span class="uscript-operator">=</span><span class="uscript-string">"Command Line Options"</span>
<span class="uscript-line">03511</span>       ButtonLoadProfile<span class="uscript-operator">=</span><span class="uscript-string">"Load Profile"</span>
<span class="uscript-line">03512</span>       ButtonDeleteProfile<span class="uscript-operator">=</span><span class="uscript-string">"Delete Profile"</span>
<span class="uscript-line">03513</span>       ButtonPreviewProfile<span class="uscript-operator">=</span><span class="uscript-string">"Load Profile"</span>
<span class="uscript-line">03514</span>       ButtonApplyImportProfile<span class="uscript-operator">=</span><span class="uscript-string">"Import Profile"</span>
<span class="uscript-line">03515</span>       ButtonApplyExportProfile<span class="uscript-operator">=</span><span class="uscript-string">"Export Profile"</span>
<span class="uscript-line">03516</span>       ButtonApplyProfileChanges<span class="uscript-operator">=</span><span class="uscript-string">"Apply Profile Changes"</span>
<span class="uscript-line">03517</span>       LabelCopyProfile<span class="uscript-operator">=</span><span class="uscript-string">"Copy Profile"</span>
<span class="uscript-line">03518</span>       LabelDeleteProfile<span class="uscript-operator">=</span><span class="uscript-string">"Delete Profile"</span>
<span class="uscript-line">03519</span>       LabelImportProfile<span class="uscript-operator">=</span><span class="uscript-string">"Import Profile"</span>
<span class="uscript-line">03520</span>       LabelExportProfile<span class="uscript-operator">=</span><span class="uscript-string">"Export Profile"</span>
<span class="uscript-line">03521</span>       LabelAddProfile<span class="uscript-operator">=</span><span class="uscript-string">"Add Profile"</span>
<span class="uscript-line">03522</span>       LabelSelectActions<span class="uscript-operator">=</span><span class="uscript-string">"(Copy, Modify, Delete, Export)"</span>
<span class="uscript-line">03523</span>       LabelTextboxActions<span class="uscript-operator">=</span><span class="uscript-string">"(Add, Copy, Import)"</span>
<span class="uscript-line">03524</span>       LabelPlayInfo<span class="uscript-operator">=</span><span class="uscript-string">"Profile Game Parameters"</span>
<span class="uscript-line">03525</span>       LabelGeneralProfile<span class="uscript-operator">=</span><span class="uscript-string">"General Profile Information"</span>
<span class="uscript-line">03526</span>       LabelGameType<span class="uscript-operator">=</span><span class="uscript-string">"Profile Game Type"</span>
<span class="uscript-line">03527</span>       LabelProfileName<span class="uscript-operator">=</span><span class="uscript-string">"Profile Name"</span>
<span class="uscript-line">03528</span>       LabelAccessControl<span class="uscript-operator">=</span><span class="uscript-string">"Profile Access Control"</span>
<span class="uscript-line">03529</span>       LabelChooseAction<span class="uscript-operator">=</span><span class="uscript-string">"Choose action to perform:"</span>
<span class="uscript-line">03530</span>       LabelManagement<span class="uscript-operator">=</span><span class="uscript-string">"Profile Management"</span>
<span class="uscript-line">03531</span>       LabelInputDescription<span class="uscript-operator">=</span><span class="uscript-string">"Actions which require input from this field are listed on the right."</span>
<span class="uscript-line">03532</span>       LabelMaxMaps<span class="uscript-operator">=</span><span class="uscript-string">"Maximum maps allowed in this profile's maplist"</span>
<span class="uscript-line">03533</span>       LabelNumberGames<span class="uscript-operator">=</span><span class="uscript-string">"Number of matches (0 = unlimited)"</span>
<span class="uscript-line">03534</span>       LabelCheckAllMap<span class="uscript-operator">=</span><span class="uscript-string">"Select all maps"</span>
<span class="uscript-line">03535</span>       LabelRequiredMaps<span class="uscript-operator">=</span><span class="uscript-string">"Check each map that will be required (non-removable) for this profile."</span>
<span class="uscript-line">03536</span>       LabelUncheckAllMap<span class="uscript-operator">=</span><span class="uscript-string">"Deselect all maps"</span>
<span class="uscript-line">03537</span>       LabelChangeMaplist<span class="uscript-operator">=</span><span class="uscript-string">"Changes to the maplist are saved immediately."</span>
<span class="uscript-line">03538</span>       LabelCheckAllMutator<span class="uscript-operator">=</span><span class="uscript-string">"Select all mutators"</span>
<span class="uscript-line">03539</span>       LabelRequiredMutators<span class="uscript-operator">=</span><span class="uscript-string">"Check each mutator that will be required (non-removable) for this profile."</span>
<span class="uscript-line">03540</span>       LabelNumberMatchesLeft<span class="uscript-operator">=</span><span class="uscript-string">"Matches Remaining:"</span>
<span class="uscript-line">03541</span>       LabelUncheckAllMutator<span class="uscript-operator">=</span><span class="uscript-string">"Deselect all mutators"</span>
<span class="uscript-line">03542</span>       LabelDelayProfileChange<span class="uscript-operator">=</span><span class="uscript-string">"Check to delay applying profile until end of current match."</span>
<span class="uscript-line">03543</span>       LabelApplyImportProfile<span class="uscript-operator">=</span><span class="uscript-string">"Click Apply Import to make this profile available in your server's list of profiles."</span>
<span class="uscript-line">03544</span>       LabelApplyExportProfile<span class="uscript-operator">=</span><span class="uscript-string">"Click Apply Export to save this profile to a .txt file."</span>
<span class="uscript-line">03545</span>       LabelModifyProfile<span class="uscript-operator">=</span><span class="uscript-string">"Modify Profile"</span>
<span class="uscript-line">03546</span>       SuccessText<span class="uscript-operator">=</span><span class="uscript-string">"Success"</span>
<span class="uscript-line">03547</span>       SuccessDeleteProfile<span class="uscript-operator">=</span><span class="uscript-string">"Profile successfully deleted!  It will no longer appear in your list of available profiles."</span>
<span class="uscript-line">03548</span>       SuccessExportProfile<span class="uscript-operator">=</span><span class="uscript-string">"Profile exported successfully!  Exported profile has been saved to the server's System folder as "</span>
<span class="uscript-line">03549</span>       SuccessImportProfile<span class="uscript-operator">=</span><span class="uscript-string">"Profile imported successfully! The remote profile will now appear in your list of available profiles."</span>
<span class="uscript-line">03550</span>       SuccessImportProfileTitle<span class="uscript-operator">=</span><span class="uscript-string">"Import Successful!"</span>
<span class="uscript-line">03551</span>       SuccessCopyProfile<span class="uscript-operator">=</span><span class="uscript-string">"Profile copied successfully! Copied profile will now be available in your list of available profiles."</span>
<span class="uscript-line">03552</span>       SuccessSwitchProfile<span class="uscript-operator">=</span><span class="uscript-string">"Profile successfully applied! Changes take effect at the end of the current match."</span>
<span class="uscript-line">03553</span>       ErrorLoadingPlayInfoText<span class="uscript-operator">(</span><span class="uscript-number">0</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"Error while loading playinfo.  LoadThisPlayInfo() received bad playinfo object!"</span>
<span class="uscript-line">03554</span>       ErrorLoadingPlayInfoText<span class="uscript-operator">(</span><span class="uscript-number">1</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"Error while loading playinfo.  LoadThisPlayInfo() could not load incoming game class!"</span>
<span class="uscript-line">03555</span>       ErrorLoadingPlayInfoText<span class="uscript-operator">(</span><span class="uscript-number">2</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"Error while loading playinfo.  LoadThisPlayInfo() could not load associated access control!"</span>
<span class="uscript-line">03556</span>       ErrorLoadingPlayInfoText<span class="uscript-operator">(</span><span class="uscript-number">3</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"Error while loading playinfo.  LoadThisPlayInfo() had exception while loading mutators!"</span>
<span class="uscript-line">03557</span>       ErrorLoadingPlayInfoText<span class="uscript-operator">(</span><span class="uscript-number">4</span><span class="uscript-operator">)</span><span class="uscript-operator">=</span><span class="uscript-string">"Error while loading playinfo.  LoadThisPlayInfo() had exception while loading server actors!"</span>
<span class="uscript-line">03558</span>       ErrorGameClassText<span class="uscript-operator">=</span><span class="uscript-string">"No gametype was selected, or the files required by this gametype do not exist on this server."</span>
<span class="uscript-line">03559</span>       ErrorGameClassTitle<span class="uscript-operator">=</span><span class="uscript-string">"Invalid GameType"</span>
<span class="uscript-line">03560</span>       ErrorAccessControlText<span class="uscript-operator">=</span><span class="uscript-string">"Exception while loading access control.  Please double check the AccessControlClass= line of the [Engine.GameInfo] section of your server's .ini file."</span>
<span class="uscript-line">03561</span>       ErrorAccessControlTitle<span class="uscript-operator">=</span><span class="uscript-string">"Invalid Access Control"</span>
<span class="uscript-line">03562</span>       ErrorSameProfileName<span class="uscript-operator">=</span><span class="uscript-string">"Another profile already exists with that name. Please select a different name!"</span>
<span class="uscript-line">03563</span>       ErrorRemoteMutator<span class="uscript-operator">=</span><span class="uscript-string">"Error loading mutator from remote profile. Could not find mutator package:"</span>
<span class="uscript-line">03564</span>       ErrorRemoteServerActor<span class="uscript-operator">=</span><span class="uscript-string">"Error loading ServerActor from remote profile.  Could not find ServerActor package:"</span>
<span class="uscript-line">03565</span>       ErrorSavingProfile<span class="uscript-operator">=</span><span class="uscript-string">"Exception while saving new profile! Please resubmit save request."</span>
<span class="uscript-line">03566</span>       ErrorDeletingProfile<span class="uscript-operator">=</span><span class="uscript-string">"Error deleting profile!  Please check server log for details."</span>
<span class="uscript-line">03567</span>       ErrorExportingProfile<span class="uscript-operator">=</span><span class="uscript-string">"Error exporting profile! Export class could not be spawned!"</span>
<span class="uscript-line">03568</span>       ErrorNoProfilesExist<span class="uscript-operator">=</span><span class="uscript-string">"No profiles exist! Could not perform selected action!"</span>
<span class="uscript-line">03569</span>       ErrorCopyFrom<span class="uscript-operator">=</span><span class="uscript-string">"Error copying profile.  No Profile Found!"</span>
<span class="uscript-line">03570</span>       ErrorCopyNoName<span class="uscript-operator">=</span><span class="uscript-string">"You must specify a unique name for the new profile!"</span>
<span class="uscript-line">03571</span>       ErrorExcludeMapNotFound<span class="uscript-operator">=</span><span class="uscript-string">"Error! Exclude map not found:"</span>
<span class="uscript-line">03572</span>       ErrorIncludeMapNotFound<span class="uscript-operator">=</span><span class="uscript-string">"Error! Include map not found:"</span>
<span class="uscript-line">03573</span>       ErrorReplacingWebConnection<span class="uscript-operator">=</span><span class="uscript-string">"Exception replacing WebServer.AcceptClass! (Very bad) Please send an email to Evolution containing your server's ini and log files."</span>
<span class="uscript-line">03574</span>       ImportClassSpawnError<span class="uscript-operator">=</span><span class="uscript-string">"Exception occured spawning connection class.  Please try again!"</span>
<span class="uscript-line">03575</span>       ImportProfileFailText<span class="uscript-operator">=</span><span class="uscript-string">"Error while importing profile.  Please ensure you have all the files necessary to load this remote profile."</span>
<span class="uscript-line">03576</span>       ImportProfileFailTitle<span class="uscript-operator">=</span><span class="uscript-string">"Import Failed!"</span>
<span class="uscript-line">03577</span>       ErrorBind<span class="uscript-operator">=</span><span class="uscript-string">"Failed to bind port! Please try again!"</span>
<span class="uscript-line">03578</span>       ErrorBadURL<span class="uscript-operator">=</span><span class="uscript-string">"URL must start with 'http://' !"</span>
<span class="uscript-line">03579</span>       ErrorServer<span class="uscript-operator">=</span><span class="uscript-string">"Unspecified error while importing profile!"</span>
<span class="uscript-line">03580</span>       ErrorResolve<span class="uscript-operator">=</span><span class="uscript-string">"URL could not be resolved!"</span>
<span class="uscript-line">03581</span>       ErrorProfile<span class="uscript-operator">=</span><span class="uscript-string">"Attempted to import a file that does not contain a profile!"</span>
<span class="uscript-line">03582</span>       ErrorTimeout<span class="uscript-operator">=</span><span class="uscript-string">"Timed out while waiting for response from foreign host!"</span>
<span class="uscript-line">03583</span>       ErrorNotFound<span class="uscript-operator">=</span><span class="uscript-string">"Profile does not exist on remote server!"</span>
<span class="uscript-line">03584</span>       ErrorForbidden<span class="uscript-operator">=</span><span class="uscript-string">"Remote profile could not be imported: Forbidden"</span>
<span class="uscript-line">03585</span>       ErrorBadRequest<span class="uscript-operator">=</span><span class="uscript-string">"Request could not be processed by remote server!"</span>
<span class="uscript-line">03586</span>       ErrorUnauthorized<span class="uscript-operator">=</span><span class="uscript-string">"Remote profile could not be imported: Unauthorized"</span>
<span class="uscript-line">03587</span>       DefaultPage<span class="uscript-operator">=</span><span class="uscript-string">"ladder_main"</span>
<span class="uscript-line">03588</span>       Title<span class="uscript-operator">=</span><span class="uscript-string">"Ladder"</span>
<span class="uscript-line">03589</span>  <span class="uscript-operator">}</span></pre></div>
</div>

<div id="footer" class="bar">
	<p><form method="post" action="http://wiki.beyondunreal.com/wiki" enctype="application/x-www-form-urlencoded">
<a href="(start).html">Home Page</a> | <a href="recent-changes.html">Recent Changes</a> | <a href="http://wiki.beyondunreal.com/wiki?action=editprefs">Preferences</a><br>
<a href="http://wiki.beyondunreal.com/wiki?action=edit&id=LadderQuery">Edit text of this page</a> | <a href="http://wiki.beyondunreal.com/wiki?action=history&id=LadderQuery">View other revisions</a><br>Last edited March 19, 2003 18:31 <a href="http://wiki.beyondunreal.com/wiki?action=browse&diff=1&id=LadderQuery">(diff)</a><br>Search: <input type="text" name="search"  size="20" /><input type="hidden" name="dosearch" value="1"  /><br><br><small><a href="http://wiki.beyondunreal.com/wiki/LadderQuery">Original page</a> &#150; copy created Sat, Jun 23, 2007</small><div></div>
</form>
	</p>
	<p>There is no spoon
</p>
</div>
</div><!-- close of "scrolling" div -->

<div id="quickbar">
	<div id="logo"><a href="http://wiki.beyondunreal.com/"><img src="shared/wikilogo.jpg" width="143" height="100" border="0"></a>
		</div>
	<div class="qbsitename">
		<p>The Unreal Engine Documentation Site</p>
	</div>
	<div class="qbsection">
<p><a href="metatopics.html">Wiki Community</a></p>
<p><a href="category-category.html">Topic Categories</a></p>
<p><a href="/cgi-bin/imageupload.cgi/wiki-ext/imageupload.htt" target="_blank ">Image Uploads</a></p>
<p><a href="http://wiki.beyondunreal.com/wiki?action=random">Random Page</a></p>
<p><a href="recent-changes.html">Recent Changes</a></p>
<p><a href="offline-wiki.html">Offline Wiki</a></p>
</div><div class="qbsection">
<p><a href="unreal-engine.html">Unreal Engine</a></p>
<p><a href="console-commands.html">Console Commands</a></p>
<p><a href="terminology.html">Terminology</a></p>
<p><a href="category-faq.html">FAQs</a></p>
<p><a href="help-desk.html">Help Desk</a></p>
</div><div class="qbsection">
<p><a href="topics-on-mapping.html">Mapping Topics</a></p>
<p><a href="mapping-lessons.html">Mapping Lessons</a></p>
<p><a href="unrealed-3.html">UnrealEd Interface</a></p>
</div><div class="qbsection">
<p><a href="unrealscript.html">UnrealScript Topics</a></p>
<p><a href="unrealscript-lessons.html">UnrealScript Lessons</a></p>
<p><a href="making-mods.html">Making Mods</a></p>
<p><a href="class-tree.html">Class Tree</a></p>
</div><div class="qbsection">
<p><a href="topics-on-modeling.html">Modeling Topics</a></p>
</div><div class="qbsection">
<p><a href="chongqing-page.html">Chongqing Page</a></p>
<p><a href="log-in.html">Log In</a></p></div>
</div>

</body></html>
