<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"  "http://www.w3.org/TR/html4/loose.dtd">

<html>
<head lang="en">
	<title>UnrealWiki: VitalOverdose/VehicleTeleporter</title>
	<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
	<link rel="stylesheet" type="text/css" media="screen, print"
		href="shared/stylebase.structural.css">	
	<link rel="stylesheet" type="text/css" media="screen"
		href="shared/template-default.css">
	<link rel="stylesheet" type="text/css" media="screen"
		href="shared/styles.chblue.css">
	<link rel="stylesheet" type="text/css" media="print"
		href="shared/template-default-print.css">
	<!--[if IE 6]>
			<style>
			/* dirty hack for IE6. */
			#quickbar {
				position: absolute;
				}
			</style>
	<![endif]-->
  <link rel="start" href="http://wiki.beyondunreal.com/">
  <link rel="glossary"  href="http://wiki.beyondunreal.com/wiki/Terminology">
  <link rel="help"  href="http://wiki.beyondunreal.com/wiki/Using_The_Wiki">
<script type="text/javascript" src="shared/dhtml.js"></script>
<script type="text/javascript" src="shared/dhtml-menu.js"></script>
<style type="text/css">#dhtml-menu    { background: #eee; padding: 5px 0px; margin-right: -20px; border: 1px solid #888; border-left: 1px solid #ccc; border-top: 1px solid #ccc;  border-right: 1px solid #888; border-bottom: 1px solid #888 }
#dhtml-menu td { color: #000; font-family: Arial,Helvetica,sans-serif; font-size: 9pt; line-height: 13pt; padding: 1px 10px; cursor: default }
#dhtml-menu a  { color: #000; font-family: Arial,Helvetica,sans-serif; font-size: 9pt; line-height: 13pt; text-decoration: none }
#dhtml-menu tt { font-family: monospace; font-size: 9pt }
#dhtml-menu-separator { height: 1px; background: red }
#dhtml-menu-anchor { cursor: default }
</style>
<script type="text/javascript" src="shared/expandable.js"></script>
</head>
<body onLoad="menuInit(); document.cookie='page=VitalOverdose/VehicleTeleporter; path=/'" class="default">
<div id="scrolling"><!-- contains all except the fixed sidebar -->
<div id="topbar"  class="bar">
	<div class="righthalf">
		<form class="inline" method="post" action="/wiki" enctype="application/x-www-form-urlencoded"><input type="text" name="search"  size="20" /> <input type="submit" name="search" value="search" /></form>
	</div>
	<div class="lefthalf">
		<script type="text/javascript"><!--
			menuAlignRight = false;
		//--></script>
		<span><script type="text/javascript"><!--
 menuWriteAnchor("Quick Navigation") //--></script></span> | <a href="(start).html">Home Page</a> | <a href="recent-changes.html">Recent Changes</a> | <a href="http://wiki.beyondunreal.com/wiki?action=editprefs">Preferences</a>
	</div>
</div>

<div id="content"><!-- contains the title and article -->
	<h1 class='pagetitle'><a href="vitaloverdose.html">VitalOverdose</a>/<a href="http://wiki.beyondunreal.com/wiki?back=VitalOverdose/VehicleTeleporter">VehicleTeleporter</a></h1>
	<div class="wiki"><div class="classpath"><img src="shared//gameicons/icon-ut2004.png"> <a href="unreal-tournament-2004.html">UT2004</a> :: <a href="actor.html">Actor</a> &gt;&gt; <a href="trigger.html">Trigger</a> &gt;&gt; VehicleTeleporter (Package: custom)<br></div>
<pre class="paraverbatim"> </pre><p>by <a href="vitaloverdose.html">VitalOverdose</a></p>
<p>Part of  <a href="vitaloverdose-vitals-pro-ma.html">Vital'sPMT</a></p>
<h2><a name="0.1"></a>Overview</h2>
<p>I've seen quite a few attempts at a vehicle teleporter but none that i was really happy with so i had a go at making one myself.</p>
<p>The thing is with this vehicle teleporter is you only need 1 of them for it to work. at post begin play it scans all the navigationpoints on the level and records any that have 'TP' in their tag property. The vehicle teleporter then picks one at random to teleport you to. The effect is very smooth.</p>
<pre class="uscript"><span class="uscript-keyword">Simulated</span> <span class="uscript-keyword">Function</span> scanTpAct<span class="uscript-operator">(</span><span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
<span class="uscript-keyword">Local</span> Actor FoundTelPoint<span class="uscript-operator">;</span>
<span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>TpAct<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">&gt;</span><span class="uscript-number">0</span><span class="uscript-operator">)</span> TpAct<span class="uscript-operator">.</span><span class="uscript-keyword">Remove</span><span class="uscript-operator">(</span><span class="uscript-number">0</span><span class="uscript-operator">,</span>TpAct<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-keyword">ForEach</span> AllActors<span class="uscript-operator">(</span> <span class="uscript-keyword">Class</span><span class="uscript-name">'Actor'</span> <span class="uscript-operator">,</span> FoundTelPoint<span class="uscript-operator">,</span><span class="uscript-name">'TP'</span> <span class="uscript-operator">)</span>
   <span class="uscript-operator">{</span>
   TpAct<span class="uscript-operator">.</span><span class="uscript-keyword">Insert</span><span class="uscript-operator">(</span><span class="uscript-number">0</span><span class="uscript-operator">,</span><span class="uscript-number">1</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
   TpAct<span class="uscript-operator">[</span><span class="uscript-number">0</span><span class="uscript-operator">]</span> <span class="uscript-operator">=</span> FoundTelPoint<span class="uscript-operator">;</span>
   <span class="uscript-operator">}</span>
<span class="uscript-operator">}</span></pre><p>There is no real need to have the vectel function and the posttel function separate from each other. the whole thing works quite well in a single function but i have split it up this way so its easyer to understand/modify. The vec collides with the VecTeleporter and the vec teleporter records the speed and rotaion details for the vehicle bfore setting its physics to none.A random spawn point is picked at this point and once the physics has been set to none the vehicle is relocated to its new point in the map.</p>
<pre class="uscript"><span class="uscript-keyword">Simulated</span> <span class="uscript-keyword">function</span> Vectel<span class="uscript-operator">(</span>Pawn Teleporting<span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
<span class="uscript-keyword">Local</span> Rotator  oldRot<span class="uscript-operator">,</span>newrot<span class="uscript-operator">;</span> 
<span class="uscript-keyword">Local</span> Vector   Abf<span class="uscript-operator">;</span> 
<span class="uscript-keyword">Local</span> EPhysics Entryphysics<span class="uscript-operator">;</span> 
<span class="uscript-keyword">Local</span> <span class="uscript-type">Int</span>      PickedTelPoint<span class="uscript-operator">;</span>
NewRot         <span class="uscript-operator">=</span> Teleporting<span class="uscript-operator">.</span>Rotation<span class="uscript-operator">;</span>
EntryPhysics   <span class="uscript-operator">=</span> Teleporting<span class="uscript-operator">.</span>Physics<span class="uscript-operator">;</span>
ABF            <span class="uscript-operator">=</span> Teleporting<span class="uscript-operator">.</span>Velocity <span class="uscript-operator">*</span> <span class="uscript-number">500</span><span class="uscript-operator">;</span>
PickedTelPoint <span class="uscript-operator">=</span> Rand<span class="uscript-operator">(</span>TpAct<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-number">-1</span><span class="uscript-operator">)</span><span class="uscript-operator">+</span><span class="uscript-number">1</span><span class="uscript-operator">;</span>
Teleporting<span class="uscript-operator">.</span>SetPhysics<span class="uscript-operator">(</span>PHYS_None<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
Teleporting<span class="uscript-operator">.</span>setLocation<span class="uscript-operator">(</span>TpAct<span class="uscript-operator">[</span>pickedTelPoint<span class="uscript-operator">]</span><span class="uscript-operator">.</span>Location<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
OldRot         <span class="uscript-operator">=</span> Teleporting<span class="uscript-operator">.</span>Rotation<span class="uscript-operator">;</span>
NewRot<span class="uscript-operator">.</span>Yaw     <span class="uscript-operator">=</span> TpAct<span class="uscript-operator">[</span>pickedTelPoint<span class="uscript-operator">]</span><span class="uscript-operator">.</span>Rotation<span class="uscript-operator">.</span>Yaw <span class="uscript-operator">+</span> Teleporting<span class="uscript-operator">.</span>Rotation<span class="uscript-operator">.</span>Yaw <span class="uscript-operator">-</span> <span class="uscript-keyword">Self</span><span class="uscript-operator">.</span>Rotation<span class="uscript-operator">.</span>Yaw<span class="uscript-operator">;</span>
PostTel<span class="uscript-operator">(</span>Teleporting<span class="uscript-operator">,</span>pickedTelPoint<span class="uscript-operator">,</span>Newrot<span class="uscript-operator">,</span>EntryPhysics<span class="uscript-operator">,</span>abf<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-operator">}</span></pre><p>In the posttel function the vehicle is given back its origional physics and a correct viewpoint based on the navigation points direction is set. Also the code makes sure that flying vehicles remain upright. Then to complete the effect a scaled boost is applied to the vehicle in the direction the navigation point is facing.</p>
<pre class="uscript"> 
<span class="uscript-keyword">Simulated</span> <span class="uscript-keyword">Function</span>  Posttel<span class="uscript-operator">(</span> Pawn Teleporting<span class="uscript-operator">,</span><span class="uscript-type">int</span> telPointnumb<span class="uscript-operator">,</span>Rotator Newrot<span class="uscript-operator">,</span>EPhysics EntryPhysics<span class="uscript-operator">,</span>Vector Abf<span class="uscript-operator">,</span><span class="uscript-keyword">optional</span> 
Vector pbf<span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
Teleporting<span class="uscript-operator">.</span>SetPhysics<span class="uscript-operator">(</span>EntryPhysics<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
Teleporting<span class="uscript-operator">.</span>Controller<span class="uscript-operator">.</span>moveTimer <span class="uscript-operator">=</span> <span class="uscript-operator">-</span><span class="uscript-number">1.0</span><span class="uscript-operator">;</span>
Teleporting<span class="uscript-operator">.</span>SetmoveTarget<span class="uscript-operator">(</span><span class="uscript-keyword">Self</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
Teleporting<span class="uscript-operator">.</span>Controller<span class="uscript-operator">.</span>SetRotation<span class="uscript-operator">(</span>newRot<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
Teleporting<span class="uscript-operator">.</span>SetRotation<span class="uscript-operator">(</span>newRot<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-keyword">if</span> <span class="uscript-operator">(</span> Teleporting<span class="uscript-operator">.</span>IsA<span class="uscript-operator">(</span><span class="uscript-name">'ONSChopperCraft'</span><span class="uscript-operator">)</span> <span class="uscript-operator">||</span>
     Teleporting<span class="uscript-operator">.</span>IsA<span class="uscript-operator">(</span><span class="uscript-name">'ONSHoverCraft'</span><span class="uscript-operator">)</span>   <span class="uscript-operator">||</span>  
     Teleporting<span class="uscript-operator">.</span>IsA<span class="uscript-operator">(</span><span class="uscript-name">'ONSPlaneCraft'</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>  
   <span class="uscript-operator">{</span>
    Teleporting<span class="uscript-operator">.</span>KSetStayUpright<span class="uscript-operator">(</span> <span class="uscript-keyword">True</span><span class="uscript-operator">,</span><span class="uscript-keyword">True</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
   <span class="uscript-operator">}</span>
Vehicle<span class="uscript-operator">(</span>Teleporting<span class="uscript-operator">)</span><span class="uscript-operator">.</span>KAddImpulse<span class="uscript-operator">(</span>abf <span class="uscript-operator">&gt;&gt;</span> Rotation<span class="uscript-operator">,</span> pbf <span class="uscript-operator">&gt;&gt;</span> Rotation<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-operator">}</span></pre><h2><a name="0.2"></a>Full Script</h2>
<p>Here's the complete script:</p>
<pre class="uscript"><span class="uscript-comment">//=============================================================================</span>
<span class="uscript-comment">// VehicleTeleporter By vitaloverdose, Feb 2006, http://www.Vitaloverdose.com</span>
<span class="uscript-comment">// This is part of the 'Vitals Pro Mapping Tools' Mod </span>
<span class="uscript-comment">// Full class list http://wiki.beyondunreal.com/wiki/Vital's_Pro_Mapping_Tools</span>
<span class="uscript-comment">// Direct Download the Mod in zipped format Http://promappingtools.zapto.org</span>
<span class="uscript-comment">//=============================================================================</span>


<span class="uscript-keyword">class</span> VehicleTeleporter <span class="uscript-keyword">extends</span> trigger
<span class="uscript-keyword">placeable</span><span class="uscript-operator">;</span>

<span class="uscript-keyword">var</span> <span class="uscript-keyword">Array</span><span class="uscript-operator">&lt;</span>actor<span class="uscript-operator">&gt;</span> TpAct<span class="uscript-operator">;</span>

<span class="uscript-keyword">Simulated</span> <span class="uscript-keyword">Function</span> scanTpAct<span class="uscript-operator">(</span><span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
 <span class="uscript-keyword">Local</span> Actor FoundTelPoint<span class="uscript-operator">;</span>
 <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>TpAct<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">&gt;</span><span class="uscript-number">0</span><span class="uscript-operator">)</span> 
    <span class="uscript-operator">{</span>
     TpAct<span class="uscript-operator">.</span><span class="uscript-keyword">Remove</span><span class="uscript-operator">(</span><span class="uscript-number">0</span><span class="uscript-operator">,</span>TpAct<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>
 <span class="uscript-keyword">ForEach</span> AllActors<span class="uscript-operator">(</span> <span class="uscript-keyword">Class</span><span class="uscript-name">'Actor'</span> <span class="uscript-operator">,</span> FoundTelPoint<span class="uscript-operator">,</span><span class="uscript-name">'TP'</span> <span class="uscript-operator">)</span>
                  <span class="uscript-operator">{</span>
                   TpAct<span class="uscript-operator">.</span><span class="uscript-keyword">Insert</span><span class="uscript-operator">(</span><span class="uscript-number">0</span><span class="uscript-operator">,</span><span class="uscript-number">1</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
                   TpAct<span class="uscript-operator">[</span><span class="uscript-number">0</span><span class="uscript-operator">]</span> <span class="uscript-operator">=</span> FoundTelPoint<span class="uscript-operator">;</span>
                  <span class="uscript-operator">}</span>
<span class="uscript-operator">}</span>

<span class="uscript-keyword">Simulated</span> <span class="uscript-keyword">function</span> Vectel<span class="uscript-operator">(</span>Pawn Teleporting<span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
<span class="uscript-keyword">Local</span> Rotator  oldRot<span class="uscript-operator">,</span>newrot<span class="uscript-operator">;</span> 
<span class="uscript-keyword">Local</span> Vector Abf<span class="uscript-operator">;</span> 
<span class="uscript-keyword">Local</span> EPhysics Entryphysics<span class="uscript-operator">;</span> 
<span class="uscript-keyword">Local</span> <span class="uscript-type">Int</span> pickedTelPoint<span class="uscript-operator">;</span>

NewRot         <span class="uscript-operator">=</span> Teleporting<span class="uscript-operator">.</span>Rotation<span class="uscript-operator">;</span>
EntryPhysics   <span class="uscript-operator">=</span> Teleporting<span class="uscript-operator">.</span>Physics<span class="uscript-operator">;</span>
ABF            <span class="uscript-operator">=</span> Teleporting<span class="uscript-operator">.</span>Velocity <span class="uscript-operator">*</span> <span class="uscript-number">500</span><span class="uscript-operator">;</span>
PickedTelPoint <span class="uscript-operator">=</span> rand<span class="uscript-operator">(</span>TpAct<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-number">-1</span><span class="uscript-operator">)</span><span class="uscript-operator">+</span><span class="uscript-number">1</span><span class="uscript-operator">;</span>
Teleporting<span class="uscript-operator">.</span>SetPhysics<span class="uscript-operator">(</span>PHYS_None<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
Teleporting<span class="uscript-operator">.</span>setLocation<span class="uscript-operator">(</span>TpAct<span class="uscript-operator">[</span>pickedTelPoint<span class="uscript-operator">]</span><span class="uscript-operator">.</span>Location<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
OldRot       <span class="uscript-operator">=</span> Teleporting<span class="uscript-operator">.</span>Rotation<span class="uscript-operator">;</span>
NewRot<span class="uscript-operator">.</span>Yaw   <span class="uscript-operator">=</span> TpAct<span class="uscript-operator">[</span>pickedTelPoint<span class="uscript-operator">]</span><span class="uscript-operator">.</span>Rotation<span class="uscript-operator">.</span>Yaw <span class="uscript-operator">+</span> Teleporting<span class="uscript-operator">.</span>Rotation<span class="uscript-operator">.</span>Yaw <span class="uscript-operator">-</span> <span class="uscript-keyword">Self</span><span class="uscript-operator">.</span>Rotation<span class="uscript-operator">.</span>Yaw<span class="uscript-operator">;</span>
Posttel<span class="uscript-operator">(</span>Teleporting<span class="uscript-operator">,</span>pickedTelPoint<span class="uscript-operator">,</span>Newrot<span class="uscript-operator">,</span>EntryPhysics<span class="uscript-operator">,</span>abf<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-operator">}</span>

<span class="uscript-keyword">Simulated</span> <span class="uscript-keyword">Function</span> PostTel<span class="uscript-operator">(</span> Pawn Teleporting<span class="uscript-operator">,</span><span class="uscript-type">int</span> telPointnumb<span class="uscript-operator">,</span>Rotator Newrot<span class="uscript-operator">,</span>EPhysics EntryPhysics<span class="uscript-operator">,</span>Vector Abf<span class="uscript-operator">,</span><span class="uscript-keyword">optional</span> Vector pbf<span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
Teleporting<span class="uscript-operator">.</span>SetPhysics<span class="uscript-operator">(</span>EntryPhysics<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
Teleporting<span class="uscript-operator">.</span>Controller<span class="uscript-operator">.</span>moveTimer <span class="uscript-operator">=</span> <span class="uscript-operator">-</span><span class="uscript-number">1.0</span><span class="uscript-operator">;</span>
Teleporting<span class="uscript-operator">.</span>SetmoveTarget<span class="uscript-operator">(</span><span class="uscript-keyword">Self</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
Teleporting<span class="uscript-operator">.</span>Controller<span class="uscript-operator">.</span>SetRotation<span class="uscript-operator">(</span>newRot<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
Teleporting<span class="uscript-operator">.</span>SetRotation<span class="uscript-operator">(</span>newRot<span class="uscript-operator">)</span><span class="uscript-operator">;</span>

<span class="uscript-keyword">if</span> <span class="uscript-operator">(</span> Teleporting<span class="uscript-operator">.</span>IsA<span class="uscript-operator">(</span><span class="uscript-name">'ONSChopperCraft'</span><span class="uscript-operator">)</span> <span class="uscript-operator">||</span>
     Teleporting<span class="uscript-operator">.</span>IsA<span class="uscript-operator">(</span><span class="uscript-name">'ONSHoverCraft'</span><span class="uscript-operator">)</span>    <span class="uscript-operator">||</span>
     Teleporting<span class="uscript-operator">.</span>IsA<span class="uscript-operator">(</span><span class="uscript-name">'ONSPlaneCraft'</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
     Teleporting<span class="uscript-operator">.</span>KSetStayUpright<span class="uscript-operator">(</span> <span class="uscript-keyword">True</span><span class="uscript-operator">,</span><span class="uscript-keyword">True</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>

Vehicle<span class="uscript-operator">(</span>Teleporting<span class="uscript-operator">)</span><span class="uscript-operator">.</span>KAddImpulse<span class="uscript-operator">(</span>abf <span class="uscript-operator">&gt;&gt;</span> Rotation<span class="uscript-operator">,</span> PBF <span class="uscript-operator">&gt;&gt;</span> Rotation<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-operator">}</span></pre><p>In this final revision the vehicle teleporter can be set to rescan the tp point at regular intervals. Quick simply this means you can have 'moving vec telpoints' as long as the actor with 'TP' as a tag is not solid.</p>
<p>Also the teleport will check to see if a spawn point is occupied before attempting to teleport a vehicle to that spot. if that spot is occupied by a solid actor the vehicleteleporter will pick another at random and test to see if that spot is suitable.</p>
<p>Also this version of the script has added fx;- ambiant fx and teleportfx.</p>
<p>the ambiant fx is really there as a visual marker to where the vehicle teleport is while playing.Also the are some sound fx that can be set in Unrealed.</p>
<pre class="uscript"><span class="uscript-comment">//=============================================================================</span>
<span class="uscript-comment">// VehicleTeleporter By Vitaloverdose, Feb 2006, http://www.Vitaloverdose.com</span>
<span class="uscript-comment">// This is part of the 'Vitals Pro Mapping Tools' Mod </span>
<span class="uscript-comment">// Full class list http://wiki.beyondunreal.com/wiki/Vital's_Pro_Mapping_Tools</span>
<span class="uscript-comment">// Direct Download the Mod in zipped format Http://promappingtools.zapto.org</span>
<span class="uscript-comment">//=============================================================================</span>

<span class="uscript-keyword">class</span> VehicleTeleporter <span class="uscript-keyword">Extends</span> VitalPMToolBox
<span class="uscript-keyword">placeable</span><span class="uscript-operator">;</span>

<span class="uscript-keyword">struct</span>                              VecRec
<span class="uscript-operator">{</span>
 <span class="uscript-keyword">var</span> OnsVehicle                     VevRef<span class="uscript-operator">;</span>
 <span class="uscript-keyword">Var</span> <span class="uscript-type">float</span>                      RecTime<span class="uscript-operator">;</span>
<span class="uscript-operator">}</span><span class="uscript-operator">;</span><span class="uscript-keyword">Var</span> <span class="uscript-keyword">Array</span><span class="uscript-operator">&lt;</span> VecRec <span class="uscript-operator">&gt;</span>               Tracking<span class="uscript-operator">;</span>


<span class="uscript-keyword">var</span> <span class="uscript-keyword">Array</span><span class="uscript-operator">&lt;</span> Actor <span class="uscript-operator">&gt;</span>                  TpAct<span class="uscript-operator">;</span>

<span class="uscript-keyword">Var</span> <span class="uscript-type">bool</span>                            bTracking<span class="uscript-operator">;</span>
<span class="uscript-keyword">var</span> <span class="uscript-type">float</span>                           NextRescan<span class="uscript-operator">;</span>
<span class="uscript-keyword">var</span> Emitter                         SpawnedAmbiantFx<span class="uscript-operator">;</span>
<span class="uscript-keyword">var</span> Emitter                         SpawnedVecFx<span class="uscript-operator">;</span>

<span class="uscript-keyword">Var</span> <span class="uscript-operator">(</span><span class="uscript-operator">)</span> <span class="uscript-type">bool</span>                         bTeleportsEmptyVecs<span class="uscript-operator">;</span>
<span class="uscript-keyword">Var</span> <span class="uscript-operator">(</span><span class="uscript-operator">)</span> <span class="uscript-type">bool</span>                         bScanDest<span class="uscript-operator">;</span>
<span class="uscript-keyword">Var</span> <span class="uscript-operator">(</span><span class="uscript-operator">)</span> Sound                        TeleportSound<span class="uscript-operator">;</span>
<span class="uscript-keyword">Var</span> <span class="uscript-operator">(</span><span class="uscript-operator">)</span> <span class="uscript-type">float</span>                        CaptureTime<span class="uscript-operator">;</span>
<span class="uscript-keyword">Var</span> <span class="uscript-operator">(</span><span class="uscript-operator">)</span> <span class="uscript-type">float</span>                        TimerFrequency<span class="uscript-operator">;</span>

<span class="uscript-keyword">Var</span> <span class="uscript-operator">(</span><span class="uscript-operator">)</span> <span class="uscript-type">Float</span>                        ReScanDelay<span class="uscript-operator">;</span>
<span class="uscript-keyword">var</span> <span class="uscript-operator">(</span><span class="uscript-operator">)</span> <span class="uscript-keyword">Array</span><span class="uscript-operator">&lt;</span> <span class="uscript-keyword">Class</span><span class="uscript-operator">&lt;</span> Emitter <span class="uscript-operator">&gt;</span> <span class="uscript-operator">&gt;</span>    VecTagFxPool<span class="uscript-operator">;</span>
<span class="uscript-keyword">Var</span> <span class="uscript-operator">(</span><span class="uscript-operator">)</span> <span class="uscript-keyword">Array</span><span class="uscript-operator">&lt;</span> <span class="uscript-keyword">Class</span><span class="uscript-operator">&lt;</span> Emitter <span class="uscript-operator">&gt;</span> <span class="uscript-operator">&gt;</span>    AmbiantFxPool<span class="uscript-operator">;</span>
<span class="uscript-keyword">Var</span> <span class="uscript-operator">(</span><span class="uscript-operator">)</span> <span class="uscript-keyword">Array</span><span class="uscript-operator">&lt;</span> <span class="uscript-keyword">Class</span><span class="uscript-operator">&lt;</span> Emitter <span class="uscript-operator">&gt;</span> <span class="uscript-operator">&gt;</span>    TeleportFxPool_Vec<span class="uscript-operator">;</span>
<span class="uscript-keyword">Var</span> <span class="uscript-operator">(</span><span class="uscript-operator">)</span> <span class="uscript-keyword">Array</span><span class="uscript-operator">&lt;</span> <span class="uscript-keyword">Class</span><span class="uscript-operator">&lt;</span> Emitter <span class="uscript-operator">&gt;</span> <span class="uscript-operator">&gt;</span>    TeleportFxPool_Self<span class="uscript-operator">;</span>

<span class="uscript-keyword">Function</span> PostBeginPlay<span class="uscript-operator">(</span><span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
 ScanTpAct<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>

 <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span> ambiantfxpool<span class="uscript-operator">.</span><span class="uscript-keyword">length</span> <span class="uscript-operator">!=</span><span class="uscript-number">0</span> <span class="uscript-operator">)</span>
    <span class="uscript-operator">{</span>
     SpawnFx<span class="uscript-operator">(</span> <span class="uscript-keyword">Self</span><span class="uscript-operator">.</span>Location <span class="uscript-operator">,</span> AmbiantFxPool  <span class="uscript-operator">,</span> <span class="uscript-keyword">self</span> <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>

 <span class="uscript-keyword">If</span> <span class="uscript-operator">(</span> <span class="uscript-operator">(</span> bScanDest <span class="uscript-operator">!=</span> <span class="uscript-keyword">false</span> <span class="uscript-operator">)</span> <span class="uscript-operator">&amp;&amp;</span> <span class="uscript-operator">(</span> <span class="uscript-operator">(</span>AmbiantFxpool<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span> <span class="uscript-operator">&lt;=</span> <span class="uscript-number">0</span> <span class="uscript-operator">)</span> <span class="uscript-operator">||</span> <span class="uscript-operator">(</span> ReScanDelay <span class="uscript-operator">&lt;=</span> <span class="uscript-number">0</span> <span class="uscript-operator">)</span><span class="uscript-operator">)</span> <span class="uscript-operator">)</span>
    <span class="uscript-operator">{</span>
     NextRescan <span class="uscript-operator">=</span> ReScanDelay<span class="uscript-operator">;</span>

     <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span> timerfrequency <span class="uscript-operator">&lt;</span> <span class="uscript-number">1</span> <span class="uscript-operator">)</span>
        <span class="uscript-operator">{</span>
         timerfrequency <span class="uscript-operator">=</span> <span class="uscript-number">1</span><span class="uscript-operator">;</span>
        <span class="uscript-operator">}</span>

     SetTimer<span class="uscript-operator">(</span> <span class="uscript-number">1</span> <span class="uscript-operator">,</span> <span class="uscript-keyword">true</span> <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>
<span class="uscript-operator">}</span>

<span class="uscript-keyword">Simulated</span> <span class="uscript-keyword">Function</span> ScanTpAct<span class="uscript-operator">(</span><span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
 <span class="uscript-keyword">Local</span> Actor FoundTelPoint<span class="uscript-operator">;</span>

 <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span> TpAct<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span> <span class="uscript-operator">&gt;</span> <span class="uscript-number">0</span> <span class="uscript-operator">)</span>
    <span class="uscript-operator">{</span>
     TpAct<span class="uscript-operator">.</span><span class="uscript-keyword">Remove</span><span class="uscript-operator">(</span><span class="uscript-number">0</span><span class="uscript-operator">,</span>TpAct<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>

 <span class="uscript-keyword">foreach</span> AllActors<span class="uscript-operator">(</span> <span class="uscript-keyword">Class</span><span class="uscript-name">'Actor'</span> <span class="uscript-operator">,</span> FoundTelPoint<span class="uscript-operator">,</span><span class="uscript-name">'TP'</span> <span class="uscript-operator">)</span>
                  <span class="uscript-operator">{</span>
                   TpAct<span class="uscript-operator">.</span><span class="uscript-keyword">Insert</span><span class="uscript-operator">(</span> <span class="uscript-number">0</span> <span class="uscript-operator">,</span> <span class="uscript-number">1</span> <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
                   TpAct<span class="uscript-operator">[</span><span class="uscript-number">0</span><span class="uscript-operator">]</span> <span class="uscript-operator">=</span> FoundTelPoint<span class="uscript-operator">;</span>
                  <span class="uscript-operator">}</span>
<span class="uscript-operator">}</span>

<span class="uscript-keyword">function</span> Touch<span class="uscript-operator">(</span> Actor Other <span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
 <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span> Other<span class="uscript-operator">.</span>IsA<span class="uscript-operator">(</span><span class="uscript-name">'Vehicle'</span><span class="uscript-operator">)</span> <span class="uscript-operator">)</span>
    <span class="uscript-operator">{</span>
     <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span> <span class="uscript-operator">(</span> vehicle<span class="uscript-operator">(</span>Other<span class="uscript-operator">)</span><span class="uscript-operator">.</span>driver <span class="uscript-operator">==</span> <span class="uscript-keyword">none</span> <span class="uscript-operator">)</span> <span class="uscript-operator">&amp;&amp;</span> <span class="uscript-operator">(</span> bTeleportsEmptyVecs <span class="uscript-operator">==</span> <span class="uscript-keyword">false</span> <span class="uscript-operator">)</span> <span class="uscript-operator">)</span>
        <span class="uscript-operator">{</span>
         <span class="uscript-keyword">return</span><span class="uscript-operator">;</span>
        <span class="uscript-operator">}</span>
   <span class="uscript-keyword">else</span>
   Vectel<span class="uscript-operator">(</span> Pawn<span class="uscript-operator">(</span>Other<span class="uscript-operator">)</span> <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
   <span class="uscript-operator">}</span>
<span class="uscript-operator">}</span>

<span class="uscript-keyword">Simulated</span> <span class="uscript-keyword">Function</span> Vectel<span class="uscript-operator">(</span>Pawn PTele<span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
 <span class="uscript-keyword">local</span> EPhysics      Entryphysics<span class="uscript-operator">;</span>
 <span class="uscript-keyword">local</span> Vehicle       Teleporting<span class="uscript-operator">;</span>
 <span class="uscript-keyword">local</span> <span class="uscript-keyword">Array</span><span class="uscript-operator">&lt;</span>Actor<span class="uscript-operator">&gt;</span>  TempTpAct<span class="uscript-operator">;</span>
 <span class="uscript-keyword">local</span> Rotator       Old_Rot<span class="uscript-operator">;</span>
 <span class="uscript-keyword">local</span> Rotator       New_Rot<span class="uscript-operator">;</span>
 <span class="uscript-keyword">local</span> Vector        NewVector<span class="uscript-operator">;</span>
 <span class="uscript-keyword">Local</span> <span class="uscript-type">int</span>           Counter<span class="uscript-operator">;</span>
 <span class="uscript-keyword">Local</span> <span class="uscript-type">int</span>           PickedRNDNo<span class="uscript-operator">;</span>

 Teleporting       <span class="uscript-operator">=</span> Vehicle<span class="uscript-operator">(</span>pTele<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
 TempTpAct<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span>  <span class="uscript-operator">=</span> tpact<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">;</span>
 TempTpAct         <span class="uscript-operator">=</span> tpact<span class="uscript-operator">;</span>
 New_Rot           <span class="uscript-operator">=</span> Teleporting<span class="uscript-operator">.</span>Rotation<span class="uscript-operator">;</span>
 EntryPhysics      <span class="uscript-operator">=</span> Teleporting<span class="uscript-operator">.</span>Physics<span class="uscript-operator">;</span>
 AppliedBoostForce <span class="uscript-operator">=</span> Teleporting<span class="uscript-operator">.</span>Velocity <span class="uscript-operator">*</span> <span class="uscript-number">500</span><span class="uscript-operator">;</span>
 Teleporting<span class="uscript-operator">.</span>SetPhysics<span class="uscript-operator">(</span>PHYS_None<span class="uscript-operator">)</span><span class="uscript-operator">;</span>

 <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span> Counter<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span>Counter<span class="uscript-operator">&lt;</span>tpact<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">;</span>Counter<span class="uscript-operator">++</span><span class="uscript-operator">)</span>       <span class="uscript-comment">//here i want to pick Numbs at Random from a list</span>
     <span class="uscript-operator">{</span>                                                 <span class="uscript-comment">//First west up the Numbs in sequential order and then</span>
      PickedRNDNo <span class="uscript-operator">=</span> Rand<span class="uscript-operator">(</span> tempTpAct<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span> <span class="uscript-operator">-</span><span class="uscript-number">1</span> <span class="uscript-operator">)</span><span class="uscript-operator">+</span><span class="uscript-number">1</span><span class="uscript-operator">;</span>      <span class="uscript-comment">//pick a RND No based on the Length of the list.Once Picked</span>

      <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span> <span class="uscript-operator">!</span>IaNavBlocked<span class="uscript-operator">(</span>Teleporting<span class="uscript-operator">.</span><span class="uscript-keyword">default</span><span class="uscript-operator">.</span>CollisionRadius<span class="uscript-operator">,</span>NewVector<span class="uscript-operator">)</span> <span class="uscript-operator">)</span>
         <span class="uscript-operator">{</span>
          NewVector   <span class="uscript-operator">=</span> tempTpAct<span class="uscript-operator">[</span>PickedRNDNo<span class="uscript-operator">]</span><span class="uscript-operator">.</span>Location<span class="uscript-operator">;</span>    <span class="uscript-comment">//the Numb is removed from the list and anOther Numb is pick</span>
          Teleporting<span class="uscript-operator">.</span>SetLocation<span class="uscript-operator">(</span>NewVector<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
          Old_Rot       <span class="uscript-operator">=</span> Teleporting<span class="uscript-operator">.</span>Rotation<span class="uscript-operator">;</span>
          New_Rot<span class="uscript-operator">.</span>Yaw   <span class="uscript-operator">=</span> TpAct<span class="uscript-operator">[</span>PickedRNDNo<span class="uscript-operator">]</span><span class="uscript-operator">.</span>Rotation<span class="uscript-operator">.</span>Yaw <span class="uscript-operator">+</span> Teleporting<span class="uscript-operator">.</span>Rotation<span class="uscript-operator">.</span>Yaw <span class="uscript-operator">-</span> <span class="uscript-keyword">Self</span><span class="uscript-operator">.</span>Rotation<span class="uscript-operator">.</span>Yaw<span class="uscript-operator">;</span>
          posttel<span class="uscript-operator">(</span>Teleporting <span class="uscript-operator">,</span> PickedRNDNo <span class="uscript-operator">,</span>NewVector<span class="uscript-operator">,</span> New_Rot <span class="uscript-operator">,</span> EntryPhysics  <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
         <span class="uscript-operator">}</span>

      tempTpAct<span class="uscript-operator">.</span><span class="uscript-keyword">remove</span><span class="uscript-operator">(</span> PickedRNDNo <span class="uscript-operator">,</span> <span class="uscript-number">1</span> <span class="uscript-operator">)</span><span class="uscript-operator">;</span>                <span class="uscript-comment">//is Picked based on the new Length of the list</span>
     <span class="uscript-operator">}</span>
<span class="uscript-operator">}</span>

<span class="uscript-keyword">Simulated</span> <span class="uscript-keyword">function</span>  VecBoost<span class="uscript-operator">(</span> OnsVehicle TheVec <span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
 <span class="uscript-keyword">Local</span> Vector PointOfBoostForce<span class="uscript-operator">;</span>  <span class="uscript-comment">// if not set defaults to(0,0,0)  ie. the center of the vec.</span>
 <span class="uscript-keyword">Local</span> Actor  RotRelation<span class="uscript-operator">;</span>        

 <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span> bDirectional<span class="uscript-operator">)</span>
    <span class="uscript-operator">{</span>
     RotRelation <span class="uscript-operator">=</span> <span class="uscript-keyword">Self</span> <span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>
 TheVec<span class="uscript-operator">.</span>KAddImpulse<span class="uscript-operator">(</span> AppliedBoostForce <span class="uscript-operator">&gt;&gt;</span> RotRelation<span class="uscript-operator">.</span>Rotation<span class="uscript-operator">,</span> PointOfBoostForce <span class="uscript-operator">&gt;&gt;</span> RotRelation<span class="uscript-operator">.</span>Rotation <span class="uscript-operator">)</span> <span class="uscript-operator">;</span>
 EnterVecRec<span class="uscript-operator">(</span> TheVec <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-operator">}</span>

<span class="uscript-keyword">function</span> Timer<span class="uscript-operator">(</span><span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
 <span class="uscript-keyword">local</span> <span class="uscript-type">int</span> counter<span class="uscript-operator">;</span>

 <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>NextRescan<span class="uscript-operator">&gt;</span><span class="uscript-number">0</span><span class="uscript-operator">)</span>
    <span class="uscript-operator">{</span>
     NextRescan<span class="uscript-operator">-=</span>timerfrequency<span class="uscript-operator">;</span>

     <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span> NextRescan <span class="uscript-operator">&lt;</span> <span class="uscript-number">0</span> <span class="uscript-operator">)</span>
        <span class="uscript-operator">{</span>
         ScanTpAct<span class="uscript-operator">(</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
         NextRescan <span class="uscript-operator">=</span> ReScanDelay<span class="uscript-operator">;</span>
        <span class="uscript-operator">}</span>
    <span class="uscript-operator">}</span>

 <span class="uscript-keyword">for</span> <span class="uscript-operator">(</span> Counter<span class="uscript-operator">=</span><span class="uscript-number">0</span><span class="uscript-operator">;</span> Counter<span class="uscript-operator">&lt;</span>Tracking<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">;</span> Counter<span class="uscript-operator">++</span> <span class="uscript-operator">)</span>
     <span class="uscript-operator">{</span>
     Tracking<span class="uscript-operator">[</span>Counter<span class="uscript-operator">]</span><span class="uscript-operator">.</span>VevRef<span class="uscript-operator">.</span>bDriverCannotLeaveVehicle <span class="uscript-operator">=</span> <span class="uscript-keyword">False</span> <span class="uscript-operator">;</span>
     Tracking<span class="uscript-operator">.</span><span class="uscript-keyword">remove</span><span class="uscript-operator">(</span> Counter <span class="uscript-operator">,</span> <span class="uscript-number">1</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
     <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span> Tracking<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span> <span class="uscript-operator">==</span> <span class="uscript-number">0</span> <span class="uscript-operator">)</span>
        <span class="uscript-operator">{</span>
         bTracking <span class="uscript-operator">=</span> <span class="uscript-keyword">False</span><span class="uscript-operator">;</span>
        <span class="uscript-operator">}</span>
        
     <span class="uscript-operator">}</span>
<span class="uscript-operator">}</span>

<span class="uscript-keyword">function</span> enterVecRec<span class="uscript-operator">(</span> ONSVehicle NewVec <span class="uscript-operator">)</span>

<span class="uscript-operator">{</span>
 NewVec<span class="uscript-operator">.</span>bDriverCannotLeaveVehicle <span class="uscript-operator">=</span> <span class="uscript-keyword">True</span><span class="uscript-operator">;</span>
 
 Tracking<span class="uscript-operator">.</span><span class="uscript-keyword">insert</span><span class="uscript-operator">(</span><span class="uscript-number">0</span><span class="uscript-operator">,</span><span class="uscript-number">1</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
 Tracking<span class="uscript-operator">[</span><span class="uscript-number">0</span><span class="uscript-operator">]</span> <span class="uscript-operator">=</span> NewVec<span class="uscript-operator">;</span>
 
 <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span>bTracking <span class="uscript-operator">==</span> <span class="uscript-keyword">False</span> <span class="uscript-operator">)</span>
    <span class="uscript-operator">{</span>
     bTracking <span class="uscript-operator">=</span> <span class="uscript-keyword">True</span><span class="uscript-operator">;</span>
     SetTimer<span class="uscript-operator">(</span>TimerFrequency<span class="uscript-operator">,</span><span class="uscript-keyword">True</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>        <span class="uscript-comment">// set Timer to repeatedly be called every 'Timerfrequncy' Seconds.</span>
    <span class="uscript-operator">}</span>
<span class="uscript-operator">}</span>


<span class="uscript-keyword">Simulated</span> <span class="uscript-keyword">Function</span>  SpawnFx<span class="uscript-operator">(</span> Vector SpawnPos <span class="uscript-operator">,</span><span class="uscript-keyword">Array</span><span class="uscript-operator">&lt;</span> <span class="uscript-keyword">Class</span><span class="uscript-operator">&lt;</span> Emitter <span class="uscript-operator">&gt;</span> <span class="uscript-operator">&gt;</span> FxSpawnpool<span class="uscript-operator">,</span> Actor Hardattachedto <span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
 <span class="uscript-keyword">Local</span> <span class="uscript-type">int</span>            PickedNumb<span class="uscript-operator">;</span>
 <span class="uscript-keyword">local</span> <span class="uscript-keyword">Class</span><span class="uscript-operator">&lt;</span>Emitter<span class="uscript-operator">&gt;</span> ChosenFxClass<span class="uscript-operator">;</span>
 <span class="uscript-keyword">local</span> Emitter        SpawnedFx<span class="uscript-operator">;</span>

 <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span> FxSpawnpool<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span> <span class="uscript-operator">&lt;=</span> <span class="uscript-number">0</span> <span class="uscript-operator">)</span>
    <span class="uscript-operator">{</span>
     PickedNumb  <span class="uscript-operator">=</span> FxSpawnpool<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">;</span>
     PickedNumb  <span class="uscript-operator">=</span> Rand<span class="uscript-operator">(</span>PickedNumb<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
     ChosenFxClass <span class="uscript-operator">=</span> FxSpawnpool<span class="uscript-operator">[</span>PickedNumb<span class="uscript-operator">]</span><span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>

 SpawnedFx         <span class="uscript-operator">=</span> Spawn<span class="uscript-operator">(</span> ChosenFxClass <span class="uscript-operator">,</span> <span class="uscript-keyword">self</span> <span class="uscript-operator">,</span> <span class="uscript-operator">,</span> SpawnPos <span class="uscript-operator">,</span> Rotation <span class="uscript-operator">)</span><span class="uscript-operator">;</span>

<span class="uscript-keyword">If</span> <span class="uscript-operator">(</span> <span class="uscript-operator">(</span>SpawnedFx <span class="uscript-operator">!=</span> <span class="uscript-keyword">none</span> <span class="uscript-operator">)</span> <span class="uscript-operator">&amp;&amp;</span> <span class="uscript-operator">(</span> Hardattachedto <span class="uscript-operator">!=</span> <span class="uscript-keyword">none</span> <span class="uscript-operator">)</span> <span class="uscript-operator">)</span>
   <span class="uscript-operator">{</span>
    SpawnedFx<span class="uscript-operator">.</span>SetBase<span class="uscript-operator">(</span> Hardattachedto <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
   <span class="uscript-operator">}</span>
<span class="uscript-operator">}</span>

<span class="uscript-keyword">Function</span> <span class="uscript-type">Bool</span> IaNavBlocked<span class="uscript-operator">(</span> <span class="uscript-type">Float</span> ScanRadius <span class="uscript-operator">,</span> Vector NavPointLoc <span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
 <span class="uscript-keyword">Local</span> <span class="uscript-type">Bool</span>    bOccupied<span class="uscript-operator">;</span>
 <span class="uscript-keyword">Local</span> Actor   FoundActoror<span class="uscript-operator">;</span>

 <span class="uscript-keyword">foreach</span> radiusActors<span class="uscript-operator">(</span> <span class="uscript-keyword">Class</span><span class="uscript-name">'Actor'</span> <span class="uscript-operator">,</span> FoundActoror <span class="uscript-operator">,</span> ScanRadius <span class="uscript-operator">,</span> NavPointLoc <span class="uscript-operator">)</span>
      <span class="uscript-operator">{</span>
      <span class="uscript-keyword">If</span> <span class="uscript-operator">(</span> <span class="uscript-operator">(</span> FoundActoror <span class="uscript-operator">!=</span> <span class="uscript-keyword">Self</span> <span class="uscript-operator">)</span> <span class="uscript-operator">&amp;&amp;</span> <span class="uscript-operator">(</span> FoundActoror<span class="uscript-operator">.</span>bCollideActors <span class="uscript-operator">==</span> <span class="uscript-keyword">True</span> <span class="uscript-operator">)</span> <span class="uscript-operator">)</span>
         <span class="uscript-operator">{</span>
          bOccupied <span class="uscript-operator">=</span> <span class="uscript-keyword">True</span><span class="uscript-operator">;</span>
         <span class="uscript-operator">}</span>
      <span class="uscript-operator">}</span>

 <span class="uscript-keyword">Return</span> bOccupied<span class="uscript-operator">;</span>
<span class="uscript-operator">}</span>

<span class="uscript-keyword">Simulated</span> <span class="uscript-keyword">Function</span> Posttel<span class="uscript-operator">(</span> Pawn Teleporting <span class="uscript-operator">,</span> <span class="uscript-type">int</span> TelPointNumb <span class="uscript-operator">,</span> Vector NewVectorLoc <span class="uscript-operator">,</span> Rotator New_Rot <span class="uscript-operator">,</span> EPhysics EntryPhysics <span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
 Teleporting<span class="uscript-operator">.</span>SetPhysics<span class="uscript-operator">(</span> EntryPhysics <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
 Teleporting<span class="uscript-operator">.</span>Controller<span class="uscript-operator">.</span>moveTimer <span class="uscript-operator">=</span> <span class="uscript-operator">-</span><span class="uscript-number">1.0</span><span class="uscript-operator">;</span>
 Teleporting<span class="uscript-operator">.</span>SetmoveTarget<span class="uscript-operator">(</span> <span class="uscript-keyword">self</span> <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
 Teleporting<span class="uscript-operator">.</span>Controller<span class="uscript-operator">.</span>SetRotation<span class="uscript-operator">(</span> New_Rot <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
 Teleporting<span class="uscript-operator">.</span>SetRotation<span class="uscript-operator">(</span> New_Rot <span class="uscript-operator">)</span><span class="uscript-operator">;</span>

 <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span> Teleporting<span class="uscript-operator">.</span>IsA<span class="uscript-operator">(</span><span class="uscript-name">'ONSChopperCraft'</span><span class="uscript-operator">)</span>  <span class="uscript-operator">||</span>
      Teleporting<span class="uscript-operator">.</span>IsA<span class="uscript-operator">(</span><span class="uscript-name">'ONSHoverCraft'</span><span class="uscript-operator">)</span>    <span class="uscript-operator">||</span>
      Teleporting<span class="uscript-operator">.</span>IsA<span class="uscript-operator">(</span><span class="uscript-name">'ONSPlaneCraft'</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>
      <span class="uscript-operator">{</span>
       Teleporting<span class="uscript-operator">.</span>KSetStayUpright<span class="uscript-operator">(</span> <span class="uscript-keyword">True</span> <span class="uscript-operator">,</span> <span class="uscript-keyword">True</span> <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
      <span class="uscript-operator">}</span>

 VecBoost<span class="uscript-operator">(</span>onsVehicle<span class="uscript-operator">(</span>Teleporting<span class="uscript-operator">)</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>

 <span class="uscript-keyword">if</span> <span class="uscript-operator">(</span> TeleportSound <span class="uscript-operator">!=</span> <span class="uscript-keyword">None</span> <span class="uscript-operator">)</span>
    <span class="uscript-operator">{</span>
     PlaySound<span class="uscript-operator">(</span> TeleportSound <span class="uscript-operator">)</span><span class="uscript-operator">;</span>
    <span class="uscript-operator">}</span>
<span class="uscript-operator">}</span></pre><p>Here is a link to a .uc file for this script;-</p>
<p><a href="http://www.fataloverdose.copperstream.co.uk/fatal/demoscripts/vpmappingtools/classes/VehicleTeleporter.uc">[Download This Script]</a></p>
<h2><a name="0.3"></a>And Finally..</h2>
<p>Here is the VecTel Pakaged up in a single function which should make it nice and easy to patch into your own script . You will have to add an array to hold the telpoints (TpAct) to make it work. The function ScanTp() doesnt have to be there . if you have another way of fillinf the PTAct array then just using the VecTel() function will work fine.</p>
<pre class="uscript"><span class="uscript-keyword">Function</span> scanTp<span class="uscript-operator">(</span><span class="uscript-operator">)</span>
<span class="uscript-operator">{</span>
<span class="uscript-keyword">Local</span> Actor FoundtPoints<span class="uscript-operator">;</span>
<span class="uscript-keyword">if</span> <span class="uscript-operator">(</span> TpAct<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span> <span class="uscript-operator">&gt;</span> <span class="uscript-number">0</span> <span class="uscript-operator">)</span> TpAct<span class="uscript-operator">.</span><span class="uscript-keyword">Remove</span><span class="uscript-operator">(</span><span class="uscript-number">0</span><span class="uscript-operator">,</span>TpAct<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-keyword">foreach</span> Dynamicactors<span class="uscript-operator">(</span><span class="uscript-keyword">Class</span><span class="uscript-name">'actor'</span><span class="uscript-operator">,</span>FoundtPoints<span class="uscript-operator">,</span><span class="uscript-name">'TP'</span><span class="uscript-operator">)</span>
        <span class="uscript-operator">{</span>
        TpAct<span class="uscript-operator">.</span><span class="uscript-keyword">insert</span><span class="uscript-operator">(</span><span class="uscript-number">0</span><span class="uscript-operator">,</span><span class="uscript-number">1</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
        TpAct<span class="uscript-operator">[</span><span class="uscript-number">0</span><span class="uscript-operator">]</span><span class="uscript-operator">=</span>FoundtPoints<span class="uscript-operator">;</span>
        <span class="uscript-operator">}</span>
<span class="uscript-operator">}</span>

<span class="uscript-keyword">Simulated</span> <span class="uscript-keyword">Function</span> Vectel<span class="uscript-operator">(</span>Vehicle telePorting<span class="uscript-operator">)</span>

<span class="uscript-operator">{</span>

<span class="uscript-keyword">Local</span> Rotator  oldRot<span class="uscript-operator">,</span>newrot<span class="uscript-operator">;</span> <span class="uscript-keyword">Local</span> Vector Abf<span class="uscript-operator">,</span>pbf<span class="uscript-operator">;</span> <span class="uscript-keyword">Local</span> EPhysics Entryphysics<span class="uscript-operator">;</span> <span class="uscript-keyword">Local</span> <span class="uscript-type">Int</span> pickedTelPoint<span class="uscript-operator">;</span>
newRot         <span class="uscript-operator">=</span> telePorting<span class="uscript-operator">.</span>Rotation<span class="uscript-operator">;</span>
EntryPhysics   <span class="uscript-operator">=</span> telePorting<span class="uscript-operator">.</span>Physics<span class="uscript-operator">;</span>
ABF            <span class="uscript-operator">=</span> telePorting<span class="uscript-operator">.</span>Velocity <span class="uscript-operator">*</span> <span class="uscript-number">500</span><span class="uscript-operator">;</span>
pickedTelPoint <span class="uscript-operator">=</span> rand<span class="uscript-operator">(</span>TpAct<span class="uscript-operator">.</span><span class="uscript-keyword">Length</span><span class="uscript-number">-1</span><span class="uscript-operator">)</span><span class="uscript-operator">+</span><span class="uscript-number">1</span><span class="uscript-operator">;</span>
telePorting<span class="uscript-operator">.</span>SetPhysics<span class="uscript-operator">(</span>PHYS_None<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
telePorting<span class="uscript-operator">.</span>setLocation<span class="uscript-operator">(</span>TpAct<span class="uscript-operator">[</span>pickedTelPoint<span class="uscript-operator">]</span><span class="uscript-operator">.</span>Location<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
oldRot         <span class="uscript-operator">=</span> telePorting<span class="uscript-operator">.</span>Rotation<span class="uscript-operator">;</span>
newRot<span class="uscript-operator">.</span>Yaw     <span class="uscript-operator">=</span> TpAct<span class="uscript-operator">[</span>pickedTelPoint<span class="uscript-operator">]</span><span class="uscript-operator">.</span>Rotation<span class="uscript-operator">.</span>Yaw <span class="uscript-operator">+</span> telePorting<span class="uscript-operator">.</span>Rotation<span class="uscript-operator">.</span>Yaw <span class="uscript-operator">-</span> <span class="uscript-keyword">Self</span><span class="uscript-operator">.</span>Rotation<span class="uscript-operator">.</span>Yaw<span class="uscript-operator">;</span>
telePorting<span class="uscript-operator">.</span>SetPhysics<span class="uscript-operator">(</span>EntryPhysics<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
telePorting<span class="uscript-operator">.</span>Controller<span class="uscript-operator">.</span>moveTimer <span class="uscript-operator">=</span> <span class="uscript-operator">-</span><span class="uscript-number">1.0</span><span class="uscript-operator">;</span>
telePorting<span class="uscript-operator">.</span>SetmoveTarget<span class="uscript-operator">(</span><span class="uscript-keyword">Self</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
telePorting<span class="uscript-operator">.</span>Controller<span class="uscript-operator">.</span>SetRotation<span class="uscript-operator">(</span>newRot<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
telePorting<span class="uscript-operator">.</span>SetRotation<span class="uscript-operator">(</span>newRot<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-keyword">if</span> <span class="uscript-operator">(</span> telePorting<span class="uscript-operator">.</span>IsA<span class="uscript-operator">(</span><span class="uscript-name">'ONSChopperCraft'</span><span class="uscript-operator">)</span> <span class="uscript-operator">||</span> telePorting<span class="uscript-operator">.</span>IsA<span class="uscript-operator">(</span><span class="uscript-name">'ONSHoverCraft'</span><span class="uscript-operator">)</span>   <span class="uscript-operator">||</span>  telePorting<span class="uscript-operator">.</span>IsA<span class="uscript-operator">(</span><span class="uscript-name">'ONSPlaneCraft'</span><span class="uscript-operator">)</span><span class="uscript-operator">)</span>  telePorting<span class="uscript-operator">.</span>KSetStayUpright<span class="uscript-operator">(</span> <span class="uscript-keyword">True</span><span class="uscript-operator">,</span><span class="uscript-keyword">True</span><span class="uscript-operator">)</span><span class="uscript-operator">;</span>
telePorting<span class="uscript-operator">.</span>KAddImpulse<span class="uscript-operator">(</span>abf <span class="uscript-operator">&gt;&gt;</span> Rotation<span class="uscript-operator">,</span> pbf <span class="uscript-operator">&gt;&gt;</span> Rotation<span class="uscript-operator">)</span><span class="uscript-operator">;</span>
<span class="uscript-operator">}</span></pre><h2><a name="0.4"></a>Related Topics</h2>
<ul><li><a href="vitaloverdose-wormhole.html">VitalOverdose/Wormhole</a></li>
</ul>
<h2><a name="0.5"></a>Discussion</h2>
<p><em class="em2">Sweavo:</em> Hi, does this work in Net play?</p>
<p><em class="em2">VitalOverdose:</em> As far as i know yes. I havent had the slightest hiccup with it yet. Bu saying that, im not aa expert at the whole replication thing just yet but so it wouldnt suprise me if it needed a slight modification somewhere. I was thinking about giving it a bit of an update anyway so i'll give it a decent online test to be sure. Let me know if you have any problems with it at all.</p>
<p><em class="em2">Sweavo:</em> have you actually tried it in net play?  Not being funny, just trying to clarify</p>
<p><em class="em2">Tarquin:</em> What is a 'moving vec telpoints'? And what do you mean by an actor being 'not solid'? I think this needs a rewrite, starting with using Teleporter as a parent class, and with clearer names for the functions too. It's fine to abbreviate a local variable, especially if it's only a counter or a placeholder you only use a couple of times, but functions should have clear, non-abbreviated names. Who's up for working on this?</p>
<h2><a name="0.6"></a>Discussion</h2>
<p><em class="em3">(Moved from VehicleTeleporter)</em></p>
<p><em class="em2">Sweavo:</em> Hi, does this work in Net play?</p>
<p><em class="em2">Vitaloverdose</em> Yes it works in net play.</p>
<p><em class="em2">Tarquin:</em> I don't really see the advantage of having only one actor and using tags. Surely it makes it harder for the mapper to clearly see what is going on in the map. </p>
<p><em class="em2">MythOpus:</em> Although I do like having an 'all-on-one' actor like this, it really would be confusing and waht not and possibly slower than using a URL / TAG system with multiple teleporters.</p>
<p><em class="em2">Tarquin:</em> Another point about this &ndash; shouldn't it be a subclass of a navigation point,  for bots to use it?</p>
<p><em class="em2">Wormbo:</em> The best way to implement it would probably be a subclass of <a href="teleporter.html">Teleporter</a> so it can take advantage of the native pathing magic in UnrealEd. An yes, having source and destination actors of this class certainly helps mappers understand want's going on.</p>
<p><em class="em2">VitalOverdose:</em> <em class="em2">Vitaloverdose</em> originally made the player pawn version of this actor for my level ons-stellacruiser which had a couple of very large (60000uu or more) space ships in it i found using a dedicated teleporter to teleporter it was to easy for a defending team to hold off any invading players by spawn killing everyone as they teleported accross to attack the other sides powerCore. Static teleporters in a confined space can like a space ship can make for some very predictable game play especially with objective based team games. Even if they were placed far away from the start points people very quickly learnt which was the closest to them from their start points and everyone just headed for that point every time they respawned.I found it was very easy to work out which way people would be running once they entered your space ship and was just creating choke points as wave after wave of people enetered the ship in the same place.I know they could just use a vehicle to fly accross to the enemy ship but i always try to make my ONS map's just as playable on foot as when your in a vehicle. Also the idea was to have an anti-Blocking/Telefrag system. As telefragging can be a bit of a problem with static teleporters when you pop out on the other side to find your already under fire from the enemy and the only way out of the teleporter is to run in the direction of the person shooting. Also I didn't want someone to be able to simply block the teleport with a vehicle. and using a large amount of possible teleport locations seemed like the best solution at the time. I haven't got the anti-telefrag system in this script as its supposed to be the most generic version of the system. When i put the script together one of my main goals was to make something they was very easy for people to integrate into their own mods, ill put all the fancy stuff on the next version.Tarquin mentioned before about letting the mapper choose the label to indicate a possible 'teleport Point' but now I'm thinking of having multiple 'TP' points and allowing the mapper to weight the different sets of possible locations.</p>
<p>Remember you don't HAVE to use multiple spawn locations  If you use 1 teleporter and 1 spawn location its no more difficult to visualise than using a standard teleporter system. Its just an option ,the system is only as complicated as the mapper decides to make it. Also this should make it very simple to add this actor to any existing maps as they all have path-nodes already set out in places the play is able to navigate to..</p>
<p>Also the whole system works with moving teleport points as well <img alt=";)" src="emoticons/wink.gif" align="middle"></p>
<p>Using the teleporter as the parent class to make use of the built in navigational properties  seems like a good idea , its not something i would have come up with myself . I guess i could just completely overwrite the existing functions from the parent class completly which wouldnt be so bad.</p>
<p><em class="em2">Tarquin:</em> I suggest you try it. Subclassing to inherit behaviour is one of the very basic principles of coding in UnrealScript, after all <img alt=":)" src="emoticons/smile.gif" align="middle"></p>
<hr class="thin"><p><a href="category-custom-class.html">Category Custom Class</a></p>
<script type="text/javascript"><!--
 menuItemAdd("Overview", "#0.1");
menuItemAdd("Full Script", "#0.2");
menuItemAdd("And Finally..", "#0.3");
menuItemAdd("Related Topics", "#0.4");
menuItemAdd("Discussion", "#0.5");
menuItemAdd("Discussion", "#0.6");
 menuWrite() //--></script></div>
</div>

<div id="footer" class="bar">
	<p><form method="post" action="http://wiki.beyondunreal.com/wiki" enctype="application/x-www-form-urlencoded">
<a href="(start).html">Home Page</a> | <a href="vitaloverdose.html">VitalOverdose</a> | <a href="recent-changes.html">Recent Changes</a> | <a href="http://wiki.beyondunreal.com/wiki?action=editprefs">Preferences</a><br>
<a href="http://wiki.beyondunreal.com/wiki?action=edit&id=VitalOverdose/VehicleTeleporter">Edit text of this page</a> | <a href="http://wiki.beyondunreal.com/wiki?action=history&id=VitalOverdose/VehicleTeleporter">View other revisions</a><br>Last edited November 25, 2006 18:13 <a href="http://wiki.beyondunreal.com/wiki?action=browse&diff=1&id=VitalOverdose/VehicleTeleporter">(diff)</a><br>Search: <input type="text" name="search"  size="20" /><input type="hidden" name="dosearch" value="1"  /><br><br><small><a href="http://wiki.beyondunreal.com/wiki/VitalOverdose/VehicleTeleporter">Original page</a> &#150; copy created Sat, Jun 23, 2007</small><div></div>
</form>
	</p>
	<p>Once I get that upgrade to 36-hour days, I will tackle that. (Mychaeel)
</p>
</div>
</div><!-- close of "scrolling" div -->

<div id="quickbar">
	<div id="logo"><a href="http://wiki.beyondunreal.com/"><img src="shared/wikilogo.jpg" width="143" height="100" border="0"></a>
		</div>
	<div class="qbsitename">
		<p>The Unreal Engine Documentation Site</p>
	</div>
	<div class="qbsection">
<p><a href="metatopics.html">Wiki Community</a></p>
<p><a href="category-category.html">Topic Categories</a></p>
<p><a href="/cgi-bin/imageupload.cgi/wiki-ext/imageupload.htt" target="_blank ">Image Uploads</a></p>
<p><a href="http://wiki.beyondunreal.com/wiki?action=random">Random Page</a></p>
<p><a href="recent-changes.html">Recent Changes</a></p>
<p><a href="offline-wiki.html">Offline Wiki</a></p>
</div><div class="qbsection">
<p><a href="unreal-engine.html">Unreal Engine</a></p>
<p><a href="console-commands.html">Console Commands</a></p>
<p><a href="terminology.html">Terminology</a></p>
<p><a href="category-faq.html">FAQs</a></p>
<p><a href="help-desk.html">Help Desk</a></p>
</div><div class="qbsection">
<p><a href="topics-on-mapping.html">Mapping Topics</a></p>
<p><a href="mapping-lessons.html">Mapping Lessons</a></p>
<p><a href="unrealed-3.html">UnrealEd Interface</a></p>
</div><div class="qbsection">
<p><a href="unrealscript.html">UnrealScript Topics</a></p>
<p><a href="unrealscript-lessons.html">UnrealScript Lessons</a></p>
<p><a href="making-mods.html">Making Mods</a></p>
<p><a href="class-tree.html">Class Tree</a></p>
</div><div class="qbsection">
<p><a href="topics-on-modeling.html">Modeling Topics</a></p>
</div><div class="qbsection">
<p><a href="chongqing-page.html">Chongqing Page</a></p>
<p><a href="log-in.html">Log In</a></p></div>
</div>

</body></html>
