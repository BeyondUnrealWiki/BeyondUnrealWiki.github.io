<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"  "http://www.w3.org/TR/html4/loose.dtd">

<html>
<head lang="en">
	<title>UnrealWiki: Visual Studio 6</title>
	<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
	<link rel="stylesheet" type="text/css" media="screen, print"
		href="shared/stylebase.structural.css">	
	<link rel="stylesheet" type="text/css" media="screen"
		href="shared/template-default.css">
	<link rel="stylesheet" type="text/css" media="screen"
		href="shared/styles.chblue.css">
	<link rel="stylesheet" type="text/css" media="print"
		href="shared/template-default-print.css">
	<!--[if IE 6]>
			<style>
			/* dirty hack for IE6. */
			#quickbar {
				position: absolute;
				}
			</style>
	<![endif]-->
  <link rel="start" href="http://wiki.beyondunreal.com/">
  <link rel="glossary"  href="http://wiki.beyondunreal.com/wiki/Terminology">
  <link rel="help"  href="http://wiki.beyondunreal.com/wiki/Using_The_Wiki">
<script type="text/javascript" src="shared/dhtml.js"></script>
<script type="text/javascript" src="shared/dhtml-menu.js"></script>
<style type="text/css">#dhtml-menu    { background: #eee; padding: 5px 0px; margin-right: -20px; border: 1px solid #888; border-left: 1px solid #ccc; border-top: 1px solid #ccc;  border-right: 1px solid #888; border-bottom: 1px solid #888 }
#dhtml-menu td { color: #000; font-family: Arial,Helvetica,sans-serif; font-size: 9pt; line-height: 13pt; padding: 1px 10px; cursor: default }
#dhtml-menu a  { color: #000; font-family: Arial,Helvetica,sans-serif; font-size: 9pt; line-height: 13pt; text-decoration: none }
#dhtml-menu tt { font-family: monospace; font-size: 9pt }
#dhtml-menu-separator { height: 1px; background: red }
#dhtml-menu-anchor { cursor: default }
</style>
<script type="text/javascript" src="shared/expandable.js"></script>
</head>
<body onLoad="menuInit(); document.cookie='page=Visual_Studio_6; path=/'" class="default">
<div id="scrolling"><!-- contains all except the fixed sidebar -->
<div id="topbar"  class="bar">
	<div class="righthalf">
		<form class="inline" method="post" action="/wiki" enctype="application/x-www-form-urlencoded"><input type="text" name="search"  size="20" /> <input type="submit" name="search" value="search" /></form>
	</div>
	<div class="lefthalf">
		<script type="text/javascript"><!--
			menuAlignRight = false;
		//--></script>
		<span><script type="text/javascript"><!--
 menuWriteAnchor("Quick Navigation") //--></script></span> | <a href="(start).html">Home Page</a> | <a href="recent-changes.html">Recent Changes</a> | <a href="http://wiki.beyondunreal.com/wiki?action=editprefs">Preferences</a>
	</div>
</div>

<div id="content"><!-- contains the title and article -->
	<h1 class='pagetitle'><a href="http://wiki.beyondunreal.com/wiki?back=Visual Studio 6">Visual Studio 6</a></h1>
	<div class="wiki"><p><em class="em2">Visual Studio 6 (VS6)</em> and <em class="em2">Visual Studio .NET (VS.NET)</em> are <a href="ide.html">IDE</a>s that can be set up for use as <a href="unrealscript.html">UnrealScript</a> editors. They work great and have some good features, plus if you already use VS, you will feel right at home.</p>
<p>If someone has a place I can put some graphic files and 1 starter file, I'll update this to make it much easier... If you want the starter file, and you see me <a href="obwando.html">OBWANDO</a> on IRC or somewhere , just ask... ill send it to you until I find a way to get it up here...</p>
<h2><a name="0.1"></a>Getting the Unreal Script source readily available</h2>
<p>First of all, make sure you've exported all the .uc's from the game's packages. You can go get the source or learn how to extract them from here: <a href="unrealscript-source.html">UnrealScript Source</a></p>
<h2><a name="0.2"></a>Setting up Visual Studio 6</h2>
<p>Next go to the UDN page here: <span class="interwiki"><img 
        alt="udntech logo"
        title="udntech"
        src="shared//InterWiki-udntech.png">&nbsp;<a href="http://udn.epicgames.com/Two/UnrealScriptHighlighting">UnrealScriptHighlighting</a></span> and follow the directions for getting the syntax highlighter to work in VS6. This will let you see the uscript words in a different color and makes reading code easier.</p>
<h3><a name="0.2.1"></a>Using a batch file for compilation</h3>
<p>You will need to create a batch file to help automate things. So... Crank up your notepad</p>
<p>The batch file should have the following in it:</p>
<pre class="uscript"><span class="uscript-operator">@</span>ECHO OFF
del <span class="uscript-operator">%</span><span class="uscript-number">1</span><span class="uscript-operator">.</span>u
ucc make</pre><p>And save it as: <em class="em2">MakePackage.bat</em> and save it in your {<a href="base-directory.html">Base Directory</a>}\System folder. (Make sure you didn't accidentally save it as MakePackage.bat<em class="em2">.txt</em>.)</p>
<ol><li>Select <em class="em1">Tools</em> &rarr; <em class="em1">Customize</em> from the menu bar.</li>
<li>Click on the <em class="em1">Tools</em> Tab and select the small graphic that looks like a square with a yellow star in the corner. It will take you to the bottom of the list.</li>
<li>In the empty field enter <code>&amp;UCC Release Builder</code>. If you want, you can use the arrows above to move it up in the list if you want.</li>
<li>In the <em class="em1">Command</em> field you put the following command (change the path to reflect <a href="base-directory.html">Base Directory</a>):<br><tt>&nbsp;&nbsp;C:\UT2003\system\MakePackage.bat</tt></li>
<li>In the <em class="em1">Arguments</em> field, enter:<br><tt>&nbsp;&nbsp;$(WkspName)</tt></li>
<li>In the <em class="em1">Initial Directory</em> field enter your {<a href="base-directory.html">Base Directory</a>}\System directory, for example:<br><tt>&nbsp;&nbsp;C:\UT2003\system</tt></li>
<li>Make sure <em class="em1">Use Output Window</em> is checked. and click on <em class="em1">Close</em>.</li>
</ol>
<h3><a name="0.2.2"></a>Using UMake for compilation</h3>
<p><a href="umake.html">UMake</a> is a graphical front-end for the UnrealScript compiler.</p>
<ol><li>Download and install <a href="umake.html">UMake</a>.</li>
<li>Proceed as described in the previous section, but:<ul><li>Enter your path to UMake.exe in the <em class="em1">Command</em> field (pointing to wherever you installed UMake in), for example:<br><tt>&nbsp;&nbsp;C:\UT2003\System\UMake.exe</tt></li>
<li>In the <em class="em1">Arguments</em> field, enter:<br><tt>&nbsp;&nbsp;$(FileName)</tt></li>
</ul>
</li>
</ol>
<h3><a name="0.2.3"></a>Creating the packages and workspace</h3>
<p>Once you have all of that together, you will need to create your new Visual Studio Workspace, and add each package that corresponds with a UT class. If you dont feel like doing this, you can nab mine when i find a place to get it hosted (~293k).</p>
<p>An ideal directory structure would be like this: e:\ut2003\_vc  &lt;&ndash; that is where your workspace will go.</p>
<p>If you dont see your workspace files, click on <em class="em2">View</em> then <em class="em2">Workspace</em></p>
<p>Just call the workspace _vc and save it in that folder. Then you need to create a new package for each class. You will perform the same process for adding a new mod into your workspace. This works very well since you will be able to work with multiple mods without any of them getting in the way of the other.</p>
<p>Creating a new package or setting up the base packages for UT2k3</p>
<p>1. At this point you need to go the menu bar in VS6 and click on <em class="em2">File</em> then on <em class="em2">New</em>.</p>
<p>2. Click on the tab called <em class="em2">Projects</em> and click on <em class="em2">Win32 Dynamic-Link Library</em>.</p>
<p>3. Make sure your location is pointing to the correct path. Example: <em class="em2">e:\ut2003\_vc</em></p>
<p>4. Add the name in <em class="em2">Project name</em>. In this case we're going to use <em class="em2">Core</em>. You will see the location is now <em class="em2">e:\ut2003\_vc\Core</em></p>
<p>5. Make sure it <em class="em2">Add to current Workspace</em> is selected, and <em class="em2">Dependency of</em> is <em class="em2">NOT</em> checked.</p>
<p>6. Click on <em class="em2">OK</em>. At the next dialog, select <em class="em2">An Empty DLL project</em> and click <em class="em2">Finish</em>, and then click <em class="em2">OK</em></p>
<p><BR></p>
<p>At this point you have a nice new shiny project, but it needs some editing...</p>
<p>1. Expand the Boldfaced Project name which in this case is <em class="em2">Core</em>.</p>
<p>2. You will see 3 folders (if you dont, click on <em class="em2">FileView</em> on the bottom of that window).</p>
<p>3. Click on Source Files and hit the delete key. Do the same for <em class="em2">Header Files</em>, and <em class="em2">Resource Files</em>.</p>
<p>4. Right-Click on your boldfaced project (which we are calling 'core' here) and click on <em class="em2">New Folder</em></p>
<p>5. The name of the new folder should be <em class="em2">Classes</em> and the file extension is <em class="em2">.uc</em> and hit <em class="em2">OK</em></p>
<p>6. Right-Click on the <em class="em2">Classes</em> folder you just make and click on <em class="em2">Add files to folder</em></p>
<p>7. In the dialog box, go to your folder that has the .uc files in it. Which in this case is <em class="em2">e:\ut2003\core\classes</em></p>
<p>8. You will have to change the filemask to <em class="em2">*.*</em> below the filenames to see the .uc files. Select the .uc (commandlet, locale, object, subsystem, time) files and click <em class="em2">OK</em></p>
<p><em class="em3"> Make sure you are looking at the \ut2003\&ndash;MOD&ndash; folder and not \ut2003\_vc\&ndash;MOD&ndash; folder.. there are no files stored in the _vc folder only references. </em></p>
<p>At this point i'm going to assume you have all of the packages done for each UT2k3 package and your mod as well.</p>
<p>Make sure your project is boldfaced. You can do this by right-clicking on your package and selecting <em class="em2">Set as Active Project</em>. Why? Ill explain in a bit.</p>
<p><em class="em2">MAKE SURE YOU SAVE EVERYTHING AT THIS POINT!!! USE THE TRIPLE DISK LOOKING ICON TO SAVE ALL OR USE THE MENU PULLDOWN</em></p>
<hr class="thin"><p>If you have a custom mod, make sure you have it in your {BaseDirectory<a href="http://wiki.beyondunreal.com/wiki?action=edit&id=BaseDirectory&referrerid=Visual_Studio_6">?</a>}/System/UT2003.ini file in the <em class="em2">EditPackages</em> section at the end of the list. Example: <em class="em2">EditPackages=MYMOD</em></p>
<p>If you dont do that step, you can compile until your drive falls out, and it will not compile your mod. There are exceptions using custom .ini files, but that is too indepth for this page.</p>
<p>Now you should have all of the packages on the left side visible. If you expand the package, and expand the classes, you should see all of the files for each one. You can double click on any of the .uc files and it will show in the editor.</p>
<p>Now to build your package, you can go to <em class="em2">Tools</em> Then select <em class="em2">UCC Release Builder</em>. and it will delete the old .u file that has the same name as the project you have boldfaced on the left sidebar. It will then compile the packages and place the output in your {BaseDirectory<a href="http://wiki.beyondunreal.com/wiki?action=edit&id=BaseDirectory&referrerid=Visual_Studio_6">?</a>}/System folder.</p>
<h2><a name="0.3"></a>Why VS6? </h2>
<ul><li>Well if you get an error, you can double click on that line, and it will go to that file, open it and jump to that line...</li>
<li>If you need to find a class or word, use the menu bar <em class="em2">Edit</em> and <em class="em2">Find in files</em> and put your word in, make sure the path points to your /ut2003 folder, and the <em class="em2">In Files/File Types</em> is set to <em class="em2">*.uc</em> It will show every instance of that word in every file will be shown to you. Just double click on that line and it will open the file and jump to that line. This is great for researching code and finding usable areas on how other coders and Epic did a lot of their routines, as well as finding some of your own.</li>
<li>Multiple packages in 1 editor. Just set another package as the <em class="em2">Active</em> package and you can keep working without fumbling around in directories.</li>
<li>Add macros to use CVS or use Sourcesafe natively, or add extra icons and macros to start up dedicated servers, build debug versions, or whatever.</li>
</ul>
<p>I hope this helps everyone, and there is no <em class="em2">Right</em> or <em class="em2">Wrong</em> editor to use, just the one you are most comfortable with. I use VS6 all of time since I do C/C++/ASM work (yes i use nasm as well) and I am comfortable with the environment. This can be adopted for Visual Studio .Net as well, and you can find more info on that on the UDN, but the method is still pretty much the same.</p>
<p>Good luck and happy Coding!</p>
<h2><a name="0.4"></a>Related Topics</h2>
<ul><li><a href="setting-up-unrealscript.html">Setting Up UnrealScript</a></li>
</ul>
<h2><a name="0.5"></a>Comments</h2>
<p><em class="em2">GRAF1K:</em> Visual Studio .NET is even more useful. Perhaps a new section or page on that would be useful.</p>
<h2><a name="0.6"></a>Setting Up Visual Studio .NET</h2>
<p>Go to the UDN page here: <span class="interwiki"><img 
        alt="udntech logo"
        title="udntech"
        src="shared//InterWiki-udntech.png">&nbsp;<a href="http://udn.epicgames.com/Two/UnrealScriptHighlighting">UnrealScriptHighlighting</a></span> and follow the directions for getting the syntax highlighter to work in VS .NET. This will let you see the uscript words in a different color and makes reading code easier.</p>
<h3><a name="0.6.1"></a>Using a batch file for compilation</h3>
<p>You will need to create a batch file to help automate things. So... Crank up your notepad</p>
<p>The batch file should have the following in it:</p>
<pre class="uscript"><span class="uscript-operator">@</span>ECHO OFF
del <span class="uscript-operator">%</span><span class="uscript-number">1</span><span class="uscript-operator">.</span>u
ucc make</pre><p>And save it as: <em class="em2">MakePackage.bat</em> and save it in your {<a href="base-directory.html">Base Directory</a>}\System folder. (Make sure you didn't accidentally save it as MakePackage.bat<em class="em2">.txt</em>.)</p>
<ol><li>Select <em class="em1">Tools</em> &rarr; <em class="em1">External Tools</em> from the menu bar.</li>
<li>Click the <em class="em1">Add</em> button. A new entry with the name <code>[New Tool 1]</code> will be added at the bottom of the list.</li>
<li>In the <em class="em1">Title</em> field enter <code>&amp;UCC Release Builder</code>. The entry in the list will adjust accordingly.</li>
<li>In the <em class="em1">Command</em> field you put the following command (change the path to reflect <a href="base-directory.html">Base Directory</a>):<br><tt>&nbsp;&nbsp;C:\UT2003\system\MakePackage.bat</tt></li>
<li>In the <em class="em1">Arguments</em> field, enter:<br><tt>&nbsp;&nbsp;$(SolutionFileName)</tt></li>
<li>In the <em class="em1">Initial Directory</em> field enter your {<a href="base-directory.html">Base Directory</a>}\System directory, for example:<br><tt>&nbsp;&nbsp;C:\UT2003\system</tt></li>
<li>Make sure <em class="em1">Use Output Window</em> is checked, and click on <em class="em1">OK</em>.</li>
</ol>
<h3><a name="0.6.2"></a>Using UMake for compilation</h3>
<ol><li>Download and install <a href="umake.html">UMake</a>.</li>
<li>Proceed as described in the previous section, but:<ul><li>Enter your path to UMake.exe in the <em class="em1">Command</em> field (pointing to wherever you installed UMake in), for example:<br><tt>&nbsp;&nbsp;C:\UT2003\System\UMake.exe</tt></li>
<li>In the <em class="em1">Arguments</em> field, enter:<br><tt>&nbsp;&nbsp;$(FileName)</tt></li>
</ul>
</li>
</ol>
<p>You can have the <em class="em1">Edit</em> button in UMake open erroneos files in the studio, but it will do so in a new window every time. If you want to be able to use it anyway, start UMake, click <em class="em1">Options</em>, make sure the <em class="em1">General</em> tab is selected and copy/paste the following into the <em class="em1">Source code editor</em> field:</p>
<p><tt>"C:\Program Files\Microsoft Visual Studio .NET\Common7\IDE\devenv.exe" %errfile% /command "Edit.GoTo %errline%"</tt></p>
<p>Change <tt>C:\Program Files\Microsoft Visual Studio .NET </tt> to the directory where you installed your Visual Studio.</p>
<h2><a name="0.7"></a>Comments</h2>
<p><em class="em2">DarthDevilous</em>: This is just the start, and I hope someone else will continue. Since I have not got some great scripting project waiting I cannot really test the rest to see whether it works. On another note, I can't get the script highlighting for VS.NET to work properly. The only difference I can see is that <em class="em2">super</em> is highlighted and that may be because I have never used it as a keyword before.</p>
<p><em class="em2">Phoenix</em>: You can get VS.NET to work properly easily&ndash;it's not very well documented on the website you've mentioned:</p>
<ol><li>Fire up regedit, and go to HKEY_LOCAL_MACHINE\Software\VisualStudio\[YourVersion]\Languages\File Extensions, add .uc if it's not there.</li>
<li>Change the (Default) value to {B2F072B0-ABC1-11D0-9D62-00C04FD9DFD9}</li>
<li>Download the usertype.dat from the site above (<span class="interwiki"><img 
        alt="udntech logo"
        title="udntech"
        src="shared//InterWiki-udntech.png">&nbsp;<a href="http://udn.epicgames.com/Two/UnrealScriptHighlighting">UnrealScriptHighlighting</a></span>) and save it to [VisualStudio]\Common7\IDE</li>
<li>You can also edit usertype.dat to add/remove any keywords.</li>
<li>Restart Visual Studio</li>
</ol>
<p>This has been tested &amp; confirmed working on Visual Studio 2005.</p>
<p><em class="em2">Daktor</em>: I cannot find the download for usertype.dat, can someone upload it or show where it is on (<span class="interwiki"><img 
        alt="udntech logo"
        title="udntech"
        src="shared//InterWiki-udntech.png">&nbsp;<a href="http://udn.epicgames.com/Two/UnrealScriptHighlighting">UnrealScriptHighlighting</a></span>)?  Thanks.</p>
<script type="text/javascript"><!--
 menuItemAdd("Getting the Unreal Script source readily available", "#0.1");
menuItemAdd("Setting up Visual Studio 6", "#0.2");
menuItemAdd("<tt>&nbsp;&nbsp;</tt>Using a batch file for compilation", "#0.2.1");
menuItemAdd("<tt>&nbsp;&nbsp;</tt>Using UMake for compilation", "#0.2.2");
menuItemAdd("<tt>&nbsp;&nbsp;</tt>Creating the packages and workspace", "#0.2.3");
menuItemAdd("Why VS6? ", "#0.3");
menuItemAdd("Related Topics", "#0.4");
menuItemAdd("Comments", "#0.5");
menuItemAdd("Setting Up Visual Studio .NET", "#0.6");
menuItemAdd("<tt>&nbsp;&nbsp;</tt>Using a batch file for compilation", "#0.6.1");
menuItemAdd("<tt>&nbsp;&nbsp;</tt>Using UMake for compilation", "#0.6.2");
menuItemAdd("Comments", "#0.7");
 menuWrite() //--></script></div>
</div>

<div id="footer" class="bar">
	<p><form method="post" action="http://wiki.beyondunreal.com/wiki" enctype="application/x-www-form-urlencoded">
<a href="(start).html">Home Page</a> | <a href="recent-changes.html">Recent Changes</a> | <a href="http://wiki.beyondunreal.com/wiki?action=editprefs">Preferences</a><br>
<a href="http://wiki.beyondunreal.com/wiki?action=edit&id=Visual_Studio_6">Edit text of this page</a> | <a href="http://wiki.beyondunreal.com/wiki?action=history&id=Visual_Studio_6">View other revisions</a><br>Last edited May 29, 2007 14:50 <a href="http://wiki.beyondunreal.com/wiki?action=browse&diff=1&id=Visual_Studio_6">(diff)</a><br>Search: <input type="text" name="search"  size="20" /><input type="hidden" name="dosearch" value="1"  /><br><br><small><a href="http://wiki.beyondunreal.com/wiki/Visual_Studio_6">Original page</a> &#150; copy created Sat, Jun 23, 2007</small><div></div>
</form>
	</p>
	<p>Cogito, ergo sum
</p>
</div>
</div><!-- close of "scrolling" div -->

<div id="quickbar">
	<div id="logo"><a href="http://wiki.beyondunreal.com/"><img src="shared/wikilogo.jpg" width="143" height="100" border="0"></a>
		</div>
	<div class="qbsitename">
		<p>The Unreal Engine Documentation Site</p>
	</div>
	<div class="qbsection">
<p><a href="metatopics.html">Wiki Community</a></p>
<p><a href="category-category.html">Topic Categories</a></p>
<p><a href="/cgi-bin/imageupload.cgi/wiki-ext/imageupload.htt" target="_blank ">Image Uploads</a></p>
<p><a href="http://wiki.beyondunreal.com/wiki?action=random">Random Page</a></p>
<p><a href="recent-changes.html">Recent Changes</a></p>
<p><a href="offline-wiki.html">Offline Wiki</a></p>
</div><div class="qbsection">
<p><a href="unreal-engine.html">Unreal Engine</a></p>
<p><a href="console-commands.html">Console Commands</a></p>
<p><a href="terminology.html">Terminology</a></p>
<p><a href="category-faq.html">FAQs</a></p>
<p><a href="help-desk.html">Help Desk</a></p>
</div><div class="qbsection">
<p><a href="topics-on-mapping.html">Mapping Topics</a></p>
<p><a href="mapping-lessons.html">Mapping Lessons</a></p>
<p><a href="unrealed-3.html">UnrealEd Interface</a></p>
</div><div class="qbsection">
<p><a href="unrealscript.html">UnrealScript Topics</a></p>
<p><a href="unrealscript-lessons.html">UnrealScript Lessons</a></p>
<p><a href="making-mods.html">Making Mods</a></p>
<p><a href="class-tree.html">Class Tree</a></p>
</div><div class="qbsection">
<p><a href="topics-on-modeling.html">Modeling Topics</a></p>
</div><div class="qbsection">
<p><a href="chongqing-page.html">Chongqing Page</a></p>
<p><a href="log-in.html">Log In</a></p></div>
</div>

</body></html>
